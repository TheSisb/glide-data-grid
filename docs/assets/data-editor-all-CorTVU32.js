const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-Bl1R5Njo.js","./iframe-rB5HGBxK.js","./preload-helper-C1FmrZbK.js","./index-CZP4DswY.js","./image-window-loader-CrVYDwEC.js","./throttle-CXm9as3A.js","./marked.esm-C1-Y-mj2.js","./image-window-loader-DhbFCWIb.css","./flatten-BV4h7nnH.js","./scrolling-data-grid-yyWWlC-z.js","./scrolling-data-grid-wZ406GJK.css","./data-grid-overlay-editor-Cmj_ecGQ.css"])))=>i.map(i=>d[i]);
var _l=Object.defineProperty;var Xl=(t,o,i)=>o in t?_l(t,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[o]=i;var hn=(t,o,i)=>Xl(t,typeof o!="symbol"?o+"":o,i);import{r as l,R as ge}from"./iframe-rB5HGBxK.js";import{_ as Yl}from"./preload-helper-C1FmrZbK.js";import{G as J,b as Ko,i as Io,m as ql,r as nr,c as Wo,C as Y,g as hr,d as jl,w as gt,e as Zl,f as Jl,h as gn,j as rr,I as Fo,p as Ql,k as ei,t as ti,l as oi,n as Gt,o as lr,q as ir,s as ni,v as $o,x as eo,y as ri,z as li,A as ii,B as ci,D as si,E as cr,F as to,H as ai,J as ui,K as sr,L as di,u as mn,M as fi,N as hi,T as gi,O as ar,P as mi,Q as vi}from"./image-window-loader-CrVYDwEC.js";import{m as St,r as Kt,g as Ci}from"./throttle-CXm9as3A.js";import{u as pi,f as ur}from"./flatten-BV4h7nnH.js";import{G as wi}from"./scrolling-data-grid-yyWWlC-z.js";import{s as pn}from"./marked.esm-C1-Y-mj2.js";const j='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',bi=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${j}<rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${o}"/></svg>`},yi=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${j}<rect x="2" y="2" width="16" height="16" rx="4" fill="${i}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${o}"/></svg>`},xi=t=>{const o=t.fgColor,i=t.bgColor;return`${j}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${o}"/>
  </svg>`},Mi=t=>{const o=t.fgColor,i=t.bgColor;return`${j}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${o}"/>
</svg>`},Ri=t=>{const o=t.fgColor,i=t.bgColor;return`${j}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${i}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${o}"
    />
</svg>`},gr=t=>{const o=t.fgColor,i=t.bgColor;return`${j}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${o}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${o}"/>
</svg>
  `},ki=t=>{const o=t.bgColor;return`${j}
    <path stroke="${o}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${o}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${o}"/>
  </svg>
`},Si=gr,Ti=t=>{const o=t.fgColor,i=t.bgColor;return`${j}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${o}"/>
</svg>`},zi=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${j}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${o}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${o}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
  </svg>`},Ei=t=>{const o=t.fgColor,i=t.bgColor;return`${j}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${o}"/>
</svg>`},Li=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${j}
    <path fill="${o}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${i}"/>
  </svg>`},Hi=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${j}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${o}"/>
  </svg>`},Di=t=>{const o=t.fgColor,i=t.bgColor;return`${j}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${o}"/>
</svg>`},Ii=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${j}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${o}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${o}"/>
  </svg>`},Fi=t=>{const o=t.fgColor,i=t.bgColor;return`${j}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${o}"/>
</svg>`},$i=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${j}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${i}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${i}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${o}"/>
  </svg>`},Ai=t=>{const o=t.fgColor,i=t.bgColor;return`${j}
  <path fill="${o}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${i}"/>
</svg>`},Pi=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${j}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${o}"/>
  </svg>`},Gi=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${j}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${o}"/>
  </svg>`},Ki=t=>{const o=t.fgColor,i=t.bgColor;return`${j}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${o}"/>
</svg>`},Wi=t=>{const o=t.fgColor,i=t.bgColor;return`${j}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${o}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${o}"/>
</svg>`},Ni=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${j}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${o}"/>
  </svg>`},Oi=t=>{const o=t.fgColor,i=t.bgColor;return`${j}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${o}"/>
</svg>`},Ui=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${j}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${o}"/>
  </svg>`},Vi=t=>{const o=t.fgColor,i=t.bgColor;return`${j}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${o}"/>
</svg>`},Bi=t=>{const o=t.fgColor,i=t.bgColor;return`${j}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${o}"/>
</svg>`},_i=t=>{const o=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${t.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>`},Xi=t=>{const o=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${t.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>
`},Yi={headerRowID:bi,headerNumber:xi,headerCode:yi,headerString:Mi,headerBoolean:Ri,headerAudioUri:Si,headerVideoUri:Ti,headerEmoji:zi,headerImage:Ei,headerUri:gr,headerPhone:Li,headerMarkdown:Hi,headerDate:Di,headerTime:Ii,headerEmail:Fi,headerReference:$i,headerIfThenElse:Ai,headerSingleValue:Pi,headerLookup:Gi,headerTextTemplate:Ki,headerMath:Wi,headerRollup:Ni,headerJoinStrings:Oi,headerSplitString:Ui,headerGeoDistance:Vi,headerArray:Bi,rowOwnerOverlay:_i,protectedColumnOverlay:Xi,renameIcon:ki},qi=pn("div")({name:"SearchWrapper",class:"slyseh9",propsAsIs:!1}),ji=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),Zi=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),Ji=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),Qi=10,ec=t=>{const{canvasRef:o,cellYOffset:i,rows:f,columns:p,searchInputRef:y,searchValue:L,searchResults:b,onSearchValueChange:M,getCellsForSelection:F,onSearchResultsChanged:v,showSearch:R=!1,onSearchClose:T}=t,[V]=l.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[_,ie]=l.useState(""),ye=L??_,U=l.useCallback(E=>{ie(E),M==null||M(E)},[M]),[A,Q]=l.useState(),Ge=l.useRef(A);Ge.current=A,l.useEffect(()=>{b!==void 0&&(b.length>0?Q(E=>({rowsSearched:f,results:b.length,selectedIndex:(E==null?void 0:E.selectedIndex)??-1})):Q(void 0))},[f,b]);const N=l.useRef();N.current===void 0&&(N.current=new AbortController);const Z=l.useRef(),[xe,Te]=l.useState([]),fe=b??xe,W=l.useCallback(()=>{Z.current!==void 0&&(window.cancelAnimationFrame(Z.current),Z.current=void 0),N.current!==void 0&&N.current.abort(),N.current=new AbortController},[]),oe=l.useRef(i);oe.current=i;const se=l.useCallback(E=>{const pe=new RegExp(E.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let re=oe.current,ze=Math.min(10,f),Fe=0;Q(void 0),Te([]);const _e=[],Tt=async()=>{var rt;if(F===void 0)return;const No=performance.now(),Oo=f-Fe;let mt=F({x:0,y:re,width:p.length,height:Math.min(ze,Oo,f-re)},N.current.signal);typeof mt=="function"&&(mt=await mt());let zt=!1;for(const[vt,Ct]of mt.entries())for(const[Ze,ce]of Ct.entries()){let ae;switch(ce.kind){case J.Text:case J.Number:ae=ce.displayData;break;case J.Uri:case J.Markdown:ae=ce.data;break;case J.Boolean:ae=typeof ce.data=="boolean"?ce.data.toString():void 0;break;case J.Image:case J.Bubble:ae=ce.data.join("üê≥");break;case J.Custom:ae=ce.copyData;break}ae!==void 0&&pe.test(ae)&&(_e.push([Ze,vt+re]),zt=!0)}const Uo=performance.now();zt&&Te([..._e]),Fe+=mt.length,Ko(Fe<=f);const no=((rt=Ge.current)==null?void 0:rt.selectedIndex)??-1;Q({results:_e.length,rowsSearched:Fe,selectedIndex:no}),v==null||v(_e,no),re+ze>=f?re=0:re+=ze;const ro=Uo-No,ot=Math.max(ro,1),nt=Qi/ot;ze=Math.ceil(ze*nt),Fe<f&&_e.length<1e3&&(Z.current=window.requestAnimationFrame(Tt))};W(),Z.current=window.requestAnimationFrame(Tt)},[W,p.length,F,v,f]),ne=l.useCallback(()=>{var E;T==null||T(),Q(void 0),Te([]),v==null||v([],-1),W(),(E=o==null?void 0:o.current)==null||E.focus()},[W,o,T,v]),Me=l.useCallback(E=>{U(E.target.value),b===void 0&&(E.target.value===""?(Q(void 0),Te([]),W()):se(E.target.value))},[se,W,U,b]);l.useEffect(()=>{y.current!==null&&(U(""),Q(void 0),xe.length>0&&(Te([]),v==null||v([],-1)),R?y.current.focus({preventScroll:!0}):W())},[R,y]);const Ie=l.useCallback(E=>{var re;if((re=E==null?void 0:E.stopPropagation)==null||re.call(E),A===void 0||A.results===0)return;const pe=(A.selectedIndex+1)%A.results;Q({...A,selectedIndex:pe}),v==null||v(fe,pe)},[A,v,fe]),Ve=l.useCallback(E=>{var re;if((re=E==null?void 0:E.stopPropagation)==null||re.call(E),A===void 0||A.results===0)return;let pe=(A.selectedIndex-1)%A.results;pe<0&&(pe+=A.results),Q({...A,selectedIndex:pe}),v==null||v(fe,pe)},[v,fe,A]),Wt=l.useCallback(E=>{(E.ctrlKey||E.metaKey)&&E.nativeEvent.code==="KeyF"||E.key==="Escape"?(ne(),E.stopPropagation(),E.preventDefault()):E.key==="Enter"&&(E.shiftKey?Ve():Ie())},[ne,Ie,Ve]);l.useEffect(()=>()=>{W()},[W]);const[Be,Ke]=l.useState(!1);l.useEffect(()=>{if(R)Ke(!0);else{const E=setTimeout(()=>Ke(!1),150);return()=>clearTimeout(E)}},[R]);const oo=l.useMemo(()=>{if(!R&&!Be)return null;let E;A!==void 0&&(E=A.results>=1e3?"over 1000":`${A.results} result${A.results!==1?"s":""}`,A.selectedIndex>=0&&(E=`${A.selectedIndex+1} of ${E}`));const pe=Fe=>{Fe.stopPropagation()},ze={width:`${f>0?Math.floor(((A==null?void 0:A.rowsSearched)??0)/f*100):0}%`};return l.createElement(qi,{className:"gdg-search-bar"+(R?"":" out"),onMouseDown:pe,onMouseMove:pe,onMouseUp:pe,onClick:pe},l.createElement("div",{className:"gdg-search-bar-inner"},l.createElement("input",{id:V,"aria-hidden":!R,"data-testid":"search-input",ref:y,onChange:Me,value:ye,tabIndex:R?void 0:-1,onKeyDownCapture:Wt}),l.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!R,tabIndex:R?void 0:-1,onClick:Ve,disabled:((A==null?void 0:A.results)??0)===0},ji),l.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!R,tabIndex:R?void 0:-1,onClick:Ie,disabled:((A==null?void 0:A.results)??0)===0},Zi),T!==void 0&&l.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!R,"data-testid":"search-close-button",tabIndex:R?void 0:-1,onClick:ne},Ji)),A!==void 0?l.createElement(l.Fragment,null,l.createElement("div",{className:"gdg-search-status"},l.createElement("div",{"data-testid":"search-result-area"},E)),l.createElement("div",{className:"gdg-search-progress",style:ze})):l.createElement("div",{className:"gdg-search-status"},l.createElement("label",{htmlFor:V},"Type to search")))},[R,Be,A,f,V,y,Me,ye,Wt,Ve,Ie,T,ne]);return l.createElement(l.Fragment,null,l.createElement(wi,{prelightCells:fe,accessibilityHeight:t.accessibilityHeight,canvasRef:t.canvasRef,cellXOffset:t.cellXOffset,cellYOffset:t.cellYOffset,className:t.className,clientSize:t.clientSize,columns:t.columns,disabledRows:t.disabledRows,enableGroups:t.enableGroups,fillHandle:t.fillHandle,firstColAccessible:t.firstColAccessible,nonGrowWidth:t.nonGrowWidth,fixedShadowX:t.fixedShadowX,fixedShadowY:t.fixedShadowY,freezeColumns:t.freezeColumns,getCellContent:t.getCellContent,getCellRenderer:t.getCellRenderer,getGroupDetails:t.getGroupDetails,getRowThemeOverride:t.getRowThemeOverride,groupHeaderHeight:t.groupHeaderHeight,headerHeight:t.headerHeight,highlightRegions:t.highlightRegions,imageWindowLoader:t.imageWindowLoader,initialSize:t.initialSize,isFilling:t.isFilling,isFocused:t.isFocused,lockColumns:t.lockColumns,maxColumnWidth:t.maxColumnWidth,minColumnWidth:t.minColumnWidth,onHeaderMenuClick:t.onHeaderMenuClick,onHeaderIndicatorClick:t.onHeaderIndicatorClick,onMouseMove:t.onMouseMove,onVisibleRegionChanged:t.onVisibleRegionChanged,overscrollX:t.overscrollX,overscrollY:t.overscrollY,preventDiagonalScrolling:t.preventDiagonalScrolling,rightElement:t.rightElement,rightElementProps:t.rightElementProps,rowHeight:t.rowHeight,rows:t.rows,scrollRef:t.scrollRef,selection:t.selection,theme:t.theme,freezeTrailingRows:t.freezeTrailingRows,hasAppendRow:t.hasAppendRow,translateX:t.translateX,translateY:t.translateY,verticalBorder:t.verticalBorder,onColumnProposeMove:t.onColumnProposeMove,drawFocusRing:t.drawFocusRing,drawCell:t.drawCell,drawHeader:t.drawHeader,experimental:t.experimental,gridRef:t.gridRef,headerIcons:t.headerIcons,isDraggable:t.isDraggable,onCanvasBlur:t.onCanvasBlur,onCanvasFocused:t.onCanvasFocused,onCellFocused:t.onCellFocused,onColumnMoved:t.onColumnMoved,onColumnResize:t.onColumnResize,onColumnResizeEnd:t.onColumnResizeEnd,onColumnResizeStart:t.onColumnResizeStart,onContextMenu:t.onContextMenu,onDragEnd:t.onDragEnd,onDragLeave:t.onDragLeave,onDragOverCell:t.onDragOverCell,onDragStart:t.onDragStart,onDrop:t.onDrop,onItemHovered:t.onItemHovered,onKeyDown:t.onKeyDown,onKeyUp:t.onKeyUp,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onRowMoved:t.onRowMoved,smoothScrollX:t.smoothScrollX,smoothScrollY:t.smoothScrollY,resizeIndicator:t.resizeIndicator}),oo)};class tc extends l.PureComponent{constructor(){super(...arguments);hn(this,"wrapperRef",l.createRef());hn(this,"clickOutside",i=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(i))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(i.target)){let f=i.target;for(;f!==null;){if(f.classList.contains("click-outside-ignore"))return;f=f.parentElement}this.props.onClickOutside()}})}componentDidMount(){const i=this.props.customEventTarget??document;i.addEventListener("pointerdown",this.clickOutside,!0),i.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const i=this.props.customEventTarget??document;i.removeEventListener("pointerdown",this.clickOutside,!0),i.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:i,isOutsideClick:f,customEventTarget:p,...y}=this.props;return l.createElement("div",{...y,ref:this.wrapperRef},this.props.children)}}const oc=()=>t=>Math.max(16,t.targetHeight-10),nc=pn("input")({name:"RenameInput",class:"r1fzhvm4",propsAsIs:!1,vars:{"r1fzhvm4-0":[oc(),"px"]}}),rc=t=>{const{bounds:o,group:i,onClose:f,canvasBounds:p,onFinish:y}=t,[L,b]=ge.useState(i);return ge.createElement(tc,{style:{position:"absolute",left:o.x-p.left+1,top:o.y-p.top,width:o.width-2,height:o.height},className:"c181oggi",onClickOutside:f},ge.createElement(nc,{targetHeight:o.height,"data-testid":"group-rename-input",value:L,onBlur:f,onFocus:M=>M.target.setSelectionRange(0,L.length),onChange:M=>b(M.target.value),onKeyDown:M=>{M.key==="Enter"?y(L):M.key==="Escape"&&f()},autoFocus:!0}))},vn=150,lc=150;function ic(t,o,i,f){var y;const p=f(o);return((y=p==null?void 0:p.measure)==null?void 0:y.call(p,t,o,i))??vn}function mr(t,o,i,f,p,y,L,b){let M=0;for(const v of p)M=Math.max(M,ic(t,v[f],o,b));const F=ql((i==null?void 0:i.title)??"#",t,o.headerFontFull).width+o.cellHorizontalPadding*2+((i==null?void 0:i.icon)===void 0?0:28);return M=Math.max(M,F),{...i,width:Math.max(Math.ceil(y),Math.min(Math.floor(L),Math.ceil(M)))}}function cc(t,o,i,f,p,y,L,b,M){const F=l.useRef(o),v=l.useRef(i),R=l.useRef(L);F.current=o,v.current=i,R.current=L;const[T,V]=l.useMemo(()=>{if(typeof window>"u")return[null,null];const N=document.createElement("canvas");return N.style.display="none",N.style.opacity="0",N.style.position="fixed",[N,N.getContext("2d",{alpha:!1})]},[]);l.useLayoutEffect(()=>(T&&document.documentElement.append(T),()=>{T==null||T.remove()}),[T]);const _=l.useRef({}),ie=l.useRef(new Map),ye=l.useRef(),[U,A]=l.useState();l.useLayoutEffect(()=>{const N=v.current;if(N===void 0||t.every(Io))return;let Z=Math.max(1,lc-Math.floor(t.length/10)),xe=0;Z<F.current&&Z>1&&(Z--,xe=1);const Te={x:0,y:0,width:t.length,height:Math.min(F.current,Z)},fe={x:0,y:F.current-1,width:t.length,height:1};(async()=>{const oe=N(Te,M.signal),se=xe>0?N(fe,M.signal):void 0;let ne;typeof oe=="object"?ne=oe:ne=await nr(oe),se!==void 0&&(typeof se=="object"?ne=[...ne,...se]:ne=[...ne,...await nr(se)]),ye.current=t,A(ne)})()},[M.signal,t,o]);const Q=ie.current,Ge=new Map;for(const N of t){const Z=N.id;Z!==void 0&&Ge.set(Z,N)}for(const[N]of Q)Ge.has(N)||delete _.current[N];return ie.current=Ge,l.useMemo(()=>{let Z=t.every(Io)?t:V===null?t.map(W=>Io(W)?W:{...W,width:vn}):(V.font=R.current.baseFontFull,t.map((W,oe)=>{var ne;if(Io(W))return W;if(_.current[W.id]!==void 0&&_.current[W.id].column===W)return{...W,width:_.current[W.id].width};if(U===void 0||ye.current!==t||W.id===void 0)return{...W,width:((ne=_.current[W.id])==null?void 0:ne.width)??vn};const se=mr(V,L,W,oe,U,p,y,b);return _.current[W.id]={width:se.width,column:W},se})),xe=0,Te=0;const fe=[];for(const[W,oe]of Z.entries())xe+=oe.width,oe.grow!==void 0&&oe.grow>0&&(Te+=oe.grow,fe.push(W));if(xe<f&&fe.length>0){const W=[...Z],oe=f-xe;let se=oe;for(let ne=0;ne<fe.length;ne++){const Me=fe[ne],Ie=(Z[Me].grow??0)/Te,Ve=ne===fe.length-1?se:Math.min(se,Math.floor(oe*Ie));W[Me]={...Z[Me],growOffset:Ve,width:Z[Me].width+Ve},se-=Ve}Z=W}return{sizedColumns:Z,nonGrowWidth:xe}},[f,t,V,U,L,p,y,b])}function sc(t,o){return t===void 0?!1:t.length>1&&t.startsWith("_")?Number.parseInt(t.slice(1))===o.keyCode:t.length===1&&t>="a"&&t<="z"?t.toUpperCase().codePointAt(0)===o.keyCode:t===o.key}function P(t,o,i){const f=vr(t,o);return f&&(i.didMatch=!0),f}function vr(t,o){if(t.length===0)return!1;if(t.includes("|")){const M=t.split("|");for(const F of M)if(vr(F,o))return!0;return!1}let i=!1,f=!1,p=!1,y=!1;const L=t.split("+"),b=L.pop();if(!sc(b,o))return!1;if(L[0]==="any")return!0;for(const M of L)switch(M){case"ctrl":i=!0;break;case"shift":f=!0;break;case"alt":p=!0;break;case"meta":y=!0;break;case"primary":Wo.value?y=!0:i=!0;break}return o.altKey===p&&o.ctrlKey===i&&o.shiftKey===f&&o.metaKey===y}function ac(t,o,i,f,p,y,L){const b=ge.useCallback((v,R,T,V)=>{var Q;(y==="cell"||y==="multi-cell")&&v!==void 0&&(v={...v,range:{x:v.cell[0],y:v.cell[1],width:1,height:1}}),!L&&v!==void 0&&v.range.width>1&&(v={...v,range:{...v.range,width:1,x:v.cell[0]}});const _=i==="mixed"&&(T||V==="drag")||i==="additive",ie=(f==="mixed"||f==="additive")&&_,ye=(p==="mixed"||p==="additive")&&_;let U={current:v===void 0?void 0:{...v,rangeStack:V==="drag"?((Q=t.current)==null?void 0:Q.rangeStack)??[]:[]},columns:ie?t.columns:Y.empty(),rows:ye?t.rows:Y.empty()};T&&(y==="multi-rect"||y==="multi-cell")&&U.current!==void 0&&t.current!==void 0&&(U={...U,current:{...U.current,rangeStack:[...t.current.rangeStack,t.current.range]}}),o(U,R)},[f,t,i,y,L,p,o]),M=ge.useCallback((v,R,T)=>{v=v??t.rows,R!==void 0&&(v=v.add(R));let V;if(p==="exclusive"&&v.length>0)V={current:void 0,columns:Y.empty(),rows:v};else{const _=T&&i==="mixed"||i==="additive",ie=T&&f==="mixed"||f==="additive";V={current:_?t.current:void 0,columns:ie?t.columns:Y.empty(),rows:v}}o(V,!1)},[f,t,i,p,o]),F=ge.useCallback((v,R,T)=>{v=v??t.columns,R!==void 0&&(v=v.add(R));let V;if(f==="exclusive"&&v.length>0)V={current:void 0,rows:Y.empty(),columns:v};else{const _=T&&i==="mixed"||i==="additive",ie=T&&p==="mixed"||p==="additive";V={current:_?t.current:void 0,rows:ie?t.rows:Y.empty(),columns:v}}o(V,!1)},[f,t,i,p,o]);return[b,M,F]}function uc(t,o,i,f,p){const y=l.useCallback(F=>{if(t===!0){const v=[];for(let R=F.y;R<F.y+F.height;R++){const T=[];for(let V=F.x;V<F.x+F.width;V++)V<0||R>=p?T.push({kind:J.Loading,allowOverlay:!1}):T.push(o([V,R]));v.push(T)}return v}return(t==null?void 0:t(F,f.signal))??[]},[f.signal,o,t,p]),L=t!==void 0?y:void 0,b=l.useCallback(F=>{if(L===void 0)return[];const v={...F,x:F.x-i};if(v.x<0){v.x=0,v.width--;const R=L(v,f.signal);return typeof R=="function"?async()=>(await R()).map(T=>[{kind:J.Loading,allowOverlay:!1},...T]):R.map(T=>[{kind:J.Loading,allowOverlay:!1},...T])}return L(v,f.signal)},[f.signal,L,i]);return[t!==void 0?b:void 0,L]}function dr(t){return typeof t=="string"?t:`${t}px`}const dc=()=>t=>t.innerWidth,fc=()=>t=>t.innerHeight,hc=pn("div")({name:"Wrapper",class:"w2q57ts",propsAsIs:!1,vars:{"w2q57ts-0":[dc()],"w2q57ts-1":[fc()]}}),gc=t=>{const{inWidth:o,inHeight:i,children:f,...p}=t;return l.createElement(hc,{innerHeight:dr(i),innerWidth:dr(o),...p},f)},mc=2,vc=1300;function Cc(t,o,i){const f=ge.useRef(0),[p,y]=t??[0,0];ge.useEffect(()=>{if(p===0&&y===0){f.current=0;return}let L=!1,b=0;const M=F=>{var v;if(!L){if(b===0)b=F;else{const R=F-b;f.current=Math.min(1,f.current+R/vc);const T=f.current**1.618*R*mc;(v=o.current)==null||v.scrollBy(p*T,y*T),b=F,i==null||i()}window.requestAnimationFrame(M)}};return window.requestAnimationFrame(M),()=>{L=!0}},[o,p,y,i])}function pc({rowHeight:t,headerHeight:o,groupHeaderHeight:i,theme:f,overscrollX:p,overscrollY:y,scaleToRem:L,remSize:b}){const[M,F,v,R,T,V]=ge.useMemo(()=>{if(!L||b===16)return[t,o,i,f,p,y];const _=b/16,ie=t,ye=hr();return[typeof ie=="number"?ie*_:U=>Math.ceil(ie(U)*_),Math.ceil(o*_),Math.ceil(i*_),{...f,headerIconSize:((f==null?void 0:f.headerIconSize)??ye.headerIconSize)*_,cellHorizontalPadding:((f==null?void 0:f.cellHorizontalPadding)??ye.cellHorizontalPadding)*_,cellVerticalPadding:((f==null?void 0:f.cellVerticalPadding)??ye.cellVerticalPadding)*_},Math.ceil((p??0)*_),Math.ceil((y??0)*_)]},[i,o,p,y,b,t,L,f]);return{rowHeight:M,headerHeight:F,groupHeaderHeight:v,theme:R,overscrollX:T,overscrollY:V}}const ht={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function G(t,o){return t===!0?o:t===!1?"":t}function fr(t){const o=Wo.value;return{activateCell:G(t.activateCell," |Enter|shift+Enter"),clear:G(t.clear,"any+Escape"),closeOverlay:G(t.closeOverlay,"any+Escape"),acceptOverlayDown:G(t.acceptOverlayDown,"Enter"),acceptOverlayUp:G(t.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:G(t.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:G(t.acceptOverlayRight,"Tab"),copy:t.copy,cut:t.cut,delete:G(t.delete,o?"Backspace|Delete":"Delete"),downFill:G(t.downFill,"primary+_68"),scrollToSelectedCell:G(t.scrollToSelectedCell,"primary+Enter"),goDownCell:G(t.goDownCell,"ArrowDown"),goDownCellRetainSelection:G(t.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:G(t.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:G(t.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:G(t.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:G(t.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:G(t.goUpCell,"ArrowUp"),goUpCellRetainSelection:G(t.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:G(t.goToFirstCell,"primary+Home"),goToFirstColumn:G(t.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:G(t.goToFirstRow,"primary+ArrowUp"),goToLastCell:G(t.goToLastCell,"primary+End"),goToLastColumn:G(t.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:G(t.goToLastRow,"primary+ArrowDown"),goToNextPage:G(t.goToNextPage,"PageDown"),goToPreviousPage:G(t.goToPreviousPage,"PageUp"),paste:t.paste,rightFill:G(t.rightFill,"primary+_82"),search:G(t.search,"primary+f"),selectAll:G(t.selectAll,"primary+a"),selectColumn:G(t.selectColumn,"ctrl+ "),selectGrowDown:G(t.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:G(t.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:G(t.selectGrowRight,"shift+ArrowRight"),selectGrowUp:G(t.selectGrowUp,"shift+ArrowUp"),selectRow:G(t.selectRow,"shift+ "),selectToFirstCell:G(t.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:G(t.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:G(t.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:G(t.selectToLastCell,"primary+shift+End"),selectToLastColumn:G(t.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:G(t.selectToLastRow,"primary+shift+ArrowDown")}}function wc(t){const o=jl(t);return ge.useMemo(()=>{if(o===void 0)return fr(ht);const i={...o,goToNextPage:(o==null?void 0:o.goToNextPage)??(o==null?void 0:o.pageDown)??ht.goToNextPage,goToPreviousPage:(o==null?void 0:o.goToPreviousPage)??(o==null?void 0:o.pageUp)??ht.goToPreviousPage,goToFirstCell:(o==null?void 0:o.goToFirstCell)??(o==null?void 0:o.first)??ht.goToFirstCell,goToLastCell:(o==null?void 0:o.goToLastCell)??(o==null?void 0:o.last)??ht.goToLastCell,selectToFirstCell:(o==null?void 0:o.selectToFirstCell)??(o==null?void 0:o.first)??ht.selectToFirstCell,selectToLastCell:(o==null?void 0:o.selectToLastCell)??(o==null?void 0:o.last)??ht.selectToLastCell};return fr({...ht,...i})},[o])}function bc(t){function o(f,p,y){if(typeof f=="number")return{headerIndex:f,isCollapsed:!1,depth:p,path:y};const L={headerIndex:f.headerIndex,isCollapsed:f.isCollapsed,depth:p,path:y};return f.subGroups!==void 0&&(L.subGroups=f.subGroups.map((b,M)=>o(b,p+1,[...y,M])).sort((b,M)=>b.headerIndex-M.headerIndex)),L}return t.map((f,p)=>o(f,0,[p])).sort((f,p)=>f.headerIndex-p.headerIndex)}function wn(t,o){const i=[];function f(b,M,F=!1){let v=M!==null?M-b.headerIndex:o-b.headerIndex;if(b.subGroups!==void 0&&(v=b.subGroups[0].headerIndex-b.headerIndex),v--,i.push({rowIndex:-1,headerIndex:b.headerIndex,contentIndex:-1,skip:F,isCollapsed:b.isCollapsed,depth:b.depth,path:b.path,rows:v}),b.subGroups)for(let R=0;R<b.subGroups.length;R++){const T=R<b.subGroups.length-1?b.subGroups[R+1].headerIndex:M;f(b.subGroups[R],T,F||b.isCollapsed)}}const p=bc(t.groups);for(let b=0;b<p.length;b++){const M=b<p.length-1?p[b+1].headerIndex:null;f(p[b],M)}let y=0,L=0;for(const b of i)b.contentIndex=L,L+=b.rows,b.rowIndex=y,y+=b.isCollapsed?1:b.rows+1;return i.filter(b=>b.skip===!1).map(b=>{const{skip:M,...F}=b;return F})}function Cn(t,o){if(o===void 0||wn.length===0)return{path:[t],originalIndex:t,isGroupHeader:!1,groupIndex:t,contentIndex:t,groupRows:-1};let i=t;for(const f of o){if(i===0)return{path:[...f.path,-1],originalIndex:f.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:f.rows};if(f.isCollapsed)i--;else{if(i<=f.rows)return{path:[...f.path,i-1],originalIndex:f.headerIndex+i,isGroupHeader:!1,groupIndex:i-1,contentIndex:f.contentIndex+i-1,groupRows:f.rows};i=i-f.rows-1}}return{path:[t],originalIndex:t,isGroupHeader:!1,groupIndex:t,contentIndex:t,groupRows:-1}}function yc(t,o,i,f){const p=ge.useMemo(()=>t===void 0?void 0:wn(t,o),[t,o]),y=ge.useMemo(()=>p==null?void 0:p.reduce((v,R)=>(v[R.rowIndex]=R,v),{}),[p]),L=ge.useMemo(()=>p===void 0?o:p.reduce((v,R)=>v+(R.isCollapsed?1:R.rows+1),0),[p,o]),b=ge.useMemo(()=>t===void 0||typeof i=="number"&&t.height===i?i:v=>y!=null&&y[v]?t.height:typeof i=="number"?i:i(v),[y,t,i]),M=ge.useCallback(v=>{if(p===void 0)return v;let R=v;for(const T of p){if(R===0)return;if(R--,!T.isCollapsed){if(R<T.rows)return T.contentIndex+R;R-=T.rows}}return v},[p]),F=gt(f??(t==null?void 0:t.themeOverride),ge.useCallback(v=>{if(t===void 0)return f==null?void 0:f(v,v,v);if(f===void 0&&(t==null?void 0:t.themeOverride)===void 0)return;const{isGroupHeader:R,contentIndex:T,groupIndex:V}=Cn(v,p);return R?t.themeOverride:f==null?void 0:f(v,V,T)},[p,f,t]));return t===void 0?{rowHeight:b,rows:o,rowNumberMapper:M,getRowThemeOverride:F}:{rowHeight:b,rows:L,rowNumberMapper:M,getRowThemeOverride:F}}function xc(t,o){const i=ge.useMemo(()=>t===void 0?void 0:wn(t,o),[t,o]);return{getRowGroupingForPath:pr,updateRowGroupingByPath:Cr,mapper:ge.useCallback(f=>{if(typeof f=="number")return Cn(f,i);const p=Cn(f[1],i);return{...p,originalIndex:[f[0],p.originalIndex]}},[i])}}function Cr(t,o,i){const[f,...p]=o;return p[0]===-1?t.map((y,L)=>L===f?{...y,...i}:y):t.map((y,L)=>L===f?{...y,subGroups:Cr(y.subGroups??[],p,i)}:y)}function pr(t,o){const[i,...f]=o;return f[0]===-1?t[i]:pr(t[i].subGroups??[],f)}function Mc(t,o){const[i]=l.useState(()=>({value:t,callback:o,facade:{get current(){return i.value},set current(f){const p=i.value;p!==f&&(i.value=f,i.callback(f,p))}}}));return i.callback=o,i.facade}function Rc(t,o,i,f,p){const[y,L]=l.useMemo(()=>[o!==void 0&&typeof i=="number"?Math.floor(o/i):0,o!==void 0&&typeof i=="number"?-(o%i):0],[o,i]),b=l.useMemo(()=>({x:f.current.x,y,width:f.current.width??1,height:f.current.height??1,ty:L}),[f,L,y]),[M,F,v]=Zl(b),R=l.useRef(p);R.current=p;const T=Mc(null,ie=>{ie!==null&&o!==void 0?ie.scrollTop=o:ie!==null&&t!==void 0&&(ie.scrollLeft=t)}),V=(M.height??1)>1;l.useLayoutEffect(()=>{if(o!==void 0&&T.current!==null&&V){if(T.current.scrollTop===o)return;T.current.scrollTop=o,T.current.scrollTop!==o&&v(),R.current()}},[o,V,v,T]);const _=(M.width??1)>1;return l.useLayoutEffect(()=>{if(t!==void 0&&T.current!==null&&_){if(T.current.scrollLeft===t)return;T.current.scrollLeft=t,T.current.scrollLeft!==t&&v(),R.current()}},[t,_,v,T]),{visibleRegion:M,setVisibleRegion:F,scrollRef:T}}const kc=l.lazy(async()=>await Yl(()=>import("./data-grid-overlay-editor-Bl1R5Njo.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url));let Sc=0;function Tc(t){return pi(ur(ur(t).filter(o=>o.span!==void 0).map(o=>{var i,f;return Kt((((i=o.span)==null?void 0:i[0])??0)+1,(((f=o.span)==null?void 0:f[1])??0)+1)})))}function Ao(t,o){return t===void 0||o===0||t.columns.length===0&&t.current===void 0?t:{current:t.current===void 0?void 0:{cell:[t.current.cell[0]+o,t.current.cell[1]],range:{...t.current.range,x:t.current.range.x+o},rangeStack:t.current.rangeStack.map(i=>({...i,x:i.x+o}))},rows:t.rows,columns:t.columns.offset(o)}}const Po={kind:J.Loading,allowOverlay:!1},Go={columns:Y.empty(),rows:Y.empty(),current:void 0},zc=(t,o)=>{var er,tr,or;const[i,f]=l.useState(Go),[p,y]=l.useState(),L=l.useRef(null),b=l.useRef(null),[M,F]=l.useState(),v=l.useRef(),R=typeof window>"u"?null:window,{imageEditorOverride:T,getRowThemeOverride:V,markdownDivCreateNode:_,width:ie,height:ye,columns:U,rows:A,getCellContent:Q,onCellClicked:Ge,onCellActivated:N,onGridFocused:Z,onGridBlurred:xe,onFillPattern:Te,onFinishedEditing:fe,coercePasteValue:W,drawHeader:oe,drawCell:se,editorBloom:ne,onHeaderClicked:Me,onColumnProposeMove:Ie,rangeSelectionColumnSpanning:Ve=!0,spanRangeBehavior:Wt="default",onGroupHeaderClicked:Be,onCellContextMenu:Ke,className:oo,onHeaderContextMenu:E,getCellsForSelection:pe,onGroupHeaderContextMenu:re,onGroupHeaderRenamed:ze,onCellEdited:Fe,onCellsEdited:_e,onSearchResultsChanged:Tt,searchResults:No,onSearchValueChange:Oo,searchValue:mt,onKeyDown:zt,onKeyUp:Uo,keybindings:no,editOnType:ro=!0,onRowAppended:ot,onColumnAppended:nt,onColumnMoved:rt,validateCell:vt,highlightRegions:Ct,rangeSelect:Ze="rect",columnSelect:ce="multi",rowSelect:ae="multi",rangeSelectionBlending:wr="exclusive",columnSelectionBlending:br="exclusive",rowSelectionBlending:yr="exclusive",onDelete:Vo,onDragStart:lo,onMouseMove:io,onPaste:pt,copyHeaders:bn=!1,freezeColumns:Je=0,cellActivationBehavior:co="second-click",rowSelectionMode:Bo="auto",columnSelectionMode:Nt="auto",onHeaderMenuClick:so,onHeaderIndicatorClick:ao,getGroupDetails:uo,rowGrouping:lt,onSearchClose:_o,onItemHovered:fo,onSelectionCleared:it,showSearch:xr,onVisibleRegionChanged:ho,gridSelection:wt,onGridSelectionChange:Xo,minColumnWidth:Mr=50,maxColumnWidth:Rr=500,maxColumnAutoWidth:kr,provideEditor:Sr,trailingRowOptions:B,freezeTrailingRows:Qe=0,allowedFillDirections:yn="orthogonal",scrollOffsetX:Tr,scrollOffsetY:zr,verticalBorder:Et,onDragOverCell:Er,onDrop:Lr,onColumnResize:Ot,onColumnResizeEnd:Ut,onColumnResizeStart:Vt,customRenderers:go,fillHandle:Hr,experimental:ue,fixedShadowX:Dr,fixedShadowY:Ir,headerIcons:Fr,imageWindowLoader:$r,initialSize:Ar,isDraggable:Pr,onDragLeave:Gr,onRowMoved:Bt,overscrollX:Kr,overscrollY:Wr,preventDiagonalScrolling:Nr,rightElement:Or,rightElementProps:Ur,trapFocus:xn=!1,smoothScrollX:Vr,smoothScrollY:Br,scaleToRem:_r=!1,rowHeight:Xr=34,headerHeight:Mn=36,groupHeaderHeight:Yr=Mn,theme:qr,isOutsideClick:jr,renderers:Yo,resizeIndicator:Zr,scrollToActiveCell:Rn=!0,drawFocusRing:kn=!0,portalElementRef:Jr}=t,Sn=kn==="no-editor"?p===void 0:kn,ee=typeof t.rowMarkers=="string"?void 0:t.rowMarkers,We=(ee==null?void 0:ee.kind)??t.rowMarkers??"none",Qr=(ee==null?void 0:ee.width)??t.rowMarkerWidth,Tn=(ee==null?void 0:ee.startIndex)??t.rowMarkerStartIndex??1,zn=(ee==null?void 0:ee.theme)??t.rowMarkerTheme,En=ee==null?void 0:ee.headerTheme,Ln=ee==null?void 0:ee.headerAlwaysVisible,mo=ae!=="multi"||(ee==null?void 0:ee.headerDisabled)===!0,vo=(ee==null?void 0:ee.checkboxStyle)??"square",Lt=Math.max(Mr,20),Co=Math.max(Rr,Lt),el=Math.max(kr??Co,Lt),Hn=l.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:D,rowNumberMapper:Dn,rowHeight:tl,getRowThemeOverride:et}=yc(lt,A,Xr,V),ol=l.useMemo(()=>Number.parseFloat(Hn.fontSize),[Hn]),{rowHeight:ct,headerHeight:qo,groupHeaderHeight:In,theme:Fn,overscrollX:nl,overscrollY:rl}=pc({groupHeaderHeight:Yr,headerHeight:Mn,overscrollX:Kr,overscrollY:Wr,remSize:ol,rowHeight:tl,scaleToRem:_r,theme:qr}),st=wc(no),Ht=Qr??(A>1e4?48:A>1e3?44:A>100?36:32),Xe=We!=="none",s=Xe?1:0,le=B!==void 0,_t=(B==null?void 0:B.sticky)===!0,[ll,$n]=l.useState(!1),il=xr??ll,cl=l.useCallback(()=>{_o!==void 0?_o():$n(!1)},[_o]),h=l.useMemo(()=>wt===void 0?void 0:Ao(wt,s),[wt,s])??i,Ee=l.useRef();Ee.current===void 0&&(Ee.current=new AbortController),l.useEffect(()=>()=>Ee==null?void 0:Ee.current.abort(),[]);const[me,sl]=uc(pe,Q,s,Ee.current,D),al=l.useCallback((e,n,r)=>{if(vt===void 0)return!0;const c=[e[0]-s,e[1]];return vt==null?void 0:vt(c,n,r)},[s,vt]),po=l.useRef(wt),$e=l.useCallback((e,n)=>{n&&(e=Jl(e,me,s,Wt,Ee.current)),Xo!==void 0?(po.current=Ao(e,-s),Xo(po.current)):f(e)},[Xo,me,s,Wt]),Dt=gt(Ot,l.useCallback((e,n,r,c)=>{Ot==null||Ot(U[r-s],n,r-s,c)},[Ot,s,U])),ul=gt(Ut,l.useCallback((e,n,r,c)=>{Ut==null||Ut(U[r-s],n,r-s,c)},[Ut,s,U])),dl=gt(Vt,l.useCallback((e,n,r,c)=>{Vt==null||Vt(U[r-s],n,r-s,c)},[Vt,s,U])),fl=gt(oe,l.useCallback((e,n)=>(oe==null?void 0:oe({...e,columnIndex:e.columnIndex-s},n))??!1,[oe,s])),hl=gt(se,l.useCallback((e,n)=>(se==null?void 0:se({...e,col:e.col-s},n))??!1,[se,s])),at=l.useCallback(e=>{if(Vo!==void 0){const n=Vo(Ao(e,-s));return typeof n=="boolean"?n:Ao(n,s)}return!0},[Vo,s]),[ve,Re,de]=ac(h,$e,wr,br,yr,Ze,Ve),we=l.useMemo(()=>gn(hr(),Fn),[Fn]),[jo,gl]=l.useState([0,0,0]),An=l.useMemo(()=>{if(Yo===void 0)return{};const e={};for(const n of Yo)e[n.kind]=n;return e},[Yo]),ke=l.useCallback(e=>e.kind!==J.Custom?An[e.kind]:go==null?void 0:go.find(n=>n.isMatch(e)),[go,An]);let{sizedColumns:He,nonGrowWidth:Pn}=cc(U,D,sl,jo[0]-(s===0?0:Ht)-jo[2],Lt,el,we,ke,Ee.current);We!=="none"&&(Pn+=Ht);const Zo=l.useMemo(()=>He.some(e=>e.group!==void 0),[He]),Xt=Zo?qo+In:qo,Gn=h.rows.length,Kn=We==="none"?void 0:Gn===0?!1:Gn===D?!0:void 0,O=l.useMemo(()=>We==="none"?He:[{title:"",width:Ht,icon:void 0,hasMenu:!1,style:"normal",themeOverride:zn,rowMarker:vo,rowMarkerChecked:Kn,headerRowMarkerTheme:En,headerRowMarkerAlwaysVisible:Ln,headerRowMarkerDisabled:mo},...He],[We,He,Ht,zn,vo,Kn,En,Ln,mo]),De=l.useRef({height:1,width:1,x:0,y:0}),wo=l.useRef(!1),{setVisibleRegion:Wn,visibleRegion:bt,scrollRef:q}=Rc(Tr,zr,ct,De,()=>wo.current=!0);De.current=bt;const ml=bt.x+s,bo=bt.y,he=l.useRef(null),Se=l.useCallback(e=>{var n;e===!0?(n=he.current)==null||n.focus():window.requestAnimationFrame(()=>{var r;(r=he.current)==null||r.focus()})},[]),be=le?D+1:D,Ae=l.useCallback(e=>{const n=s===0?e:e.map(c=>({...c,location:[c.location[0]-s,c.location[1]]})),r=_e==null?void 0:_e(n);if(r!==!0)for(const c of n)Fe==null||Fe(c.location,c.value);return r},[Fe,_e,s]),[yt,Jo]=l.useState(),yo=h.current!==void 0&&h.current.range.width*h.current.range.height>1?h.current.range:void 0,It=Sn?(er=h.current)==null?void 0:er.cell:void 0,xo=It==null?void 0:It[0],Mo=It==null?void 0:It[1],vl=l.useMemo(()=>{if((Ct===void 0||Ct.length===0)&&(yo??xo??Mo??yt)===void 0)return;const e=[];if(Ct!==void 0)for(const n of Ct){const r=O.length-n.range.x-s;r>0&&e.push({color:n.color,range:{...n.range,x:n.range.x+s,width:Math.min(r,n.range.width)},style:n.style})}return yt!==void 0&&e.push({color:rr(we.accentColor,0),range:yt,style:"dashed"}),yo!==void 0&&e.push({color:rr(we.accentColor,.5),range:yo,style:"solid-outline"}),xo!==void 0&&Mo!==void 0&&e.push({color:we.accentColor,range:{x:xo,y:Mo,width:1,height:1},style:"solid-outline"}),e.length>0?e:void 0},[yt,yo,xo,Mo,Ct,O.length,we.accentColor,s]),Nn=l.useRef(O);Nn.current=O;const Le=l.useCallback(([e,n],r=!1)=>{var g,a,d,m,C,x,k;const c=le&&n===be-1;if(e===0&&Xe){if(c)return Po;const w=Dn(n);return w===void 0?Po:{kind:Fo.Marker,allowOverlay:!1,checkboxStyle:vo,checked:(h==null?void 0:h.rows.hasIndex(n))===!0,markerKind:We==="clickable-number"?"number":We,row:Tn+w,drawHandle:Bt!==void 0,cursor:We==="clickable-number"?"pointer":void 0}}else if(c){const H=e===s?(B==null?void 0:B.hint)??"":"",S=Nn.current[e];if(((g=S==null?void 0:S.trailingRowOptions)==null?void 0:g.disabled)===!0)return Po;{const $=((a=S==null?void 0:S.trailingRowOptions)==null?void 0:a.hint)??H,I=((d=S==null?void 0:S.trailingRowOptions)==null?void 0:d.addIcon)??(B==null?void 0:B.addIcon);return{kind:Fo.NewRow,hint:$,allowOverlay:!1,icon:I}}}else{const w=e-s;if(r||(ue==null?void 0:ue.strict)===!0){const S=De.current,$=S.x>w||w>S.x+S.width||S.y>n||n>S.y+S.height||n>=on.current,I=w===((C=(m=S.extras)==null?void 0:m.selected)==null?void 0:C[0])&&n===((x=S.extras)==null?void 0:x.selected[1]);let z=!1;if(((k=S.extras)==null?void 0:k.freezeRegions)!==void 0){for(const K of S.extras.freezeRegions)if(Ql(K,w,n)){z=!0;break}}if($&&!I&&!z)return Po}let H=Q([w,n]);return s!==0&&H.span!==void 0&&(H={...H,span:[H.span[0]+s,H.span[1]+s]}),H}},[le,be,Xe,Dn,vo,h==null?void 0:h.rows,We,Tn,Bt,s,B==null?void 0:B.hint,B==null?void 0:B.addIcon,ue==null?void 0:ue.strict,Q]),Qo=l.useCallback(e=>{let n=(uo==null?void 0:uo(e))??{name:e};return ze!==void 0&&e!==""&&(n={icon:n.icon,name:n.name,overrideTheme:n.overrideTheme,actions:[...n.actions??[],{title:"Rename",icon:"renameIcon",onClick:r=>rn({group:n.name,bounds:r.bounds})}]}),n},[uo,ze]),Ro=l.useCallback(e=>{var d;const[n,r]=e.cell,c=O[n],u=(c==null?void 0:c.group)!==void 0?(d=Qo(c.group))==null?void 0:d.overrideTheme:void 0,g=c==null?void 0:c.themeOverride,a=et==null?void 0:et(r);y({...e,theme:gn(we,u,g,a,e.content.themeOverride)})},[et,O,Qo,we]),Ft=l.useCallback((e,n,r)=>{var a;if(h.current===void 0)return;const[c,u]=h.current.cell,g=Le([c,u]);if(g.kind!==J.Boolean&&g.allowOverlay){let d=g;if(r!==void 0)switch(d.kind){case J.Number:{const m=ei(()=>r==="-"?-0:Number.parseFloat(r),0);d={...d,data:Number.isNaN(m)?0:m};break}case J.Text:case J.Markdown:case J.Uri:d={...d,data:r};break}Ro({target:e,content:d,initialValue:r,cell:[c,u],highlight:r===void 0,forceEditMode:r!==void 0,activation:n})}else g.kind===J.Boolean&&n.inputType==="keyboard"&&g.readonly!==!0&&(Ae([{location:h.current.cell,value:{...g,data:ti(g.data)}}]),(a=he.current)==null||a.damage([{cell:h.current.cell}]))},[Le,h,Ae,Ro]),On=l.useCallback((e,n)=>{var u;const r=(u=he.current)==null?void 0:u.getBounds(e,n);if(r===void 0||q.current===null)return;const c=Le([e,n]);c.allowOverlay&&Ro({target:r,content:c,initialValue:void 0,highlight:!0,cell:[e,n],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[Le,q,Ro]),te=l.useCallback((e,n,r="both",c=0,u=0,g=void 0)=>{if(q.current!==null){const a=he.current,d=b.current,m=typeof e!="number"?e.unit==="cell"?e.amount:void 0:e,C=typeof n!="number"?n.unit==="cell"?n.amount:void 0:n,x=typeof e!="number"&&e.unit==="px"?e.amount:void 0,k=typeof n!="number"&&n.unit==="px"?n.amount:void 0;if(a!==null&&d!==null){let w={x:0,y:0,width:0,height:0},H=0,S=0;if((m!==void 0||C!==void 0)&&(w=a.getBounds((m??0)+s,C??0)??w,w.width===0||w.height===0))return;const $=d.getBoundingClientRect(),I=$.width/d.offsetWidth;if(x!==void 0&&(w={...w,x:x-$.left-q.current.scrollLeft,width:1}),k!==void 0&&(w={...w,y:k+$.top-q.current.scrollTop,height:1}),w!==void 0){const z={x:w.x-c,y:w.y-u,width:w.width+2*c,height:w.height+2*u};let K=0;for(let fn=0;fn<Je;fn++)K+=He[fn].width;let X=0;const Ce=Qe+(_t?1:0);Ce>0&&(X=oi(be,Ce,ct));let Ue=K*I+$.left+s*Ht*I,qe=$.right,je=$.top+Xt*I,tt=$.bottom-X*I;const Ho=w.width+c*2;switch(g==null?void 0:g.hAlign){case"start":qe=Ue+Ho;break;case"end":Ue=qe-Ho;break;case"center":Ue=Math.floor((Ue+qe)/2)-Ho/2,qe=Ue+Ho;break}const Do=w.height+u*2;switch(g==null?void 0:g.vAlign){case"start":tt=je+Do;break;case"end":je=tt-Do;break;case"center":je=Math.floor((je+tt)/2)-Do/2,tt=je+Do;break}Ue>z.x?H=z.x-Ue:qe<z.x+z.width&&(H=z.x+z.width-qe),je>z.y?S=z.y-je:tt<z.y+z.height&&(S=z.y+z.height-tt),r==="vertical"||typeof e=="number"&&e<Je?H=0:(r==="horizontal"||typeof n=="number"&&n>=be-Ce)&&(S=0),(H!==0||S!==0)&&(I!==1&&(H/=I,S/=I),q.current.scrollTo({left:H+q.current.scrollLeft,top:S+q.current.scrollTop,behavior:(g==null?void 0:g.behavior)??"auto"}))}}}},[s,Qe,Ht,q,Xt,Je,He,be,_t,ct]),en=l.useRef(On),tn=l.useRef(Q);en.current=On,tn.current=Q;const on=l.useRef(D);on.current=D;const Un=l.useRef(O.length);Un.current=O.length;const ut=l.useCallback(async(e,n=!0,r)=>{var C;const c=O[e];if(((C=c==null?void 0:c.trailingRowOptions)==null?void 0:C.disabled)===!0)return;const u=ot==null?void 0:ot();let g,a=!0;u!==void 0&&(g=await u,g==="top"&&(a=!1),typeof g=="number"&&(a=!1));let d=0;const m=()=>{if(on.current<=D){d<500&&window.setTimeout(m,d),d=50+d*2;return}const x=typeof g=="number"?g:a?D:0;Lo.current(e-s,x,"both",0,0,r?{behavior:r}:void 0),ve({cell:[e,x],range:{x:e,y:x,width:1,height:1}},!1,!1,"edit");const k=tn.current([e-s,x]);k.allowOverlay&&eo(k)&&k.readonly!==!0&&n&&window.setTimeout(()=>{en.current(e,x)},0)};m()},[O,ot,s,D,ve]),ko=l.useCallback(async(e,n=!0)=>{const r=nt==null?void 0:nt();let c,u=!0;r!==void 0&&(c=await r,c==="left"&&(u=!1),typeof c=="number"&&(u=!1));let g=0;const a=()=>{if(Un.current<=O.length){g<500&&window.setTimeout(a,g),g=50+g*2;return}const d=typeof c=="number"?c:u?O.length:0;te(d-s,e),ve({cell:[d,e],range:{x:d,y:e,width:1,height:1}},!1,!1,"edit");const m=tn.current([d-s,e]);m.allowOverlay&&eo(m)&&m.readonly!==!0&&n&&window.setTimeout(()=>{en.current(d,e)},0)};a()},[O,nt,s,te,ve]),$t=l.useCallback(e=>{var r,c;const n=((c=(r=He[e])==null?void 0:r.trailingRowOptions)==null?void 0:c.targetColumn)??(B==null?void 0:B.targetColumn);if(typeof n=="number")return n+(Xe?1:0);if(typeof n=="object"){const u=U.indexOf(n);if(u>=0)return u+(Xe?1:0)}},[He,U,Xe,B==null?void 0:B.targetColumn]),dt=l.useRef(),At=l.useRef(),Yt=l.useCallback((e,n)=>{var u;const[r,c]=n;return gn(we,(u=O[r])==null?void 0:u.themeOverride,et==null?void 0:et(c),e.themeOverride)},[et,O,we]),{mapper:xt}=xc(lt,A),Ne=lt==null?void 0:lt.navigationBehavior,qt=l.useCallback(e=>{var C,x,k;const n=Wo.value?e.metaKey:e.ctrlKey,r=n&&ae==="multi",[c,u]=e.location,g=h.columns,a=h.rows,[d,m]=((C=h.current)==null?void 0:C.cell)??[];if(e.kind==="cell"){if(At.current=void 0,Mt.current=[c,u],c===0&&Xe){if(le===!0&&u===D||We==="number"||ae==="none")return;const w=Le(e.location);if(w.kind!==Fo.Marker)return;if(Bt!==void 0){const $=ke(w);Ko(($==null?void 0:$.kind)===Fo.Marker);const I=(x=$==null?void 0:$.onClick)==null?void 0:x.call($,{...e,cell:w,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,theme:Yt(w,e.location),preventDefault:()=>{}});if(I===void 0||I.checked===w.checked)return}y(void 0),Se();const H=a.hasIndex(u),S=dt.current;if(ae==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&S!==void 0&&a.hasIndex(S)){const $=[Math.min(S,u),Math.max(S,u)+1];r||Bo==="multi"?Re(void 0,$,!0):Re(Y.fromSingleSelection($),void 0,r)}else ae==="multi"&&(r||e.isTouch||Bo==="multi")?H?Re(a.remove(u),void 0,!0):(Re(void 0,u,!0),dt.current=u):H&&a.length===1?Re(Y.empty(),void 0,n):(Re(Y.fromSingleSelection(u),void 0,n),dt.current=u)}else if(c>=s&&le&&u===D){const w=$t(c);ut(w??c)}else if(d!==c||m!==u){const w=Le(e.location),H=ke(w);if((H==null?void 0:H.onSelect)!==void 0){let I=!1;if(H.onSelect({...e,cell:w,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,preventDefault:()=>I=!0,theme:Yt(w,e.location)}),I)return}if(Ne==="block"&&xt(u).isGroupHeader)return;const S=_t&&u===D,$=_t&&h!==void 0&&((k=h.current)==null?void 0:k.cell[1])===D;if((e.shiftKey||e.isLongTouch===!0)&&d!==void 0&&m!==void 0&&h.current!==void 0&&!$){if(S)return;const I=Math.min(c,d),z=Math.max(c,d),K=Math.min(u,m),X=Math.max(u,m);ve({...h.current,range:{x:I,y:K,width:z-I+1,height:X-K+1}},!0,n,"click"),dt.current=void 0,Se()}else ve({cell:[c,u],range:{x:c,y:u,width:1,height:1}},!0,n,"click"),dt.current=void 0,y(void 0),Se()}}else if(e.kind==="header")if(Mt.current=[c,u],y(void 0),Xe&&c===0)dt.current=void 0,At.current=void 0,!mo&&ae==="multi"&&(a.length!==D?Re(Y.fromSingleSelection([0,D]),void 0,n):Re(Y.empty(),void 0,n),Se());else{const w=At.current;if(ce==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&w!==void 0&&g.hasIndex(w)){const H=[Math.min(w,c),Math.max(w,c)+1];n||e.isTouch||Nt==="multi"?de(void 0,H,n):de(Y.fromSingleSelection(H),void 0,n)}else ce==="multi"&&(n||e.isTouch||Nt==="multi")?(g.hasIndex(c)?de(g.remove(c),void 0,n):de(void 0,c,n),At.current=c):ce!=="none"&&(g.hasIndex(c)?de(g.remove(c),void 0,n):de(Y.fromSingleSelection(c),void 0,n),At.current=c);dt.current=void 0,Se()}else e.kind===Gt?Mt.current=[c,u]:e.kind===lr&&!e.isMaybeScrollbar&&($e(Go,!1),y(void 0),Se(),it==null||it(),dt.current=void 0,At.current=void 0)},[ae,ce,h,Xe,s,le,D,We,Le,Bt,Se,Bo,Nt,ke,Yt,Re,$t,ut,Ne,xt,_t,ve,mo,de,$e,it]),jt=l.useRef(!1),Mt=l.useRef(),Vn=l.useRef(bt),Pe=l.useRef(),Cl=l.useCallback(e=>{if(Rt.current=!1,Vn.current=De.current,e.button!==0&&e.button!==1){Pe.current=void 0;return}const n=performance.now();Pe.current={button:e.button,time:n,location:e.location},(e==null?void 0:e.kind)==="header"&&(jt.current=!0);const r=e.kind==="cell"&&e.isFillHandle;!r&&e.kind!=="cell"&&e.isEdge||(F({previousSelection:h,fillHandle:r}),Mt.current=void 0,!e.isTouch&&e.button===0&&!r?qt(e):!e.isTouch&&e.button===1&&(Mt.current=e.location))},[h,qt]),[nn,rn]=l.useState(),Bn=l.useCallback(e=>{if(e.kind!==Gt||ce!=="multi")return;const n=Wo.value?e.metaKey:e.ctrlKey,[r]=e.location,c=h.columns;if(r<s)return;const u=O[r];let g=r,a=r;for(let d=r-1;d>=s&&ir(u.group,O[d].group);d--)g--;for(let d=r+1;d<O.length&&ir(u.group,O[d].group);d++)a++;if(Se(),n||e.isTouch||Nt==="multi")if(c.hasAll([g,a+1])){let d=c;for(let m=g;m<=a;m++)d=d.remove(m);de(d,void 0,n)}else de(void 0,[g,a+1],n);else de(Y.fromSingleSelection([g,a+1]),void 0,n)},[ce,Se,h.columns,O,s,de,Nt]),Rt=l.useRef(!1),So=l.useCallback(async e=>{if(me!==void 0&&Dt!==void 0){const n=De.current.y,r=De.current.height;let c=me({x:e,y:n,width:1,height:Math.min(r,D-n)},Ee.current.signal);typeof c!="object"&&(c=await c());const u=He[e-s],a=document.createElement("canvas").getContext("2d",{alpha:!1});if(a!==null){a.font=we.baseFontFull;const d=mr(a,we,u,0,c,Lt,Co,ke);Dt==null||Dt(u,d.width,e,d.width)}}},[He,me,Co,we,Lt,Dt,s,D,ke]),[pl,ln]=l.useState(),Pt=l.useCallback(async(e,n)=>{var d,m;const r=(d=e.current)==null?void 0:d.range;if(r===void 0||me===void 0||n.current===void 0)return;const c=n.current.range;if(Te!==void 0){let C=!1;if(Te({fillDestination:{...c,x:c.x-s},patternSource:{...r,x:r.x-s},preventDefault:()=>C=!0}),C)return}let u=me(r,Ee.current.signal);typeof u!="object"&&(u=await u());const g=u,a=[];for(let C=0;C<c.width;C++)for(let x=0;x<c.height;x++){const k=[c.x+C,c.y+x];if(ni(k,r))continue;const w=g[x%r.height][C%r.width];$o(w)||!eo(w)||a.push({location:k,value:{...w}})}Ae(a),(m=he.current)==null||m.damage(a.map(C=>({cell:C.location})))},[me,Ae,Te,s]),_n=l.useCallback(()=>{if(h.current===void 0||h.current.range.width<=1)return;const e={...h,current:{...h.current,range:{...h.current.range,width:1}}};Pt(e,h)},[Pt,h]),Xn=l.useCallback(()=>{if(h.current===void 0||h.current.range.height<=1)return;const e={...h,current:{...h.current,range:{...h.current.range,height:1}}};Pt(e,h)},[Pt,h]),wl=l.useCallback((e,n)=>{var x,k;const r=M;if(F(void 0),Jo(void 0),ln(void 0),jt.current=!1,n)return;if((r==null?void 0:r.fillHandle)===!0&&h.current!==void 0&&((x=r.previousSelection)==null?void 0:x.current)!==void 0){if(yt===void 0)return;const w={...h,current:{...h.current,range:ri(r.previousSelection.current.range,yt)}};Pt(r.previousSelection,w),$e(w,!0);return}const[c,u]=e.location,[g,a]=Mt.current??[],d=()=>{Rt.current=!0},m=w=>{var S,$,I;const H=w.isTouch||g===c&&a===u;if(H&&(Ge==null||Ge([c-s,u],{...w,preventDefault:d})),!Rt.current&&H){const z=Le(e.location),K=ke(z);if(K!==void 0&&K.onClick!==void 0){const X=K.onClick({...w,cell:z,posX:w.localEventX,posY:w.localEventY,bounds:w.bounds,theme:Yt(z,e.location),preventDefault:d});X!==void 0&&!$o(X)&&to(X)&&(Ae([{location:w.location,value:X}]),(S=he.current)==null||S.damage([{cell:w.location}]))}}if(w.button===1)return!Rt.current;if(!Rt.current){if(Rt.current||h.current===void 0)return!1;const z=Le(e.location);let K=!1;switch(z.activationBehaviorOverride??co){case"double-click":case"second-click":{if(((I=($=r==null?void 0:r.previousSelection)==null?void 0:$.current)==null?void 0:I.cell)===void 0)break;const[X,Ce]=h.current.cell,[Ue,qe]=r.previousSelection.current.cell;K=c===X&&c===Ue&&u===Ce&&u===qe&&(w.isDoubleClick===!0||co==="second-click");break}case"single-click":{K=!0;break}}if(K){const Ce={inputType:"pointer",pointerActivation:w.isDoubleClick===!0?"double-click":z.activationBehaviorOverride??co,pointerType:w.isTouch?"touch":"mouse"};return N==null||N([c-s,u],Ce),Ft(w.bounds,Ce),!0}}return!1},C=e.location[0]-s;if(e.isTouch){const w=De.current,H=Vn.current;if(w.x!==H.x||w.y!==H.y)return;if(e.isLongTouch===!0){if(e.kind==="cell"&&li((k=h.current)==null?void 0:k.cell,e.location)){Ke==null||Ke([C,e.location[1]],{...e,preventDefault:d});return}else if(e.kind==="header"&&h.columns.hasIndex(c)){E==null||E(C,{...e,preventDefault:d});return}else if(e.kind===Gt){if(C<0)return;re==null||re(C,{...e,preventDefault:d});return}}e.kind==="cell"?m(e)||qt(e):e.kind===Gt?Be==null||Be(C,{...e,preventDefault:d}):(e.kind===ii&&(Me==null||Me(C,{...e,preventDefault:d})),qt(e));return}e.kind==="header"&&(e.isEdge?e.isDoubleClick===!0&&So(c):e.button===0&&c===g&&u===a&&(Me==null||Me(C,{...e,preventDefault:d}))),e.kind===Gt&&e.button===0&&c===g&&u===a&&(Be==null||Be(C,{...e,preventDefault:d}),Rt.current||Bn(e)),e.kind==="cell"&&(e.button===0||e.button===1)&&m(e),Mt.current=void 0},[M,h,s,yt,Pt,$e,Ge,Le,ke,co,Yt,Ae,N,Ft,Ke,E,re,qt,Be,Me,So,Bn]),bl=l.useCallback(e=>{const n={...e,location:[e.location[0]-s,e.location[1]]};io==null||io(n),M!==void 0&&e.buttons===0&&(F(void 0),Jo(void 0),ln(void 0),jt.current=!1),ln(r=>{var c;return jt.current?[e.scrollEdge[0],0]:e.scrollEdge[0]===(r==null?void 0:r[0])&&e.scrollEdge[1]===r[1]?r:M===void 0||(((c=Pe.current)==null?void 0:c.location[0])??0)<s?void 0:e.scrollEdge})},[M,io,s]),yl=l.useCallback((e,n)=>{so==null||so(e-s,n)},[so,s]),xl=l.useCallback((e,n)=>{ao==null||ao(e-s,n)},[ao,s]),Ye=(tr=h==null?void 0:h.current)==null?void 0:tr.cell,Ml=l.useCallback((e,n,r,c,u,g)=>{wo.current=!1;let a=Ye;a!==void 0&&(a=[a[0]-s,a[1]]);const d=Je===0?void 0:{x:0,y:e.y,width:Je,height:e.height},m=[];d!==void 0&&m.push(d),Qe>0&&(m.push({x:e.x-s,y:D-Qe,width:e.width,height:Qe}),Je>0&&m.push({x:0,y:D-Qe,width:Je,height:Qe}));const C={x:e.x-s,y:e.y,width:e.width,height:le&&e.y+e.height>=D?e.height-1:e.height,tx:u,ty:g,extras:{selected:a,freezeRegion:d,freezeRegions:m}};De.current=C,Wn(C),gl([n,r,c]),ho==null||ho(C,C.tx,C.ty,C.extras)},[Ye,s,le,D,Je,Qe,Wn,ho]),Rl=gt(Ie,l.useCallback((e,n)=>(Ie==null?void 0:Ie(e-s,n-s))!==!1,[Ie,s])),kl=gt(rt,l.useCallback((e,n)=>{rt==null||rt(e-s,n-s),ce!=="none"&&de(Y.fromSingleSelection(n),void 0,!0)},[ce,rt,s,de])),cn=l.useRef(!1),Sl=l.useCallback(e=>{if(e.location[0]===0&&s>0){e.preventDefault();return}lo==null||lo({...e,location:[e.location[0]-s,e.location[1]]}),e.defaultPrevented()||(cn.current=!0),F(void 0)},[lo,s]),Tl=l.useCallback(()=>{cn.current=!1},[]),Yn=lt==null?void 0:lt.selectionBehavior,To=l.useCallback(e=>{if(Yn!=="block-spanning")return;const{isGroupHeader:n,path:r,groupRows:c}=xt(e);if(n)return[e,e];const u=r[r.length-1],g=e-u,a=e+c-u-1;return[g,a]},[xt,Yn]),sn=l.useRef(),an=l.useCallback(e=>{var n,r,c;if(!ci(e,sn.current)&&(sn.current=e,!(((n=Pe==null?void 0:Pe.current)==null?void 0:n.button)!==void 0&&Pe.current.button>=1))){if(e.buttons!==0&&M!==void 0&&((r=Pe.current)==null?void 0:r.location[0])===0&&s===1&&ae==="multi"&&M.previousSelection&&!M.previousSelection.rows.hasIndex(Pe.current.location[1])&&h.rows.hasIndex(Pe.current.location[1])){const u=Math.min(Pe.current.location[1],e.location[1]),g=Math.max(Pe.current.location[1],e.location[1])+1;Re(Y.fromSingleSelection([u,g]),void 0,!1)}else if(e.buttons!==0&&M!==void 0&&h.current!==void 0&&!cn.current&&!jt.current&&(Ze==="rect"||Ze==="multi-rect")){const[u,g]=h.current.cell;let[a,d]=e.location;if(d<0&&(d=De.current.y),M.fillHandle===!0&&((c=M.previousSelection)==null?void 0:c.current)!==void 0){const m=M.previousSelection.current.range;d=Math.min(d,le?D-1:D);const C=si(m,a,d,yn);Jo(C)}else{if(le&&g===D)return;if(le&&d===D)if(e.kind===lr)d--;else return;a=Math.max(a,s);const x=To(g);d=x===void 0?d:St(d,x[0],x[1]);const k=a-u,w=d-g,H={x:k>=0?u:a,y:w>=0?g:d,width:Math.abs(k)+1,height:Math.abs(w)+1};ve({...h.current,range:H},!0,!1,"drag")}}fo==null||fo({...e,location:[e.location[0]-s,e.location[1]]})}},[M,s,ae,h,Ze,fo,Re,le,D,yn,To,ve]),zl=l.useCallback(()=>{var a,d;const e=sn.current;if(e===void 0)return;const[n,r]=e.scrollEdge;let[c,u]=e.location;const g=De.current;n===-1?c=((d=(a=g.extras)==null?void 0:a.freezeRegion)==null?void 0:d.x)??g.x:n===1&&(c=g.x+g.width),r===-1?u=Math.max(0,g.y):r===1&&(u=Math.min(D-1,g.y+g.height)),c=St(c,0,O.length-1),u=St(u,0,D-1),an({...e,location:[c,u]})},[O.length,an,D]);Cc(pl,q,zl);const Oe=l.useCallback(e=>{if(h.current===void 0)return;const[n,r]=e,[c,u]=h.current.cell,g=h.current.range;let a=g.x,d=g.x+g.width,m=g.y,C=g.y+g.height;const[x,k]=To(u)??[0,D-1],w=k+1;if(r!==0)switch(r){case 2:{C=w,m=u,te(0,C,"vertical");break}case-2:{m=x,C=u+1,te(0,m,"vertical");break}case 1:{m<u?(m++,te(0,m,"vertical")):(C=Math.min(w,C+1),te(0,C,"vertical"));break}case-1:{C>u+1?(C--,te(0,C,"vertical")):(m=Math.max(x,m-1),te(0,m,"vertical"));break}default:cr()}if(n!==0)if(n===2)d=O.length,a=c,te(d-1-s,0,"horizontal");else if(n===-2)a=s,d=c+1,te(a-s,0,"horizontal");else{let H=[];if(me!==void 0){const S=me({x:a,y:m,width:d-a-s,height:C-m},Ee.current.signal);typeof S=="object"&&(H=Tc(S))}if(n===1){let S=!1;if(a<c){if(H.length>0){const $=Kt(a+1,c+1).find(I=>!H.includes(I-s));$!==void 0&&(a=$,S=!0)}else a++,S=!0;S&&te(a,0,"horizontal")}S||(d=Math.min(O.length,d+1),te(d-1-s,0,"horizontal"))}else if(n===-1){let S=!1;if(d>c+1){if(H.length>0){const $=Kt(d-1,c,-1).find(I=>!H.includes(I-s));$!==void 0&&(d=$,S=!0)}else d--,S=!0;S&&te(d-s,0,"horizontal")}S||(a=Math.max(s,a-1),te(a-s,0,"horizontal"))}else cr()}ve({cell:h.current.cell,range:{x:a,y:m,width:d-a,height:C-m}},!0,!1,"keyboard-select")},[me,To,h,O.length,s,D,te,ve]),un=l.useRef(Rn);un.current=Rn;const ft=l.useCallback((e,n,r,c)=>{const u=be-(r?0:1);e=St(e,s,He.length-1+s),n=St(n,0,u);const g=Ye==null?void 0:Ye[0],a=Ye==null?void 0:Ye[1];if(e===g&&n===a)return!1;if(c&&h.current!==void 0){const d=[...h.current.rangeStack];(h.current.range.width>1||h.current.range.height>1)&&d.push(h.current.range),$e({...h,current:{cell:[e,n],range:{x:e,y:n,width:1,height:1},rangeStack:d}},!0)}else ve({cell:[e,n],range:{x:e,y:n,width:1,height:1}},!0,!1,"keyboard-nav");return v.current!==void 0&&v.current[0]===e&&v.current[1]===n&&(v.current=void 0),un.current&&te(e-s,n),!0},[be,s,He.length,Ye,h,te,$e,ve]),El=l.useCallback((e,n)=>{(p==null?void 0:p.cell)!==void 0&&e!==void 0&&to(e)&&(Ae([{location:p.cell,value:e}]),window.requestAnimationFrame(()=>{var u;(u=he.current)==null||u.damage([{cell:p.cell}])})),Se(!0),y(void 0);const[r,c]=n;if(h.current!==void 0&&(r!==0||c!==0)){const u=h.current.cell[1]===be-1&&e!==void 0,g=h.current.cell[0]===O.length-1&&e!==void 0;let a=!0;if(u&&c===1&&ot!==void 0){a=!1;const d=h.current.cell[0]+r,m=$t(d);ut(m??d,!1)}if(g&&r===1&&nt!==void 0){a=!1;const d=h.current.cell[1]+c;ko(d,!1)}a&&ft(St(h.current.cell[0]+r,0,O.length-1),St(h.current.cell[1]+c,0,be-1),u,!1)}fe==null||fe(e,n)},[p==null?void 0:p.cell,Se,h,fe,Ae,be,ft,O.length,ut,ko,ot,nt,$t]),Ll=l.useMemo(()=>`gdg-overlay-${Sc++}`,[]),kt=l.useCallback(e=>{var r,c,u,g;Se();const n=[];for(let a=e.x;a<e.x+e.width;a++)for(let d=e.y;d<e.y+e.height;d++){const m=Q([a-s,d]);if(!m.allowOverlay&&m.kind!==J.Boolean)continue;let C;if(m.kind===J.Custom){const x=ke(m),k=(r=x==null?void 0:x.provideEditor)==null?void 0:r.call(x,{...m,location:[a-s,d]});(x==null?void 0:x.onDelete)!==void 0?C=x.onDelete(m):ai(k)&&(C=(c=k==null?void 0:k.deletedValue)==null?void 0:c.call(k,m))}else if(to(m)&&m.allowOverlay||m.kind===J.Boolean){const x=ke(m);C=(u=x==null?void 0:x.onDelete)==null?void 0:u.call(x,m)}C!==void 0&&!$o(C)&&to(C)&&n.push({location:[a,d],value:C})}Ae(n),(g=he.current)==null||g.damage(n.map(a=>({cell:a.location})))},[Se,Q,ke,Ae,s]),Zt=p!==void 0,qn=l.useCallback(e=>{var $,I;const n=()=>{e.stopPropagation(),e.preventDefault()},r={didMatch:!1},{bounds:c}=e,u=h.columns,g=h.rows,a=st;if(!Zt&&P(a.clear,e,r))$e(Go,!1),it==null||it();else if(!Zt&&P(a.selectAll,e,r))$e({columns:Y.empty(),rows:Y.empty(),current:{cell:(($=h.current)==null?void 0:$.cell)??[s,0],range:{x:s,y:0,width:U.length,height:D},rangeStack:[]}},!1);else if(P(a.search,e,r))(I=L==null?void 0:L.current)==null||I.focus({preventScroll:!0}),$n(!0);else if(P(a.delete,e,r)){const z=(at==null?void 0:at(h))??!0;if(z!==!1){const K=z===!0?h:z;if(K.current!==void 0){kt(K.current.range);for(const X of K.current.rangeStack)kt(X)}for(const X of K.rows)kt({x:s,y:X,width:U.length,height:1});for(const X of K.columns)kt({x:X,y:0,width:1,height:D})}}if(r.didMatch)return n(),!0;if(h.current===void 0)return!1;let[d,m]=h.current.cell;const[,C]=h.current.cell;let x=!1,k=!1;if(P(a.scrollToSelectedCell,e,r))Lo.current(d-s,m);else if(ce!=="none"&&P(a.selectColumn,e,r))u.hasIndex(d)?de(u.remove(d),void 0,!0):ce==="single"?de(Y.fromSingleSelection(d),void 0,!0):de(void 0,d,!0);else if(ae!=="none"&&P(a.selectRow,e,r))g.hasIndex(m)?Re(g.remove(m),void 0,!0):ae==="single"?Re(Y.fromSingleSelection(m),void 0,!0):Re(void 0,m,!0);else if(!Zt&&c!==void 0&&P(a.activateCell,e,r))if(m===D&&le)window.setTimeout(()=>{const z=$t(d);ut(z??d)},0);else{const z={inputType:"keyboard",key:e.key};N==null||N([d-s,m],z),Ft(c,z)}else h.current.range.height>1&&P(a.downFill,e,r)?Xn():h.current.range.width>1&&P(a.rightFill,e,r)?_n():P(a.goToNextPage,e,r)?m+=Math.max(1,De.current.height-4):P(a.goToPreviousPage,e,r)?m-=Math.max(1,De.current.height-4):P(a.goToFirstCell,e,r)?(y(void 0),m=0,d=0):P(a.goToLastCell,e,r)?(y(void 0),m=Number.MAX_SAFE_INTEGER,d=Number.MAX_SAFE_INTEGER):P(a.selectToFirstCell,e,r)?(y(void 0),Oe([-2,-2])):P(a.selectToLastCell,e,r)?(y(void 0),Oe([2,2])):Zt?(P(a.closeOverlay,e,r)&&y(void 0),P(a.acceptOverlayDown,e,r)&&(y(void 0),m++),P(a.acceptOverlayUp,e,r)&&(y(void 0),m--),P(a.acceptOverlayLeft,e,r)&&(y(void 0),d--),P(a.acceptOverlayRight,e,r)&&(y(void 0),d++)):(P(a.goDownCell,e,r)?m+=1:P(a.goUpCell,e,r)?m-=1:P(a.goRightCell,e,r)?d+=1:P(a.goLeftCell,e,r)?d-=1:P(a.goDownCellRetainSelection,e,r)?(m+=1,x=!0):P(a.goUpCellRetainSelection,e,r)?(m-=1,x=!0):P(a.goRightCellRetainSelection,e,r)?(d+=1,x=!0):P(a.goLeftCellRetainSelection,e,r)?(d-=1,x=!0):P(a.goToLastRow,e,r)?m=D-1:P(a.goToFirstRow,e,r)?m=Number.MIN_SAFE_INTEGER:P(a.goToLastColumn,e,r)?d=Number.MAX_SAFE_INTEGER:P(a.goToFirstColumn,e,r)?d=Number.MIN_SAFE_INTEGER:(Ze==="rect"||Ze==="multi-rect")&&(P(a.selectGrowDown,e,r)?Oe([0,1]):P(a.selectGrowUp,e,r)?Oe([0,-1]):P(a.selectGrowRight,e,r)?Oe([1,0]):P(a.selectGrowLeft,e,r)?Oe([-1,0]):P(a.selectToLastRow,e,r)?Oe([0,2]):P(a.selectToFirstRow,e,r)?Oe([0,-2]):P(a.selectToLastColumn,e,r)?Oe([2,0]):P(a.selectToFirstColumn,e,r)&&Oe([-2,0])),k=r.didMatch);if(Ne!==void 0&&Ne!=="normal"&&m!==C){const z=Ne==="skip-up"||Ne==="skip"||Ne==="block",K=Ne==="skip-down"||Ne==="skip"||Ne==="block",X=m<C;if(X&&z){for(;m>=0&&xt(m).isGroupHeader;)m--;m<0&&(m=C)}else if(!X&&K){for(;m<D&&xt(m).isGroupHeader;)m++;m>=D&&(m=C)}}const H=ft(d,m,!1,x),S=r.didMatch;return S&&(H||!k||xn)&&n(),S},[Ne,Zt,h,st,ce,ae,Ze,s,xt,D,ft,$e,it,U.length,at,xn,kt,de,Re,le,$t,ut,N,Ft,Xn,_n,Oe]),Jt=l.useCallback(e=>{let n=!1;if(zt!==void 0&&zt({...e,...e.location&&{location:[e.location[0]-s,e.location[1]]},cancel:()=>{n=!0}}),n||qn(e)||h.current===void 0)return;const[r,c]=h.current.cell,u=De.current;if(ro&&!e.metaKey&&!e.ctrlKey&&h.current!==void 0&&e.key.length===1&&/[\p{L}\p{M}\p{N}\p{S}\p{P}]/u.test(e.key)&&e.bounds!==void 0&&eo(Q([r-s,Math.max(0,Math.min(c,D-1))]))){if((!le||c!==D)&&(u.y>c||c>u.y+u.height||u.x>r||r>u.x+u.width))return;const g={inputType:"keyboard",key:e.key};N==null||N([r-s,c],g),Ft(e.bounds,g,e.key),e.stopPropagation(),e.preventDefault()}},[ro,zt,qn,h,Q,s,D,le,N,Ft]),Hl=l.useCallback((e,n)=>{const r=e.location[0]-s;if(e.kind==="header"&&(E==null||E(r,{...e,preventDefault:n})),e.kind===Gt){if(r<0)return;re==null||re(r,{...e,preventDefault:n})}if(e.kind==="cell"){const[c,u]=e.location;Ke==null||Ke([r,u],{...e,preventDefault:n}),ui(h,e.location)||ft(c,u,!1,!1)}},[h,Ke,re,E,s,ft]),dn=l.useCallback(async e=>{var a,d,m;if(!st.paste)return;function n(C,x,k,w){var S,$;const H=typeof k=="object"?(k==null?void 0:k.join(`
`))??"":(k==null?void 0:k.toString())??"";if(!$o(C)&&eo(C)&&C.readonly!==!0){const I=W==null?void 0:W(H,C);if(I!==void 0&&to(I))return{location:x,value:I};const z=ke(C);if(z===void 0)return;if(z.kind===J.Custom){Ko(C.kind===J.Custom);const K=(S=z.onPaste)==null?void 0:S.call(z,H,C.data);return K===void 0?void 0:{location:x,value:{...C,data:K}}}else{const K=($=z.onPaste)==null?void 0:$.call(z,H,C,{formatted:w,formattedString:typeof w=="string"?w:w==null?void 0:w.join(`
`),rawValue:k});return K===void 0?void 0:(Ko(K.kind===C.kind),{location:x,value:K})}}}const r=h.columns,c=h.rows,u=((a=q.current)==null?void 0:a.contains(document.activeElement))===!0||((d=b.current)==null?void 0:d.contains(document.activeElement))===!0;let g;if(h.current!==void 0?g=[h.current.range.x,h.current.range.y]:r.length===1?g=[r.first()??0,0]:c.length===1&&(g=[s,c.first()??0]),u&&g!==void 0){let C,x;const k="text/plain",w="text/html";if(navigator.clipboard.read!==void 0){const I=await navigator.clipboard.read();for(const z of I){if(z.types.includes(w)){const X=await(await z.getType(w)).text(),Ce=sr(X);if(Ce!==void 0){C=Ce;break}}z.types.includes(k)&&(x=await(await z.getType(k)).text())}}else if(navigator.clipboard.readText!==void 0)x=await navigator.clipboard.readText();else if(e!==void 0&&(e==null?void 0:e.clipboardData)!==null){if(e.clipboardData.types.includes(w)){const I=e.clipboardData.getData(w);C=sr(I)}C===void 0&&e.clipboardData.types.includes(k)&&(x=e.clipboardData.getData(k))}else return;const[H,S]=g,$=[];do{if(pt===void 0){const I=Le(g),z=x??(C==null?void 0:C.map(X=>X.map(Ce=>Ce.rawValue).join("	")).join("	"))??"",K=n(I,g,z,void 0);K!==void 0&&$.push(K);break}if(C===void 0){if(x===void 0)return;C=di(x)}if(pt===!1||typeof pt=="function"&&(pt==null?void 0:pt([g[0]-s,g[1]],C.map(I=>I.map(z=>{var K;return((K=z.rawValue)==null?void 0:K.toString())??""}))))!==!0)return;for(const[I,z]of C.entries()){if(I+S>=D)break;for(const[K,X]of z.entries()){const Ce=[K+H,I+S],[Ue,qe]=Ce;if(Ue>=O.length||qe>=be)continue;const je=Le(Ce),tt=n(je,Ce,X.rawValue,X.formatted);tt!==void 0&&$.push(tt)}}}while(!1);Ae($),(m=he.current)==null||m.damage($.map(I=>({cell:I.location})))}},[W,ke,Le,h,st.paste,q,O.length,Ae,be,pt,s,D]);mn("paste",dn,R,!1,!0);const Qt=l.useCallback(async(e,n)=>{var a,d;if(!st.copy)return;const r=n===!0||((a=q.current)==null?void 0:a.contains(document.activeElement))===!0||((d=b.current)==null?void 0:d.contains(document.activeElement))===!0,c=h.columns,u=h.rows,g=(m,C)=>{if(!bn)ar(m,C,e);else{const x=C.map(k=>({kind:J.Text,data:U[k].title,displayData:U[k].title,allowOverlay:!1}));ar([x,...m],C,e)}};if(r&&me!==void 0){if(h.current!==void 0){let m=me(h.current.range,Ee.current.signal);typeof m!="object"&&(m=await m()),g(m,Kt(h.current.range.x-s,h.current.range.x+h.current.range.width-s))}else if(u!==void 0&&u.length>0){const C=[...u].map(x=>{const k=me({x:s,y:x,width:U.length,height:1},Ee.current.signal);return typeof k=="object"?k[0]:k().then(w=>w[0])});if(C.some(x=>x instanceof Promise)){const x=await Promise.all(C);g(x,Kt(U.length))}else g(C,Kt(U.length))}else if(c.length>0){const m=[],C=[];for(const x of c){let k=me({x,y:0,width:1,height:D},Ee.current.signal);typeof k!="object"&&(k=await k()),m.push(k),C.push(x-s)}if(m.length===1)g(m[0],C);else{const x=m.reduce((k,w)=>k.map((H,S)=>[...H,...w[S]]));g(x,C)}}}},[U,me,h,st.copy,s,q,D,bn]);mn("copy",Qt,R,!1,!1);const Dl=l.useCallback(async e=>{var r,c;if(!(!st.cut||!(((r=q.current)==null?void 0:r.contains(document.activeElement))===!0||((c=b.current)==null?void 0:c.contains(document.activeElement))===!0))&&(await Qt(e),h.current!==void 0)){let u={current:{cell:h.current.cell,range:h.current.range,rangeStack:[]},rows:Y.empty(),columns:Y.empty()};const g=at==null?void 0:at(u);if(g===!1||(u=g===!0?u:g,u.current===void 0))return;kt(u.current.range)}},[kt,h,st.cut,Qt,q,at]);mn("cut",Dl,R,!1,!1);const Il=l.useCallback((e,n)=>{if(Tt!==void 0){s!==0&&(e=e.map(u=>[u[0]-s,u[1]])),Tt(e,n);return}if(e.length===0||n===-1)return;const[r,c]=e[n];v.current!==void 0&&v.current[0]===r&&v.current[1]===c||(v.current=[r,c],ft(r,c,!1,!1))},[Tt,s,ft]),[zo,Eo]=((or=wt==null?void 0:wt.current)==null?void 0:or.cell)??[],Lo=l.useRef(te);Lo.current=te,l.useLayoutEffect(()=>{var e,n,r,c;un.current&&!wo.current&&zo!==void 0&&Eo!==void 0&&(zo!==((n=(e=po.current)==null?void 0:e.current)==null?void 0:n.cell[0])||Eo!==((c=(r=po.current)==null?void 0:r.current)==null?void 0:c.cell[1]))&&Lo.current(zo,Eo),wo.current=!1},[zo,Eo]);const jn=h.current!==void 0&&(h.current.cell[0]>=O.length||h.current.cell[1]>=be);l.useLayoutEffect(()=>{jn&&$e(Go,!1)},[jn,$e]);const Fl=l.useMemo(()=>le===!0&&(B==null?void 0:B.tint)===!0?Y.fromSingleSelection(be-1):Y.empty(),[be,le,B==null?void 0:B.tint]),$l=l.useCallback(e=>typeof Et=="boolean"?Et:(Et==null?void 0:Et(e-s))??!0,[s,Et]),Al=l.useMemo(()=>{if(nn===void 0||b.current===null)return null;const{bounds:e,group:n}=nn,r=b.current.getBoundingClientRect();return l.createElement(rc,{bounds:e,group:n,canvasBounds:r,onClose:()=>rn(void 0),onFinish:c=>{rn(void 0),ze==null||ze(n,c)}})},[ze,nn]),Pl=Math.min(O.length,Je+(Xe?1:0));l.useImperativeHandle(o,()=>({appendRow:(e,n)=>ut(e+s,n),appendColumn:(e,n)=>ko(e,n),updateCells:e=>{var n;return s!==0&&(e=e.map(r=>({cell:[r.cell[0]+s,r.cell[1]]}))),(n=he.current)==null?void 0:n.damage(e)},getBounds:(e,n)=>{var r;if(!((b==null?void 0:b.current)===null||(q==null?void 0:q.current)===null)){if(e===void 0&&n===void 0){const c=b.current.getBoundingClientRect(),u=c.width/q.current.clientWidth;return{x:c.x-q.current.scrollLeft*u,y:c.y-q.current.scrollTop*u,width:q.current.scrollWidth*u,height:q.current.scrollHeight*u}}return(r=he.current)==null?void 0:r.getBounds((e??0)+s,n)}},focus:()=>{var e;return(e=he.current)==null?void 0:e.focus()},emit:async e=>{switch(e){case"delete":Jt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Jt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Jt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await Qt(void 0,!0);break;case"paste":await dn();break}},scrollTo:te,remeasureColumns:e=>{for(const n of e)So(n+s)},getMouseArgsForPosition:(e,n,r)=>{if((he==null?void 0:he.current)===null)return;const c=he.current.getMouseArgsForPosition(e,n,r);if(c!==void 0)return{...c,location:[c.location[0]-s,c.location[1]]}}}),[ut,ko,So,q,Qt,Jt,dn,s,te]);const[Zn,Jn]=Ye??[],Gl=l.useCallback(e=>{const[n,r]=e;if(r===-1){ce!=="none"&&(de(Y.fromSingleSelection(n),void 0,!1),Se());return}Zn===n&&Jn===r||(ve({cell:e,range:{x:n,y:r,width:1,height:1}},!0,!1,"keyboard-nav"),te(n,r))},[ce,Se,te,Zn,Jn,ve,de]),[Kl,Wl]=l.useState(!1),Qn=l.useRef(Ci(e=>{Wl(e)},5)),Nl=l.useCallback(()=>{Qn.current(!0),Z==null||Z(),h.current===void 0&&h.columns.length===0&&h.rows.length===0&&M===void 0&&ve({cell:[s,bo],range:{x:s,y:bo,width:1,height:1}},!0,!1,"keyboard-select")},[bo,h,M,s,ve]),Ol=l.useCallback(()=>{Qn.current(!1),xe==null||xe()},[xe]),[Ul,Vl]=l.useMemo(()=>{let e;const n=(ue==null?void 0:ue.scrollbarWidthOverride)??fi(),r=D+(le?1:0);if(typeof ct=="number")e=Xt+r*ct;else{let u=0;const g=Math.min(r,10);for(let a=0;a<g;a++)u+=ct(a);u=Math.floor(u/g),e=Xt+r*u}e+=n;const c=O.reduce((u,g)=>g.width+u,0)+n;return[`${Math.min(1e5,c)}px`,`${Math.min(1e5,e)}px`]},[O,ue==null?void 0:ue.scrollbarWidthOverride,ct,D,le,Xt]),Bl=l.useMemo(()=>hi(we),[we]);return l.createElement(gi.Provider,{value:we},l.createElement(gc,{style:Bl,className:oo,inWidth:ie??Ul,inHeight:ye??Vl},l.createElement(ec,{fillHandle:Hr,drawFocusRing:Sn,experimental:ue,fixedShadowX:Dr,fixedShadowY:Ir,getRowThemeOverride:et,headerIcons:Fr,imageWindowLoader:$r,initialSize:Ar,isDraggable:Pr,onDragLeave:Gr,onRowMoved:Bt,overscrollX:nl,overscrollY:rl,preventDiagonalScrolling:Nr,rightElement:Or,rightElementProps:Ur,smoothScrollX:Vr,smoothScrollY:Br,className:oo,enableGroups:Zo,onCanvasFocused:Nl,onCanvasBlur:Ol,canvasRef:b,onContextMenu:Hl,theme:we,cellXOffset:ml,cellYOffset:bo,accessibilityHeight:bt.height,onDragEnd:Tl,columns:O,nonGrowWidth:Pn,drawHeader:fl,onColumnProposeMove:Rl,drawCell:hl,disabledRows:Fl,freezeColumns:Pl,lockColumns:s,firstColAccessible:s===0,getCellContent:Le,minColumnWidth:Lt,maxColumnWidth:Co,searchInputRef:L,showSearch:il,onSearchClose:cl,highlightRegions:vl,getCellsForSelection:me,getGroupDetails:Qo,headerHeight:qo,isFocused:Kl,groupHeaderHeight:Zo?In:0,freezeTrailingRows:Qe+(le&&(B==null?void 0:B.sticky)===!0?1:0),hasAppendRow:le,onColumnResize:Dt,onColumnResizeEnd:ul,onColumnResizeStart:dl,onCellFocused:Gl,onColumnMoved:kl,onDragStart:Sl,onHeaderMenuClick:yl,onHeaderIndicatorClick:xl,onItemHovered:an,isFilling:(M==null?void 0:M.fillHandle)===!0,onMouseMove:bl,onKeyDown:Jt,onKeyUp:Uo,onMouseDown:Cl,onMouseUp:wl,onDragOverCell:Er,onDrop:Lr,onSearchResultsChanged:Il,onVisibleRegionChanged:Ml,clientSize:jo,rowHeight:ct,searchResults:No,searchValue:mt,onSearchValueChange:Oo,rows:be,scrollRef:q,selection:h,translateX:bt.tx,translateY:bt.ty,verticalBorder:$l,gridRef:he,getCellRenderer:ke,resizeIndicator:Zr}),Al,p!==void 0&&l.createElement(l.Suspense,{fallback:null},l.createElement(kc,{...p,validateCell:al,bloom:ne,id:Ll,getCellRenderer:ke,className:(ue==null?void 0:ue.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:Sr,imageEditorOverride:T,portalElementRef:Jr,onFinishEditing:El,markdownDivCreateNode:_,isOutsideClick:jr,customEventTarget:ue==null?void 0:ue.eventTarget}))))},Ec=l.forwardRef(zc),Lc=(t,o)=>{const i=l.useMemo(()=>({...Yi,...t.headerIcons}),[t.headerIcons]),f=l.useMemo(()=>t.renderers??mi,[t.renderers]),p=l.useMemo(()=>t.imageWindowLoader??new vi,[t.imageWindowLoader]);return l.createElement(Ec,{...t,renderers:f,headerIcons:i,ref:o,imageWindowLoader:p})},Wc=l.forwardRef(Lc);export{tc as C,Wc as D,ht as k,xc as u};
