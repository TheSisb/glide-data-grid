var Vi=Object.defineProperty;var Ui=(e,t,n)=>t in e?Vi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var oe=(e,t,n)=>(Ui(e,typeof t!="symbol"?t+"":t,n),n);import{a as Qe,j as Y,F as Yn,s as yt,b as qi}from"./marked.esm-I79JNzkl.js";import{r as E,R as Jn}from"./index-KtDdPitk.js";import{h as ji,d as Ki,v as Gi,_ as Ji,g as Qi,c as xn,r as Zi,j as er,t as tr}from"./throttle-UPaD_CsS.js";import{_ as nr}from"./iframe-HjJLx1tn.js";function Jo(e="This should not happen"){throw new Error(e)}function gt(e,t="Assertion failed"){if(!e)return Jo(t)}function Qn(e,t){return Jo(t??"Hell froze over")}function al(e,t){try{return e()}catch{return t}}const Mo=Object.prototype.hasOwnProperty;function Yt(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Yt(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(Mo.call(e,n)&&++o&&!Mo.call(t,n)||!(n in t)||!Yt(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const Cn=null,Zn=void 0;var de=(e=>(e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom",e))(de||{}),or=(e=>(e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e))(or||{}),_n=(e=>(e.Triangle="triangle",e.Dots="dots",e))(_n||{});function dl(e){return"width"in e&&typeof e.width=="number"}async function cl(e){return typeof e=="object"?e:await e()}function ir(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown")}function ul(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown"||e.kind==="boolean"||e.kind==="image"||e.kind==="custom")}function Qo(e){return e.kind==="marker"||e.kind==="new-row"}function rr(e){if(!ir(e)||e.kind==="image")return!1;if(e.kind==="text"||e.kind==="number"||e.kind==="markdown"||e.kind==="uri"||e.kind==="custom"||e.kind==="boolean")return e.readonly!==!0;Qn(e,"A cell was passed with an invalid kind")}function fl(e){return ji(e,"editor")}function eo(e){return!(e.readonly??!1)}var rn=(e=>(e.NewRow="new-row",e.Marker="marker",e))(rn||{});function sr(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,i){return o[0]-i[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const i=n[n.length-1];i[1]<o[0]?n.push([...o]):i[1]<o[1]&&(i[1]=o[1])}return n}let Eo;const ht=class ht{constructor(t){this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new ht(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=sr([...this.items,n]);return new ht(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],i=typeof t=="number"?t+1:t[1];for(const[r,l]of n.entries()){const[s,a]=l;if(s<=i&&o<=a){const d=[];s<o&&d.push([s,o]),i<a&&d.push([i,a]),n.splice(r,1,...d)}}return new ht(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,i]=this.items[n];if(t>=o&&t<i)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],i=this.items[n];if(o[0]!==i[0]||o[1]!==i[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let i=n;i<o;i++)t.push(i);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};oe(ht,"empty",()=>Eo??(Eo=new ht([]))),oe(ht,"fromSingleSelection",t=>ht.empty().add(t));let Vn=ht;function Je(e,t,n,o,i=!1){const r=E.useRef();r.current=t,E.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const l=n,s=a=>{var d;(d=r.current)==null||d.call(l,a)};return l.addEventListener(e,s,{passive:o,capture:i}),()=>{l.removeEventListener(e,s,{capture:i})}},[e,n,o,i])}function hl(e,t){return e===void 0?void 0:t}const lr=Math.PI;function Fo(e){return e*lr/180}const Zo=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),ei=(e,t,n,o,i)=>{switch(e){case"left":return Math.floor(t)+o+i/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-i/2}},ti=(e,t,n)=>Math.min(e,t-n*2),ni=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,to=e=>{const t=e.fgColor??"currentColor";return Qe("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Y("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),Y("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"})]})},ar=e=>{const t=e.fgColor??"currentColor";return Y("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Y("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})};function dr(e,t,n){const[o,i]=E.useState(e),r=E.useRef(!0);E.useEffect(()=>()=>{r.current=!1},[]);const l=E.useRef(Ki(s=>{r.current&&i(s)},n));return E.useLayoutEffect(()=>{r.current&&l.current(()=>e())},t),o}const cr="֑-߿יִ-﷽ﹰ-ﻼ",ur="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",fr=new RegExp("^[^"+ur+"]*["+cr+"]");function no(e){return fr.test(e)?"rtl":"not-rtl"}let pn;function Bo(){if(typeof document>"u")return 0;if(pn!==void 0)return pn;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),pn=n-o,pn}const Dt=Symbol();function gl(e){const t=E.useRef([Dt,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=E.useState(e),[,i]=E.useState(),r=E.useCallback(s=>{const a=t.current[0];a!==Dt&&(s=typeof s=="function"?s(a):s,s===a)||(a!==Dt&&i({}),o(d=>typeof s=="function"?s(a===Dt?d:a):s),t.current[0]=Dt)},[]),l=E.useCallback(()=>{t.current[0]=Dt,i({})},[]);return[t.current[0]===Dt?n:t.current[0],r,l]}function oi(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function ml(e){const t=E.useRef(e);return Yt(e,t.current)||(t.current=e),t.current}function hr(e,t){return Jn.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,contentAlign:n.contentAlign,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled})),[e,t])}function yl(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(wn(e.current.cell,t))return!0;const i=[e.current.range,...e.current.rangeStack];for(const r of i)if(n>=r.x&&n<r.x+r.width&&o>=r.y&&o<r.y+r.height)return!0}return!1}function Un(e,t){return(e??"")===(t??"")}function gr(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function mr(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function wn(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function ii(e){return[e.x+e.width-1,e.y+e.height-1]}function Ao(e,t,n){const o=n.x,i=n.x+n.width-1,r=n.y,l=n.y+n.height-1,[s,a]=e;if(a<r||a>l)return!1;if(t.span===void 0)return s>=o&&s<=i;const[d,f]=t.span;return d>=o&&d<=i||f>=o&&d<=i||d<o&&f>i}function yr(e,t,n,o){let i=0;if(n.current===void 0)return i;const r=n.current.range;(o||r.height*r.width>1)&&Ao(e,t,r)&&i++;for(const l of n.current.rangeStack)Ao(e,t,l)&&i++;return i}function ri(e,t){let n=e;if(t!==void 0){let o=[...e];const i=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,i)):(o.splice(t.dest+1,0,i),o.splice(t.src,1)),o=o.map((r,l)=>({...r,sticky:e[l].sticky})),n=o}return n}function _t(e,t){let n=0;const o=ri(e,t);for(let i=0;i<o.length;i++){const r=o[i];if(r.sticky)n+=r.width;else break}return n}function Ut(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let i=e-t;i<e;i++)o+=n(i);return o}}function qn(e,t,n,o,i){const r=ri(e,o),l=[];for(const d of r)if(d.sticky)l.push(d);else break;if(l.length>0)for(const d of l)n-=d.width;let s=t,a=i??0;for(;a<=n&&s<r.length;)a+=r[s].width,s++;for(let d=t;d<s;d++){const f=r[d];f.sticky||l.push(f)}return l}function br(e,t,n){let o=0;for(const i of t){const r=i.sticky?o:o+(n??0);if(e<=r+i.width)return i.sourceIndex;o+=i.width}return-1}function vr(e,t,n,o,i,r,l,s,a,d){const f=o+i;if(n&&e<=i)return-2;if(e<=f)return-1;let g=t;for(let c=0;c<d;c++){const u=r-1-c,b=typeof l=="number"?l:l(u);if(g-=b,e>=g)return u}const m=r-d,h=e-(a??0);if(typeof l=="number"){const c=Math.floor((h-f)/l)+s;return c>=m?void 0:c}else{let c=f;for(let u=s;u<m;u++){const b=l(u);if(h<=c+b)return u;c+=b}return}}let kn=0,tn={};const oo=typeof window>"u";let nt=null,Wn=!1;function si(){if(!(oo||Wn)&&!(typeof document>"u"))try{nt=document.createElement("span"),nt.style.visibility="hidden",nt.style.position="absolute",nt.style.top="-9999px",nt.style.left="-9999px",nt.style.whiteSpace="nowrap",nt.style.padding="0",nt.style.margin="0",nt.style.border="none",document.body.append(nt),Wn=!0}catch{Wn=!1,nt=null}}async function pr(){var e;oo||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,kn=0,tn={},Gi(),si())}pr();oo||setTimeout(si,0);function li(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function qe(e,t,n,o="middle"){const i=li(e,t,o,n);let r=tn[i];return r===void 0&&(r=t.measureText(e),tn[i]=r,kn++),kn>1e4&&(tn={},kn=0),r}function ai(e,t){const n=li(e,void 0,"middle",t);return tn[n]}function Ct(e,t){return typeof t!="string"&&(t=t.baseFontFull),wr(e,t)}function Do(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const Ho=[];function wr(e,t){for(const r of Ho)if(r.key===t)return r.val;const n=Do(e,"alphabetic"),i=-(Do(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return Ho.push({key:t,val:i}),i}function kr(e,t,n,o,i,r){const{ctx:l,rect:s,theme:a}=e;let d=Number.MAX_SAFE_INTEGER;const f=500;if(t!==void 0&&(d=n-t,d<f)){const g=1-d/f;l.globalAlpha=g,l.fillStyle=a.bgSearchResult,l.fillRect(s.x+1,s.y+1,s.width-(i?2:1),s.height-(r?2:1)),l.globalAlpha=1,o!==void 0&&(o.fillStyle=a.bgSearchResult)}return d<f}function ln(e,t,n){const{ctx:o,theme:i}=e,r=t??{},l=n??i.textDark;return l!==r.fillStyle&&(o.fillStyle=l,r.fillStyle=l),r}function di(e,t,n,o,i,r,l,s,a){a==="right"?e.fillText(t,n+i-(s.cellHorizontalPadding+.5),o+r/2+l):a==="center"?e.fillText(t,n+i/2,o+r/2+l):e.fillText(t,n+s.cellHorizontalPadding+.5,o+r/2+l)}function ci(e,t){const n=qe("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function xr(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Cr(e,t,n,o,i,r,l,s,a,d){const f=s.baseFontFull,g=Ji(e,t,f,i-s.cellHorizontalPadding*2,d??!1),m=ci(e,f),h=s.lineHeight*m,c=m+h*(g.length-1),u=c+s.cellVerticalPadding>r;u&&(e.save(),e.rect(n,o,i,r),e.clip());const b=o+r/2-c/2;let v=Math.max(o+s.cellVerticalPadding,b);for(const p of g)if(di(e,p,n,v,i,m,l,s,a),v+=h,v>o+r)break;u&&e.restore()}function mt(e,t,n,o,i){const{ctx:r,rect:l,theme:s}=e,{x:a,y:d,width:f,height:g}=l;o=o??!1,o||(t=xr(t,f));const m=Ct(r,s),h=no(t)==="rtl";if(n===void 0&&h&&(n="right"),h&&(r.direction="rtl"),t.length>0){let c=!1;n==="right"?(r.textAlign="right",c=!0):n!==void 0&&n!=="left"&&(r.textAlign=n,c=!0),o?Cr(r,t,a,d,f,g,m,s,n,i):di(r,t,a,d,f,g,m,s,n),c&&(r.textAlign="start"),h&&(r.direction="inherit")}}function at(e,t,n,o,i,r){typeof r=="number"&&(r={tl:r,tr:r,br:r,bl:r}),r={tl:Math.max(0,Math.min(r.tl,i/2,o/2)),tr:Math.max(0,Math.min(r.tr,i/2,o/2)),bl:Math.max(0,Math.min(r.bl,i/2,o/2)),br:Math.max(0,Math.min(r.br,i/2,o/2))},e.moveTo(t+r.tl,n),e.arcTo(t+o,n,t+o,n+r.tr,r.tr),e.arcTo(t+o,n+i,t+o-r.br,n+i,r.br),e.arcTo(t,n+i,t,n+i-r.bl,r.bl),e.arcTo(t,n,t+r.tl,n,r.tl)}function Sr(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Ir(e,t,n){const o=function(s,a){const d=a.x-s.x,f=a.y-s.y,g=Math.sqrt(d*d+f*f),m=d/g,h=f/g;return{x:d,y:a.y-s.y,len:g,nx:m,ny:h,ang:Math.atan2(h,m)}};let i;const r=t.length;let l=t[r-1];for(let s=0;s<r;s++){let a=t[s%r];const d=t[(s+1)%r],f=o(a,l),g=o(a,d),m=f.nx*g.ny-f.ny*g.nx,h=f.nx*g.nx-f.ny*-g.ny;let c=Math.asin(m<-1?-1:m>1?1:m),u=1,b=!1;h<0?c<0?c=Math.PI+c:(c=Math.PI-c,u=-1,b=!0):c>0&&(u=-1,b=!0),i=a.radius!==void 0?a.radius:n;const v=c/2;let p=Math.abs(Math.cos(v)*i/Math.sin(v)),S;p>Math.min(f.len/2,g.len/2)?(p=Math.min(f.len/2,g.len/2),S=Math.abs(p*Math.sin(v)/Math.cos(v))):S=i;let B=a.x+g.nx*p,A=a.y+g.ny*p;B+=-g.ny*S*u,A+=g.nx*S*u,e.arc(B,A,S,f.ang+Math.PI/2*u,g.ang-Math.PI/2*u,b),l=a,a=d}e.closePath()}function jn(e,t,n,o,i,r,l,s,a,d,f,g,m,h,c){const u={x:0,y:r+d,width:0,height:0};if(e>=h.length||t>=f||t<-2||e<0)return u;const b=r-i;if(e>=g){const v=l>e?-1:1,p=_t(h);u.x+=p+a;for(let S=l;S!==e;S+=v)u.x+=h[v===1?S:S-1].width*v}else for(let v=0;v<e;v++)u.x+=h[v].width;if(u.width=h[e].width+1,t===-1)u.y=i,u.height=b;else if(t===-2){u.y=0,u.height=i;let v=e;const p=h[e].group,S=h[e].sticky;for(;v>0&&Un(h[v-1].group,p)&&h[v-1].sticky===S;){const A=h[v-1];u.x-=A.width,u.width+=A.width,v--}let B=e;for(;B+1<h.length&&Un(h[B+1].group,p)&&h[B+1].sticky===S;){const A=h[B+1];u.width+=A.width,B++}if(!S){const A=_t(h),I=u.x-A;I<0&&(u.x-=I,u.width+=I),u.x+u.width>n&&(u.width=n-u.x)}}else if(t>=f-m){let v=f-t;for(u.y=o;v>0;){const p=t+v-1;u.height=typeof c=="number"?c:c(p),u.y-=u.height,v--}u.height+=1}else{const v=s>t?-1:1;if(typeof c=="number"){const p=t-s;u.y+=p*c}else for(let p=s;p!==t;p+=v)u.y+=c(p)*v;u.height=(typeof c=="number"?c:c(t))+1}return u}const io=1<<21;function ot(e,t){return(t+2)*io+e}function ui(e){return e%io}function ro(e){return Math.floor(e/io)-2}function so(e){const t=ui(e),n=ro(e);return[t,n]}class fi{constructor(){oe(this,"visibleWindow",{x:0,y:0,width:0,height:0});oe(this,"freezeCols",0);oe(this,"freezeRows",[]);oe(this,"isInWindow",t=>{const n=ui(t),o=ro(t),i=this.visibleWindow,r=n>=i.x&&n<=i.x+i.width||n<this.freezeCols,l=o>=i.y&&o<=i.y+i.height||this.freezeRows.includes(o);return r&&l})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Yt(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Mr extends fi{constructor(){super(...arguments);oe(this,"cache",new Map);oe(this,"setValue",(n,o)=>{this.cache.set(ot(n[0],n[1]),o)});oe(this,"getValue",n=>this.cache.get(ot(n[0],n[1])));oe(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class nn{constructor(t=[]){oe(this,"cells");this.cells=new Set(t.map(n=>ot(n[0],n[1])))}add(t){this.cells.add(ot(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(ot(t[0],t[1]))}remove(t){this.cells.delete(ot(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(ro(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(ot(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield so(t)}}function Er(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class Fr{constructor(t,n){oe(this,"spriteMap",new Map);oe(this,"headerIcons");oe(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,i,r,l,s,a=1){const[d,f]=Er(n,s),g=l*Math.ceil(window.devicePixelRatio),m=`${d}_${f}_${g}_${t}`;let h=this.spriteMap.get(m);if(h===void 0){const c=this.headerIcons[t];if(c===void 0)return;h=document.createElement("canvas");const u=h.getContext("2d");if(u===null)return;const b=new Image;b.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(c({fgColor:f,bgColor:d}))}`,this.spriteMap.set(m,h);const v=b.decode();if(v===void 0)return;this.inFlight++,v.then(()=>{u.drawImage(b,0,0,g,g)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else a<1&&(o.globalAlpha=a),o.drawImage(h,0,0,g,g,i,r,l,l),a<1&&(o.globalAlpha=1)}}const zn={};let xt=null;function Br(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Kn(e){const t=e.toLowerCase().trim();if(zn[t]!==void 0)return zn[t];xt=xt||Br(),xt.style.color="#000",xt.style.color=t;const n=getComputedStyle(xt).color;xt.style.color="#fff",xt.style.color=t;const o=getComputedStyle(xt).color;if(o!==n)return[0,0,0,1];let i=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return i.length<4&&i.push(1),i=i.map(r=>Number.isNaN(r)?0:r),zn[t]=i,i}function an(e,t){const[n,o,i]=Kn(e);return`rgba(${n}, ${o}, ${i}, ${t})`}const Po=new Map;function Ro(e,t){const n=`${e}-${t}`,o=Po.get(n);if(o!==void 0)return o;const i=Ue(e,t);return Po.set(n,i),i}function Ue(e,t){if(t===void 0)return e;const[n,o,i,r]=Kn(e);if(r===1)return e;const[l,s,a,d]=Kn(t),f=r+d*(1-r),g=(r*n+d*l*(1-r))/f,m=(r*o+d*s*(1-r))/f,h=(r*i+d*a*(1-r))/f;return`rgba(${g}, ${m}, ${h}, ${f})`}function hi(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y)}function Sn(e,t,n,o,i,r,l,s,a){s=s??t;let d=t,f=e;const g=o-r;let m=!1;for(;d<n&&f<g;){const h=i(f);if(d+h>s&&a(d,f,h,!1,l&&f===o-1)===!0){m=!0;break}d+=h,f++}if(!m){d=n;for(let h=0;h<r;h++){f=o-1-h;const c=i(f);d-=c,a(d,f,c,!0,l&&f===o-1)}}}function St(e,t,n,o,i,r){let l=0,s=0;const a=i+o;for(const d of e){const f=d.sticky?s:l+n;if(r(d,f,a,d.sticky?0:s,t)===!0)break;l+=d.width,s+=d.sticky?d.width:0}}function gi(e,t,n,o,i){let r=0,l=0;for(let s=0;s<e.length;s++){const a=e[s];let d=s+1,f=a.width;for(a.sticky&&(l+=f);d<e.length&&Un(e[d].group,a.group)&&e[d].sticky===e[s].sticky;){const u=e[d];f+=u.width,d++,s++,u.sticky&&(l+=u.width)}const g=a.sticky?0:n,m=r+g,h=a.sticky?0:Math.max(0,l-m),c=Math.min(f-h,t-(m+h));i([a.sourceIndex,e[d-1].sourceIndex],a.group??"",m+h,0,c,o),r+=f}}function mi(e,t,n,o,i,r,l){var m;const[s,a]=e;let d,f;const g=((m=l.find(h=>!h.sticky))==null?void 0:m.sourceIndex)??0;if(a>g){const h=Math.max(s,g);let c=t,u=o;for(let b=r.sourceIndex-1;b>=h;b--)c-=l[b].width,u+=l[b].width;for(let b=r.sourceIndex+1;b<=a;b++)u+=l[b].width;f={x:c,y:n,width:u,height:i}}if(g>s){const h=Math.min(a,g-1);let c=t,u=o;for(let b=r.sourceIndex-1;b>=s;b--)c-=l[b].width,u+=l[b].width;for(let b=r.sourceIndex+1;b<=h;b++)u+=l[b].width;d={x:c,y:n,width:u,height:i}}return[d,f]}function bl(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const yi={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4};function vl(){return yi}const pl=Jn.createContext(yi);function Vt(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const i in o)o.hasOwnProperty(i)&&(i==="bgCell"?n[i]=Ue(o[i],n[i]):n[i]=o[i]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}function wl(e,t,n,o){if(o==="any")return Ar(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),mr([t,n],e))return;const i=t-e.x,r=e.x+e.width-t,l=n-e.y+1,s=e.y+e.height-n,a=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="horizontal"?Number.MAX_SAFE_INTEGER:l,o==="horizontal"?Number.MAX_SAFE_INTEGER:s);return a===s?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:a===l?{x:e.x,y:n,width:e.width,height:e.y-n}:a===r?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function sn(e,t,n,o,i,r,l,s){return e<=i+l&&i<=e+n&&t<=r+s&&r<=t+o}function $t(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Ar(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),i=Math.max(e.x+e.width,t.x+t.width)-n,r=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:i,height:r}}function Dr(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function Hr(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const i=-4,r=-4,l=t+4,s=n+4,a=i-e.x,d=e.x+e.width-l,f=r-e.y,g=e.y+e.height-s,m=a>0?e.x+Math.floor(a/o)*o:e.x,h=d>0?e.x+e.width-Math.floor(d/o)*o:e.x+e.width,c=f>0?e.y+Math.floor(f/o)*o:e.y,u=g>0?e.y+e.height-Math.floor(g/o)*o:e.y+e.height;return{x:m,y:c,width:h-m,height:u-c}}function Pr(e,t,n,o,i){const[r,l,s,a]=t,[d,f,g,m]=i,{x:h,y:c,width:u,height:b}=e,v=[];if(u<=0||b<=0)return v;const p=h+u,S=c+b,B=h<r,A=c<l,I=h+u>s,D=c+b>a,W=h>=r&&h<s||p>r&&p<=s||h<r&&p>s,k=c>=l&&c<a||S>l&&S<=a||c<l&&S>a;if(W&&k){const M=Math.max(h,r),x=Math.max(c,l),C=Math.min(p,s),w=Math.min(S,a);v.push({rect:{x:M,y:x,width:C-M,height:w-x},clip:{x:d,y:f,width:g-d+1,height:m-f+1}})}if(B&&A){const M=h,x=c,C=Math.min(p,r),w=Math.min(S,l);v.push({rect:{x:M,y:x,width:C-M,height:w-x},clip:{x:0,y:0,width:d+1,height:f+1}})}if(A&&W){const M=Math.max(h,r),x=c,C=Math.min(p,s),w=Math.min(S,l);v.push({rect:{x:M,y:x,width:C-M,height:w-x},clip:{x:d,y:0,width:g-d+1,height:f+1}})}if(A&&I){const M=Math.max(h,s),x=c,C=p,w=Math.min(S,l);v.push({rect:{x:M,y:x,width:C-M,height:w-x},clip:{x:g,y:0,width:n-g+1,height:f+1}})}if(B&&k){const M=h,x=Math.max(c,l),C=Math.min(p,r),w=Math.min(S,a);v.push({rect:{x:M,y:x,width:C-M,height:w-x},clip:{x:0,y:f,width:d+1,height:m-f+1}})}if(I&&k){const M=Math.max(h,s),x=Math.max(c,l),C=p,w=Math.min(S,a);v.push({rect:{x:M,y:x,width:C-M,height:w-x},clip:{x:g,y:f,width:n-g+1,height:m-f+1}})}if(B&&D){const M=h,x=Math.max(c,a),C=Math.min(p,r),w=S;v.push({rect:{x:M,y:x,width:C-M,height:w-x},clip:{x:0,y:m,width:d+1,height:o-m+1}})}if(D&&W){const M=Math.max(h,r),x=Math.max(c,a),C=Math.min(p,s),w=S;v.push({rect:{x:M,y:x,width:C-M,height:w-x},clip:{x:d,y:m,width:g-d+1,height:o-m+1}})}if(I&&D){const M=Math.max(h,s),x=Math.max(c,a),C=p,w=S;v.push({rect:{x:M,y:x,width:C-M,height:w-x},clip:{x:g,y:m,width:n-g+1,height:o-m+1}})}return v}const Rr={kind:de.Loading,allowOverlay:!1};function To(e,t,n,o,i,r,l,s,a,d,f,g,m,h,c,u,b,v,p,S,B,A,I,D,W,k,P,M,x,C,w,$,U,q,se){let le=(S==null?void 0:S.size)??Number.MAX_SAFE_INTEGER;const he=performance.now();let ge=C.baseFontFull;e.font=ge;const Oe={ctx:e},K=[0,0],De=b>0?Ut(a,b,d):0;let Se,N;const we=hi(p);return St(t,s,r,l,i,(J,Ie,je,dt,It)=>{const ct=Math.max(0,dt-Ie),Ke=Ie+ct,ye=i+1,bt=J.width-ct,vt=o-i-1;if(p.length>0){let xe=!1;for(let ae=0;ae<p.length;ae++){const be=p[ae];if(sn(Ke,ye,bt,vt,be.x,be.y,be.width,be.height)){xe=!0;break}}if(!xe)return}const Xe=()=>{e.save(),e.beginPath(),e.rect(Ke,ye,bt,vt),e.clip()},ce=B.columns.hasIndex(J.sourceIndex),$e=g(J.group??"").overrideTheme,Me=J.themeOverride===void 0&&$e===void 0?C:Vt(C,$e,J.themeOverride),We=Me.baseFontFull;We!==ge&&(ge=We,e.font=We),Xe();let Q;return Sn(It,je,o,a,d,b,v,we,(xe,ae,be,L,j)=>{var Et,it,rt;if(ae<0||(K[0]=J.sourceIndex,K[1]=ae,S!==void 0&&!S.has(K)))return;if(p.length>0){let ne=!1;for(let Fe=0;Fe<p.length;Fe++){const ke=p[Fe];if(sn(Ie,xe,J.width,be,ke.x,ke.y,ke.width,ke.height)){ne=!0;break}}if(!ne)return}const ue=B.rows.hasIndex(ae),te=h.hasIndex(ae),ie=ae<a?f(K):Rr;let Ce=Ie,fe=J.width,G=!1,Te=!1;if(ie.span!==void 0){const[ne,Fe]=ie.span,ke=`${ae},${ne},${Fe},${J.sticky}`;if(N===void 0&&(N=new Set),N.has(ke)){le--;return}else{const st=mi(ie.span,Ie,xe,J.width,be,J,n),Ve=J.sticky?st[0]:st[1];if(!J.sticky&&st[0]!==void 0&&(Te=!0),Ve!==void 0){Ce=Ve.x,fe=Ve.width,N.add(ke),e.restore(),Q=void 0,e.save(),e.beginPath();const pt=Math.max(0,dt-Ve.x);e.rect(Ve.x+pt,xe,Ve.width-pt,be),Se===void 0&&(Se=[]),Se.push({x:Ve.x+pt,y:xe,width:Ve.width-pt,height:be}),e.clip(),G=!0}}}const Ye=m==null?void 0:m(ae),_e=j&&((Et=J.trailingRowOptions)==null?void 0:Et.themeOverride)!==void 0?(it=J.trailingRowOptions)==null?void 0:it.themeOverride:void 0,Ee=ie.themeOverride===void 0&&Ye===void 0&&_e===void 0?Me:Vt(Me,Ye,_e,ie.themeOverride);e.beginPath();const Ge=gr(K,ie,B);let ze=yr(K,ie,B,u);const Pt=ie.span!==void 0&&B.columns.some(ne=>ie.span!==void 0&&ne>=ie.span[0]&&ne<=ie.span[1]);Ge&&!c&&u?ze=0:Ge&&u&&(ze=Math.max(ze,1)),Pt&&ze++,Ge||(ue&&ze++,ce&&!j&&ze++);const Rt=ie.kind===de.Protected?Ee.bgCellMedium:Ee.bgCell;let ve;if((L||Rt!==C.bgCell)&&(ve=Ue(Rt,ve)),ze>0||te){te&&(ve=Ue(Ee.bgHeader,ve));for(let ne=0;ne<ze;ne++)ve=Ue(Ee.accentLight,ve)}else if(A!==void 0){for(const ne of A)if(ne[0]===J.sourceIndex&&ne[1]===ae){ve=Ue(Ee.bgSearchResult,ve);break}}if(I!==void 0)for(let ne=0;ne<I.length;ne++){const Fe=I[ne],ke=Fe.range;Fe.style!=="solid-outline"&&ke.x<=J.sourceIndex&&J.sourceIndex<ke.x+ke.width&&ke.y<=ae&&ae<ke.y+ke.height&&(ve=Ue(Fe.color,ve))}let Mt=!1;if(S!==void 0){const ne=xe+1,ke=(L?ne+be-1:Math.min(ne+be-1,o-De))-ne;(ke!==be-1||Ce+1<=dt)&&(Mt=!0,e.save(),e.beginPath(),e.rect(Ce+1,ne,fe-1,ke),e.clip()),ve=ve===void 0?Ee.bgCell:Ue(ve,Ee.bgCell)}const ut=J.sourceIndex===n.length-1,pe=ae===a-1;ve!==void 0&&(e.fillStyle=ve,Q!==void 0&&(Q.fillStyle=ve),S!==void 0?e.fillRect(Ce+1,xe+1,fe-(ut?2:1),be-(pe?2:1)):e.fillRect(Ce,xe,fe,be)),ie.style==="faded"&&(e.globalAlpha=.6);let Ne;for(let ne=0;ne<k.length;ne++){const Fe=k[ne];if(Fe.item[0]===J.sourceIndex&&Fe.item[1]===ae){Ne=Fe;break}}if(fe>se&&!Te){const ne=Ee.baseFontFull;ne!==ge&&(e.font=ne,ge=ne),Q=bi(e,ie,J.sourceIndex,ae,ut,pe,Ce,xe,fe,be,ze>0,Ee,ve??Ee.bgCell,D,W,(Ne==null?void 0:Ne.hoverAmount)??0,P,x,he,M,Q,w,$,U,q)}return Mt&&e.restore(),ie.style==="faded"&&(e.globalAlpha=1),le--,G&&(e.restore(),(rt=Q==null?void 0:Q.deprep)==null||rt.call(Q,Oe),Q=void 0,Xe(),ge=We,e.font=We),le<=0}),e.restore(),le<=0}),Se}const Jt=[0,0],Qt={x:0,y:0,width:0,height:0},Ln=[void 0,()=>{}];let Gn=!1;function Tr(){Gn=!0}function bi(e,t,n,o,i,r,l,s,a,d,f,g,m,h,c,u,b,v,p,S,B,A,I,D,W){var $,U;let k,P;b!==void 0&&b[0][0]===n&&b[0][1]===o&&(k=b[1][0],P=b[1][1]);let M;Jt[0]=n,Jt[1]=o,Qt.x=l,Qt.y=s,Qt.width=a,Qt.height=d,Ln[0]=I.getValue(Jt),Ln[1]=q=>I.setValue(Jt,q),Gn=!1;const x={ctx:e,theme:g,col:n,row:o,cell:t,rect:Qt,highlighted:f,cellFillColor:m,hoverAmount:u,frameTime:p,hoverX:k,drawState:Ln,hoverY:P,imageLoader:h,spriteManager:c,hyperWrapping:v,overrideCursor:k!==void 0?W:void 0,requestAnimationFrame:Tr},C=kr(x,t.lastUpdated,p,B,i,r),w=D(t);if(w!==void 0){(B==null?void 0:B.renderer)!==w&&(($=B==null?void 0:B.deprep)==null||$.call(B,x),B=void 0);const q=(U=w.drawPrep)==null?void 0:U.call(w,x,B);S!==void 0&&!Qo(x.cell)?S(x,()=>w.draw(x,t)):w.draw(x,t),M=q===void 0?void 0:{deprep:q==null?void 0:q.deprep,fillStyle:q==null?void 0:q.fillStyle,font:q==null?void 0:q.font,renderer:w}}return(C||Gn)&&(A==null||A(Jt)),M}function lo(e,t,n,o,i,r,l,s,a=-20,d=-20,f=32,g="center",m="square"){const h=Math.floor(i+l/2),c=m==="circle"?1e4:t.roundingRadius??4;let u=ti(f,l,t.cellVerticalPadding),b=u/2;const v=ei(g,o,r,t.cellHorizontalPadding,u),p=Zo(v,h,u),S=ni(o+a,i+d,p);switch(n){case!0:{e.beginPath(),at(e,v-u/2,h-u/2,u,u,c),m==="circle"&&(b*=.8,u*=.8),e.fillStyle=s?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(v-b+u/4.23,h-b+u/1.97),e.lineTo(v-b+u/2.42,h-b+u/1.44),e.lineTo(v-b+u/1.29,h-b+u/3.25),e.strokeStyle=t.rowMarkerIcon??t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case Cn:case!1:{e.beginPath(),at(e,v-u/2+.5,h-u/2+.5,u-1,u-1,c),e.lineWidth=1,e.strokeStyle=S?t.textDark:t.textMedium,e.stroke();break}case Zn:{e.beginPath(),at(e,v-u/2,h-u/2,u,u,c),e.fillStyle=S?t.textMedium:t.textLight,e.fill(),m==="circle"&&(b*=.8,u*=.8),e.beginPath(),e.moveTo(v-u/3,h),e.lineTo(v+u/3,h),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:Qn()}}function Wr(e,t,n,o,i,r,l,s,a,d,f,g,m,h,c,u,b,v,p){var k,P,M,x;const S=l+s;if(S<=0)return;e.fillStyle=g.bgHeader,e.fillRect(0,0,i,S);const B=(k=o==null?void 0:o[0])==null?void 0:k[0],A=(P=o==null?void 0:o[0])==null?void 0:P[1],I=(M=o==null?void 0:o[1])==null?void 0:M[0],D=(x=o==null?void 0:o[1])==null?void 0:x[1],W=g.headerFontFull;e.font=W,St(t,0,r,0,S,(C,w,$,U)=>{var J;if(b!==void 0&&!b.has([C.sourceIndex,-1]))return;const q=Math.max(0,U-w);e.save(),e.beginPath(),e.rect(w+q,s,C.width-q,l),e.clip();const se=u(C.group??"").overrideTheme,le=C.themeOverride===void 0&&se===void 0?g:Vt(g,se,C.themeOverride);le.bgHeader!==g.bgHeader&&(e.fillStyle=le.bgHeader,e.fill()),le!==g&&(e.font=le.baseFontFull);const he=f.columns.hasIndex(C.sourceIndex),ge=a!==void 0||d,Oe=!ge&&A===-1&&B===C.sourceIndex,K=ge?0:((J=h.find(Ie=>Ie.item[0]===C.sourceIndex&&Ie.item[1]===-1))==null?void 0:J.hoverAmount)??0,De=(f==null?void 0:f.current)!==void 0&&f.current.cell[0]===C.sourceIndex,Se=he?le.accentColor:De?le.bgHeaderHasFocus:le.bgHeader,N=n?s:0,we=C.sourceIndex===0?0:1;he?(e.fillStyle=Se,e.fillRect(w+we,N,C.width-we,l)):(De||K>0)&&(e.beginPath(),e.rect(w+we,N,C.width-we,l),De&&(e.fillStyle=le.bgHeaderHasFocus,e.fill()),K>0&&(e.globalAlpha=K,e.fillStyle=le.bgHeaderHovered,e.fill(),e.globalAlpha=1)),wi(e,w,N,C.width,l,C,he,le,Oe,Oe?I:void 0,Oe?D:void 0,De,K,m,v,p),e.restore()}),n&&zr(e,t,i,r,s,o,g,m,h,c,u,b)}function zr(e,t,n,o,i,r,l,s,a,d,f,g){const m=l.cellHorizontalPadding,[h,c]=(r==null?void 0:r[0])??[];let u=0;gi(t,n,o,i,(b,v,p,S,B,A)=>{if(g!==void 0&&!g.hasItemInRectangle({x:b[0],y:-2,width:b[1]-b[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(p,S,B,A),e.clip();const I=f(v),D=(I==null?void 0:I.overrideTheme)===void 0?l:Vt(l,I.overrideTheme),W=c===-2&&h!==void 0&&h>=b[0]&&h<=b[1],k=W?D.bgHeaderHovered:D.bgHeader;if(k!==l.bgHeader&&(e.fillStyle=k,e.fill()),e.fillStyle=D.textGroupHeader??D.textHeader,I!==void 0){let P=p;if(I.icon!==void 0&&(s.drawSprite(I.icon,"normal",e,P+m,(i-20)/2,20,D),P+=26),e.fillText(I.name,P+m,i/2+Ct(e,l.headerFontFull)),I.actions!==void 0&&W){const M=vi({x:p,y:S,width:B,height:A},I.actions);e.beginPath();const x=M[0].x-10,C=p+B-x;e.rect(x,0,C,i);const w=e.createLinearGradient(x,0,x+C,0),$=an(k,0);w.addColorStop(0,$),w.addColorStop(10/C,k),w.addColorStop(1,k),e.fillStyle=w,e.fill(),e.globalAlpha=.6;const[U,q]=(r==null?void 0:r[1])??[-1,-1];for(let se=0;se<I.actions.length;se++){const le=I.actions[se],he=M[se],ge=$t(he,U+p,q);ge&&(e.globalAlpha=1),s.drawSprite(le.icon,"normal",e,he.x+he.width/2-10,he.y+he.height/2-10,20,D),ge&&(e.globalAlpha=.6)}e.globalAlpha=1}}p!==0&&d(b[0])&&(e.beginPath(),e.moveTo(p+.5,0),e.lineTo(p+.5,i),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()),e.restore(),u=p+B}),e.beginPath(),e.moveTo(u+.5,0),e.lineTo(u+.5,i),e.moveTo(0,i+.5),e.lineTo(n,i+.5),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()}const Nt=30;function Lr(e,t,n,o,i){return i?{x:e,y:t,width:Nt,height:Math.min(Nt,o)}:{x:e+n-Nt,y:Math.max(t,t+o/2-Nt/2),width:Nt,height:Math.min(Nt,o)}}function vi(e,t){const n=[];let o=e.x+e.width-26*t.length;const i=e.y+e.height/2-13,r=26,l=26;for(let s=0;s<t.length;s++)n.push({x:o,y:i,width:l,height:r}),o+=26;return n}function Zt(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function pi(e,t,n,o,i,r,l,s){var A;const a=l.cellHorizontalPadding,d=l.headerIconSize,f=Lr(n,o,i,r,!1),g=s||t.contentAlign==="right",m=t.contentAlign==="center";let h=n+a,c,u;const b=t.icon!==void 0&&t.icon!==null;b&&(c={x:g?n+i-a-d:h,y:o+(r-d)/2,width:d,height:d},g||(h+=Math.ceil(d*1.3)),t.overlayIcon!==void 0&&(u={x:c.x+9,y:c.y+6,width:18,height:18}));const v=e===void 0?((A=ai(t.title,l.headerFontFull))==null?void 0:A.width)??0:qe(t.title,e,l.headerFontFull).width,p={x:m?n+(i-v)/2:g?n:h,y:o,width:m?v:g?i-(b?d+a:a):i-(h-n)-a,height:r};let S;t.indicatorIcon!==void 0&&(S={x:g?b?c.x-d-a:n+i-d-a:h+v+a,y:o+(r-d)/2,width:d,height:d});const B=n+i/2;return{menuBounds:Zt(f,B,s),iconBounds:Zt(c,B,s),iconOverlayBounds:Zt(u,B,s),textBounds:Zt(p,B,s),indicatorIconBounds:Zt(S,B,s)}}function Wo(e,t,n,o,i,r,l,s,a,d,f,g,m,h,c,u){if(r.rowMarker!==void 0&&r.headerRowMarkerDisabled!==!0){const p=r.rowMarkerChecked;p!==!0&&r.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=g);const S=r.headerRowMarkerTheme!==void 0?Vt(s,r.headerRowMarkerTheme):s;lo(e,S,p,t,n,o,i,!1,void 0,void 0,18,"center",r.rowMarker),p!==!0&&r.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const b=l?s.textHeaderSelected:s.textHeader,v=r.hasMenu===!0&&(a||h&&l)&&u.menuBounds!==void 0;if(r.icon!==void 0&&u.iconBounds!==void 0){let p=l?"selected":"normal";r.style==="highlight"&&(p=l?"selected":"special"),m.drawSprite(r.icon,p,e,u.iconBounds.x,u.iconBounds.y,u.iconBounds.width,s),r.overlayIcon!==void 0&&u.iconOverlayBounds!==void 0&&m.drawSprite(r.overlayIcon,l?"selected":"special",e,u.iconOverlayBounds.x,u.iconOverlayBounds.y,u.iconOverlayBounds.width,s)}if(v&&o>35){const S=c?35:o-35,B=c?35*.7:o-35*.7,A=S/o,I=B/o,D=e.createLinearGradient(t,0,t+o,0),W=an(b,0);D.addColorStop(c?1:0,b),D.addColorStop(A,b),D.addColorStop(I,W),D.addColorStop(c?0:1,W),e.fillStyle=D}else e.fillStyle=b;if(u.textBounds!==void 0){const p=c||r.contentAlign==="right";e.textAlign=p?"right":"left";const S=p?u.textBounds.x+u.textBounds.width:u.textBounds.x;e.fillText(r.title,S,n+i/2+Ct(e,s.headerFontFull))}if(r.indicatorIcon!==void 0&&u.indicatorIconBounds!==void 0&&(!v||!sn(u.menuBounds.x,u.menuBounds.y,u.menuBounds.width,u.menuBounds.height,u.indicatorIconBounds.x,u.indicatorIconBounds.y,u.indicatorIconBounds.width,u.indicatorIconBounds.height))){let p=l?"selected":"normal";r.style==="highlight"&&(p=l?"selected":"special"),m.drawSprite(r.indicatorIcon,p,e,u.indicatorIconBounds.x,u.indicatorIconBounds.y,u.indicatorIconBounds.width,s)}if(v&&u.menuBounds!==void 0){const p=u.menuBounds,S=d!==void 0&&f!==void 0&&$t(p,d+t,f+n);if(S||(e.globalAlpha=.7),r.menuIcon===void 0||r.menuIcon===_n.Triangle){e.beginPath();const B=p.x+p.width/2-5.5,A=p.y+p.height/2-3;Ir(e,[{x:B,y:A},{x:B+11,y:A},{x:B+5.5,y:A+6}],1),e.fillStyle=b,e.fill()}else if(r.menuIcon===_n.Dots){e.beginPath();const B=p.x+p.width/2,A=p.y+p.height/2;Sr(e,B,A),e.fillStyle=b,e.fill()}else{const B=p.x+(p.width-s.headerIconSize)/2,A=p.y+(p.height-s.headerIconSize)/2;m.drawSprite(r.menuIcon,"normal",e,B,A,s.headerIconSize,s)}S||(e.globalAlpha=1)}}function wi(e,t,n,o,i,r,l,s,a,d,f,g,m,h,c,u){const b=no(r.title)==="rtl",v=pi(e,r,t,n,o,i,s,b);c!==void 0?c({ctx:e,theme:s,rect:{x:t,y:n,width:o,height:i},column:r,columnIndex:r.sourceIndex,isSelected:l,hoverAmount:m,isHovered:a,hasSelectedCell:g,spriteManager:h,menuBounds:(v==null?void 0:v.menuBounds)??{x:0,y:0,height:0,width:0}},()=>Wo(e,t,n,o,i,r,l,s,a,d,f,m,h,u,b,v)):Wo(e,t,n,o,i,r,l,s,a,d,f,m,h,u,b,v)}function Or(e,t,n,o,i,r,l,s,a,d,f,g,m,h,c,u,b,v,p){if(v!==void 0||t[t.length-1]!==n[t.length-1])return;const S=hi(b);St(t,a,l,s,r,(B,A,I,D,W)=>{if(B!==t[t.length-1])return;A+=B.width;const k=Math.max(A,D);k>o||(e.save(),e.beginPath(),e.rect(k,r+1,1e4,i-r-1),e.clip(),Sn(W,I,i,d,f,c,u,S,(P,M,x,C)=>{if(!C&&b.length>0&&!b.some(se=>sn(A,P,1e4,x,se.x,se.y,se.width,se.height)))return;const w=m.hasIndex(M),$=h.hasIndex(M);e.beginPath();const U=g==null?void 0:g(M),q=U===void 0?p:Vt(p,U);q.bgCell!==p.bgCell&&(e.fillStyle=q.bgCell,e.fillRect(A,P,1e4,x)),$&&(e.fillStyle=q.bgHeader,e.fillRect(A,P,1e4,x)),w&&(e.fillStyle=q.accentLight,e.fillRect(A,P,1e4,x))}),e.restore())})}function Nr(e,t,n,o,i,r,l,s,a){let d=!1;for(const c of t)if(!c.sticky){d=l(c.sourceIndex);break}const f=a.horizontalBorderColor??a.borderColor,g=a.borderColor,m=d?_t(t):0;let h;if(m!==0&&(h=Ro(g,a.bgCell),e.beginPath(),e.moveTo(m+.5,0),e.lineTo(m+.5,o),e.strokeStyle=h,e.stroke()),i>0){const c=g===f&&h!==void 0?h:Ro(f,a.bgCell),u=Ut(r,i,s);e.beginPath(),e.moveTo(0,o-u+.5),e.lineTo(n,o-u+.5),e.strokeStyle=c,e.stroke()}}const ki=(e,t,n)=>{let o=0,i=t,r=0,l=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;for(const s of e)o=Math.min(o,s.x-1),i=Math.max(i,s.x+s.width+1),r=Math.min(r,s.y-1),l=Math.max(l,s.y+s.height+1)}return{minX:o,maxX:i,minY:r,maxY:l}};function Xr(e,t,n,o,i,r,l,s,a,d,f,g,m,h,c){var x;const u=c.bgCell,{minX:b,maxX:v,minY:p,maxY:S}=ki(s,r,l),B=[],A=l-Ut(h,m,d);let I=a,D=n,W=0;for(;I+i<A;){const C=I+i,w=d(D);if(C>=p&&C<=S-1){const $=f==null?void 0:f(D),U=$==null?void 0:$.bgCell;U!==void 0&&U!==u&&D>=h-m&&B.push({x:b,y:C,w:v-b,h:w,color:U})}I+=w,D<h-m&&(W=I),D++}let k=0;const P=Math.min(A,S)-W;if(P>0)for(let C=0;C<t.length;C++){const w=t[C];if(w.width===0)continue;const $=w.sticky?k:k+o,U=(x=w.themeOverride)==null?void 0:x.bgCell;U!==void 0&&U!==u&&$>=b&&$<=v&&g(C+1)&&B.push({x:$,y:W,w:w.width,h:P,color:U}),k+=w.width}if(B.length===0)return;let M;e.beginPath();for(let C=B.length-1;C>=0;C--){const w=B[C];M===void 0?M=w.color:w.color!==M&&(e.fillStyle=M,e.fill(),e.beginPath(),M=w.color),e.rect(w.x,w.y,w.w,w.h)}M!==void 0&&(e.fillStyle=M,e.fill()),e.beginPath()}function zo(e,t,n,o,i,r,l,s,a,d,f,g,m,h,c,u,b,v=!1){if(a!==void 0){e.beginPath(),e.save(),e.rect(0,0,r,l);for(const x of a)e.rect(x.x+1,x.y+1,x.width-1,x.height-1);e.clip("evenodd")}const p=b.horizontalBorderColor??b.borderColor,S=b.borderColor,{minX:B,maxX:A,minY:I,maxY:D}=ki(s,r,l),W=[];e.beginPath();let k=.5;for(let x=0;x<t.length;x++){const C=t[x];if(C.width===0)continue;k+=C.width;const w=C.sticky?k:k+o;w>=B&&w<=A&&h(x+1)&&W.push({x1:w,y1:Math.max(d,I),x2:w,y2:Math.min(l,D),color:S})}let P=l+.5;for(let x=u-c;x<u;x++){const C=g(x);P-=C,W.push({x1:B,y1:P,x2:A,y2:P,color:p})}if(v!==!0){let x=f+.5,C=n;const w=P;for(;x+i<w;){const $=x+i;if($>=I&&$<=D-1){const U=m==null?void 0:m(C);W.push({x1:B,y1:$,x2:A,y2:$,color:(U==null?void 0:U.horizontalBorderColor)??(U==null?void 0:U.borderColor)??p})}x+=g(C),C++}}const M=Qi(W,x=>x.color);for(const x of Object.keys(M)){e.strokeStyle=x;for(const C of M[x])e.moveTo(C.x1,C.y1),e.lineTo(C.x2,C.y2);e.stroke(),e.beginPath()}a!==void 0&&e.restore()}function $r(e,t,n,o,i,r,l,s,a,d,f,g,m,h,c,u,b,v,p){const S=[];e.imageSmoothingEnabled=!1;const B=Math.min(i.cellYOffset,l),A=Math.max(i.cellYOffset,l);let I=0;if(typeof v=="number")I+=(A-B)*v;else for(let w=B;w<A;w++)I+=v(w);l>i.cellYOffset&&(I=-I),I+=a-i.translateY;const D=Math.min(i.cellXOffset,r),W=Math.max(i.cellXOffset,r);let k=0;for(let w=D;w<W;w++)k+=u[w].width;r>i.cellXOffset&&(k=-k),k+=s-i.translateX;const P=_t(b);if(k!==0&&I!==0)return{regions:[]};const M=d>0?Ut(m,d,v):0,x=f-P-Math.abs(k),C=g-h-M-Math.abs(I)-1;if(x>150&&C>150){const w={sx:0,sy:0,sw:f*c,sh:g*c,dx:0,dy:0,dw:f*c,dh:g*c};if(I>0?(w.sy=(h+1)*c,w.sh=C*c,w.dy=(I+h+1)*c,w.dh=C*c,S.push({x:0,y:h,width:f,height:I+1})):I<0&&(w.sy=(-I+h+1)*c,w.sh=C*c,w.dy=(h+1)*c,w.dh=C*c,S.push({x:0,y:g+I-M,width:f,height:-I+M})),k>0?(w.sx=P*c,w.sw=x*c,w.dx=(k+P)*c,w.dw=x*c,S.push({x:P-1,y:0,width:k+2,height:g})):k<0&&(w.sx=(P-k)*c,w.sw=x*c,w.dx=P*c,w.dw=x*c,S.push({x:f+k,y:0,width:-k,height:g})),e.setTransform(1,0,0,1,0,0),p){if(P>0&&k!==0&&I===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const $=P*c,U=g*c;e.drawImage(t,0,0,$,U,0,0,$,U)}if(M>0&&k===0&&I!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const $=(g-M)*c,U=f*c,q=M*c;e.drawImage(t,0,$,U,q,0,$,U,q)}}e.drawImage(t,w.sx,w.sy,w.sw,w.sh,w.dx,w.dy,w.dw,w.dh),e.scale(c,c)}return e.imageSmoothingEnabled=!0,{regions:S}}function Yr(e,t,n,o,i,r,l,s,a,d){const f=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||i!==e.translateY||St(a,n,o,i,s,(g,m,h,c)=>{if(g.sourceIndex===d){const u=Math.max(m,c)+1;return f.push({x:u,y:0,width:r-u,height:l}),!0}}),f}function _r(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const i=e.mappedColumns[o],r=t.mappedColumns[o];if(Yt(i,r))continue;if(n!==void 0||i.width===r.width)return!1;const{width:l,...s}=i,{width:a,...d}=r;if(!Yt(s,d))return!1;n=o}return n===void 0?!0:n}return!0}function Lo(e,t,n,o,i,r,l,s,a,d,f,g,m,h,c,u){const b=c==null?void 0:c.filter(D=>D.style!=="no-outline");if(b===void 0||b.length===0)return;const v=_t(s),p=Ut(h,m,g),S=[a,0,s.length,h-m],B=[v,0,t,n-p],A=b.map(D=>{const W=D.range,k=D.style??"dashed";return Pr(W,S,t,n,B).map(P=>{const M=P.rect,x=jn(M.x,M.y,t,n,f,d+f,o,i,r,l,h,a,m,s,g),C=M.width===1&&M.height===1?x:jn(M.x+M.width-1,M.y+M.height-1,t,n,f,d+f,o,i,r,l,h,a,m,s,g);return M.x+M.width>=s.length&&(C.width-=1),M.y+M.height>=h&&(C.height-=1),{color:D.color,style:k,clip:P.clip,rect:Hr({x:x.x,y:x.y,width:C.x+C.width-x.x,height:C.y+C.height-x.y},t,n,8)}})}),I=()=>{e.lineWidth=1;let D=!1;for(const W of A)for(const k of W)if((k==null?void 0:k.rect)!==void 0&&sn(0,0,t,n,k.rect.x,k.rect.y,k.rect.width,k.rect.height)){const P=D,M=!Dr(k.clip,k.rect);M&&(e.save(),e.rect(k.clip.x,k.clip.y,k.clip.width,k.clip.height),e.clip()),k.style==="dashed"&&!D?(e.setLineDash([5,3]),D=!0):(k.style==="solid"||k.style==="solid-outline")&&D&&(e.setLineDash([]),D=!1),e.strokeStyle=k.style==="solid-outline"?Ue(Ue(k.color,u.borderColor),u.bgCell):an(k.color,1),e.strokeRect(k.rect.x+.5,k.rect.y+.5,k.rect.width-1,k.rect.height-1),M&&(e.restore(),D=P)}D&&e.setLineDash([])};return I(),I}function Oo(e,t,n,o,i){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=i,e.stroke(),e.globalAlpha=1}function On(e,t,n,o,i,r,l,s,a,d,f,g,m,h,c,u,b){if(f.current===void 0)return;const v=f.current.range,p=f.current.cell,S=[v.x+v.width-1,v.y+v.height-1];if(p[1]>=b&&S[1]>=b||!l.some(w=>w.sourceIndex===p[0]||w.sourceIndex===S[0]))return;const[A,I]=f.current.cell,D=m(f.current.cell),W=D.span??[A,A],k=I>=b-h,P=h>0&&!k?Ut(b,h,g)-1:0,M=S[1];let x;if(St(l,o,i,r,d,(w,$,U,q,se)=>{if(w.sticky&&A>w.sourceIndex)return;const le=w.sourceIndex<W[0],he=w.sourceIndex>W[1],ge=w.sourceIndex===S[0];if(!(!ge&&(le||he)))return Sn(se,U,n,b,g,h,c,void 0,(Oe,K,De)=>{if(K!==I&&K!==M)return;let Se=$,N=w.width;if(D.span!==void 0){const J=mi(D.span,$,Oe,w.width,De,w,s),Ie=w.sticky?J[0]:J[1];Ie!==void 0&&(Se=Ie.x,N=Ie.width)}return K===M&&ge&&u&&(x=()=>{var J;q>Se&&!w.sticky&&(e.beginPath(),e.rect(q,0,t-q,n),e.clip()),e.beginPath(),e.rect(Se+N-4,Oe+De-4,4,4),e.fillStyle=((J=w.themeOverride)==null?void 0:J.accentColor)??a.accentColor,e.fill()}),x!==void 0}),x!==void 0}),x===void 0)return;const C=()=>{e.save(),e.beginPath(),e.rect(0,d,t,n-d-P),e.clip(),x==null||x(),e.restore()};return C(),C}function Vr(e,t,n,o,i,r,l,s,a){a===void 0||a.size===0||(e.beginPath(),gi(t,n,r,o,(d,f,g,m,h,c)=>{a.hasItemInRectangle({x:d[0],y:-2,width:d[1]-d[0]+1,height:1})&&e.rect(g,m,h,c)}),St(t,s,r,l,i,(d,f,g,m)=>{const h=Math.max(0,m-f),c=f+h+1,u=d.width-h-1;a.has([d.sourceIndex,-1])&&e.rect(c,o,u,i-o)}),e.clip())}function Ur(e,t,n,o,i,r,l,s,a,d){let f=0;return St(e,r,o,i,n,(g,m,h,c,u)=>(Sn(u,h,t,l,s,a,d,void 0,(b,v,p,S)=>{S||(f=Math.max(v,f))}),!0)),f}function No(e,t){var ut;const{canvasCtx:n,headerCanvasCtx:o,width:i,height:r,cellXOffset:l,cellYOffset:s,translateX:a,translateY:d,mappedColumns:f,enableGroups:g,freezeColumns:m,dragAndDropState:h,theme:c,drawFocus:u,headerHeight:b,groupHeaderHeight:v,disabledRows:p,rowHeight:S,verticalBorder:B,overrideCursor:A,isResizing:I,selection:D,fillHandle:W,freezeTrailingRows:k,rows:P,getCellContent:M,getGroupDetails:x,getRowThemeOverride:C,isFocused:w,drawHeaderCallback:$,prelightCells:U,drawCellCallback:q,highlightRegions:se,resizeCol:le,imageLoader:he,lastBlitData:ge,hoverValues:Oe,hyperWrapping:K,hoverInfo:De,spriteManager:Se,maxScaleFactor:N,hasAppendRow:we,touchMode:J,enqueue:Ie,renderStateProvider:je,getCellRenderer:dt,renderStrategy:It,bufferACtx:ct,bufferBCtx:Ke,damage:ye,minimumCellWidth:bt,resizeIndicator:vt}=e;if(i===0||r===0)return;const Xe=It==="double-buffer",ce=Math.min(N,Math.ceil(window.devicePixelRatio??1)),$e=It!=="direct"&&_r(e,t),Me=n.canvas;(Me.width!==i*ce||Me.height!==r*ce)&&(Me.width=i*ce,Me.height=r*ce,Me.style.width=i+"px",Me.style.height=r+"px");const We=o.canvas,Q=g?v+b:b,xe=Q+1;(We.width!==i*ce||We.height!==xe*ce)&&(We.width=i*ce,We.height=xe*ce,We.style.width=i+"px",We.style.height=xe+"px");const ae=ct.canvas,be=Ke.canvas;Xe&&(ae.width!==i*ce||ae.height!==r*ce)&&(ae.width=i*ce,ae.height=r*ce,ge.current!==void 0&&(ge.current.aBufferScroll=void 0)),Xe&&(be.width!==i*ce||be.height!==r*ce)&&(be.width=i*ce,be.height=r*ce,ge.current!==void 0&&(ge.current.bBufferScroll=void 0));const L=ge.current;if($e===!0&&l===(L==null?void 0:L.cellXOffset)&&s===(L==null?void 0:L.cellYOffset)&&a===(L==null?void 0:L.translateX)&&d===(L==null?void 0:L.translateY))return;let j=null;Xe&&(j=n);const ue=o;let te;Xe?ye!==void 0?te=(L==null?void 0:L.lastBuffer)==="b"?Ke:ct:te=(L==null?void 0:L.lastBuffer)==="b"?ct:Ke:te=n;const ie=te.canvas,Ce=Xe?ie===ae?be:ae:Me,fe=typeof S=="number"?()=>S:S;ue.save(),te.save(),ue.beginPath(),te.beginPath(),ue.textBaseline="middle",te.textBaseline="middle",ce!==1&&(ue.scale(ce,ce),te.scale(ce,ce));const G=qn(f,l,i,h,a);let Te=[];const Ye=u&&((ut=D.current)==null?void 0:ut.cell[1])===s&&d===0;let _e=!1;if(se!==void 0){for(const pe of se)if(pe.style!=="no-outline"&&pe.range.y===s&&d===0){_e=!0;break}}const Ee=()=>{Wr(ue,G,g,De,i,a,b,v,h,I,D,c,Se,Oe,B,x,ye,$,J),zo(ue,G,s,a,d,i,r,void 0,void 0,v,Q,fe,C,B,k,P,c,!0),ue.beginPath(),ue.moveTo(0,xe-.5),ue.lineTo(i,xe-.5),ue.strokeStyle=Ue(c.headerBottomBorderColor??c.horizontalBorderColor??c.borderColor,c.bgHeader),ue.stroke(),_e&&Lo(ue,i,r,l,s,a,d,f,m,b,v,S,k,P,se,c),Ye&&On(ue,i,r,s,a,d,G,f,c,Q,D,fe,M,k,we,W,P)};if(ye!==void 0){const pe=G[G.length-1].sourceIndex+1,Ne=ye.hasItemInRegion([{x:l,y:-2,width:pe,height:2},{x:l,y:s,width:pe,height:300},{x:0,y:s,width:m,height:300},{x:0,y:-2,width:m,height:2},{x:l,y:P-k,width:pe,height:k,when:k>0}]),Et=it=>{To(it,G,f,r,Q,a,d,s,P,fe,M,x,C,p,w,u,k,we,Te,ye,D,U,se,he,Se,Oe,De,q,K,c,Ie,je,dt,A,bt);const rt=D.current;W&&u&&rt!==void 0&&ye.has(ii(rt.range))&&On(it,i,r,s,a,d,G,f,c,Q,D,fe,M,k,we,W,P)};Ne&&(Et(te),j!==null&&(j.save(),j.scale(ce,ce),j.textBaseline="middle",Et(j),j.restore()),ye.hasHeader()&&(Vr(ue,G,i,v,Q,a,d,s,ye),Ee())),te.restore(),ue.restore();return}if(($e!==!0||l!==(L==null?void 0:L.cellXOffset)||a!==(L==null?void 0:L.translateX)||Ye!==(L==null?void 0:L.mustDrawFocusOnHeader)||_e!==(L==null?void 0:L.mustDrawHighlightRingsOnHeader))&&Ee(),$e===!0){gt(Ce!==void 0&&L!==void 0);const{regions:pe}=$r(te,Ce,Ce===ae?L.aBufferScroll:L.bBufferScroll,Ce===ae?L.bBufferScroll:L.aBufferScroll,L,l,s,a,d,k,i,r,P,Q,ce,f,G,S,Xe);Te=pe}else $e!==!1&&(gt(L!==void 0),Te=Yr(L,l,s,a,d,i,r,Q,G,$e));Nr(te,G,i,r,k,P,B,fe,c);const Ge=Lo(te,i,r,l,s,a,d,f,m,b,v,S,k,P,se,c),ze=u?On(te,i,r,s,a,d,G,f,c,Q,D,fe,M,k,we,W,P):void 0;if(te.fillStyle=c.bgCell,Te.length>0){te.beginPath();for(const pe of Te)te.rect(pe.x,pe.y,pe.width,pe.height);te.clip(),te.fill(),te.beginPath()}else te.fillRect(0,0,i,r);const Pt=To(te,G,f,r,Q,a,d,s,P,fe,M,x,C,p,w,u,k,we,Te,ye,D,U,se,he,Se,Oe,De,q,K,c,Ie,je,dt,A,bt);Or(te,G,f,i,r,Q,a,d,s,P,fe,C,D.rows,p,k,we,Te,ye,c),Xr(te,G,s,a,d,i,r,Te,Q,fe,C,B,k,P,c),zo(te,G,s,a,d,i,r,Te,Pt,v,Q,fe,C,B,k,P,c),Ge==null||Ge(),ze==null||ze(),I&&vt!=="none"&&St(G,0,a,0,Q,(pe,Ne)=>pe.sourceIndex===le?(Oo(ue,Ne+pe.width,0,Q+1,Ue(c.resizeIndicatorColor??c.accentLight,c.bgHeader)),vt==="full"&&Oo(te,Ne+pe.width,Q,r,Ue(c.resizeIndicatorColor??c.accentLight,c.bgCell)),!0):!1),j!==null&&(j.fillStyle=c.bgCell,j.fillRect(0,0,i,r),j.drawImage(te.canvas,0,0));const Rt=Ur(G,r,Q,a,d,s,P,fe,k,we);he==null||he.setWindow({x:l,y:s,width:G.length,height:Rt-s},m,Array.from({length:k},(pe,Ne)=>P-1-Ne));const ve=L!==void 0&&(l!==L.cellXOffset||a!==L.translateX),Mt=L!==void 0&&(s!==L.cellYOffset||d!==L.translateY);ge.current={cellXOffset:l,cellYOffset:s,translateX:a,translateY:d,mustDrawFocusOnHeader:Ye,mustDrawHighlightRingsOnHeader:_e,lastBuffer:Xe?ie===ae?"a":"b":void 0,aBufferScroll:ie===ae?[ve,Mt]:L==null?void 0:L.aBufferScroll,bBufferScroll:ie===be?[ve,Mt]:L==null?void 0:L.bBufferScroll},te.restore(),ue.restore()}const qr=80;function jr(e){const t=e-1;return t*t*t+1}class Kr{constructor(t){oe(this,"currentHoveredItem");oe(this,"leavingItems",[]);oe(this,"lastAnimationTime");oe(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>wn(o.item,t.item))||this.leavingItems.push(t)});oe(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>wn(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});oe(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});oe(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});oe(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:jr(t.hoverAmount)})));oe(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/qr;for(const r of this.leavingItems)r.hoverAmount=xn(r.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=xn(this.currentHoveredItem.hoverAmount+o,0,1));const i=this.getAnimatingItems();this.callback(i),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});oe(this,"setHovered",t=>{var n;if(!wn((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Gr{constructor(t){oe(this,"fn");oe(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function ao(e){return new Gr(e)}const Jr=ao(()=>window.navigator.userAgent.includes("Firefox")),Xo=ao(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),kl=ao(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Qr(e){const t=E.useRef([]),n=E.useRef(0),o=E.useRef(e);o.current=e;const i=E.useCallback(()=>{const r=()=>window.requestAnimationFrame(l),l=()=>{const s=t.current.map(so);t.current=[],o.current(new nn(s)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?r:l)},[]);return E.useCallback(r=>{t.current.length===0&&i();const l=ot(r[0],r[1]);t.current.includes(l)||t.current.push(l)},[i])}const Ht="header",Xt="group-header",$o="out-of-bounds";var en=(e=>(e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End",e))(en||{});function Zr(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const Yo=6,es=(e,t)=>{if(e.kind===de.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},ts=(e,t)=>{const{width:n,height:o,accessibilityHeight:i,columns:r,cellXOffset:l,cellYOffset:s,headerHeight:a,fillHandle:d=!1,groupHeaderHeight:f,rowHeight:g,rows:m,getCellContent:h,getRowThemeOverride:c,onHeaderMenuClick:u,onHeaderIndicatorClick:b,enableGroups:v,isFilling:p,onCanvasFocused:S,onCanvasBlur:B,isFocused:A,selection:I,freezeColumns:D,onContextMenu:W,freezeTrailingRows:k,fixedShadowX:P=!0,fixedShadowY:M=!0,drawFocusRing:x,onMouseDown:C,onMouseUp:w,onMouseMoveRaw:$,onMouseMove:U,onItemHovered:q,dragAndDropState:se,firstColAccessible:le,onKeyDown:he,onKeyUp:ge,highlightRegions:Oe,canvasRef:K,onDragStart:De,onDragEnd:Se,eventTargetRef:N,isResizing:we,resizeColumn:J,isDragging:Ie,isDraggable:je=!1,allowResize:dt,disabledRows:It,hasAppendRow:ct,getGroupDetails:Ke,theme:ye,prelightCells:bt,headerIcons:vt,verticalBorder:Xe,drawCell:ce,drawHeader:$e,onCellFocused:Me,onDragOverCell:We,onDrop:Q,onDragLeave:xe,imageWindowLoader:ae,smoothScrollX:be=!1,smoothScrollY:L=!1,experimental:j,getCellRenderer:ue,resizeIndicator:te="full"}=e,ie=e.translateX??0,Ce=e.translateY??0,fe=Math.max(D,Math.min(r.length-1,l)),G=E.useRef(null),Te=E.useRef(window),Ye=Te.current,_e=ae,Ee=E.useRef(),[Ge,ze]=E.useState(!1),Pt=E.useRef([]),Rt=E.useRef(),[ve,Mt]=E.useState(),[ut,pe]=E.useState(),Ne=E.useRef(null),[Et,it]=E.useState(),[rt,ne]=E.useState(!1),Fe=E.useRef(rt);Fe.current=rt;const ke=E.useMemo(()=>new Fr(vt,()=>{cn.current=void 0,qt.current()}),[vt]),st=v?f+a:a,Ve=E.useRef(-1),pt=((j==null?void 0:j.enableFirefoxRescaling)??!1)&&Jr.value,Mn=((j==null?void 0:j.enableSafariRescaling)??!1)&&Xo.value;E.useLayoutEffect(()=>{window.devicePixelRatio===1||!pt&&!Mn||(Ve.current!==-1&&ze(!0),window.clearTimeout(Ve.current),Ve.current=window.setTimeout(()=>{ze(!1),Ve.current=-1},200))},[s,fe,ie,Ce,pt,Mn]);const Be=hr(r,D),En=P?_t(Be,se):0,He=E.useCallback((y,F,z)=>{const T=y.getBoundingClientRect();if(F>=Be.length||z>=m)return;const H=T.width/n,R=jn(F,z,n,o,f,st,fe,s,ie,Ce,m,D,k,Be,g);return H!==1&&(R.x*=H,R.y*=H,R.width*=H,R.height*=H),R.x+=T.x,R.y+=T.y,R},[n,o,f,st,fe,s,ie,Ce,m,D,k,Be,g]),Le=E.useCallback((y,F,z,T)=>{const H=y.getBoundingClientRect(),R=H.width/n,_=(F-H.left)/R,V=(z-H.top)/R,O=5,Pe=qn(Be,fe,n,void 0,ie);let X=0,re=0;T instanceof MouseEvent&&(X=T.button,re=T.buttons);const Z=br(_,Pe,ie),ee=vr(V,o,v,a,f,m,g,s,Ce,k),Re=(T==null?void 0:T.shiftKey)===!0,Ze=(T==null?void 0:T.ctrlKey)===!0,Ae=(T==null?void 0:T.metaKey)===!0,ft=T!==void 0&&!(T instanceof MouseEvent)||(T==null?void 0:T.pointerType)==="touch",wt=[_<0?-1:n<_?1:0,V<st?-1:o<V?1:0];let et;if(Z===-1||V<0||_<0||ee===void 0||_>n||V>o){const me=_>n?1:_<0?-1:0,tt=V>o?1:V<0?-1:0;let lt=me*2,Kt=tt*2;me===0&&(lt=Z===-1?en.EndPadding:en.Center),tt===0&&(Kt=ee===void 0?en.EndPadding:en.Center);let kt=!1;if(Z===-1&&ee===-1){const Gt=He(y,Be.length-1,-1);gt(Gt!==void 0),kt=F<Gt.x+Gt.width+O}const Tn=_>n&&_<n+Bo()||V>o&&V<o+Bo();et={kind:$o,location:[Z!==-1?Z:_<0?0:Be.length-1,ee??m-1],region:[lt,Kt],shiftKey:Re,ctrlKey:Ze,metaKey:Ae,isEdge:kt,isTouch:ft,button:X,buttons:re,scrollEdge:wt,isMaybeScrollbar:Tn}}else if(ee<=-1){let me=He(y,Z,ee);gt(me!==void 0);let tt=me!==void 0&&me.x+me.width-F<=O;const lt=Z-1;F-me.x<=O&&lt>=0?(tt=!0,me=He(y,lt,ee),gt(me!==void 0),et={kind:v&&ee===-2?Xt:Ht,location:[lt,ee],bounds:me,group:Be[lt].group??"",isEdge:tt,shiftKey:Re,ctrlKey:Ze,metaKey:Ae,isTouch:ft,localEventX:F-me.x,localEventY:z-me.y,button:X,buttons:re,scrollEdge:wt}):et={kind:v&&ee===-2?Xt:Ht,group:Be[Z].group??"",location:[Z,ee],bounds:me,isEdge:tt,shiftKey:Re,ctrlKey:Ze,metaKey:Ae,isTouch:ft,localEventX:F-me.x,localEventY:z-me.y,button:X,buttons:re,scrollEdge:wt}}else{const me=He(y,Z,ee);gt(me!==void 0);const tt=me!==void 0&&me.x+me.width-F<O;let lt=!1;if(d&&I.current!==void 0){const Kt=ii(I.current.range),kt=He(y,Kt[0],Kt[1]);if(kt!==void 0){const Tn=kt.x+kt.width-2,Gt=kt.y+kt.height-2;lt=Math.abs(Tn-F)<Yo&&Math.abs(Gt-z)<Yo}}et={kind:"cell",location:[Z,ee],bounds:me,isEdge:tt,shiftKey:Re,ctrlKey:Ze,isFillHandle:lt,metaKey:Ae,isTouch:ft,localEventX:F-me.x,localEventY:z-me.y,button:X,buttons:re,scrollEdge:wt}}return et},[n,Be,fe,ie,o,v,a,f,m,g,s,Ce,k,He,d,I,st]),[Ft]=ve??[],co=E.useRef(()=>{}),Tt=E.useRef(ve);Tt.current=ve;const[Bt,At]=E.useMemo(()=>{const y=document.createElement("canvas"),F=document.createElement("canvas");return y.style.display="none",y.style.opacity="0",y.style.position="fixed",F.style.display="none",F.style.opacity="0",F.style.position="fixed",[y.getContext("2d",{alpha:!1}),F.getContext("2d",{alpha:!1})]},[]);E.useLayoutEffect(()=>{if(!(Bt===null||At===null))return document.documentElement.append(Bt.canvas),document.documentElement.append(At.canvas),()=>{Bt.canvas.remove(),At.canvas.remove()}},[Bt,At]);const dn=E.useMemo(()=>new Mr,[]),uo=pt&&Ge?1:Mn&&Ge?2:5,fo=(j==null?void 0:j.disableMinimumCellWidth)===!0?1:10,cn=E.useRef(),un=E.useRef(null),fn=E.useRef(null),hn=E.useCallback(()=>{var _;const y=G.current,F=Ne.current;if(y===null||F===null||(un.current===null&&(un.current=y.getContext("2d",{alpha:!1}),y.width=0,y.height=0),fn.current===null&&(fn.current=F.getContext("2d",{alpha:!1}),F.width=0,F.height=0),un.current===null||fn.current===null||Bt===null||At===null))return;let z=!1;const T=V=>{z=!0,it(V)},H=cn.current,R={headerCanvasCtx:fn.current,canvasCtx:un.current,bufferACtx:Bt,bufferBCtx:At,width:n,height:o,cellXOffset:fe,cellYOffset:s,translateX:Math.round(ie),translateY:Math.round(Ce),mappedColumns:Be,enableGroups:v,freezeColumns:D,dragAndDropState:se,theme:ye,headerHeight:a,groupHeaderHeight:f,disabledRows:It??Vn.empty(),rowHeight:g,verticalBorder:Xe,isResizing:we,resizeCol:J,isFocused:A,selection:I,fillHandle:d,drawCellCallback:ce,hasAppendRow:ct,overrideCursor:T,maxScaleFactor:uo,freezeTrailingRows:k,rows:m,drawFocus:x,getCellContent:h,getGroupDetails:Ke??(V=>({name:V})),getRowThemeOverride:c,drawHeaderCallback:$e,prelightCells:bt,highlightRegions:Oe,imageLoader:_e,lastBlitData:Rt,damage:Ee.current,hoverValues:Pt.current,hoverInfo:Tt.current,spriteManager:ke,scrolling:Ge,hyperWrapping:(j==null?void 0:j.hyperWrapping)??!1,touchMode:rt,enqueue:co.current,renderStateProvider:dn,renderStrategy:(j==null?void 0:j.renderStrategy)??(Xo.value?"double-buffer":"single-buffer"),getCellRenderer:ue,minimumCellWidth:fo,resizeIndicator:te};R.damage===void 0?(cn.current=R,No(R,H)):No(R,void 0),!z&&(R.damage===void 0||R.damage.has((_=Tt==null?void 0:Tt.current)==null?void 0:_[0]))&&it(void 0)},[Bt,At,n,o,fe,s,ie,Ce,Be,v,D,se,ye,a,f,It,g,Xe,we,ct,J,A,I,d,k,m,x,uo,h,Ke,c,ce,$e,bt,Oe,_e,ke,Ge,j==null?void 0:j.hyperWrapping,j==null?void 0:j.renderStrategy,rt,dn,ue,fo,te]),qt=E.useRef(hn);E.useLayoutEffect(()=>{hn(),qt.current=hn},[hn]),E.useLayoutEffect(()=>{(async()=>{var F;((F=document==null?void 0:document.fonts)==null?void 0:F.ready)!==void 0&&(await document.fonts.ready,cn.current=void 0,qt.current())})()},[]);const Wt=E.useCallback(y=>{Ee.current=y,qt.current(),Ee.current=void 0},[]),Ii=Qr(Wt);co.current=Ii;const ho=E.useCallback(y=>{Wt(new nn(y.map(F=>F.cell)))},[Wt]);_e.setCallback(Wt);const[Mi,Ei]=E.useState(!1),[gn,zt]=Ft??[],Fi=gn!==void 0&&zt===-1,Bi=gn!==void 0&&zt===-2;let go=!1,mo=!1,mn=Et;if(mn===void 0&&gn!==void 0&&zt!==void 0&&zt>-1&&zt<m){const y=h([gn,zt],!0);go=y.kind===rn.NewRow||y.kind===rn.Marker&&y.markerKind!=="number",mo=y.kind===de.Boolean&&eo(y),mn=y.cursor}const yo=Ie?"grabbing":(ut??!1)||we?"col-resize":Mi||p?"crosshair":mn!==void 0?mn:Fi||go||mo||Bi?"pointer":"default",Fn=E.useMemo(()=>({contain:"strict",display:"block",cursor:yo}),[yo]),bo=E.useRef("default"),Bn=N==null?void 0:N.current;Bn!=null&&bo.current!==Fn.cursor&&(Bn.style.cursor=bo.current=Fn.cursor);const Lt=E.useCallback((y,F,z,T)=>{if(Ke===void 0)return;const H=Ke(y);if(H.actions!==void 0){const R=vi(F,H.actions);for(const[_,V]of R.entries())if($t(V,z+F.x,T+V.y))return H.actions[_]}},[Ke]),Ot=E.useCallback((y,F,z,T)=>{const H=Be[F];if(!Ie&&!we&&!(ut??!1)){const R=He(y,F,-1);gt(R!==void 0);const _=pi(void 0,H,R.x,R.y,R.width,R.height,ye,no(H.title)==="rtl");if(H.hasMenu===!0&&_.menuBounds!==void 0&&$t(_.menuBounds,z,T))return{area:"menu",bounds:_.menuBounds};if(H.indicatorIcon!==void 0&&_.indicatorIconBounds!==void 0&&$t(_.indicatorIconBounds,z,T))return{area:"indicator",bounds:_.indicatorIconBounds}}},[Be,He,ut,Ie,we,ye]),An=E.useRef(0),jt=E.useRef(),Dn=E.useRef(!1),vo=E.useCallback(y=>{const F=G.current,z=N==null?void 0:N.current;if(F===null||y.target!==F&&y.target!==z)return;Dn.current=!0;let T,H;if(y instanceof MouseEvent?(T=y.clientX,H=y.clientY):(T=y.touches[0].clientX,H=y.touches[0].clientY),y.target===z&&z!==null){const _=z.getBoundingClientRect();if(T>_.right||H>_.bottom)return}const R=Le(F,T,H,y);jt.current=R.location,R.isTouch&&(An.current=Date.now()),Fe.current!==R.isTouch&&ne(R.isTouch),!(R.kind===Ht&&Ot(F,R.location[0],T,H)!==void 0)&&(R.kind===Xt&&Lt(R.group,R.bounds,R.localEventX,R.localEventY)!==void 0||(C==null||C(R),!R.isTouch&&je!==!0&&je!==R.kind&&R.button<3&&R.button!==1&&y.preventDefault()))},[N,je,Le,Lt,Ot,C]);Je("touchstart",vo,Ye,!1),Je("mousedown",vo,Ye,!1);const po=E.useRef(0),wo=E.useCallback(y=>{var re,Z;const F=po.current;po.current=Date.now();const z=G.current;if(Dn.current=!1,w===void 0||z===null)return;const T=N==null?void 0:N.current,H=y.target!==z&&y.target!==T;let R,_,V=!0;if(y instanceof MouseEvent){if(R=y.clientX,_=y.clientY,V=y.button<3,y.pointerType==="touch")return}else R=y.changedTouches[0].clientX,_=y.changedTouches[0].clientY;let O=Le(z,R,_,y);O.isTouch&&An.current!==0&&Date.now()-An.current>500&&(O={...O,isLongTouch:!0}),F!==0&&Date.now()-F<(O.isTouch?1e3:500)&&(O={...O,isDoubleClick:!0}),Fe.current!==O.isTouch&&ne(O.isTouch),!H&&y.cancelable&&V&&y.preventDefault();const[Pe]=O.location,X=Ot(z,Pe,R,_);if(O.kind===Ht&&X!==void 0){(O.button!==0||((re=jt.current)==null?void 0:re[0])!==Pe||((Z=jt.current)==null?void 0:Z[1])!==-1)&&w(O,!0);return}else if(O.kind===Xt){const ee=Lt(O.group,O.bounds,O.localEventX,O.localEventY);if(ee!==void 0){O.button===0&&ee.onClick(O);return}}w(O,H)},[w,N,Le,Ot,Lt]);Je("mouseup",wo,Ye,!1),Je("touchend",wo,Ye,!1);const Ai=E.useCallback(y=>{var Pe,X;const F=G.current;if(F===null)return;const z=N==null?void 0:N.current,T=y.target!==F&&y.target!==z;let H,R,_=!0;y instanceof MouseEvent?(H=y.clientX,R=y.clientY,_=y.button<3):(H=y.changedTouches[0].clientX,R=y.changedTouches[0].clientY);const V=Le(F,H,R,y);Fe.current!==V.isTouch&&ne(V.isTouch),!T&&y.cancelable&&_&&y.preventDefault();const[O]=V.location;if(V.kind===Ht){const re=Ot(F,O,H,R);re!==void 0&&V.button===0&&((Pe=jt.current)==null?void 0:Pe[0])===O&&((X=jt.current)==null?void 0:X[1])===-1&&(re.area==="menu"?u==null||u(O,re.bounds):re.area==="indicator"&&(b==null||b(O,re.bounds)))}else if(V.kind===Xt){const re=Lt(V.group,V.bounds,V.localEventX,V.localEventY);re!==void 0&&V.button===0&&re.onClick(V)}},[N,Le,Ot,u,b,Lt]);Je("click",Ai,Ye,!1);const Di=E.useCallback(y=>{const F=G.current,z=N==null?void 0:N.current;if(F===null||y.target!==F&&y.target!==z||W===void 0)return;const T=Le(F,y.clientX,y.clientY,y);W(T,()=>{y.cancelable&&y.preventDefault()})},[N,Le,W]);Je("contextmenu",Di,(N==null?void 0:N.current)??null,!1);const ko=E.useCallback(y=>{Ee.current=new nn(y.map(F=>F.item)),Pt.current=y,qt.current(),Ee.current=void 0},[]),xo=E.useMemo(()=>new Kr(ko),[ko]),Co=E.useRef(xo);Co.current=xo,E.useLayoutEffect(()=>{const y=Co.current;if(Ft===void 0||Ft[1]<0){y.setHovered(Ft);return}const F=h(Ft,!0),z=ue(F),T=z===void 0&&F.kind===de.Custom||(z==null?void 0:z.needsHover)!==void 0&&(typeof z.needsHover=="boolean"?z.needsHover:z.needsHover(F));y.setHovered(T?Ft:void 0)},[h,ue,Ft]);const So=E.useRef(),Hi=E.useCallback(y=>{var V;const F=G.current;if(F===null)return;const z=N==null?void 0:N.current,T=y.target!==F&&y.target!==z,H=Le(F,y.clientX,y.clientY,y);if(H.kind!=="out-of-bounds"&&T&&!Dn.current&&!H.isTouch)return;const R=(O,Pe)=>{Mt(X=>X===O||(X==null?void 0:X[0][0])===(O==null?void 0:O[0][0])&&(X==null?void 0:X[0][1])===(O==null?void 0:O[0][1])&&((X==null?void 0:X[1][0])===(O==null?void 0:O[1][0])&&(X==null?void 0:X[1][1])===(O==null?void 0:O[1][1])||!Pe)?X:O)};if(!Zr(H,So.current))it(void 0),q==null||q(H),R(H.kind===$o?void 0:[H.location,[H.localEventX,H.localEventY]],!0),So.current=H;else if(H.kind==="cell"||H.kind===Ht||H.kind===Xt){let O=!1,Pe=!0;if(H.kind==="cell"){const re=h(H.location);Pe=((V=ue(re))==null?void 0:V.needsHoverPosition)??re.kind===de.Custom,O=Pe}else O=!0;const X=[H.location,[H.localEventX,H.localEventY]];R(X,Pe),Tt.current=X,O&&Wt(new nn([H.location]))}const _=H.location[0]>=(le?0:1);pe(H.kind===Ht&&H.isEdge&&_&&dt===!0),Ei(H.kind==="cell"&&H.isFillHandle),$==null||$(y),U(H)},[N,Le,le,dt,$,U,q,h,ue,Wt]);Je("mousemove",Hi,Ye,!0);const Pi=E.useCallback(y=>{const F=G.current;if(F===null)return;let z,T;I.current!==void 0&&(z=He(F,I.current.cell[0],I.current.cell[1]),T=I.current.cell),he==null||he({bounds:z,stopPropagation:()=>y.stopPropagation(),preventDefault:()=>y.preventDefault(),cancel:()=>{},ctrlKey:y.ctrlKey,metaKey:y.metaKey,shiftKey:y.shiftKey,altKey:y.altKey,key:y.key,keyCode:y.keyCode,rawEvent:y,location:T})},[he,I,He]),Ri=E.useCallback(y=>{const F=G.current;if(F===null)return;let z,T;I.current!==void 0&&(z=He(F,I.current.cell[0],I.current.cell[1]),T=I.current.cell),ge==null||ge({bounds:z,stopPropagation:()=>y.stopPropagation(),preventDefault:()=>y.preventDefault(),cancel:()=>{},ctrlKey:y.ctrlKey,metaKey:y.metaKey,shiftKey:y.shiftKey,altKey:y.altKey,key:y.key,keyCode:y.keyCode,rawEvent:y,location:T})},[ge,I,He]),Ti=E.useCallback(y=>{if(G.current=y,K!==void 0&&(K.current=y),y===null)Te.current=window;else{const F=y.getRootNode();F===document&&(Te.current=window),Te.current=F}},[K]),Wi=E.useCallback(y=>{const F=G.current;if(F===null||je===!1||we){y.preventDefault();return}let z,T;const H=Le(F,y.clientX,y.clientY);if(je!==!0&&H.kind!==je){y.preventDefault();return}const R=(re,Z)=>{z=re,T=Z};let _,V,O;const Pe=(re,Z,ee)=>{_=re,V=Z,O=ee};let X=!1;if(De==null||De({...H,setData:R,setDragImage:Pe,preventDefault:()=>X=!0,defaultPrevented:()=>X}),!X&&z!==void 0&&T!==void 0&&y.dataTransfer!==null)if(y.dataTransfer.setData(z,T),y.dataTransfer.effectAllowed="copyLink",_!==void 0&&V!==void 0&&O!==void 0)y.dataTransfer.setDragImage(_,V,O);else{const[re,Z]=H.location;if(Z!==void 0){const ee=document.createElement("canvas"),Re=He(F,re,Z);gt(Re!==void 0);const Ze=Math.ceil(window.devicePixelRatio??1);ee.width=Re.width*Ze,ee.height=Re.height*Ze;const Ae=ee.getContext("2d");Ae!==null&&(Ae.scale(Ze,Ze),Ae.textBaseline="middle",Z===-1?(Ae.font=ye.headerFontFull,Ae.fillStyle=ye.bgHeader,Ae.fillRect(0,0,ee.width,ee.height),wi(Ae,0,0,Re.width,Re.height,Be[re],!1,ye,!1,void 0,void 0,!1,0,ke,$e,!1)):(Ae.font=ye.baseFontFull,Ae.fillStyle=ye.bgCell,Ae.fillRect(0,0,ee.width,ee.height),bi(Ae,h([re,Z]),0,Z,!1,!1,0,0,Re.width,Re.height,!1,ye,ye.bgCell,_e,ke,1,void 0,!1,0,void 0,void 0,void 0,dn,ue,()=>{}))),ee.style.left="-100%",ee.style.position="absolute",ee.style.width=`${Re.width}px`,ee.style.height=`${Re.height}px`,document.body.append(ee),y.dataTransfer.setDragImage(ee,Re.width/2,Re.height/2),window.setTimeout(()=>{ee.remove()},0)}}else y.preventDefault()},[je,we,Le,De,He,ye,Be,ke,$e,h,_e,dn,ue]);Je("dragstart",Wi,(N==null?void 0:N.current)??null,!1,!1);const Hn=E.useRef(),zi=E.useCallback(y=>{const F=G.current;if(Q!==void 0&&y.preventDefault(),F===null||We===void 0)return;const z=Le(F,y.clientX,y.clientY),[T,H]=z.location,R=T-(le?0:1),[_,V]=Hn.current??[];(_!==R||V!==H)&&(Hn.current=[R,H],We([R,H],y.dataTransfer))},[le,Le,We,Q]);Je("dragover",zi,(N==null?void 0:N.current)??null,!1,!1);const Li=E.useCallback(()=>{Hn.current=void 0,Se==null||Se()},[Se]);Je("dragend",Li,(N==null?void 0:N.current)??null,!1,!1);const Oi=E.useCallback(y=>{const F=G.current;if(F===null||Q===void 0)return;y.preventDefault();const z=Le(F,y.clientX,y.clientY),[T,H]=z.location,R=T-(le?0:1);Q([R,H],y.dataTransfer)},[le,Le,Q]);Je("drop",Oi,(N==null?void 0:N.current)??null,!1,!1);const Ni=E.useCallback(()=>{xe==null||xe()},[xe]);Je("dragleave",Ni,(N==null?void 0:N.current)??null,!1,!1);const Io=E.useRef(I);Io.current=I;const yn=E.useRef(null),Pn=E.useCallback(y=>{var F;G.current===null||!G.current.contains(document.activeElement)||(y===null&&Io.current.current!==void 0?(F=K==null?void 0:K.current)==null||F.focus({preventScroll:!0}):y!==null&&y.focus({preventScroll:!0}),yn.current=y)},[K]);E.useImperativeHandle(t,()=>({focus:()=>{var F;const y=yn.current;y===null||!document.contains(y)?(F=K==null?void 0:K.current)==null||F.focus({preventScroll:!0}):y.focus({preventScroll:!0})},getBounds:(y,F)=>{if(!(K===void 0||K.current===null))return He(K.current,y??0,F??-1)},damage:ho}),[K,ho,He]);const Rn=E.useRef(),Xi=dr(()=>{var V,O,Pe;if(n<50||(j==null?void 0:j.disableAccessibilityTree)===!0)return null;let y=qn(Be,fe,n,se,ie);const F=le?0:-1;!le&&((V=y[0])==null?void 0:V.sourceIndex)===0&&(y=y.slice(1));const[z,T]=((O=I.current)==null?void 0:O.cell)??[],H=(Pe=I.current)==null?void 0:Pe.range,R=y.map(X=>X.sourceIndex),_=Zi(s,Math.min(m,s+i));return z!==void 0&&T!==void 0&&!(R.includes(z)&&_.includes(T))&&Pn(null),Qe("table",{role:"grid","aria-rowcount":m+1,"aria-multiselectable":"true","aria-colcount":Be.length+F,children:[Y("thead",{role:"rowgroup",children:Y("tr",{role:"row","aria-rowindex":1,children:y.map(X=>Y("th",{role:"columnheader","aria-selected":I.columns.hasIndex(X.sourceIndex),"aria-colindex":X.sourceIndex+1+F,tabIndex:-1,onFocus:re=>{if(re.target!==yn.current)return Me==null?void 0:Me([X.sourceIndex,-1])},children:X.title},X.sourceIndex))})}),Y("tbody",{role:"rowgroup",children:_.map(X=>Y("tr",{role:"row","aria-selected":I.rows.hasIndex(X),"aria-rowindex":X+2,children:y.map(re=>{const Z=re.sourceIndex,ee=ot(Z,X),Re=z===Z&&T===X,Ze=H!==void 0&&Z>=H.x&&Z<H.x+H.width&&X>=H.y&&X<H.y+H.height,Ae=`glide-cell-${Z}-${X}`,ft=[Z,X],wt=h(ft,!0);return Y("td",{role:"gridcell","aria-colindex":Z+1+F,"aria-selected":Ze,"aria-readonly":Qo(wt)||!rr(wt),id:Ae,"data-testid":Ae,onClick:()=>{const et=K==null?void 0:K.current;if(et!=null)return he==null?void 0:he({bounds:He(et,Z,X),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:ft})},onFocusCapture:et=>{var me,tt;if(!(et.target===yn.current||((me=Rn.current)==null?void 0:me[0])===Z&&((tt=Rn.current)==null?void 0:tt[1])===X))return Rn.current=ft,Me==null?void 0:Me(ft)},ref:Re?Pn:void 0,tabIndex:-1,children:es(wt,ue)},ee)})},X))})]},"access-tree")},[n,Be,fe,se,ie,m,s,i,I,Pn,h,K,he,He,Me],200),bn=D===0||!P?0:fe>D?1:xn(-ie/100,0,1),$i=-s*32+Ce,vn=M?xn(-$i/100,0,1):0,Yi=E.useMemo(()=>{if(!bn&&!vn)return null;const y={position:"absolute",top:0,left:En,width:n-En,height:o,opacity:bn,pointerEvents:"none",transition:be?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},F={position:"absolute",top:st,left:0,width:n,height:o,opacity:vn,pointerEvents:"none",transition:L?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return Qe(Yn,{children:[bn>0&&Y("div",{id:"shadow-x",style:y}),vn>0&&Y("div",{id:"shadow-y",style:F})]})},[bn,vn,En,n,be,st,o,L]),_i=E.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return Qe(Yn,{children:[Y("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Pi,onKeyUp:Ri,onFocus:S,onBlur:B,ref:Ti,style:Fn,children:Xi}),Y("canvas",{ref:Ne,style:_i}),Yi]})},xl=E.memo(E.forwardRef(ts));function ns(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string"};switch(e.kind){case de.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Zn?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case de.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case de.Image:case de.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case de.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case de.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case de.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case de.Markdown:case de.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case de.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case de.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case de.Protected:return{formatted:"************",rawValue:"",format:"string"};default:Qn()}}function os(e,t){return e.map((o,i)=>{const r=t[i];return o.map(l=>l.span!==void 0&&l.span[0]!==r?{formatted:"",rawValue:"",format:"string"}:ns(l))})}function _o(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function is(e){var n;const t=[];for(const o of e){const i=[];for(const r of o)r.format==="url"?i.push(((n=r.rawValue)==null?void 0:n.toString())??""):r.format==="string-array"?i.push(r.formatted.map(l=>_o(l,!0)).join(",")):i.push(_o(r.formatted,!1));t.push(i.join("	"))}return t.join(`
`)}function Nn(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function Vo(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function rs(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function ss(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const i of o){const r=`gdg-format="${i.format}"`;i.format==="url"?t.push(`<td ${r}><a href="${i.rawValue}">${Nn(i.formatted)}</a></td>`):i.format==="string-array"?t.push(`<td ${r}><ol>${i.formatted.map((l,s)=>`<li gdg-raw-value=${Vo(i.rawValue[s])}>`+Nn(l)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${Vo(((n=i.rawValue)==null?void 0:n.toString())??"")} ${r}>${Nn(i.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function ls(e,t){const n=os(e,t),o=is(n),i=ss(n);return{textPlain:o,textHtml:i}}function Cl(e){var l;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],i=[];let r;for(;o.length>0;){const s=o.pop();if(s===void 0)break;if(s instanceof HTMLTableElement||s.nodeName==="TBODY")o.push(...[...s.children].reverse());else if(s instanceof HTMLTableRowElement)r!==void 0&&i.push(r),r=[],o.push(...[...s.children].reverse());else if(s instanceof HTMLTableCellElement){const a=s.cloneNode(!0),f=a.children.length===1&&a.children[0].nodeName==="P"?a.children[0]:null,g=(f==null?void 0:f.children.length)===1&&f.children[0].nodeName==="FONT",m=a.querySelectorAll("br");for(const u of m)u.replaceWith(`
`);const h=a.getAttribute("gdg-raw-value"),c=a.getAttribute("gdg-format")??"string";if(a.querySelector("a")!==null)r==null||r.push({rawValue:((l=a.querySelector("a"))==null?void 0:l.getAttribute("href"))??"",formatted:a.textContent??"",format:c});else if(a.querySelector("ol")!==null){const u=a.querySelectorAll("li");r==null||r.push({rawValue:[...u].map(b=>b.getAttribute("gdg-raw-value")??""),formatted:[...u].map(b=>b.textContent??""),format:"string-array"})}else if(h!==null)r==null||r.push({rawValue:rs(h),formatted:a.textContent??"",format:c});else{let u=a.textContent??"";g&&(u=u.replace(/\n(?!\n)/g,"")),r==null||r.push({rawValue:u??"",formatted:u??"",format:c})}}}return r!==void 0&&i.push(r),i}function Sl(e,t,n,o,i){var s;const r=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let l=!1;do{if((e==null?void 0:e.current)===void 0)break;const a=(s=e.current)==null?void 0:s.range,d=[];if(a.width>2){const m=t({x:a.x,y:a.y,width:1,height:a.height},i.signal);if(typeof m=="function")return r;d.push(...m);const h=t({x:a.x+a.width-1,y:a.y,width:1,height:a.height},i.signal);if(typeof h=="function")return r;d.push(...h)}else{const m=t({x:a.x,y:a.y,width:a.width,height:a.height},i.signal);if(typeof m=="function")return r;d.push(...m)}let f=a.x-n,g=a.x+a.width-1-n;for(const m of d)for(const h of m)h.span!==void 0&&(f=Math.min(h.span[0],f),g=Math.max(h.span[1],g));f===a.x-n&&g===a.x+a.width-1-n?l=!0:e={current:{cell:e.current.cell??[0,0],range:{x:f+n,y:a.y,width:g-f+1,height:a.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!l);return e}function Uo(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function Il(e){let t;(s=>{s[s.None=0]="None",s[s.inString=1]="inString",s[s.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],i=0,r=0;e=e.replace(/\r\n/g,`
`);let l=0;for(const s of e){switch(r){case 0:s==="	"||s===`
`?(o.push(e.slice(i,l)),i=l+1,s===`
`&&(n.push(o),o=[])):s==='"'&&(r=1);break;case 1:s==='"'&&(r=2);break;case 2:s==='"'?r=1:((s==="	"||s===`
`)&&(o.push(Uo(e.slice(i,l))),i=l+1,s===`
`&&(n.push(o),o=[])),r=0);break}l++}return i<e.length&&o.push(Uo(e.slice(i,e.length))),n.push(o),n.map(s=>s.map(a=>({rawValue:a,formatted:a,format:"string"})))}function Ml(e,t,n){var s;const o=ls(e,t),i=a=>{var d;(d=window.navigator.clipboard)==null||d.writeText(a)},r=(a,d)=>{var f;return((f=window.navigator.clipboard)==null?void 0:f.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"}),"text/html":new Blob([d],{type:"text/html"})})]),!0)},l=(a,d)=>{var f,g;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(f=n==null?void 0:n.clipboardData)==null||f.setData("text/plain",a),(g=n==null?void 0:n.clipboardData)==null||g.setData("text/html",d)}catch{r(a,d)||i(a)}};((s=window.navigator.clipboard)==null?void 0:s.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?l(o.textPlain,o.textHtml):i(o.textPlain),n==null||n.preventDefault()}function as(e){return e!==!0}const xi=20;function qo(e){const{cell:t,posX:n,posY:o,bounds:i,theme:r}=e,{width:l,height:s,x:a,y:d}=i,f=t.maxSize??xi,g=Math.floor(i.y+s/2),m=ti(f,s,r.cellVerticalPadding),h=ei(t.contentAlign??"center",a,l,r.cellHorizontalPadding,m),c=Zo(h,g,m),u=ni(a+n,d+o,c);return eo(t)&&u}const ds={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:de.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>cs(e,e.cell.data,eo(e.cell),e.cell.maxSize??xi,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{qo(e)&&e.preventDefault()},onClick:e=>{if(qo(e))return{...e.cell,data:as(e.cell.data)}},onPaste:(e,t)=>{let n=Cn;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Zn),n===t.data?void 0:{...t,data:n}}};function cs(e,t,n,o,i){if(!n&&t===Cn)return;const{ctx:r,hoverAmount:l,theme:s,rect:a,highlighted:d,hoverX:f,hoverY:g,cell:{contentAlign:m}}=e,{x:h,y:c,width:u,height:b}=a;let v=!1;if(i>0){let p=n?1-i+i*l:.4;if(t===Cn&&(p*=l),p===0)return;p<1&&(v=!0,r.globalAlpha=p)}lo(r,s,t,h,c,u,b,d,f,g,o,m),v&&(r.globalAlpha=1)}const us=yt("div")({name:"BubblesOverlayEditorStyle",class:"bed7b9f",propsAsIs:!1}),fs=e=>{const{bubbles:t}=e;return Qe(us,{children:[t.map((n,o)=>Y("div",{className:"boe-bubble",children:n},o)),Y("textarea",{className:"gdg-input",autoFocus:!0})]})},hs=fs,gs={getAccessibilityString:e=>oi(e.data),kind:de.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,i)=>qe(i,e,n.baseFontFull).width+o+20,0)+2*n.cellHorizontalPadding-4,draw:e=>ys(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return Y(hs,{bubbles:t.data})},onPaste:()=>{}},ms=4;function ys(e,t){const{rect:n,theme:o,ctx:i,highlighted:r}=e,{x:l,y:s,width:a,height:d}=n,f=20,g=8,m=ms;let h=l+o.cellHorizontalPadding;const c=[];for(const u of t){if(h>l+a)break;const b=qe(u,i,o.baseFontFull).width;c.push({x:h,width:b}),h+=b+g*2+m}i.beginPath();for(const u of c)at(i,u.x,s+(d-f)/2,u.width+g*2,f,o.roundingRadius??f/2);i.fillStyle=r?o.bgBubbleSelected:o.bgBubble,i.fill();for(const[u,b]of c.entries())i.beginPath(),i.fillStyle=o.textBubble,i.fillText(t[u],b.x+g,s+d/2+Ct(i,o))}const bs=yt("div")({name:"DrilldownOverlayEditorStyle",class:"dy18k32",propsAsIs:!1}),vs=e=>{const{drilldowns:t}=e;return Y(bs,{children:t.map((n,o)=>Qe("div",{className:"doe-bubble",children:[n.img!==void 0&&Y("img",{src:n.img}),Y("div",{children:n.text})]},o))})},ps=vs,ws={getAccessibilityString:e=>oi(e.data.map(t=>t.text)),kind:de.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,i)=>qe(i.text,e,n.baseFontFull).width+o+20+(i.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>Cs(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return Y(ps,{drilldowns:t.data})},onPaste:()=>{}},ks=4,on={};function xs(e,t,n,o){const i=Math.ceil(window.devicePixelRatio),r=5,l=n-r*2,s=4,a=n*i,d=o+r,f=o*3,g=(f+r*2)*i,m=`${e},${t},${i},${n}`;if(on[m]!==void 0)return{el:on[m],height:a,width:g,middleWidth:s*i,sideWidth:d*i,padding:r*i,dpr:i};const h=document.createElement("canvas"),c=h.getContext("2d");return c===null?null:(h.width=g,h.height=a,c.scale(i,i),on[m]=h,c.beginPath(),at(c,r,r,f,l,o),c.shadowColor="rgba(24, 25, 34, 0.4)",c.shadowBlur=1,c.fillStyle=e,c.fill(),c.shadowColor="rgba(24, 25, 34, 0.3)",c.shadowOffsetY=1,c.shadowBlur=5,c.fillStyle=e,c.fill(),c.shadowOffsetY=0,c.shadowBlur=0,c.shadowBlur=0,c.beginPath(),at(c,r+.5,r+.5,f,l,o),c.strokeStyle=t,c.lineWidth=1,c.stroke(),{el:h,height:a,width:g,sideWidth:d*i,middleWidth:o*i,padding:r*i,dpr:i})}function Cs(e,t){const{rect:n,theme:o,ctx:i,imageLoader:r,col:l,row:s}=e,{x:a,width:d}=n,f=o.baseFontFull,g=ci(i,f),m=Math.min(n.height,Math.max(16,Math.ceil(g*o.lineHeight)*2)),h=Math.floor(n.y+(n.height-m)/2),c=m-10,u=8,b=ks;let v=a+o.cellHorizontalPadding;const p=o.roundingRadius??6,S=xs(o.bgCell,o.drilldownBorder,m,p),B=[];for(const A of t){if(v>a+d)break;const D=qe(A.text,i,f).width;let W=0;if(A.img!==void 0){const P=r.loadOrGetImage(A.img,l,s);P!==void 0&&(P instanceof HTMLImageElement?P.complete&&P.naturalWidth>0&&P.naturalHeight>0:P.width>0&&P.height>0)&&(W=c-8+4)}const k=D+W+u*2;B.push({x:v,width:k}),v+=k+b}if(S!==null){const{el:A,height:I,middleWidth:D,sideWidth:W,width:k,dpr:P,padding:M}=S;if(A.width>0&&A.height>0){const x=W/P,C=M/P;for(const w of B){const $=Math.floor(w.x),U=Math.floor(w.width),q=U-(x-C)*2;i.imageSmoothingEnabled=!1;try{i.drawImage(A,0,0,W,I,$-C,h,x,m),q>0&&i.drawImage(A,W,0,D,I,$+(x-C),h,q,m),i.drawImage(A,k-W,0,W,I,$+U-(x-C),h,x,m)}catch{const se=`${o.bgCell}_${o.drilldownBorder}_${m}_${p}`;delete on[se]}i.imageSmoothingEnabled=!0}}else{const x=`${o.bgCell}_${o.drilldownBorder}_${m}_${p}`;delete on[x]}}i.beginPath();for(const[A,I]of B.entries()){const D=t[A];let W=I.x+u;if(D.img!==void 0){const k=r.loadOrGetImage(D.img,l,s);if(k!==void 0&&(k instanceof HTMLImageElement?k.complete&&k.naturalWidth>0&&k.naturalHeight>0:k.width>0&&k.height>0)){const M=c-8;let x=0,C=0,w=k.width,$=k.height;w>$?(x+=(w-$)/2,w=$):$>w&&(C+=($-w)/2,$=w),i.beginPath(),at(i,W,h+m/2-M/2,M,M,o.roundingRadius??3),i.save(),i.clip(),i.drawImage(k,x,C,w,$,W,h+m/2-M/2,M,M),i.restore(),W+=M+4}}i.beginPath(),i.fillStyle=o.textBubble,i.fillText(D.text,W,h+m/2+Ct(i,o))}}const Ss=yt("div")({name:"ImageOverlayEditorStyle",class:"i1f2fhaz",propsAsIs:!1}),Is=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:i}=e,r=t.filter(s=>s!=="");if(r.length===0)return null;const l=r.length>1;return Qe(Ss,{"data-testid":"GDG-default-image-overlay-editor",children:[Y(er.Carousel,{showArrows:l,showThumbs:!1,swipeable:l,emulateTouch:l,infiniteLoop:l,children:r.map(s=>{const a=(i==null?void 0:i(s))??Y("img",{draggable:!1,src:s});return Y("div",{className:"gdg-centering-container",children:a},s)})}),n&&o&&Y("button",{className:"gdg-edit-icon",onClick:o,children:Y(to,{})})]})},Ms={getAccessibilityString:e=>e.data.join(", "),kind:de.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>Es(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e;return Y(o??Is,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:r=>{n({...t,data:[r]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(i=>{try{return new URL(i),i}catch{return}}).filter(i=>i!==void 0);if(!(o.length===t.data.length&&o.every((i,r)=>i===t.data[r])))return{...t,data:o}}},Xn=4;function Es(e,t,n,o){const{rect:i,col:r,row:l,theme:s,ctx:a,imageLoader:d}=e,{x:f,y:g,height:m,width:h}=i,c=m-s.cellVerticalPadding*2,u=[];let b=0;for(let p=0;p<t.length;p++){const S=t[p];if(S.length===0)continue;const B=d.loadOrGetImage(S,r,l);if(B!==void 0){u[p]=B;const A=B.width*(c/B.height);b+=A+Xn}}if(b===0)return;b-=Xn;let v=f+s.cellHorizontalPadding;o==="right"?v=Math.floor(f+h-s.cellHorizontalPadding-b):o==="center"&&(v=Math.floor(f+h/2-b/2));for(const p of u){if(p===void 0)continue;const S=p.width*(c/p.height);n>0&&(a.beginPath(),at(a,v,g+s.cellVerticalPadding,S,c,n),a.save(),a.clip()),a.drawImage(p,v,g+s.cellVerticalPadding,S,c),n>0&&a.restore(),v+=S+Xn}}function Fs(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const Bs={getAccessibilityString:()=>"",kind:de.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:i,rect:r,theme:l}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let s=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(s+=Math.round(Fs(n,o)*t.skeletonWidthVariability));const a=l.cellHorizontalPadding;s+a*2>=r.width&&(s=r.width-a*2-1);const d=t.skeletonHeight??Math.min(18,r.height-2*l.cellVerticalPadding);at(i,r.x+a,r.y+(r.height-d)/2,s,d,l.roundingRadius??3),i.fillStyle=an(l.textDark,.1),i.fill()},onPaste:()=>{}},As=yt("div")({name:"MarkdownContainer",class:"m1ec5h7p",propsAsIs:!1});class Ds extends Jn.PureComponent{constructor(){super(...arguments);oe(this,"targetElement",null);oe(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:i,createNode:r}=o,l=qi(i),s=document.createRange();s.selectNodeContents(n),s.deleteContents();let a=r==null?void 0:r(l);if(a===void 0){const f=document.createElement("template");f.innerHTML=l,a=f.content}n.append(a);const d=n.getElementsByTagName("a");for(const f of d)f.target="_blank",f.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),Y(As,{ref:this.containerRefHook})}}const Hs=yt("textarea")({name:"InputBox",class:"iotb8b8",propsAsIs:!1}),Ps=yt("div")({name:"ShadowBox",class:"s1xtsfdl",propsAsIs:!1}),Rs=yt("div")({name:"GrowingEntryStyle",class:"g1d7u5bt",propsAsIs:!1});let jo=0;const In=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:i,altNewline:r,validatedSelection:l,...s}=e,{onChange:a,className:d}=s,f=E.useRef(null),g=n??"";gt(a!==void 0,"GrowingEntry must be a controlled input area");const[m]=E.useState(()=>"input-box-"+(jo=(jo+1)%1e7));E.useEffect(()=>{const c=f.current;if(c===null||c.disabled)return;const u=g.toString().length;c.focus(),c.setSelectionRange(i?0:u,u)},[]),E.useLayoutEffect(()=>{var c;if(l!==void 0){const u=typeof l=="number"?[l,null]:l;(c=f.current)==null||c.setSelectionRange(u[0],u[1])}},[l]);const h=E.useCallback(c=>{c.key==="Enter"&&c.shiftKey&&r===!0||o==null||o(c)},[r,o]);return Qe(Rs,{className:"gdg-growing-entry",children:[Y(Ps,{className:d,children:g+`
`}),Y(Hs,{...s,className:(d??"")+" gdg-input",id:m,ref:f,onKeyDown:h,value:g,placeholder:t,dir:"auto"})]})},Ts=()=>e=>e.targetWidth,Ko=yt("div")({name:"MarkdownOverlayEditorStyle",class:"mmv7gx6",propsAsIs:!1,vars:{"mmv7gx6-0":[Ts(),"px"]}}),Ws=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:i,targetRect:r,onFinish:l,validatedSelection:s}=e,a=t.data,d=t.readonly===!0,[f,g]=E.useState(a===""||o),m=E.useCallback(()=>{g(c=>!c)},[]),h=a?"gdg-ml-6":"";return f?Qe(Ko,{targetWidth:r.width-20,children:[Y(In,{autoFocus:!0,highlight:!1,validatedSelection:s,value:a,onKeyDown:c=>{c.key==="Enter"&&c.stopPropagation()},onChange:n}),Y("div",{className:`gdg-edit-icon gdg-checkmark-hover ${h}`,onClick:()=>l(t),children:Y(ar,{})})]}):Qe(Ko,{targetWidth:r.width,children:[Y(Ds,{contents:a,createNode:i}),!d&&Qe(Yn,{children:[Y("div",{className:"spacer"}),Y("div",{className:`gdg-edit-icon gdg-edit-hover ${h}`,onClick:m,children:Y(to,{})})]}),Y("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0})]})},zs={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:de.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:ln,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return qe(o,e,n.baseFontFull).width+2*n.cellHorizontalPadding},draw:e=>mt(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:i,markdownDivCreateNode:r,forceEditMode:l,validatedSelection:s}=e;return Y(Ws,{onFinish:i,targetRect:o,value:n,validatedSelection:s,onChange:a=>t({...n,data:a.target.value}),forceEditMode:l,createNode:r})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},Ls={getAccessibilityString:e=>e.row.toString(),kind:rn.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:Os,measure:()=>44,draw:e=>Xs(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:i}=e,{width:r,height:l}=t,s=n.drawHandle?7+(r-7)/2:r/2,a=l/2;if(Math.abs(o-s)<=10&&Math.abs(i-a)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function Os(e,t){const{ctx:n,theme:o}=e,i=o.markerFontFull,r=t??{};return(r==null?void 0:r.font)!==i&&(n.font=i,r.font=i),r.deprep=Ns,n.textAlign="center",r}function Ns(e){const{ctx:t}=e;t.textAlign="start"}function Xs(e,t,n,o,i,r){const{ctx:l,rect:s,hoverAmount:a,theme:d}=e,{x:f,y:g,width:m,height:h}=s,c=n?1:o==="checkbox-visible"?.6+.4*a:a;if(o!=="number"&&c>0){l.globalAlpha=c;const u=7*(n?a:1);if(lo(l,d,n,i?f+u:f,g,i?m-u:m,h,!0,void 0,void 0,18,"center",r),i){l.globalAlpha=a,l.beginPath();for(const b of[3,6])for(const v of[-5,-1,3])l.rect(f+b,g+h/2+v,2,2);l.fillStyle=d.textLight,l.fill(),l.beginPath()}l.globalAlpha=1}if(o==="number"||o==="both"&&!n){const u=t.toString(),b=d.markerFontFull,v=f+m/2;o==="both"&&a!==0&&(l.globalAlpha=1-a),l.fillStyle=d.textLight,l.font=b,l.fillText(u,v,g+h/2+Ct(l,b)),a!==0&&(l.globalAlpha=1)}}const $s={getAccessibilityString:()=>"",kind:rn.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>Ys(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function Ys(e,t,n){const{ctx:o,rect:i,hoverAmount:r,theme:l,spriteManager:s}=e,{x:a,y:d,width:f,height:g}=i;o.beginPath(),o.globalAlpha=r,o.rect(a+1,d+1,f,g-2),o.fillStyle=l.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const m=t!=="";let h=0;if(n!==void 0){const u=g-8,b=a+8/2,v=d+8/2;s.drawSprite(n,"normal",o,b,v,u,l,m?1:r),h=u}else{h=24;const c=12,u=m?c:r*c,b=m?0:(1-r)*c*.5,v=l.cellHorizontalPadding+4;u>0&&(o.moveTo(a+v+b,d+g/2),o.lineTo(a+v+b+u,d+g/2),o.moveTo(a+v+b+u*.5,d+g/2-u*.5),o.lineTo(a+v+b+u*.5,d+g/2+u*.5),o.lineWidth=2,o.strokeStyle=l.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=l.textMedium,o.fillText(t,h+a+l.cellHorizontalPadding+.5,d+g/2+Ct(o,l)),o.beginPath()}function Ci(e,t,n,o,i,r,l){e.textBaseline="alphabetic";const s=_s(e,i,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),at(e,s.x,s.y,s.width,s.height,t.roundingRadius??4),e.globalAlpha=r,e.fillStyle=(n==null?void 0:n.bgColor)??an(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",l==null||l("text")}function _s(e,t,n,o,i){const r=o.cellHorizontalPadding,l=o.cellVerticalPadding;if(i)return{x:t.x+r/2,y:t.y+l/2+1,width:t.width-r,height:t.height-l-1};const s=qe(n,e,o.baseFontFull,"alphabetic"),a=t.height-l,d=Math.min(a,s.actualBoundingBoxAscent*2.5);return{x:t.x+r/2,y:t.y+(t.height-d)/2+1,width:s.width+r*3,height:d-1}}const Vs=E.lazy(async()=>await nr(()=>import("./number-overlay-editor-uE9yTs1s.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url)),Us={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:de.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:ln,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:i,rect:r,overrideCursor:l}=e,{hoverEffect:s,displayData:a,hoverEffectTheme:d}=n;s===!0&&t>0&&Ci(o,i,d,a,r,t,l),mt(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>qe(t.displayData,e,n.baseFontFull).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:i}=e;return Y(E.Suspense,{fallback:null,children:Y(Vs,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:i,onChange:r=>n({...o,data:Number.isNaN(r.floatValue??0)?0:r.floatValue})})})},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},qs={getAccessibilityString:()=>"",measure:()=>108,kind:de.Protected,needsHover:!1,needsHoverPosition:!1,draw:js,onPaste:()=>{}};function js(e){const{ctx:t,theme:n,rect:o}=e,{x:i,y:r,height:l}=o;t.beginPath();const s=2.5;let a=i+n.cellHorizontalPadding+s;const d=r+l/2,f=Math.cos(Fo(30))*s,g=Math.sin(Fo(30))*s;for(let m=0;m<12;m++)t.moveTo(a,d-s),t.lineTo(a,d+s),t.moveTo(a+f,d-g),t.lineTo(a-f,d+g),t.moveTo(a-f,d-g),t.lineTo(a+f,d+g),a+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const Ks={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:de.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>ln(e,t,e.theme.textLight),draw:e=>mt(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>qe(t.data,e,n.baseFontFull).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:i}=e;return Y(In,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:i,onChange:r=>n({...o,data:r.target.value})})},onPaste:()=>{}},Gs={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:de.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:ln,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:i,rect:r,theme:l,overrideCursor:s}=e,{displayData:a,contentAlign:d,hoverEffect:f,allowWrapping:g,hoverEffectTheme:m}=t;f===!0&&n>0&&Ci(i,l,m,a,r,n,s),mt(e,a,d,g,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let i=0;for(const r of o)i=Math.max(i,qe(r,e,n.baseFontFull).width);return i+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:i,validatedSelection:r}=t;return Y(In,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:i.readonly!==!0,disabled:i.readonly===!0,altNewline:!0,value:i.data,validatedSelection:r,onChange:l=>o({...i,data:l.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Js=yt("div")({name:"UriOverlayEditorStyle",class:"uwr6ffw",propsAsIs:!1}),Qs=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:i,validatedSelection:r,preview:l}=e,[s,a]=E.useState(!i&&(t===""||o)),d=E.useCallback(()=>{a(!0)},[]);return s?Y(In,{validatedSelection:r,highlight:!0,autoFocus:!0,value:t,onChange:n}):Qe(Js,{children:[Y("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer",children:l}),!i&&Y("div",{className:"gdg-edit-icon",onClick:d,children:Y(to,{})}),Y("textarea",{className:"gdg-input",autoFocus:!0})]})},Zs=Qs;function Si(e,t,n,o){let i=n.cellHorizontalPadding;const r=t.height/2-e.actualBoundingBoxAscent/2,l=e.width,s=e.actualBoundingBoxAscent;return o==="right"?i=t.width-l-n.cellHorizontalPadding:o==="center"&&(i=t.width/2-l/2),{x:i,y:r,width:l,height:s}}function Go(e){const{cell:t,bounds:n,posX:o,posY:i,theme:r}=e,l=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const s=ai(l,r.baseFontFull);if(s===void 0)return!1;const a=Si(s,n,r,t.contentAlign);return $t({x:a.x-4,y:a.y-4,width:a.width+8,height:a.height+8},o,i)}const el={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:de.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:ln,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:i,hoverY:r,rect:l,ctx:s}=e,a=t.displayData??t.data,d=t.hoverEffect===!0;if(o!==void 0&&d&&i!==void 0&&r!==void 0){const f=qe(a,s,n.baseFontFull),g=Si(f,l,n,t.contentAlign),{x:m,y:h,width:c,height:u}=g;if(i>=m-4&&i<=m-4+c+8&&r>=h-4&&r<=h-4+u+8){const b=Ct(s,n.baseFontFull);o("pointer");const v=5,p=h-b;s.beginPath(),s.moveTo(l.x+m,Math.floor(l.y+p+u+v)+.5),s.lineTo(l.x+m+c,Math.floor(l.y+p+u+v)+.5),s.strokeStyle=n.linkColor,s.stroke(),s.save(),s.fillStyle=e.cellFillColor,mt({...e,rect:{...l,x:l.x-1}},a,t.contentAlign),mt({...e,rect:{...l,x:l.x-2}},a,t.contentAlign),mt({...e,rect:{...l,x:l.x+1}},a,t.contentAlign),mt({...e,rect:{...l,x:l.x+2}},a,t.contentAlign),s.restore()}}s.fillStyle=d?n.linkColor:n.textDark,mt(e,a,t.contentAlign)},onSelect:e=>{Go(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;Go(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>qe(t.displayData??t.data,e,n.baseFontFull).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:i,validatedSelection:r}=t;return Y(Zs,{forceEditMode:o.readonly!==!0&&(i||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:r,readonly:o.readonly===!0,onChange:l=>n({...o,data:l.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},El=[Ls,$s,ds,gs,ws,Ms,Bs,zs,Us,qs,Ks,Gs,el],$n=[];class tl extends fi{constructor(){super(...arguments);oe(this,"imageLoaded",()=>{});oe(this,"loadedLocations",[]);oe(this,"cache",{});oe(this,"sendLoaded",tr(()=>{this.imageLoaded(new nn(this.loadedLocations)),this.loadedLocations=[]},20));oe(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const i=this.cache[o];let r=!1;for(let l=0;l<i.cells.length;l++){const s=i.cells[l];if(this.isInWindow(s)){r=!0;break}}r?i.cells=i.cells.filter(this.isInWindow):(i.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,i,r){let l=!1;const s=$n.pop()??new Image;let a=!1;const d={img:void 0,cells:[ot(o,i)],url:n,cancel:()=>{a||(a=!0,$n.length<12?$n.unshift(s):l||(s.src=""))}},f=new Promise(g=>s.addEventListener("load",()=>g(null)));requestAnimationFrame(async()=>{try{s.src=n,await f,await s.decode();const g=this.cache[r];if(g!==void 0&&!a){g.img=s;for(const m of g.cells)this.loadedLocations.push(so(m));l=!0,this.sendLoaded()}}catch{d.cancel()}}),this.cache[r]=d}loadOrGetImage(n,o,i){const r=n,l=this.cache[r];if(l!==void 0){const s=ot(o,i);return l.cells.includes(s)||l.cells.push(s),l.img}else this.loadImage(n,o,i,r)}}const Fl=tl;export{Ht as A,Zr as B,Vn as C,wl as D,Qn as E,ir as F,de as G,fl as H,rn as I,yl as J,Cl as K,Il as L,Bo as M,bl as N,Ml as O,Fl as P,El as Q,xl as R,Xo as S,pl as T,Jr as U,ul as V,or as a,gt as b,kl as c,ml as d,gl as e,Sl as f,vl as g,Vt as h,dl as i,an as j,al as k,Ut as l,qe as m,Xt as n,$o as o,$t as p,Un as q,cl as r,mr as s,as as t,Je as u,Qo as v,hl as w,rr as x,Ar as y,wn as z};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./number-overlay-editor-uE9yTs1s.js","./marked.esm-I79JNzkl.js","./index-KtDdPitk.js","./react-number-format.es-GxoQxwCo.js","./number-overlay-editor-8QJ1sjy4.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}