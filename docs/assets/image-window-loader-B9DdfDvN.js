const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./number-overlay-editor-CK4Gu6Bp.js","./iframe-BZCng1zM.js","./preload-helper-C1FmrZbK.js","./marked.esm-DICA0ayZ.js","./react-number-format.es-5tRpePvg.js","./number-overlay-editor-DjcVbkae.css"])))=>i.map(i=>d[i]);
var qi=Object.defineProperty;var Ui=(e,t,n)=>t in e?qi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var G=(e,t,n)=>Ui(e,typeof t!="symbol"?t+"":t,n);import{r as b,R as nn}from"./iframe-BZCng1zM.js";import{h as ji,g as Ki,k as Gi,v as Ji,l as Qi,m as Cn,r as Zi,j as er,t as tr}from"./throttle-CvI-UzeK.js";import{s as mt,a as nr}from"./marked.esm-DICA0ayZ.js";import{_ as or}from"./preload-helper-C1FmrZbK.js";function Jo(e="This should not happen"){throw new Error(e)}function ht(e,t="Assertion failed"){if(!e)return Jo(t)}function Zn(e,t){return Jo(t??"Hell froze over")}function ol(e,t){try{return e()}catch{return t}}const Eo=Object.prototype.hasOwnProperty;function Ot(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Ot(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(Eo.call(e,n)&&++o&&!Eo.call(t,n)||!(n in t)||!Ot(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const Sn=null,eo=void 0;var le=(e=>(e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom",e))(le||{}),ir=(e=>(e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e))(ir||{}),qn=(e=>(e.Triangle="triangle",e.Dots="dots",e))(qn||{});function il(e){return"width"in e&&typeof e.width=="number"}async function rl(e){return typeof e=="object"?e:await e()}function rr(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown")}function sl(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown"||e.kind==="boolean"||e.kind==="image"||e.kind==="custom")}function Qo(e){return e.kind==="marker"||e.kind==="new-row"}function sr(e){if(!rr(e)||e.kind==="image")return!1;switch(e.kind){case"text":case"number":case"markdown":case"uri":case"custom":case"boolean":return e.readonly!==!0;default:Zn(e,"A cell was passed with an invalid kind")}}function ll(e){return ji(e,"editor")}function to(e){return!(e.readonly??!1)}var on=(e=>(e.NewRow="new-row",e.Marker="marker",e))(on||{});const In={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function Nn(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,i){return o[0]-i[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const i=n[n.length-1];i[1]<o[0]?n.push([...o]):i[1]<o[1]&&(i[1]=o[1])}return n}let Fo;const Ve=class Ve{constructor(t){this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new Ve(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=Nn([...this.items,n]);return new Ve(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],i=typeof t=="number"?t+1:t[1];for(const[r,l]of n.entries()){const[s,a]=l;if(s<=i&&o<=a){const c=[];s<o&&c.push([s,o]),i<a&&c.push([i,a]),n.splice(r,1,...c)}}return new Ve(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,i]=this.items[n];if(t>=o&&t<i)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],i=this.items[n];if(o[0]!==i[0]||o[1]!==i[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let i=n;i<o;i++)t.push(i);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};G(Ve,"create",t=>new Ve(Nn(t))),G(Ve,"empty",()=>Fo??(Fo=new Ve([]))),G(Ve,"fromSingleSelection",t=>Ve.empty().add(t)),G(Ve,"fromArray",t=>{if(t.length===0)return Ve.empty();const n=t.map(i=>[i,i+1]),o=Nn(n);return new Ve(o)});let Un=Ve;function et(e,t,n,o,i=!1){const r=b.useRef();r.current=t,b.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const l=n,s=a=>{var c;(c=r.current)==null||c.call(l,a)};return l.addEventListener(e,s,{passive:o,capture:i}),()=>{l.removeEventListener(e,s,{capture:i})}},[e,n,o,i])}function al(e,t){return e===void 0?void 0:t}const lr=Math.PI;function Bo(e){return e*lr/180}const Zo=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),ei=(e,t,n,o,i)=>{switch(e){case"left":return Math.floor(t)+o+i/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-i/2}},ti=(e,t,n)=>Math.min(e,t-n*2),ni=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,no=e=>{const t=e.fgColor??"currentColor";return b.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},b.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),b.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},ar=e=>{const t=e.fgColor??"currentColor";return b.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},b.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function cr(e,t,n){const[o,i]=b.useState(e),r=b.useRef(!0);b.useEffect(()=>()=>{r.current=!1},[]);const l=b.useRef(Ki(s=>{r.current&&i(s)},n));return b.useLayoutEffect(()=>{r.current&&l.current(()=>e())},t),o}const dr="֑-߿יִ-﷽ﹰ-ﻼ",ur="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",fr=new RegExp("^[^"+ur+"]*["+dr+"]");function oo(e){return fr.test(e)?"rtl":"not-rtl"}let vn;function Ao(){if(typeof document>"u")return 0;if(vn!==void 0)return vn;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),vn=n-o,vn}const Bt=Symbol();function cl(e){const t=b.useRef([Bt,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=b.useState(e),[,i]=b.useState(),r=b.useCallback(s=>{const a=t.current[0];a!==Bt&&(s=typeof s=="function"?s(a):s,s===a)||(a!==Bt&&i({}),o(c=>typeof s=="function"?s(a===Bt?c:a):s),t.current[0]=Bt)},[]),l=b.useCallback(()=>{t.current[0]=Bt,i({})},[]);return[t.current[0]===Bt?n:t.current[0],r,l]}function oi(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function dl(e){const t=b.useRef(e);return Ot(e,t.current)||(t.current=e),t.current}function hr(e,t){return nn.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,contentAlign:n.contentAlign,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled})),[e,t])}function ul(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(wn(e.current.cell,t))return!0;const i=[e.current.range,...e.current.rangeStack];for(const r of i)if(n>=r.x&&n<r.x+r.width&&o>=r.y&&o<r.y+r.height)return!0}return!1}function jn(e,t){return(e??"")===(t??"")}function gr(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function mr(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function wn(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function ii(e){return[e.x+e.width-1,e.y+e.height-1]}function Ho(e,t,n){const o=n.x,i=n.x+n.width-1,r=n.y,l=n.y+n.height-1,[s,a]=e;if(a<r||a>l)return!1;if(t.span===void 0)return s>=o&&s<=i;const[c,u]=t.span;return c>=o&&c<=i||u>=o&&c<=i||c<o&&u>i}function br(e,t,n,o){let i=0;if(n.current===void 0)return i;const r=n.current.range;(o||r.height*r.width>1)&&Ho(e,t,r)&&i++;for(const l of n.current.rangeStack)Ho(e,t,l)&&i++;return i}function ri(e,t){let n=e;if(t!==void 0){let o=[...e];const i=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,i)):(o.splice(t.dest+1,0,i),o.splice(t.src,1)),o=o.map((r,l)=>({...r,sticky:e[l].sticky})),n=o}return n}function Xt(e,t){let n=0;const o=ri(e,t);for(let i=0;i<o.length;i++){const r=o[i];if(r.sticky)n+=r.width;else break}return n}function Yt(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let i=e-t;i<e;i++)o+=n(i);return o}}function Kn(e,t,n,o,i){const r=ri(e,o),l=[];for(const c of r)if(c.sticky)l.push(c);else break;if(l.length>0)for(const c of l)n-=c.width;let s=t,a=i??0;for(;a<=n&&s<r.length;)a+=r[s].width,s++;for(let c=t;c<s;c++){const u=r[c];u.sticky||l.push(u)}return l}function yr(e,t,n){let o=0;for(const i of t){const r=i.sticky?o:o+(n??0);if(e<=r+i.width)return i.sourceIndex;o+=i.width}return-1}function vr(e,t,n,o,i,r,l,s,a,c){const u=o+i;if(n&&e<=i)return-2;if(e<=u)return-1;let g=t;for(let d=0;d<c;d++){const f=r-1-d,v=typeof l=="number"?l:l(f);if(g-=v,e>=g)return f}const m=r-c,h=e-(a??0);if(typeof l=="number"){const d=Math.floor((h-u)/l)+s;return d>=m?void 0:d}else{let d=u;for(let f=s;f<m;f++){const v=l(f);if(h<=d+v)return f;d+=v}return}}let kn=0,Zt={};const Mn=typeof window>"u";let Xe=null,xn=!1;const pr=!Mn&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent);function si(){if(!(Mn||xn)&&!(typeof document>"u"))try{Xe=document.createElement("span"),Xe.style.visibility="hidden",Xe.style.position="absolute",Xe.style.top="-9999px",Xe.style.left="-9999px",Xe.style.whiteSpace="nowrap",Xe.style.padding="0",Xe.style.margin="0",Xe.style.border="none",document.body.append(Xe),xn=!0}catch{xn=!1,Xe=null}}async function wr(){var e;Mn||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,kn=0,Zt={},Ji(),si())}wr();Mn||setTimeout(si,0);function li(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function rt(e,t,n,o="middle"){const i=li(e,t,o,n);let r=Zt[i];if(r===void 0){if(r=t.measureText(e),pr&&e.length>5&&xn&&Xe)try{Xe.style.font=n??t.font,Xe.textContent=e;const l=Xe.getBoundingClientRect().width;l>r.width&&Object.defineProperty(r,"width",{value:l,writable:!0,enumerable:!0,configurable:!0})}catch{}Zt[i]=r,kn++}return kn>1e4&&(Zt={},kn=0),r}function ai(e,t){const n=li(e,void 0,"middle",t);return Zt[n]}function kt(e,t){return typeof t!="string"&&(t=t.baseFontFull),kr(e,t)}function Po(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const Do=[];function kr(e,t){for(const r of Do)if(r.key===t)return r.val;const n=Po(e,"alphabetic"),i=-(Po(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return Do.push({key:t,val:i}),i}function xr(e,t,n,o,i,r){const{ctx:l,rect:s,theme:a}=e;let c=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(c=n-t,c<u)){const g=1-c/u;l.globalAlpha=g,l.fillStyle=a.bgSearchResult,l.fillRect(s.x+1,s.y+1,s.width-(i?2:1),s.height-(r?2:1)),l.globalAlpha=1,o!==void 0&&(o.fillStyle=a.bgSearchResult)}return c<u}function sn(e,t,n){const{ctx:o,theme:i}=e,r=t??{},l=n??i.textDark;return l!==r.fillStyle&&(o.fillStyle=l,r.fillStyle=l),r}function ci(e,t,n,o,i,r,l,s,a){a==="right"?e.fillText(t,n+i-(s.cellHorizontalPadding+.5),o+r/2+l):a==="center"?e.fillText(t,n+i/2,o+r/2+l):e.fillText(t,n+s.cellHorizontalPadding+.5,o+r/2+l)}function di(e,t){const n=rt("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function Cr(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Sr(e,t,n,o,i,r,l,s,a,c){const u=s.baseFontFull,g=Gi(e,t,u,i-s.cellHorizontalPadding*2,c??!1),m=di(e,u),h=s.lineHeight*m,d=m+h*(g.length-1),f=d+s.cellVerticalPadding>r;f&&(e.save(),e.rect(n,o,i,r),e.clip());const v=o+r/2-d/2;let w=Math.max(o+s.cellVerticalPadding,v);for(const p of g)if(ci(e,p,n,w,i,m,l,s,a),w+=h,w>o+r)break;f&&e.restore()}function gt(e,t,n,o,i){const{ctx:r,rect:l,theme:s}=e,{x:a,y:c,width:u,height:g}=l;o=o??!1,o||(t=Cr(t,u));const m=kt(r,s),h=oo(t)==="rtl";if(n===void 0&&h&&(n="right"),h&&(r.direction="rtl"),t.length>0){let d=!1;n==="right"?(r.textAlign="right",d=!0):n!==void 0&&n!=="left"&&(r.textAlign=n,d=!0),o?Sr(r,t,a,c,u,g,m,s,n,i):ci(r,t,a,c,u,g,m,s,n),d&&(r.textAlign="start"),h&&(r.direction="inherit")}}function dt(e,t,n,o,i,r){typeof r=="number"&&(r={tl:r,tr:r,br:r,bl:r}),r={tl:Math.max(0,Math.min(r.tl,i/2,o/2)),tr:Math.max(0,Math.min(r.tr,i/2,o/2)),bl:Math.max(0,Math.min(r.bl,i/2,o/2)),br:Math.max(0,Math.min(r.br,i/2,o/2))},e.moveTo(t+r.tl,n),e.arcTo(t+o,n,t+o,n+r.tr,r.tr),e.arcTo(t+o,n+i,t+o-r.br,n+i,r.br),e.arcTo(t,n+i,t,n+i-r.bl,r.bl),e.arcTo(t,n,t+r.tl,n,r.tl)}function Ir(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Mr(e,t,n){const o=function(s,a){const c=a.x-s.x,u=a.y-s.y,g=Math.sqrt(c*c+u*u),m=c/g,h=u/g;return{x:c,y:a.y-s.y,len:g,nx:m,ny:h,ang:Math.atan2(h,m)}};let i;const r=t.length;let l=t[r-1];for(let s=0;s<r;s++){let a=t[s%r];const c=t[(s+1)%r],u=o(a,l),g=o(a,c),m=u.nx*g.ny-u.ny*g.nx,h=u.nx*g.nx-u.ny*-g.ny;let d=Math.asin(m<-1?-1:m>1?1:m),f=1,v=!1;h<0?d<0?d=Math.PI+d:(d=Math.PI-d,f=-1,v=!0):d>0&&(f=-1,v=!0),i=a.radius!==void 0?a.radius:n;const w=d/2;let p=Math.abs(Math.cos(w)*i/Math.sin(w)),I;p>Math.min(u.len/2,g.len/2)?(p=Math.min(u.len/2,g.len/2),I=Math.abs(p*Math.sin(w)/Math.cos(w))):I=i;let B=a.x+g.nx*p,A=a.y+g.ny*p;B+=-g.ny*I*f,A+=g.nx*I*f,e.arc(B,A,I,u.ang+Math.PI/2*f,g.ang-Math.PI/2*f,v),l=a,a=c}e.closePath()}function Gn(e,t,n,o,i,r,l,s,a,c,u,g,m,h,d){const f={x:0,y:r+c,width:0,height:0};if(e>=h.length||t>=u||t<-2||e<0)return f;const v=r-i;if(e>=g){const w=l>e?-1:1,p=Xt(h);f.x+=p+a;for(let I=l;I!==e;I+=w)f.x+=h[w===1?I:I-1].width*w}else for(let w=0;w<e;w++)f.x+=h[w].width;if(f.width=h[e].width+1,t===-1)f.y=i,f.height=v;else if(t===-2){f.y=0,f.height=i;let w=e;const p=h[e].group,I=h[e].sticky;for(;w>0&&jn(h[w-1].group,p)&&h[w-1].sticky===I;){const A=h[w-1];f.x-=A.width,f.width+=A.width,w--}let B=e;for(;B+1<h.length&&jn(h[B+1].group,p)&&h[B+1].sticky===I;){const A=h[B+1];f.width+=A.width,B++}if(!I){const A=Xt(h),E=f.x-A;E<0&&(f.x-=E,f.width+=E),f.x+f.width>n&&(f.width=n-f.x)}}else if(t>=u-m){let w=u-t;for(f.y=o;w>0;){const p=t+w-1;f.height=typeof d=="number"?d:d(p),f.y-=f.height,w--}f.height+=1}else{const w=s>t?-1:1;if(typeof d=="number"){const p=t-s;f.y+=p*d}else for(let p=s;p!==t;p+=w)f.y+=d(p)*w;f.height=(typeof d=="number"?d:d(t))+1}return f}const io=1<<21;function it(e,t){return(t+2)*io+e}function ui(e){return e%io}function ro(e){return Math.floor(e/io)-2}function so(e){const t=ui(e),n=ro(e);return[t,n]}class fi{constructor(){G(this,"visibleWindow",{x:0,y:0,width:0,height:0});G(this,"freezeCols",0);G(this,"freezeRows",[]);G(this,"isInWindow",t=>{const n=ui(t),o=ro(t),i=this.visibleWindow,r=n>=i.x&&n<=i.x+i.width||n<this.freezeCols,l=o>=i.y&&o<=i.y+i.height||this.freezeRows.includes(o);return r&&l})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Ot(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Er extends fi{constructor(){super(...arguments);G(this,"cache",new Map);G(this,"setValue",(n,o)=>{this.cache.set(it(n[0],n[1]),o)});G(this,"getValue",n=>this.cache.get(it(n[0],n[1])));G(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class en{constructor(t=[]){G(this,"cells");this.cells=new Set(t.map(n=>it(n[0],n[1])))}add(t){this.cells.add(it(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(it(t[0],t[1]))}remove(t){this.cells.delete(it(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(ro(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(it(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield so(t)}}function Fr(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class Br{constructor(t,n){G(this,"spriteMap",new Map);G(this,"headerIcons");G(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,i,r,l,s,a=1){const[c,u]=Fr(n,s),g=l*Math.ceil(window.devicePixelRatio),m=`${c}_${u}_${g}_${t}`;let h=this.spriteMap.get(m);if(h===void 0){const d=this.headerIcons[t];if(d===void 0)return;h=document.createElement("canvas");const f=h.getContext("2d");if(f===null)return;const v=new Image;v.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(d({fgColor:u,bgColor:c}))}`,this.spriteMap.set(m,h);const w=v.decode();if(w===void 0)return;this.inFlight++,w.then(()=>{f.drawImage(v,0,0,g,g)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else a<1&&(o.globalAlpha=a),o.drawImage(h,0,0,g,g,i,r,l,l),a<1&&(o.globalAlpha=1)}}const On={};let wt=null;function Ar(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Jn(e){const t=e.toLowerCase().trim();if(On[t]!==void 0)return On[t];wt=wt||Ar(),wt.style.color="#000",wt.style.color=t;const n=getComputedStyle(wt).color;wt.style.color="#fff",wt.style.color=t;const o=getComputedStyle(wt).color;if(o!==n)return[0,0,0,1];let i=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return i.length<4&&i.push(1),i=i.map(r=>Number.isNaN(r)?0:r),On[t]=i,i}function ln(e,t){const[n,o,i]=Jn(e);return`rgba(${n}, ${o}, ${i}, ${t})`}const Ro=new Map;function To(e,t){const n=`${e}-${t}`,o=Ro.get(n);if(o!==void 0)return o;const i=Je(e,t);return Ro.set(n,i),i}function Je(e,t){if(t===void 0)return e;const[n,o,i,r]=Jn(e);if(r===1)return e;const[l,s,a,c]=Jn(t),u=r+c*(1-r),g=(r*n+c*l*(1-r))/u,m=(r*o+c*s*(1-r))/u,h=(r*i+c*a*(1-r))/u;return`rgba(${g}, ${m}, ${h}, ${u})`}function hi(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function En(e,t,n,o,i,r,l,s,a){s=s??t;let c=t,u=e;const g=o-r;let m=!1;for(;c<n&&u<g;){const h=i(u);if(c+h>s&&a(c,u,h,!1,l&&u===o-1)===!0){m=!0;break}c+=h,u++}if(!m){c=n;for(let h=0;h<r;h++){u=o-1-h;const d=i(u);c-=d,a(c,u,d,!0,l&&u===o-1)}}}function xt(e,t,n,o,i,r){let l=0,s=0;const a=i+o;for(const c of e){const u=c.sticky?s:l+n;if(r(c,u,a,c.sticky?0:s,t)===!0)break;l+=c.width,s+=c.sticky?c.width:0}}function gi(e,t,n,o,i){let r=0,l=0;for(let s=0;s<e.length;s++){const a=e[s];let c=s+1,u=a.width;for(a.sticky&&(l+=u);c<e.length&&jn(e[c].group,a.group)&&e[c].sticky===e[s].sticky;){const f=e[c];u+=f.width,c++,s++,f.sticky&&(l+=f.width)}const g=a.sticky?0:n,m=r+g,h=a.sticky?0:Math.max(0,l-m),d=Math.min(u-h,t-(m+h));i([a.sourceIndex,e[c-1].sourceIndex],a.group??"",m+h,0,d,o),r+=u}}function mi(e,t,n,o,i,r,l){var m;const[s,a]=e;let c,u;const g=((m=l.find(h=>!h.sticky))==null?void 0:m.sourceIndex)??0;if(a>g){const h=Math.max(s,g);let d=t,f=o;for(let v=r.sourceIndex-1;v>=h;v--)d-=l[v].width,f+=l[v].width;for(let v=r.sourceIndex+1;v<=a;v++)f+=l[v].width;u={x:d,y:n,width:f,height:i}}if(g>s){const h=Math.min(a,g-1);let d=t,f=o;for(let v=r.sourceIndex-1;v>=s;v--)d-=l[v].width,f+=l[v].width;for(let v=r.sourceIndex+1;v<=h;v++)f+=l[v].width;c={x:d,y:n,width:f,height:i}}return[c,u]}function fl(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const bi={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function hl(){return bi}const gl=nn.createContext(bi);function $t(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const i in o)o.hasOwnProperty(i)&&(i==="bgCell"?n[i]=Je(o[i],n[i]):n[i]=o[i]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}function ml(e,t,n,o){if(o==="any")return Hr(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),mr([t,n],e))return;const i=t-e.x,r=e.x+e.width-t,l=n-e.y+1,s=e.y+e.height-n,a=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="horizontal"?Number.MAX_SAFE_INTEGER:l,o==="horizontal"?Number.MAX_SAFE_INTEGER:s);return a===s?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:a===l?{x:e.x,y:n,width:e.width,height:e.y-n}:a===r?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function rn(e,t,n,o,i,r,l,s){return e<=i+l&&i<=e+n&&t<=r+s&&r<=t+o}function Nt(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Hr(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),i=Math.max(e.x+e.width,t.x+t.width)-n,r=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:i,height:r}}function Pr(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function Dr(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const i=-4,r=-4,l=t+4,s=n+4,a=i-e.x,c=e.x+e.width-l,u=r-e.y,g=e.y+e.height-s,m=a>0?e.x+Math.floor(a/o)*o:e.x,h=c>0?e.x+e.width-Math.floor(c/o)*o:e.x+e.width,d=u>0?e.y+Math.floor(u/o)*o:e.y,f=g>0?e.y+e.height-Math.floor(g/o)*o:e.y+e.height;return{x:m,y:d,width:h-m,height:f-d}}function Rr(e,t,n,o,i){const[r,l,s,a]=t,[c,u,g,m]=i,{x:h,y:d,width:f,height:v}=e,w=[];if(f<=0||v<=0)return w;const p=h+f,I=d+v,B=h<r,A=d<l,E=h+f>s,H=d+v>a,z=h>=r&&h<s||p>r&&p<=s||h<r&&p>s,x=d>=l&&d<a||I>l&&I<=a||d<l&&I>a;if(z&&x){const M=Math.max(h,r),S=Math.max(d,l),C=Math.min(p,s),k=Math.min(I,a);w.push({rect:{x:M,y:S,width:C-M,height:k-S},clip:{x:c,y:u,width:g-c+1,height:m-u+1}})}if(B&&A){const M=h,S=d,C=Math.min(p,r),k=Math.min(I,l);w.push({rect:{x:M,y:S,width:C-M,height:k-S},clip:{x:0,y:0,width:c+1,height:u+1}})}if(A&&z){const M=Math.max(h,r),S=d,C=Math.min(p,s),k=Math.min(I,l);w.push({rect:{x:M,y:S,width:C-M,height:k-S},clip:{x:c,y:0,width:g-c+1,height:u+1}})}if(A&&E){const M=Math.max(h,s),S=d,C=p,k=Math.min(I,l);w.push({rect:{x:M,y:S,width:C-M,height:k-S},clip:{x:g,y:0,width:n-g+1,height:u+1}})}if(B&&x){const M=h,S=Math.max(d,l),C=Math.min(p,r),k=Math.min(I,a);w.push({rect:{x:M,y:S,width:C-M,height:k-S},clip:{x:0,y:u,width:c+1,height:m-u+1}})}if(E&&x){const M=Math.max(h,s),S=Math.max(d,l),C=p,k=Math.min(I,a);w.push({rect:{x:M,y:S,width:C-M,height:k-S},clip:{x:g,y:u,width:n-g+1,height:m-u+1}})}if(B&&H){const M=h,S=Math.max(d,a),C=Math.min(p,r),k=I;w.push({rect:{x:M,y:S,width:C-M,height:k-S},clip:{x:0,y:m,width:c+1,height:o-m+1}})}if(H&&z){const M=Math.max(h,r),S=Math.max(d,a),C=Math.min(p,s),k=I;w.push({rect:{x:M,y:S,width:C-M,height:k-S},clip:{x:c,y:m,width:g-c+1,height:o-m+1}})}if(E&&H){const M=Math.max(h,s),S=Math.max(d,a),C=p,k=I;w.push({rect:{x:M,y:S,width:C-M,height:k-S},clip:{x:g,y:m,width:n-g+1,height:o-m+1}})}return w}const Tr={kind:le.Loading,allowOverlay:!1};function Wo(e,t,n,o,i,r,l,s,a,c,u,g,m,h,d,f,v,w,p,I,B,A,E,H,z,x,D,M,S,C,k,Y,L,q,ne){let oe=(I==null?void 0:I.size)??Number.MAX_SAFE_INTEGER;const fe=performance.now();let ge=C.baseFontFull;e.font=ge;const $e={ctx:e},U=[0,0],He=v>0?Yt(a,v,c):0;let Me,X;const me=hi(p);return xt(t,s,r,l,i,(ie,ze,Se,ke,Qe)=>{const Ye=Math.max(0,ke-ze),Oe=ze+Ye,be=i+1,bt=ie.width-Ye,yt=o-i-1;if(p.length>0){let xe=!1;for(let se=0;se<p.length;se++){const ye=p[se];if(rn(Oe,be,bt,yt,ye.x,ye.y,ye.width,ye.height)){xe=!0;break}}if(!xe)return}const qe=()=>{e.save(),e.beginPath(),e.rect(Oe,be,bt,yt),e.clip()},ae=B.columns.hasIndex(ie.sourceIndex),Ue=g(ie.group??"").overrideTheme,Ee=ie.themeOverride===void 0&&Ue===void 0?C:$t(C,Ue,ie.themeOverride),Le=Ee.baseFontFull;Le!==ge&&(ge=Le,e.font=Le),qe();let J;return En(Qe,Se,o,a,c,v,w,me,(xe,se,ye,N,_)=>{var St,st,lt;if(se<0||(U[0]=ie.sourceIndex,U[1]=se,I!==void 0&&!I.has(U)))return;if(p.length>0){let te=!1;for(let Be=0;Be<p.length;Be++){const we=p[Be];if(rn(ze,xe,ie.width,ye,we.x,we.y,we.width,we.height)){te=!0;break}}if(!te)return}const ce=B.rows.hasIndex(se),ee=h.hasIndex(se),re=se<a?u(U):Tr;let Ie=ze,de=ie.width,j=!1,Pe=!1;if(re.span!==void 0){const[te,Be]=re.span,we=`${se},${te},${Be},${ie.sticky}`;if(X===void 0&&(X=new Set),X.has(we)){oe--;return}else{const at=mi(re.span,ze,xe,ie.width,ye,ie,n),Ge=ie.sticky?at[0]:at[1];if(!ie.sticky&&at[0]!==void 0&&(Pe=!0),Ge!==void 0){Ie=Ge.x,de=Ge.width,X.add(we),e.restore(),J=void 0,e.save(),e.beginPath();const vt=Math.max(0,ke-Ge.x);e.rect(Ge.x+vt,xe,Ge.width-vt,ye),Me===void 0&&(Me=[]),Me.push({x:Ge.x+vt,y:xe,width:Ge.width-vt,height:ye}),e.clip(),j=!0}}}const je=m==null?void 0:m(se),Ke=_&&((St=ie.trailingRowOptions)==null?void 0:St.themeOverride)!==void 0?(st=ie.trailingRowOptions)==null?void 0:st.themeOverride:void 0,Fe=re.themeOverride===void 0&&je===void 0&&Ke===void 0?Ee:$t(Ee,je,Ke,re.themeOverride);e.beginPath();const Ze=gr(U,re,B);let Ne=br(U,re,B,f);const Ht=re.span!==void 0&&B.columns.some(te=>re.span!==void 0&&te>=re.span[0]&&te<=re.span[1]);Ze&&!d&&f?Ne=0:Ze&&f&&(Ne=Math.max(Ne,1)),Ht&&Ne++,Ze||(ce&&Ne++,ae&&!_&&Ne++);const Pt=re.kind===le.Protected?Fe.bgCellMedium:Fe.bgCell;let ve;if((N||Pt!==C.bgCell)&&(ve=Je(Pt,ve)),Ne>0||ee){ee&&(ve=Je(Fe.bgHeader,ve));for(let te=0;te<Ne;te++)ve=Je(Fe.accentLight,ve)}else if(A!==void 0){for(const te of A)if(te[0]===ie.sourceIndex&&te[1]===se){ve=Je(Fe.bgSearchResult,ve);break}}if(E!==void 0)for(let te=0;te<E.length;te++){const Be=E[te],we=Be.range;Be.style!=="solid-outline"&&we.x<=ie.sourceIndex&&ie.sourceIndex<we.x+we.width&&we.y<=se&&se<we.y+we.height&&(ve=Je(Be.color,ve))}let Ct=!1;if(I!==void 0){const te=xe+1,we=(N?te+ye-1:Math.min(te+ye-1,o-He))-te;(we!==ye-1||Ie+1<=ke)&&(Ct=!0,e.save(),e.beginPath(),e.rect(Ie+1,te,de-1,we),e.clip()),ve=ve===void 0?Fe.bgCell:Je(ve,Fe.bgCell)}const ut=ie.sourceIndex===n.length-1,pe=se===a-1;ve!==void 0&&(e.fillStyle=ve,J!==void 0&&(J.fillStyle=ve),I!==void 0?e.fillRect(Ie+1,xe+1,de-(ut?2:1),ye-(pe?2:1)):e.fillRect(Ie,xe,de,ye)),re.style==="faded"&&(e.globalAlpha=.6);let _e;for(let te=0;te<x.length;te++){const Be=x[te];if(Be.item[0]===ie.sourceIndex&&Be.item[1]===se){_e=Be;break}}if(de>ne&&!Pe){const te=Fe.baseFontFull;te!==ge&&(e.font=te,ge=te),J=yi(e,re,ie.sourceIndex,se,ut,pe,Ie,xe,de,ye,Ne>0,Fe,ve??Fe.bgCell,H,z,(_e==null?void 0:_e.hoverAmount)??0,D,S,fe,M,J,k,Y,L,q)}return Ct&&e.restore(),re.style==="faded"&&(e.globalAlpha=1),oe--,j&&(e.restore(),(lt=J==null?void 0:J.deprep)==null||lt.call(J,$e),J=void 0,qe(),ge=Le,e.font=Le),oe<=0}),e.restore(),oe<=0}),Me}const jt=[0,0],Kt={x:0,y:0,width:0,height:0},Xn=[void 0,()=>{}];let Qn=!1;function Wr(){Qn=!0}function yi(e,t,n,o,i,r,l,s,a,c,u,g,m,h,d,f,v,w,p,I,B,A,E,H,z){var Y,L;let x,D;v!==void 0&&v[0][0]===n&&v[0][1]===o&&(x=v[1][0],D=v[1][1]);let M;jt[0]=n,jt[1]=o,Kt.x=l,Kt.y=s,Kt.width=a,Kt.height=c,Xn[0]=E.getValue(jt),Xn[1]=q=>E.setValue(jt,q),Qn=!1;const S={ctx:e,theme:g,col:n,row:o,cell:t,rect:Kt,highlighted:u,cellFillColor:m,hoverAmount:f,frameTime:p,hoverX:x,drawState:Xn,hoverY:D,imageLoader:h,spriteManager:d,hyperWrapping:w,overrideCursor:x!==void 0?z:void 0,requestAnimationFrame:Wr},C=xr(S,t.lastUpdated,p,B,i,r),k=H(t);if(k!==void 0){(B==null?void 0:B.renderer)!==k&&((Y=B==null?void 0:B.deprep)==null||Y.call(B,S),B=void 0);const q=(L=k.drawPrep)==null?void 0:L.call(k,S,B);I!==void 0&&!Qo(S.cell)?I(S,()=>k.draw(S,t)):k.draw(S,t),M=q===void 0?void 0:{deprep:q==null?void 0:q.deprep,fillStyle:q==null?void 0:q.fillStyle,font:q==null?void 0:q.font,renderer:k}}return(C||Qn)&&(A==null||A(jt)),M}function lo(e,t,n,o,i,r,l,s,a=-20,c=-20,u=void 0,g="center",m="square"){const h=Math.floor(i+l/2),d=m==="circle"?1e4:t.roundingRadius??4;let f=ti(u??t.checkboxMaxSize,l,t.cellVerticalPadding),v=f/2;const w=ei(g,o,r,t.cellHorizontalPadding,f),p=Zo(w,h,f),I=ni(o+a,i+c,p);switch(n){case!0:{e.beginPath(),dt(e,w-f/2,h-f/2,f,f,d),m==="circle"&&(v*=.8,f*=.8),e.fillStyle=s?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(w-v+f/4.23,h-v+f/1.97),e.lineTo(w-v+f/2.42,h-v+f/1.44),e.lineTo(w-v+f/1.29,h-v+f/3.25),e.strokeStyle=t.rowMarkerIcon??t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case Sn:case!1:{e.beginPath(),dt(e,w-f/2+.5,h-f/2+.5,f-1,f-1,d),e.lineWidth=1,e.strokeStyle=I?t.textDark:t.textMedium,e.stroke();break}case eo:{e.beginPath(),dt(e,w-f/2,h-f/2,f,f,d),e.fillStyle=I?t.textMedium:t.textLight,e.fill(),m==="circle"&&(v*=.8,f*=.8),e.beginPath(),e.moveTo(w-f/3,h),e.lineTo(w+f/3,h),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:Zn()}}function zr(e,t,n,o,i,r,l,s,a,c,u,g,m,h,d,f,v,w,p){var x,D,M,S;const I=l+s;if(I<=0)return;e.fillStyle=g.bgHeader,e.fillRect(0,0,i,I);const B=(x=o==null?void 0:o[0])==null?void 0:x[0],A=(D=o==null?void 0:o[0])==null?void 0:D[1],E=(M=o==null?void 0:o[1])==null?void 0:M[0],H=(S=o==null?void 0:o[1])==null?void 0:S[1],z=g.headerFontFull;e.font=z,xt(t,0,r,0,I,(C,k,Y,L)=>{var ie;if(v!==void 0&&!v.has([C.sourceIndex,-1]))return;const q=Math.max(0,L-k);e.save(),e.beginPath(),e.rect(k+q,s,C.width-q,l),e.clip();const ne=f(C.group??"").overrideTheme,oe=C.themeOverride===void 0&&ne===void 0?g:$t(g,ne,C.themeOverride);oe.bgHeader!==g.bgHeader&&(e.fillStyle=oe.bgHeader,e.fill()),oe!==g&&(e.font=oe.headerFontFull);const fe=u.columns.hasIndex(C.sourceIndex),ge=a!==void 0||c||C.headerRowMarkerDisabled===!0,$e=!ge&&A===-1&&B===C.sourceIndex,U=ge?0:((ie=h.find(ze=>ze.item[0]===C.sourceIndex&&ze.item[1]===-1))==null?void 0:ie.hoverAmount)??0,He=(u==null?void 0:u.current)!==void 0&&u.current.cell[0]===C.sourceIndex,Me=fe?oe.accentColor:He?oe.bgHeaderHasFocus:oe.bgHeader,X=n?s:0,me=C.sourceIndex===0?0:1;fe?(e.fillStyle=Me,e.fillRect(k+me,X,C.width-me,l)):(He||U>0)&&(e.beginPath(),e.rect(k+me,X,C.width-me,l),He&&(e.fillStyle=oe.bgHeaderHasFocus,e.fill()),U>0&&(e.globalAlpha=U,e.fillStyle=oe.bgHeaderHovered,e.fill(),e.globalAlpha=1)),wi(e,k,X,C.width,l,C,fe,oe,$e,$e?E:void 0,$e?H:void 0,He,U,m,w,p),e.restore()}),n&&Lr(e,t,i,r,s,o,g,m,h,d,f,v)}function Lr(e,t,n,o,i,r,l,s,a,c,u,g){const m=l.cellHorizontalPadding,[h,d]=(r==null?void 0:r[0])??[];let f=0;gi(t,n,o,i,(v,w,p,I,B,A)=>{if(g!==void 0&&!g.hasItemInRectangle({x:v[0],y:-2,width:v[1]-v[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(p,I,B,A),e.clip();const E=u(w),H=(E==null?void 0:E.overrideTheme)===void 0?l:$t(l,E.overrideTheme),z=d===-2&&h!==void 0&&h>=v[0]&&h<=v[1],x=z?H.bgGroupHeaderHovered??H.bgHeaderHovered:H.bgGroupHeader??H.bgHeader;if(x!==l.bgHeader&&(e.fillStyle=x,e.fill()),e.fillStyle=H.textGroupHeader??H.textHeader,E!==void 0){let D=p;if(E.icon!==void 0&&(s.drawSprite(E.icon,"normal",e,D+m,(i-20)/2,20,H),D+=26),e.fillText(E.name,D+m,i/2+kt(e,l.headerFontFull)),E.actions!==void 0&&z){const M=vi({x:p,y:I,width:B,height:A},E.actions);e.beginPath();const S=M[0].x-10,C=p+B-S;e.rect(S,0,C,i);const k=e.createLinearGradient(S,0,S+C,0),Y=ln(x,0);k.addColorStop(0,Y),k.addColorStop(10/C,x),k.addColorStop(1,x),e.fillStyle=k,e.fill(),e.globalAlpha=.6;const[L,q]=(r==null?void 0:r[1])??[-1,-1];for(let ne=0;ne<E.actions.length;ne++){const oe=E.actions[ne],fe=M[ne],ge=Nt(fe,L+p,q);ge&&(e.globalAlpha=1),s.drawSprite(oe.icon,"normal",e,fe.x+fe.width/2-10,fe.y+fe.height/2-10,20,H),ge&&(e.globalAlpha=.6)}e.globalAlpha=1}}p!==0&&c(v[0])&&(e.beginPath(),e.moveTo(p+.5,0),e.lineTo(p+.5,i),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()),e.restore(),f=p+B}),e.beginPath(),e.moveTo(f+.5,0),e.lineTo(f+.5,i),e.moveTo(0,i+.5),e.lineTo(n,i+.5),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()}const pn=30;function Nr(e,t,n,o,i){return{x:e+n-pn,y:Math.max(t,t+o/2-pn/2),width:pn,height:Math.min(pn,o)}}function vi(e,t){const n=[];let o=e.x+e.width-26*t.length;const i=e.y+e.height/2-13,r=26,l=26;for(let s=0;s<t.length;s++)n.push({x:o,y:i,width:l,height:r}),o+=26;return n}function Gt(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function pi(e,t,n,o,i,r,l,s){var A;const a=l.cellHorizontalPadding,c=l.headerIconSize,u=Nr(n,o,i,r),g=s||t.contentAlign==="right",m=t.contentAlign==="center";let h=n+a,d,f;const v=t.icon!==void 0&&t.icon!==null;v&&(d={x:g?n+i-a-c:h,y:o+(r-c)/2,width:c,height:c},g||(h+=Math.ceil(c*1.3)),t.overlayIcon!==void 0&&(f={x:d.x+9,y:d.y+6,width:18,height:18}));const w=e===void 0?((A=ai(t.title,l.headerFontFull))==null?void 0:A.width)??0:rt(t.title,e,l.headerFontFull).width,p={x:m?n+(i-w)/2:g?n:h,y:o,width:m?w:g?i-(v?c+a:a):i-(h-n)-a,height:r};let I;t.indicatorIcon!==void 0&&(I={x:g?v?d.x-c-a:n+i-c-a:h+w+a,y:o+(r-c)/2,width:c,height:c});const B=n+i/2;return{menuBounds:Gt(u,B,s),iconBounds:Gt(d,B,s),iconOverlayBounds:Gt(f,B,s),textBounds:Gt(p,B,s),indicatorIconBounds:Gt(I,B,s)}}function zo(e,t,n,o,i,r,l,s,a,c,u,g,m,h,d,f){if(r.rowMarker!==void 0&&r.headerRowMarkerDisabled!==!0){const p=r.rowMarkerChecked;p!==!0&&r.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=g);const I=r.headerRowMarkerTheme!==void 0?$t(s,r.headerRowMarkerTheme):s;lo(e,I,p,t,n,o,i,!1,void 0,void 0,s.checkboxMaxSize,"center",r.rowMarker),p!==!0&&r.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const v=l?s.textHeaderSelected:s.textHeader,w=r.hasMenu===!0&&(a||h&&l)&&f.menuBounds!==void 0;if(r.icon!==void 0&&f.iconBounds!==void 0){let p=l?"selected":"normal";r.style==="highlight"&&(p=l?"selected":"special"),m.drawSprite(r.icon,p,e,f.iconBounds.x,f.iconBounds.y,f.iconBounds.width,s),r.overlayIcon!==void 0&&f.iconOverlayBounds!==void 0&&m.drawSprite(r.overlayIcon,l?"selected":"special",e,f.iconOverlayBounds.x,f.iconOverlayBounds.y,f.iconOverlayBounds.width,s)}if(w&&o>35){const I=d?35:o-35,B=d?35*.7:o-35*.7,A=I/o,E=B/o,H=e.createLinearGradient(t,0,t+o,0),z=ln(v,0);H.addColorStop(d?1:0,v),H.addColorStop(A,v),H.addColorStop(E,z),H.addColorStop(d?0:1,z),e.fillStyle=H}else e.fillStyle=v;if(f.textBounds!==void 0){const p=d||r.contentAlign==="right";e.textAlign=p?"right":"left";const I=p?f.textBounds.x+f.textBounds.width:f.textBounds.x;e.fillText(r.title,I,n+i/2+kt(e,s.headerFontFull))}if(r.indicatorIcon!==void 0&&f.indicatorIconBounds!==void 0&&(!w||!rn(f.menuBounds.x,f.menuBounds.y,f.menuBounds.width,f.menuBounds.height,f.indicatorIconBounds.x,f.indicatorIconBounds.y,f.indicatorIconBounds.width,f.indicatorIconBounds.height))){let p=l?"selected":"normal";r.style==="highlight"&&(p=l?"selected":"special"),m.drawSprite(r.indicatorIcon,p,e,f.indicatorIconBounds.x,f.indicatorIconBounds.y,f.indicatorIconBounds.width,s)}if(w&&f.menuBounds!==void 0){const p=f.menuBounds,I=c!==void 0&&u!==void 0&&Nt(p,c+t,u+n);if(I||(e.globalAlpha=.7),r.menuIcon===void 0||r.menuIcon===qn.Triangle){e.beginPath();const B=p.x+p.width/2-5.5,A=p.y+p.height/2-3;Mr(e,[{x:B,y:A},{x:B+11,y:A},{x:B+5.5,y:A+6}],1),e.fillStyle=v,e.fill()}else if(r.menuIcon===qn.Dots){e.beginPath();const B=p.x+p.width/2,A=p.y+p.height/2;Ir(e,B,A),e.fillStyle=v,e.fill()}else{const B=p.x+(p.width-s.headerIconSize)/2,A=p.y+(p.height-s.headerIconSize)/2;m.drawSprite(r.menuIcon,"normal",e,B,A,s.headerIconSize,s)}I||(e.globalAlpha=1)}}function wi(e,t,n,o,i,r,l,s,a,c,u,g,m,h,d,f){const v=oo(r.title)==="rtl",w=pi(e,r,t,n,o,i,s,v);d!==void 0?d({ctx:e,theme:s,rect:{x:t,y:n,width:o,height:i},column:r,columnIndex:r.sourceIndex,isSelected:l,hoverAmount:m,isHovered:a,hasSelectedCell:g,spriteManager:h,menuBounds:(w==null?void 0:w.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:c,hoverY:u},()=>zo(e,t,n,o,i,r,l,s,a,c,u,m,h,f,v,w)):zo(e,t,n,o,i,r,l,s,a,c,u,m,h,f,v,w)}function Or(e,t,n,o,i,r,l,s,a,c,u,g,m,h,d,f,v,w,p){if(w!==void 0||t[t.length-1]!==n[t.length-1])return;const I=hi(v);xt(t,a,l,s,r,(B,A,E,H,z)=>{if(B!==t[t.length-1])return;A+=B.width;const x=Math.max(A,H);x>o||(e.save(),e.beginPath(),e.rect(x,r+1,1e4,i-r-1),e.clip(),En(z,E,i,c,u,d,f,I,(D,M,S,C)=>{if(!C&&v.length>0&&!v.some(ne=>rn(A,D,1e4,S,ne.x,ne.y,ne.width,ne.height)))return;const k=m.hasIndex(M),Y=h.hasIndex(M);e.beginPath();const L=g==null?void 0:g(M),q=L===void 0?p:$t(p,L);q.bgCell!==p.bgCell&&(e.fillStyle=q.bgCell,e.fillRect(A,D,1e4,S)),Y&&(e.fillStyle=q.bgHeader,e.fillRect(A,D,1e4,S)),k&&(e.fillStyle=q.accentLight,e.fillRect(A,D,1e4,S))}),e.restore())})}function Xr(e,t,n,o,i,r,l,s,a){let c=!1;for(const d of t)if(!d.sticky){c=l(d.sourceIndex);break}const u=a.horizontalBorderColor??a.borderColor,g=a.borderColor,m=c?Xt(t):0;let h;if(m!==0&&(h=To(g,a.bgCell),e.beginPath(),e.moveTo(m+.5,0),e.lineTo(m+.5,o),e.strokeStyle=h,e.stroke()),i>0){const d=g===u&&h!==void 0?h:To(u,a.bgCell),f=Yt(r,i,s);e.beginPath(),e.moveTo(0,o-f+.5),e.lineTo(n,o-f+.5),e.strokeStyle=d,e.stroke()}}const ki=(e,t,n)=>{let o=0,i=t,r=0,l=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;for(const s of e)o=Math.min(o,s.x-1),i=Math.max(i,s.x+s.width+1),r=Math.min(r,s.y-1),l=Math.max(l,s.y+s.height+1)}return{minX:o,maxX:i,minY:r,maxY:l}};function $r(e,t,n,o,i,r,l,s,a,c,u,g,m,h,d){var S;const f=d.bgCell,{minX:v,maxX:w,minY:p,maxY:I}=ki(s,r,l),B=[],A=l-Yt(h,m,c);let E=a,H=n,z=0;for(;E+i<A;){const C=E+i,k=c(H);if(C>=p&&C<=I-1){const Y=u==null?void 0:u(H),L=Y==null?void 0:Y.bgCell;L!==void 0&&L!==f&&H>=h-m&&B.push({x:v,y:C,w:w-v,h:k,color:L})}E+=k,H<h-m&&(z=E),H++}let x=0;const D=Math.min(A,I)-z;if(D>0)for(let C=0;C<t.length;C++){const k=t[C];if(k.width===0)continue;const Y=k.sticky?x:x+o,L=(S=k.themeOverride)==null?void 0:S.bgCell;L!==void 0&&L!==f&&Y>=v&&Y<=w&&g(C+1)&&B.push({x:Y,y:z,w:k.width,h:D,color:L}),x+=k.width}if(B.length===0)return;let M;e.beginPath();for(let C=B.length-1;C>=0;C--){const k=B[C];M===void 0?M=k.color:k.color!==M&&(e.fillStyle=M,e.fill(),e.beginPath(),M=k.color),e.rect(k.x,k.y,k.w,k.h)}M!==void 0&&(e.fillStyle=M,e.fill()),e.beginPath()}function Lo(e,t,n,o,i,r,l,s,a,c,u,g,m,h,d,f,v,w=!1){if(a!==void 0){e.beginPath(),e.save(),e.rect(0,0,r,l);for(const S of a)e.rect(S.x+1,S.y+1,S.width-1,S.height-1);e.clip("evenodd")}const p=v.horizontalBorderColor??v.borderColor,I=v.borderColor,{minX:B,maxX:A,minY:E,maxY:H}=ki(s,r,l),z=[];e.beginPath();let x=.5;for(let S=0;S<t.length;S++){const C=t[S];if(C.width===0)continue;x+=C.width;const k=C.sticky?x:x+o;k>=B&&k<=A&&h(S+1)&&z.push({x1:k,y1:Math.max(c,E),x2:k,y2:Math.min(l,H),color:I})}let D=l+.5;for(let S=f-d;S<f;S++){const C=g(S);D-=C,z.push({x1:B,y1:D,x2:A,y2:D,color:p})}if(w!==!0){let S=u+.5,C=n;const k=D;for(;S+i<k;){const Y=S+i;if(Y>=E&&Y<=H-1){const L=m==null?void 0:m(C);z.push({x1:B,y1:Y,x2:A,y2:Y,color:(L==null?void 0:L.horizontalBorderColor)??(L==null?void 0:L.borderColor)??p})}S+=g(C),C++}}const M=Qi(z,S=>S.color);for(const S of Object.keys(M)){e.strokeStyle=S;for(const C of M[S])e.moveTo(C.x1,C.y1),e.lineTo(C.x2,C.y2);e.stroke(),e.beginPath()}a!==void 0&&e.restore()}function Yr(e,t,n,o,i,r,l,s,a,c,u,g,m,h,d,f,v,w,p){const I=[];e.imageSmoothingEnabled=!1;const B=Math.min(i.cellYOffset,l),A=Math.max(i.cellYOffset,l);let E=0;if(typeof w=="number")E+=(A-B)*w;else for(let k=B;k<A;k++)E+=w(k);l>i.cellYOffset&&(E=-E),E+=a-i.translateY;const H=Math.min(i.cellXOffset,r),z=Math.max(i.cellXOffset,r);let x=0;for(let k=H;k<z;k++)x+=f[k].width;r>i.cellXOffset&&(x=-x),x+=s-i.translateX;const D=Xt(v);if(x!==0&&E!==0)return{regions:[]};const M=c>0?Yt(m,c,w):0,S=u-D-Math.abs(x),C=g-h-M-Math.abs(E)-1;if(S>150&&C>150){const k={sx:0,sy:0,sw:u*d,sh:g*d,dx:0,dy:0,dw:u*d,dh:g*d};if(E>0?(k.sy=(h+1)*d,k.sh=C*d,k.dy=(E+h+1)*d,k.dh=C*d,I.push({x:0,y:h,width:u,height:E+1})):E<0&&(k.sy=(-E+h+1)*d,k.sh=C*d,k.dy=(h+1)*d,k.dh=C*d,I.push({x:0,y:g+E-M,width:u,height:-E+M})),x>0?(k.sx=D*d,k.sw=S*d,k.dx=(x+D)*d,k.dw=S*d,I.push({x:D-1,y:0,width:x+2,height:g})):x<0&&(k.sx=(D-x)*d,k.sw=S*d,k.dx=D*d,k.dw=S*d,I.push({x:u+x,y:0,width:-x,height:g})),e.setTransform(1,0,0,1,0,0),p){if(D>0&&x!==0&&E===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const Y=D*d,L=g*d;e.drawImage(t,0,0,Y,L,0,0,Y,L)}if(M>0&&x===0&&E!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const Y=(g-M)*d,L=u*d,q=M*d;e.drawImage(t,0,Y,L,q,0,Y,L,q)}}e.drawImage(t,k.sx,k.sy,k.sw,k.sh,k.dx,k.dy,k.dw,k.dh),e.scale(d,d)}return e.imageSmoothingEnabled=!0,{regions:I}}function _r(e,t,n,o,i,r,l,s,a,c){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||i!==e.translateY||xt(a,n,o,i,s,(g,m,h,d)=>{if(g.sourceIndex===c){const f=Math.max(m,d)+1;return u.push({x:f,y:0,width:r-f,height:l}),!0}}),u}function Vr(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const i=e.mappedColumns[o],r=t.mappedColumns[o];if(Ot(i,r))continue;if(n!==void 0||i.width===r.width)return!1;const{width:l,...s}=i,{width:a,...c}=r;if(!Ot(s,c))return!1;n=o}return n===void 0?!0:n}return!0}function No(e,t,n,o,i,r,l,s,a,c,u,g,m,h,d,f){const v=d==null?void 0:d.filter(H=>H.style!=="no-outline");if(v===void 0||v.length===0)return;const w=Xt(s),p=Yt(h,m,g),I=[a,0,s.length,h-m],B=[w,0,t,n-p],A=v.map(H=>{const z=H.range,x=H.style??"dashed";return Rr(z,I,t,n,B).map(D=>{const M=D.rect,S=Gn(M.x,M.y,t,n,u,c+u,o,i,r,l,h,a,m,s,g),C=M.width===1&&M.height===1?S:Gn(M.x+M.width-1,M.y+M.height-1,t,n,u,c+u,o,i,r,l,h,a,m,s,g);return M.x+M.width>=s.length&&(C.width-=1),M.y+M.height>=h&&(C.height-=1),{color:H.color,style:x,clip:D.clip,rect:Dr({x:S.x,y:S.y,width:C.x+C.width-S.x,height:C.y+C.height-S.y},t,n,8)}})}),E=()=>{e.lineWidth=1;let H=!1;for(const z of A)for(const x of z)if((x==null?void 0:x.rect)!==void 0&&rn(0,0,t,n,x.rect.x,x.rect.y,x.rect.width,x.rect.height)){const D=H,M=!Pr(x.clip,x.rect);e.beginPath(),M&&(e.save(),e.rect(x.clip.x,x.clip.y,x.clip.width,x.clip.height),e.clip()),x.style==="dashed"&&!H?(e.setLineDash([5,3]),H=!0):(x.style==="solid"||x.style==="solid-outline")&&H&&(e.setLineDash([]),H=!1),e.strokeStyle=x.style==="solid-outline"?Je(Je(x.color,f.borderColor),f.bgCell):ln(x.color,1),e.closePath(),e.strokeRect(x.rect.x+.5,x.rect.y+.5,x.rect.width-1,x.rect.height-1),M&&(e.restore(),H=D)}H&&e.setLineDash([])};return E(),E}function Oo(e,t,n,o,i){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=i,e.stroke(),e.globalAlpha=1}function $n(e,t,n,o,i,r,l,s,a,c,u,g,m,h,d,f,v){if(u.current===void 0)return;const w=f!==!1&&f!==void 0;if(!w)return;const p=typeof f=="object"?{...In,...f}:In,I=u.current.range,B=u.current.cell,A=[I.x+I.width-1,I.y+I.height-1];if(B[1]>=v&&A[1]>=v||!l.some(L=>L.sourceIndex===B[0]||L.sourceIndex===A[0]))return;const[H,z]=u.current.cell,x=m(u.current.cell),D=x.span??[H,H],M=z>=v-h,S=h>0&&!M?Yt(v,h,g)-1:0,C=A[1];let k;if(xt(l,o,i,r,c,(L,q,ne,oe,fe)=>{if(L.sticky&&H>L.sourceIndex)return;const ge=L.sourceIndex<D[0],$e=L.sourceIndex>D[1],U=L.sourceIndex===A[0];if(!(!U&&(ge||$e)))return En(fe,ne,n,v,g,h,d,void 0,(He,Me,X)=>{if(Me!==z&&Me!==C)return;let me=q,ie=L.width;if(x.span!==void 0){const Se=mi(x.span,q,He,L.width,X,L,s),ke=L.sticky?Se[0]:Se[1];ke!==void 0&&(me=ke.x,ie=ke.width)}return Me===C&&U&&w&&(k=()=>{var Oe;oe>me&&!L.sticky&&(e.beginPath(),e.rect(oe,0,t-oe,n),e.clip());const Se=p.size,ke=Se/2,Qe=me+ie+p.offsetX-ke+.5,Ye=He+X+p.offsetY-ke+.5;e.beginPath(),p.shape==="circle"?e.arc(Qe+ke,Ye+ke,ke,0,Math.PI*2):e.rect(Qe,Ye,Se,Se),e.fillStyle=((Oe=L.themeOverride)==null?void 0:Oe.accentColor)??a.accentColor,e.fill(),p.outline>0&&(e.lineWidth=p.outline,e.strokeStyle=a.bgCell,p.shape==="circle"?(e.beginPath(),e.arc(Qe+ke,Ye+ke,ke+p.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(Qe-p.outline/2,Ye-p.outline/2,Se+p.outline,Se+p.outline))}),k!==void 0}),k!==void 0}),k===void 0)return;const Y=()=>{e.save(),e.beginPath(),e.rect(0,c,t,n-c-S),e.clip(),k==null||k(),e.restore()};return Y(),Y}function qr(e,t,n,o,i,r,l,s,a){a===void 0||a.size===0||(e.beginPath(),gi(t,n,r,o,(c,u,g,m,h,d)=>{a.hasItemInRectangle({x:c[0],y:-2,width:c[1]-c[0]+1,height:1})&&e.rect(g,m,h,d)}),xt(t,s,r,l,i,(c,u,g,m)=>{const h=Math.max(0,m-u),d=u+h+1,f=c.width-h-1;a.has([c.sourceIndex,-1])&&e.rect(d,o,f,i-o)}),e.clip())}function Ur(e,t,n,o,i,r,l,s,a,c){let u=0;return xt(e,r,o,i,n,(g,m,h,d,f)=>(En(f,h,t,l,s,a,c,void 0,(v,w,p,I)=>{I||(u=Math.max(w,u))}),!0)),u}function Xo(e,t){var ut;const{canvasCtx:n,headerCanvasCtx:o,width:i,height:r,cellXOffset:l,cellYOffset:s,translateX:a,translateY:c,mappedColumns:u,enableGroups:g,freezeColumns:m,dragAndDropState:h,theme:d,drawFocus:f,headerHeight:v,groupHeaderHeight:w,disabledRows:p,rowHeight:I,verticalBorder:B,overrideCursor:A,isResizing:E,selection:H,fillHandle:z,freezeTrailingRows:x,rows:D,getCellContent:M,getGroupDetails:S,getRowThemeOverride:C,isFocused:k,drawHeaderCallback:Y,prelightCells:L,drawCellCallback:q,highlightRegions:ne,resizeCol:oe,imageLoader:fe,lastBlitData:ge,hoverValues:$e,hyperWrapping:U,hoverInfo:He,spriteManager:Me,maxScaleFactor:X,hasAppendRow:me,touchMode:ie,enqueue:ze,renderStateProvider:Se,getCellRenderer:ke,renderStrategy:Qe,bufferACtx:Ye,bufferBCtx:Oe,damage:be,minimumCellWidth:bt,resizeIndicator:yt}=e;if(i===0||r===0)return;const qe=Qe==="double-buffer",ae=Math.min(X,Math.ceil(window.devicePixelRatio??1)),Ue=Qe!=="direct"&&Vr(e,t),Ee=n.canvas;(Ee.width!==i*ae||Ee.height!==r*ae)&&(Ee.width=i*ae,Ee.height=r*ae,Ee.style.width=i+"px",Ee.style.height=r+"px");const Le=o.canvas,J=g?w+v:v,xe=J+1;(Le.width!==i*ae||Le.height!==xe*ae)&&(Le.width=i*ae,Le.height=xe*ae,Le.style.width=i+"px",Le.style.height=xe+"px");const se=Ye.canvas,ye=Oe.canvas;qe&&(se.width!==i*ae||se.height!==r*ae)&&(se.width=i*ae,se.height=r*ae,ge.current!==void 0&&(ge.current.aBufferScroll=void 0)),qe&&(ye.width!==i*ae||ye.height!==r*ae)&&(ye.width=i*ae,ye.height=r*ae,ge.current!==void 0&&(ge.current.bBufferScroll=void 0));const N=ge.current;if(Ue===!0&&l===(N==null?void 0:N.cellXOffset)&&s===(N==null?void 0:N.cellYOffset)&&a===(N==null?void 0:N.translateX)&&c===(N==null?void 0:N.translateY))return;let _=null;qe&&(_=n);const ce=o;let ee;qe?be!==void 0?ee=(N==null?void 0:N.lastBuffer)==="b"?Oe:Ye:ee=(N==null?void 0:N.lastBuffer)==="b"?Ye:Oe:ee=n;const re=ee.canvas,Ie=qe?re===se?ye:se:Ee,de=typeof I=="number"?()=>I:I;ce.save(),ee.save(),ce.beginPath(),ee.beginPath(),ce.textBaseline="middle",ee.textBaseline="middle",ae!==1&&(ce.scale(ae,ae),ee.scale(ae,ae));const j=Kn(u,l,i,h,a);let Pe=[];const je=f&&((ut=H.current)==null?void 0:ut.cell[1])===s&&c===0;let Ke=!1;if(ne!==void 0){for(const pe of ne)if(pe.style!=="no-outline"&&pe.range.y===s&&c===0){Ke=!0;break}}const Fe=()=>{zr(ce,j,g,He,i,a,v,w,h,E,H,d,Me,$e,B,S,be,Y,ie),Lo(ce,j,s,a,c,i,r,void 0,void 0,w,J,de,C,B,x,D,d,!0),ce.beginPath(),ce.moveTo(0,xe-.5),ce.lineTo(i,xe-.5),ce.strokeStyle=Je(d.headerBottomBorderColor??d.horizontalBorderColor??d.borderColor,d.bgHeader),ce.stroke(),Ke&&No(ce,i,r,l,s,a,c,u,m,v,w,I,x,D,ne,d),je&&$n(ce,i,r,s,a,c,j,u,d,J,H,de,M,x,me,z,D)};if(be!==void 0){const pe=j[j.length-1].sourceIndex+1,_e=be.hasItemInRegion([{x:l,y:-2,width:pe,height:2},{x:l,y:s,width:pe,height:300},{x:0,y:s,width:m,height:300},{x:0,y:-2,width:m,height:2},{x:l,y:D-x,width:pe,height:x,when:x>0}]),St=st=>{Wo(st,j,u,r,J,a,c,s,D,de,M,S,C,p,k,f,x,me,Pe,be,H,L,ne,fe,Me,$e,He,q,U,d,ze,Se,ke,A,bt);const lt=H.current;z!==!1&&z!==void 0&&f&&lt!==void 0&&be.has(ii(lt.range))&&$n(st,i,r,s,a,c,j,u,d,J,H,de,M,x,me,z,D)};_e&&(St(ee),_!==null&&(_.save(),_.scale(ae,ae),_.textBaseline="middle",St(_),_.restore()),be.hasHeader()&&(qr(ce,j,i,w,J,a,c,s,be),Fe())),ee.restore(),ce.restore();return}if((Ue!==!0||l!==(N==null?void 0:N.cellXOffset)||a!==(N==null?void 0:N.translateX)||je!==(N==null?void 0:N.mustDrawFocusOnHeader)||Ke!==(N==null?void 0:N.mustDrawHighlightRingsOnHeader))&&Fe(),Ue===!0){ht(Ie!==void 0&&N!==void 0);const{regions:pe}=Yr(ee,Ie,Ie===se?N.aBufferScroll:N.bBufferScroll,Ie===se?N.bBufferScroll:N.aBufferScroll,N,l,s,a,c,x,i,r,D,J,ae,u,j,I,qe);Pe=pe}else Ue!==!1&&(ht(N!==void 0),Pe=_r(N,l,s,a,c,i,r,J,j,Ue));Xr(ee,j,i,r,x,D,B,de,d);const Ze=No(ee,i,r,l,s,a,c,u,m,v,w,I,x,D,ne,d),Ne=f?$n(ee,i,r,s,a,c,j,u,d,J,H,de,M,x,me,z,D):void 0;if(ee.fillStyle=d.bgCell,Pe.length>0){ee.beginPath();for(const pe of Pe)ee.rect(pe.x,pe.y,pe.width,pe.height);ee.clip(),ee.fill(),ee.beginPath()}else ee.fillRect(0,0,i,r);Or(ee,j,u,i,r,J,a,c,s,D,de,C,H.rows,p,x,me,Pe,be,d),$r(ee,j,s,a,c,i,r,Pe,J,de,C,B,x,D,d);const Ht=Wo(ee,j,u,r,J,a,c,s,D,de,M,S,C,p,k,f,x,me,Pe,be,H,L,ne,fe,Me,$e,He,q,U,d,ze,Se,ke,A,bt);Lo(ee,j,s,a,c,i,r,Pe,Ht,w,J,de,C,B,x,D,d),Ze==null||Ze(),Ne==null||Ne(),E&&yt!=="none"&&xt(j,0,a,0,J,(pe,_e)=>pe.sourceIndex===oe?(Oo(ce,_e+pe.width,0,J+1,Je(d.resizeIndicatorColor??d.accentLight,d.bgHeader)),yt==="full"&&Oo(ee,_e+pe.width,J,r,Je(d.resizeIndicatorColor??d.accentLight,d.bgCell)),!0):!1),_!==null&&(_.fillStyle=d.bgCell,_.fillRect(0,0,i,r),_.drawImage(ee.canvas,0,0));const Pt=Ur(j,r,J,a,c,s,D,de,x,me);fe==null||fe.setWindow({x:l,y:s,width:j.length,height:Pt-s},m,Array.from({length:x},(pe,_e)=>D-1-_e));const ve=N!==void 0&&(l!==N.cellXOffset||a!==N.translateX),Ct=N!==void 0&&(s!==N.cellYOffset||c!==N.translateY);ge.current={cellXOffset:l,cellYOffset:s,translateX:a,translateY:c,mustDrawFocusOnHeader:je,mustDrawHighlightRingsOnHeader:Ke,lastBuffer:qe?re===se?"a":"b":void 0,aBufferScroll:re===se?[ve,Ct]:N==null?void 0:N.aBufferScroll,bBufferScroll:re===ye?[ve,Ct]:N==null?void 0:N.bBufferScroll},ee.restore(),ce.restore()}const jr=80;function Kr(e){const t=e-1;return t*t*t+1}class Gr{constructor(t){G(this,"currentHoveredItem");G(this,"leavingItems",[]);G(this,"lastAnimationTime");G(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>wn(o.item,t.item))||this.leavingItems.push(t)});G(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>wn(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});G(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});G(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});G(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:Kr(t.hoverAmount)})));G(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/jr;for(const r of this.leavingItems)r.hoverAmount=Cn(r.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=Cn(this.currentHoveredItem.hoverAmount+o,0,1));const i=this.getAnimatingItems();this.callback(i),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});G(this,"setHovered",t=>{var n;if(!wn((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Jr{constructor(t){G(this,"fn");G(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function ao(e){return new Jr(e)}const Qr=ao(()=>window.navigator.userAgent.includes("Firefox")),$o=ao(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),bl=ao(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Zr(e){const t=b.useRef([]),n=b.useRef(0),o=b.useRef(e);o.current=e;const i=b.useCallback(()=>{const r=()=>window.requestAnimationFrame(l),l=()=>{const s=t.current.map(so);t.current=[],o.current(new en(s)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?r:l)},[]);return b.useCallback(r=>{t.current.length===0&&i();const l=it(r[0],r[1]);t.current.includes(l)||t.current.push(l)},[i])}const At="header",Jt="group-header",Yo="out-of-bounds";var Qt=(e=>(e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End",e))(Qt||{});function es(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const ts=(e,t)=>{if(e.kind===le.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},ns=(e,t)=>{const{width:n,height:o,accessibilityHeight:i,columns:r,cellXOffset:l,cellYOffset:s,headerHeight:a,fillHandle:c=!1,groupHeaderHeight:u,rowHeight:g,rows:m,getCellContent:h,getRowThemeOverride:d,onHeaderMenuClick:f,onHeaderIndicatorClick:v,enableGroups:w,isFilling:p,onCanvasFocused:I,onCanvasBlur:B,isFocused:A,selection:E,freezeColumns:H,onContextMenu:z,freezeTrailingRows:x,fixedShadowX:D=!0,fixedShadowY:M=!0,drawFocusRing:S,onMouseDown:C,onMouseUp:k,onMouseMoveRaw:Y,onMouseMove:L,onItemHovered:q,dragAndDropState:ne,firstColAccessible:oe,onKeyDown:fe,onKeyUp:ge,highlightRegions:$e,canvasRef:U,onDragStart:He,onDragEnd:Me,eventTargetRef:X,isResizing:me,resizeColumn:ie,isDragging:ze,isDraggable:Se=!1,allowResize:ke,disabledRows:Qe,hasAppendRow:Ye,getGroupDetails:Oe,theme:be,prelightCells:bt,headerIcons:yt,verticalBorder:qe,drawCell:ae,drawHeader:Ue,onCellFocused:Ee,onDragOverCell:Le,onDrop:J,onDragLeave:xe,imageWindowLoader:se,smoothScrollX:ye=!1,smoothScrollY:N=!1,experimental:_,getCellRenderer:ce,resizeIndicator:ee="full"}=e,re=e.translateX??0,Ie=e.translateY??0,de=Math.max(H,Math.min(r.length-1,l)),j=b.useRef(null),Pe=b.useRef((_==null?void 0:_.eventTarget)??window),je=Pe.current,Ke=se,Fe=b.useRef(),[Ze,Ne]=b.useState(!1),Ht=b.useRef([]),Pt=b.useRef(),[ve,Ct]=b.useState(),[ut,pe]=b.useState(),_e=b.useRef(null),[St,st]=b.useState(),[lt,te]=b.useState(!1),Be=b.useRef(lt);Be.current=lt;const we=b.useMemo(()=>new Br(yt,()=>{cn.current=void 0,_t.current()}),[yt]),at=w?u+a:a,Ge=b.useRef(-1),vt=((_==null?void 0:_.enableFirefoxRescaling)??!1)&&Qr.value,Bn=((_==null?void 0:_.enableSafariRescaling)??!1)&&$o.value;b.useLayoutEffect(()=>{window.devicePixelRatio===1||!vt&&!Bn||(Ge.current!==-1&&Ne(!0),window.clearTimeout(Ge.current),Ge.current=window.setTimeout(()=>{Ne(!1),Ge.current=-1},200))},[s,de,re,Ie,vt,Bn]);const Ce=hr(r,H),An=b.useMemo(()=>D?Xt(Ce,ne):0,[Ce,ne,D]),De=b.useCallback((y,F,W)=>{const T=y.getBoundingClientRect();if(F>=Ce.length||W>=m)return;const P=T.width/n,R=Gn(F,W,n,o,u,at,de,s,re,Ie,m,H,x,Ce,g);return P!==1&&(R.x*=P,R.y*=P,R.width*=P,R.height*=P),R.x+=T.x,R.y+=T.y,R},[n,o,u,at,de,s,re,Ie,m,H,x,Ce,g]),Re=b.useCallback((y,F,W,T)=>{const P=y.getBoundingClientRect(),R=P.width/n,V=(F-P.left)/R,K=(W-P.top)/R,O=5,Te=Kn(Ce,de,n,void 0,re);let $=0,ue=0;T instanceof MouseEvent&&($=T.button,ue=T.buttons);const Q=yr(V,Te,re),Z=vr(K,o,w,a,u,m,g,s,Ie,x),We=(T==null?void 0:T.shiftKey)===!0,tt=(T==null?void 0:T.ctrlKey)===!0,Ae=(T==null?void 0:T.metaKey)===!0,ft=T!==void 0&&!(T instanceof MouseEvent)||(T==null?void 0:T.pointerType)==="touch",pt=[V<0?-1:n<V?1:0,K<at?-1:o<K?1:0];let nt;if(Q===-1||K<0||V<0||Z===void 0||V>n||K>o){const he=V>n?1:V<0?-1:0,ot=K>o?1:K<0?-1:0;let ct=he*2,Ln=ot*2;he===0&&(ct=Q===-1?Qt.EndPadding:Qt.Center),ot===0&&(Ln=Z===void 0?Qt.EndPadding:Qt.Center);let zt=!1;if(Q===-1&&Z===-1){const Lt=De(y,Ce.length-1,-1);ht(Lt!==void 0),zt=F<Lt.x+Lt.width+O}const qt=V>n&&V<n+Ao()||K>o&&K<o+Ao();nt={kind:Yo,location:[Q!==-1?Q:V<0?0:Ce.length-1,Z??m-1],region:[ct,Ln],shiftKey:We,ctrlKey:tt,metaKey:Ae,isEdge:zt,isTouch:ft,button:$,buttons:ue,scrollEdge:pt,isMaybeScrollbar:qt}}else if(Z<=-1){let he=De(y,Q,Z);ht(he!==void 0);let ot=he!==void 0&&he.x+he.width-F<=O;const ct=Q-1;F-he.x<=O&&ct>=0?(ot=!0,he=De(y,ct,Z),ht(he!==void 0),nt={kind:w&&Z===-2?Jt:At,location:[ct,Z],bounds:he,group:Ce[ct].group??"",isEdge:ot,shiftKey:We,ctrlKey:tt,metaKey:Ae,isTouch:ft,localEventX:F-he.x,localEventY:W-he.y,button:$,buttons:ue,scrollEdge:pt}):nt={kind:w&&Z===-2?Jt:At,group:Ce[Q].group??"",location:[Q,Z],bounds:he,isEdge:ot,shiftKey:We,ctrlKey:tt,metaKey:Ae,isTouch:ft,localEventX:F-he.x,localEventY:W-he.y,button:$,buttons:ue,scrollEdge:pt}}else{const he=De(y,Q,Z);ht(he!==void 0);const ot=he!==void 0&&he.x+he.width-F<O;let ct=!1;if(c!==!1&&c!==void 0&&E.current!==void 0){const zt=typeof c=="object"?{...In,...c}:In,qt=zt.size,Lt=qt/2,Mo=ii(E.current.range),Ut=De(y,Mo[0],Mo[1]);if(Ut!==void 0){const _i=Ut.x+Ut.width+zt.offsetX-Lt+.5,Vi=Ut.y+Ut.height+zt.offsetY-Lt+.5;ct=Math.abs(_i-F)<qt&&Math.abs(Vi-W)<qt}}nt={kind:"cell",location:[Q,Z],bounds:he,isEdge:ot,shiftKey:We,ctrlKey:tt,isFillHandle:ct,metaKey:Ae,isTouch:ft,localEventX:F-he.x,localEventY:W-he.y,button:$,buttons:ue,scrollEdge:pt}}return nt},[n,Ce,de,re,o,w,a,u,m,g,s,Ie,x,De,c,E,at]),[It]=ve??[],co=b.useRef(()=>{}),Dt=b.useRef(ve);Dt.current=ve;const[Mt,Et]=b.useMemo(()=>{const y=document.createElement("canvas"),F=document.createElement("canvas");return y.style.display="none",y.style.opacity="0",y.style.position="fixed",F.style.display="none",F.style.opacity="0",F.style.position="fixed",[y.getContext("2d",{alpha:!1}),F.getContext("2d",{alpha:!1})]},[]);b.useLayoutEffect(()=>{if(!(Mt===null||Et===null))return document.documentElement.append(Mt.canvas),document.documentElement.append(Et.canvas),()=>{Mt.canvas.remove(),Et.canvas.remove()}},[Mt,Et]);const an=b.useMemo(()=>new Er,[]),uo=vt&&Ze?1:Bn&&Ze?2:5,fo=(_==null?void 0:_.disableMinimumCellWidth)===!0?1:10,cn=b.useRef(),dn=b.useRef(null),un=b.useRef(null),fn=b.useCallback(()=>{var V;const y=j.current,F=_e.current;if(y===null||F===null||(dn.current===null&&(dn.current=y.getContext("2d",{alpha:!1}),y.width=0,y.height=0),un.current===null&&(un.current=F.getContext("2d",{alpha:!1}),F.width=0,F.height=0),dn.current===null||un.current===null||Mt===null||Et===null))return;let W=!1;const T=K=>{W=!0,st(K)},P=cn.current,R={headerCanvasCtx:un.current,canvasCtx:dn.current,bufferACtx:Mt,bufferBCtx:Et,width:n,height:o,cellXOffset:de,cellYOffset:s,translateX:Math.round(re),translateY:Math.round(Ie),mappedColumns:Ce,enableGroups:w,freezeColumns:H,dragAndDropState:ne,theme:be,headerHeight:a,groupHeaderHeight:u,disabledRows:Qe??Un.empty(),rowHeight:g,verticalBorder:qe,isResizing:me,resizeCol:ie,isFocused:A,selection:E,fillHandle:c,drawCellCallback:ae,hasAppendRow:Ye,overrideCursor:T,maxScaleFactor:uo,freezeTrailingRows:x,rows:m,drawFocus:S,getCellContent:h,getGroupDetails:Oe??(K=>({name:K})),getRowThemeOverride:d,drawHeaderCallback:Ue,prelightCells:bt,highlightRegions:$e,imageLoader:Ke,lastBlitData:Pt,damage:Fe.current,hoverValues:Ht.current,hoverInfo:Dt.current,spriteManager:we,scrolling:Ze,hyperWrapping:(_==null?void 0:_.hyperWrapping)??!1,touchMode:lt,enqueue:co.current,renderStateProvider:an,renderStrategy:(_==null?void 0:_.renderStrategy)??($o.value?"double-buffer":"single-buffer"),getCellRenderer:ce,minimumCellWidth:fo,resizeIndicator:ee};R.damage===void 0?(cn.current=R,Xo(R,P)):Xo(R,void 0),!W&&(R.damage===void 0||R.damage.has((V=Dt==null?void 0:Dt.current)==null?void 0:V[0]))&&st(void 0)},[Mt,Et,n,o,de,s,re,Ie,Ce,w,H,ne,be,a,u,Qe,g,qe,me,Ye,ie,A,E,c,x,m,S,uo,h,Oe,d,ae,Ue,bt,$e,Ke,we,Ze,_==null?void 0:_.hyperWrapping,_==null?void 0:_.renderStrategy,lt,an,ce,fo,ee]),_t=b.useRef(fn);b.useLayoutEffect(()=>{fn(),_t.current=fn},[fn]),b.useLayoutEffect(()=>{(async()=>{var F;((F=document==null?void 0:document.fonts)==null?void 0:F.ready)!==void 0&&(await document.fonts.ready,cn.current=void 0,_t.current())})()},[]);const Rt=b.useCallback(y=>{Fe.current=y,_t.current(),Fe.current=void 0},[]),Si=Zr(Rt);co.current=Si;const ho=b.useCallback(y=>{Rt(new en(y.map(F=>F.cell)))},[Rt]);Ke.setCallback(Rt);const[Ii,Mi]=b.useState(!1),[Ft,Tt]=It??[],Ei=Ft!==void 0&&Tt===-1&&Ft>=0&&Ft<Ce.length&&Ce[Ft].headerRowMarkerDisabled!==!0,Fi=Ft!==void 0&&Tt===-2;let go=!1,mo=!1,hn=St;if(hn===void 0&&Ft!==void 0&&Tt!==void 0&&Tt>-1&&Tt<m){const y=h([Ft,Tt],!0);go=y.kind===on.NewRow||y.kind===on.Marker&&y.markerKind!=="number",mo=y.kind===le.Boolean&&to(y),hn=y.cursor}const bo=ze?"grabbing":(ut??!1)||me?"col-resize":Ii||p?"crosshair":hn!==void 0?hn:Ei||go||mo||Fi?"pointer":"default",Hn=b.useMemo(()=>({contain:"strict",display:"block",cursor:bo}),[bo]),yo=b.useRef("default"),Pn=X==null?void 0:X.current;Pn!=null&&yo.current!==Hn.cursor&&(Pn.style.cursor=yo.current=Hn.cursor);const gn=b.useCallback((y,F,W,T)=>{if(Oe===void 0)return;const P=Oe(y);if(P.actions!==void 0){const R=vi(F,P.actions);for(const[V,K]of R.entries())if(Nt(K,W+F.x,T+K.y))return P.actions[V]}},[Oe]),Wt=b.useCallback((y,F,W,T)=>{const P=Ce[F];if(!ze&&!me&&!(ut??!1)){const R=De(y,F,-1);ht(R!==void 0);const V=pi(void 0,P,R.x,R.y,R.width,R.height,be,oo(P.title)==="rtl");if(P.hasMenu===!0&&V.menuBounds!==void 0&&Nt(V.menuBounds,W,T))return{area:"menu",bounds:V.menuBounds};if(P.indicatorIcon!==void 0&&V.indicatorIconBounds!==void 0&&Nt(V.indicatorIconBounds,W,T))return{area:"indicator",bounds:V.indicatorIconBounds}}},[Ce,De,ut,ze,me,be]),Dn=b.useRef(0),Vt=b.useRef(),Rn=b.useRef(!1),vo=b.useCallback(y=>{const F=j.current,W=X==null?void 0:X.current;if(F===null||y.target!==F&&y.target!==W)return;Rn.current=!0;let T,P;if(y instanceof MouseEvent?(T=y.clientX,P=y.clientY):(T=y.touches[0].clientX,P=y.touches[0].clientY),y.target===W&&W!==null){const V=W.getBoundingClientRect();if(T>V.right||P>V.bottom)return}const R=Re(F,T,P,y);Vt.current=R.location,R.isTouch&&(Dn.current=Date.now()),Be.current!==R.isTouch&&te(R.isTouch),!(R.kind===At&&Wt(F,R.location[0],T,P)!==void 0)&&(R.kind===Jt&&gn(R.group,R.bounds,R.localEventX,R.localEventY)!==void 0||(C==null||C(R),!R.isTouch&&Se!==!0&&Se!==R.kind&&R.button<3&&R.button!==1&&y.preventDefault()))},[X,Se,Re,gn,Wt,C]);et("touchstart",vo,je,!1),et("mousedown",vo,je,!1);const po=b.useRef(0),wo=b.useCallback(y=>{var ue,Q;const F=po.current;po.current=Date.now();const W=j.current;if(Rn.current=!1,k===void 0||W===null)return;const T=X==null?void 0:X.current,P=y.target!==W&&y.target!==T;let R,V,K=!0;if(y instanceof MouseEvent){if(R=y.clientX,V=y.clientY,K=y.button<3,y.pointerType==="touch")return}else R=y.changedTouches[0].clientX,V=y.changedTouches[0].clientY;let O=Re(W,R,V,y);O.isTouch&&Dn.current!==0&&Date.now()-Dn.current>500&&(O={...O,isLongTouch:!0}),F!==0&&Date.now()-F<(O.isTouch?1e3:500)&&(O={...O,isDoubleClick:!0}),Be.current!==O.isTouch&&te(O.isTouch),!P&&y.cancelable&&K&&y.preventDefault();const[Te]=O.location,$=Wt(W,Te,R,V);if(O.kind===At&&$!==void 0){(O.button!==0||((ue=Vt.current)==null?void 0:ue[0])!==Te||((Q=Vt.current)==null?void 0:Q[1])!==-1)&&k(O,!0);return}else if(O.kind===Jt){const Z=gn(O.group,O.bounds,O.localEventX,O.localEventY);if(Z!==void 0){O.button===0&&Z.onClick(O);return}}k(O,P)},[k,X,Re,Wt,gn]);et("mouseup",wo,je,!1),et("touchend",wo,je,!1);const Bi=b.useCallback(y=>{var Te,$;const F=j.current;if(F===null)return;const W=X==null?void 0:X.current,T=y.target!==F&&y.target!==W;let P,R,V=!0;y instanceof MouseEvent?(P=y.clientX,R=y.clientY,V=y.button<3):(P=y.changedTouches[0].clientX,R=y.changedTouches[0].clientY);const K=Re(F,P,R,y);Be.current!==K.isTouch&&te(K.isTouch),!T&&y.cancelable&&V&&y.preventDefault();const[O]=K.location;if(K.kind===At){const ue=Wt(F,O,P,R);ue!==void 0&&K.button===0&&((Te=Vt.current)==null?void 0:Te[0])===O&&(($=Vt.current)==null?void 0:$[1])===-1&&(ue.area==="menu"?f==null||f(O,ue.bounds):ue.area==="indicator"&&(v==null||v(O,ue.bounds)))}},[X,Re,Wt,f,v]);et("click",Bi,je,!1);const Ai=b.useCallback(y=>{const F=j.current,W=X==null?void 0:X.current;if(F===null||y.target!==F&&y.target!==W||z===void 0)return;const T=Re(F,y.clientX,y.clientY,y);z(T,()=>{y.cancelable&&y.preventDefault()})},[X,Re,z]);et("contextmenu",Ai,(X==null?void 0:X.current)??null,!1);const ko=b.useCallback(y=>{Fe.current=new en(y.map(F=>F.item)),Ht.current=y,_t.current(),Fe.current=void 0},[]),xo=b.useMemo(()=>new Gr(ko),[ko]),Co=b.useRef(xo);Co.current=xo,b.useLayoutEffect(()=>{const y=Co.current;if(It===void 0||It[1]<0){y.setHovered(It);return}const F=h(It,!0),W=ce(F),T=W===void 0&&F.kind===le.Custom||(W==null?void 0:W.needsHover)!==void 0&&(typeof W.needsHover=="boolean"?W.needsHover:W.needsHover(F));y.setHovered(T?It:void 0)},[h,ce,It]);const So=b.useRef(),Hi=b.useCallback(y=>{var K;const F=j.current;if(F===null)return;const W=X==null?void 0:X.current,T=y.target!==F&&y.target!==W,P=Re(F,y.clientX,y.clientY,y);if(P.kind!=="out-of-bounds"&&T&&!Rn.current&&!P.isTouch)return;const R=(O,Te)=>{Ct($=>$===O||($==null?void 0:$[0][0])===(O==null?void 0:O[0][0])&&($==null?void 0:$[0][1])===(O==null?void 0:O[0][1])&&(($==null?void 0:$[1][0])===(O==null?void 0:O[1][0])&&($==null?void 0:$[1][1])===(O==null?void 0:O[1][1])||!Te)?$:O)};if(!es(P,So.current))st(void 0),q==null||q(P),R(P.kind===Yo?void 0:[P.location,[P.localEventX,P.localEventY]],!0),So.current=P;else if(P.kind==="cell"||P.kind===At||P.kind===Jt){let O=!1,Te=!0;if(P.kind==="cell"){const ue=h(P.location);Te=((K=ce(ue))==null?void 0:K.needsHoverPosition)??ue.kind===le.Custom,O=Te}else O=!0;const $=[P.location,[P.localEventX,P.localEventY]];R($,Te),Dt.current=$,O&&Rt(new en([P.location]))}const V=P.location[0]>=(oe?0:1);pe(P.kind===At&&P.isEdge&&V&&ke===!0),Mi(P.kind==="cell"&&P.isFillHandle),Y==null||Y(y),L(P)},[X,Re,oe,ke,Y,L,q,h,ce,Rt]);et("mousemove",Hi,je,!0);const Pi=b.useCallback(y=>{const F=j.current;if(F===null)return;let W,T;E.current!==void 0&&(W=De(F,E.current.cell[0],E.current.cell[1]),T=E.current.cell),fe==null||fe({bounds:W,stopPropagation:()=>y.stopPropagation(),preventDefault:()=>y.preventDefault(),cancel:()=>{},ctrlKey:y.ctrlKey,metaKey:y.metaKey,shiftKey:y.shiftKey,altKey:y.altKey,key:y.key,keyCode:y.keyCode,rawEvent:y,location:T})},[fe,E,De]),Di=b.useCallback(y=>{const F=j.current;if(F===null)return;let W,T;E.current!==void 0&&(W=De(F,E.current.cell[0],E.current.cell[1]),T=E.current.cell),ge==null||ge({bounds:W,stopPropagation:()=>y.stopPropagation(),preventDefault:()=>y.preventDefault(),cancel:()=>{},ctrlKey:y.ctrlKey,metaKey:y.metaKey,shiftKey:y.shiftKey,altKey:y.altKey,key:y.key,keyCode:y.keyCode,rawEvent:y,location:T})},[ge,E,De]),Ri=b.useCallback(y=>{if(j.current=y,U!==void 0&&(U.current=y),_!=null&&_.eventTarget)Pe.current=_.eventTarget;else if(y===null)Pe.current=window;else{const F=y.getRootNode();F===document&&(Pe.current=window),Pe.current=F}},[U,_==null?void 0:_.eventTarget]),Ti=b.useCallback(y=>{const F=j.current;if(F===null||Se===!1||me){y.preventDefault();return}let W,T;const P=Re(F,y.clientX,y.clientY);if(Se!==!0&&P.kind!==Se){y.preventDefault();return}const R=(ue,Q)=>{W=ue,T=Q};let V,K,O;const Te=(ue,Q,Z)=>{V=ue,K=Q,O=Z};let $=!1;if(He==null||He({...P,setData:R,setDragImage:Te,preventDefault:()=>$=!0,defaultPrevented:()=>$}),!$&&W!==void 0&&T!==void 0&&y.dataTransfer!==null)if(y.dataTransfer.setData(W,T),y.dataTransfer.effectAllowed="copyLink",V!==void 0&&K!==void 0&&O!==void 0)y.dataTransfer.setDragImage(V,K,O);else{const[ue,Q]=P.location;if(Q!==void 0){const Z=document.createElement("canvas"),We=De(F,ue,Q);ht(We!==void 0);const tt=Math.ceil(window.devicePixelRatio??1);Z.width=We.width*tt,Z.height=We.height*tt;const Ae=Z.getContext("2d");Ae!==null&&(Ae.scale(tt,tt),Ae.textBaseline="middle",Q===-1?(Ae.font=be.headerFontFull,Ae.fillStyle=be.bgHeader,Ae.fillRect(0,0,Z.width,Z.height),wi(Ae,0,0,We.width,We.height,Ce[ue],!1,be,!1,void 0,void 0,!1,0,we,Ue,!1)):(Ae.font=be.baseFontFull,Ae.fillStyle=be.bgCell,Ae.fillRect(0,0,Z.width,Z.height),yi(Ae,h([ue,Q]),0,Q,!1,!1,0,0,We.width,We.height,!1,be,be.bgCell,Ke,we,1,void 0,!1,0,void 0,void 0,void 0,an,ce,()=>{}))),Z.style.left="-100%",Z.style.position="absolute",Z.style.width=`${We.width}px`,Z.style.height=`${We.height}px`,document.body.append(Z),y.dataTransfer.setDragImage(Z,We.width/2,We.height/2),window.setTimeout(()=>{Z.remove()},0)}}else y.preventDefault()},[Se,me,Re,He,De,be,Ce,we,Ue,h,Ke,an,ce]);et("dragstart",Ti,(X==null?void 0:X.current)??null,!1,!1);const Tn=b.useRef(),Wi=b.useCallback(y=>{const F=j.current;if(J!==void 0&&y.preventDefault(),F===null||Le===void 0)return;const W=Re(F,y.clientX,y.clientY),[T,P]=W.location,R=T-(oe?0:1),[V,K]=Tn.current??[];(V!==R||K!==P)&&(Tn.current=[R,P],Le([R,P],y.dataTransfer))},[oe,Re,Le,J]);et("dragover",Wi,(X==null?void 0:X.current)??null,!1,!1);const zi=b.useCallback(()=>{Tn.current=void 0,Me==null||Me()},[Me]);et("dragend",zi,(X==null?void 0:X.current)??null,!1,!1);const Li=b.useCallback(y=>{const F=j.current;if(F===null||J===void 0)return;y.preventDefault();const W=Re(F,y.clientX,y.clientY),[T,P]=W.location,R=T-(oe?0:1);J([R,P],y.dataTransfer)},[oe,Re,J]);et("drop",Li,(X==null?void 0:X.current)??null,!1,!1);const Ni=b.useCallback(()=>{xe==null||xe()},[xe]);et("dragleave",Ni,(X==null?void 0:X.current)??null,!1,!1);const Io=b.useRef(E);Io.current=E;const mn=b.useRef(null),Wn=b.useCallback(y=>{var F;j.current===null||!j.current.contains(document.activeElement)||(y===null&&Io.current.current!==void 0?(F=U==null?void 0:U.current)==null||F.focus({preventScroll:!0}):y!==null&&y.focus({preventScroll:!0}),mn.current=y)},[U]);b.useImperativeHandle(t,()=>({focus:()=>{var F;const y=mn.current;y===null||!document.contains(y)?(F=U==null?void 0:U.current)==null||F.focus({preventScroll:!0}):y.focus({preventScroll:!0})},getBounds:(y,F)=>{if(!(U===void 0||U.current===null))return De(U.current,y??0,F??-1)},damage:ho,getMouseArgsForPosition:(y,F,W)=>{if(!(U===void 0||U.current===null))return Re(U.current,y,F,W)}}),[U,ho,De,Re]);const zn=b.useRef(),Oi=cr(()=>{var K,O,Te;if(n<50||(_==null?void 0:_.disableAccessibilityTree)===!0)return null;let y=Kn(Ce,de,n,ne,re);const F=oe?0:-1;!oe&&((K=y[0])==null?void 0:K.sourceIndex)===0&&(y=y.slice(1));const[W,T]=((O=E.current)==null?void 0:O.cell)??[],P=(Te=E.current)==null?void 0:Te.range,R=y.map($=>$.sourceIndex),V=Zi(s,Math.min(m,s+i));return W!==void 0&&T!==void 0&&!(R.includes(W)&&V.includes(T))&&Wn(null),b.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":m+1,"aria-multiselectable":"true","aria-colcount":Ce.length+F},b.createElement("thead",{role:"rowgroup"},b.createElement("tr",{role:"row","aria-rowindex":1},y.map($=>b.createElement("th",{role:"columnheader","aria-selected":E.columns.hasIndex($.sourceIndex),"aria-colindex":$.sourceIndex+1+F,tabIndex:-1,onFocus:ue=>{if(ue.target!==mn.current)return Ee==null?void 0:Ee([$.sourceIndex,-1])},key:$.sourceIndex},$.title)))),b.createElement("tbody",{role:"rowgroup"},V.map($=>b.createElement("tr",{role:"row","aria-selected":E.rows.hasIndex($),key:$,"aria-rowindex":$+2},y.map(ue=>{const Q=ue.sourceIndex,Z=it(Q,$),We=W===Q&&T===$,tt=P!==void 0&&Q>=P.x&&Q<P.x+P.width&&$>=P.y&&$<P.y+P.height,Ae=`glide-cell-${Q}-${$}`,ft=[Q,$],pt=h(ft,!0);return b.createElement("td",{key:Z,role:"gridcell","aria-colindex":Q+1+F,"aria-selected":tt,"aria-readonly":Qo(pt)||!sr(pt),id:Ae,"data-testid":Ae,onClick:()=>{const nt=U==null?void 0:U.current;if(nt!=null)return fe==null?void 0:fe({bounds:De(nt,Q,$),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:ft})},onFocusCapture:nt=>{var he,ot;if(!(nt.target===mn.current||((he=zn.current)==null?void 0:he[0])===Q&&((ot=zn.current)==null?void 0:ot[1])===$))return zn.current=ft,Ee==null?void 0:Ee(ft)},ref:We?Wn:void 0,tabIndex:-1},ts(pt,ce))})))))},[n,Ce,de,ne,re,m,s,i,E,Wn,h,U,fe,De,Ee],200),bn=H===0||!D?0:de>H?1:Cn(-re/100,0,1),Xi=-s*32+Ie,yn=M?Cn(-Xi/100,0,1):0,$i=b.useMemo(()=>{if(!bn&&!yn)return null;const y={position:"absolute",top:0,left:An,width:n-An,height:o,opacity:bn,pointerEvents:"none",transition:ye?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},F={position:"absolute",top:at,left:0,width:n,height:o,opacity:yn,pointerEvents:"none",transition:N?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return b.createElement(b.Fragment,null,bn>0&&b.createElement("div",{id:"shadow-x",style:y}),yn>0&&b.createElement("div",{id:"shadow-y",style:F}))},[bn,yn,An,n,ye,at,o,N]),Yi=b.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return b.createElement(b.Fragment,null,b.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Pi,onKeyUp:Di,onFocus:I,onBlur:B,ref:Ri,style:Hn},Oi),b.createElement("canvas",{ref:_e,style:Yi}),$i)},yl=b.memo(b.forwardRef(ns));function os(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case le.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===eo?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case le.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case le.Image:case le.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case le.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case le.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case le.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case le.Markdown:case le.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case le.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case le.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case le.Protected:return{formatted:"************",rawValue:"",format:"string"};default:Zn()}}function is(e,t){return e.map((o,i)=>{const r=t[i];return o.map(l=>l.span!==void 0&&l.span[0]!==r?{formatted:"",rawValue:"",format:"string"}:os(l))})}function _o(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function rs(e){var n;const t=[];for(const o of e){const i=[];for(const r of o)r.format==="url"?i.push(((n=r.rawValue)==null?void 0:n.toString())??""):r.format==="string-array"?i.push(r.formatted.map(l=>_o(l,!0)).join(",")):i.push(r.doNotEscape===!0?r.formatted:_o(r.formatted,!1));t.push(i.join("	"))}return t.join(`
`)}function Yn(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function Vo(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function ss(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function ls(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const i of o){const r=`gdg-format="${i.format}"`;i.format==="url"?t.push(`<td ${r}><a href="${i.rawValue}">${Yn(i.formatted)}</a></td>`):i.format==="string-array"?t.push(`<td ${r}><ol>${i.formatted.map((l,s)=>`<li gdg-raw-value=${Vo(i.rawValue[s])}>`+Yn(l)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${Vo(((n=i.rawValue)==null?void 0:n.toString())??"")} ${r}>${Yn(i.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function as(e,t){const n=is(e,t),o=rs(n),i=ls(n);return{textPlain:o,textHtml:i}}function vl(e){var l;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],i=[];let r;for(;o.length>0;){const s=o.pop();if(s===void 0)break;if(s instanceof HTMLTableElement||s.nodeName==="TBODY")o.push(...[...s.children].reverse());else if(s instanceof HTMLTableRowElement)r!==void 0&&i.push(r),r=[],o.push(...[...s.children].reverse());else if(s instanceof HTMLTableCellElement){const a=s.cloneNode(!0),u=a.children.length===1&&a.children[0].nodeName==="P"?a.children[0]:null,g=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",m=a.querySelectorAll("br");for(const f of m)f.replaceWith(`
`);const h=a.getAttribute("gdg-raw-value"),d=a.getAttribute("gdg-format")??"string";if(a.querySelector("a")!==null)r==null||r.push({rawValue:((l=a.querySelector("a"))==null?void 0:l.getAttribute("href"))??"",formatted:a.textContent??"",format:d});else if(a.querySelector("ol")!==null){const f=a.querySelectorAll("li");r==null||r.push({rawValue:[...f].map(v=>v.getAttribute("gdg-raw-value")??""),formatted:[...f].map(v=>v.textContent??""),format:"string-array"})}else if(h!==null)r==null||r.push({rawValue:ss(h),formatted:a.textContent??"",format:d});else{let f=a.textContent??"";g&&(f=f.replace(/\n(?!\n)/g,"")),r==null||r.push({rawValue:f??"",formatted:f??"",format:d})}}}return r!==void 0&&i.push(r),i}function pl(e,t,n,o,i){var s;const r=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let l=!1;do{if((e==null?void 0:e.current)===void 0)break;const a=(s=e.current)==null?void 0:s.range,c=[];if(a.width>2){const m=t({x:a.x,y:a.y,width:1,height:a.height},i.signal);if(typeof m=="function")return r;c.push(...m);const h=t({x:a.x+a.width-1,y:a.y,width:1,height:a.height},i.signal);if(typeof h=="function")return r;c.push(...h)}else{const m=t({x:a.x,y:a.y,width:a.width,height:a.height},i.signal);if(typeof m=="function")return r;c.push(...m)}let u=a.x-n,g=a.x+a.width-1-n;for(const m of c)for(const h of m)h.span!==void 0&&(u=Math.min(h.span[0],u),g=Math.max(h.span[1],g));u===a.x-n&&g===a.x+a.width-1-n?l=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:a.y,width:g-u+1,height:a.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!l);return e}function qo(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function wl(e){let t;(s=>{s[s.None=0]="None",s[s.inString=1]="inString",s[s.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],i=0,r=0;e=e.replace(/\r\n/g,`
`);let l=0;for(const s of e){switch(r){case 0:s==="	"||s===`
`?(o.push(e.slice(i,l)),i=l+1,s===`
`&&(n.push(o),o=[])):s==='"'&&(r=1);break;case 1:s==='"'&&(r=2);break;case 2:s==='"'?r=1:((s==="	"||s===`
`)&&(o.push(qo(e.slice(i,l))),i=l+1,s===`
`&&(n.push(o),o=[])),r=0);break}l++}return i<e.length&&o.push(qo(e.slice(i,e.length))),n.push(o),n.map(s=>s.map(a=>({rawValue:a,formatted:a,format:"string"})))}function kl(e,t,n){var s;const o=as(e,t),i=a=>{var c;(c=window.navigator.clipboard)==null||c.writeText(a)},r=(a,c)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"}),"text/html":new Blob([c],{type:"text/html"})})]),!0)},l=(a,c)=>{var u,g;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",a),(g=n==null?void 0:n.clipboardData)==null||g.setData("text/html",c)}catch{r(a,c)||i(a)}};((s=window.navigator.clipboard)==null?void 0:s.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?l(o.textPlain,o.textHtml):i(o.textPlain),n==null||n.preventDefault()}function cs(e){return e!==!0}function Uo(e){const{cell:t,posX:n,posY:o,bounds:i,theme:r}=e,{width:l,height:s,x:a,y:c}=i,u=t.maxSize??r.checkboxMaxSize,g=Math.floor(i.y+s/2),m=ti(u,s,r.cellVerticalPadding),h=ei(t.contentAlign??"center",a,l,r.cellHorizontalPadding,m),d=Zo(h,g,m),f=ni(a+n,c+o,d);return to(t)&&f}const ds={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:le.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>us(e,e.cell.data,to(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Uo(e)&&e.preventDefault()},onClick:e=>{if(Uo(e))return{...e.cell,data:cs(e.cell.data)}},onPaste:(e,t)=>{let n=Sn;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=eo),n===t.data?void 0:{...t,data:n}}};function us(e,t,n,o,i){if(!n&&t===Sn)return;const{ctx:r,hoverAmount:l,theme:s,rect:a,highlighted:c,hoverX:u,hoverY:g,cell:{contentAlign:m}}=e,{x:h,y:d,width:f,height:v}=a;let w=!1;if(i>0){let p=n?1-i+i*l:.4;if(t===Sn&&(p*=l),p===0)return;p<1&&(w=!0,r.globalAlpha=p)}lo(r,s,t,h,d,f,v,c,u,g,o,m),w&&(r.globalAlpha=1)}const fs=mt("div")({name:"BubblesOverlayEditorStyle",class:"bed7b9f",propsAsIs:!1}),hs=e=>{const{bubbles:t}=e;return b.createElement(fs,null,t.map((n,o)=>b.createElement("div",{key:o,className:"boe-bubble"},n)),b.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},gs={getAccessibilityString:e=>oi(e.data),kind:le.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((i,r)=>e.measureText(r).width+i+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>ms(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return b.createElement(hs,{bubbles:t.data})},onPaste:()=>{}};function ms(e,t){const{rect:n,theme:o,ctx:i,highlighted:r}=e,{x:l,y:s,width:a,height:c}=n;let u=l+o.cellHorizontalPadding;const g=[];for(const m of t){if(u>l+a)break;const h=rt(m,i,o.baseFontFull).width;g.push({x:u,width:h}),u+=h+o.bubblePadding*2+o.bubbleMargin}i.beginPath();for(const m of g)dt(i,m.x,s+(c-o.bubbleHeight)/2,m.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);i.fillStyle=r?o.bgBubbleSelected:o.bgBubble,i.fill();for(const[m,h]of g.entries())i.beginPath(),i.fillStyle=o.textBubble,i.fillText(t[m],h.x+o.bubblePadding,s+c/2+kt(i,o))}const bs=mt("div")({name:"DrilldownOverlayEditorStyle",class:"dy18k32",propsAsIs:!1}),ys=e=>{const{drilldowns:t}=e;return b.createElement(bs,null,t.map((n,o)=>b.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&b.createElement("img",{src:n.img}),b.createElement("div",null,n.text))))},vs={getAccessibilityString:e=>oi(e.data.map(t=>t.text)),kind:le.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,i)=>e.measureText(i.text).width+o+n.bubblePadding*2+n.bubbleMargin+(i.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>ws(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return b.createElement(ys,{drilldowns:t.data})},onPaste:()=>{}},tn={};function ps(e,t,n,o){const i=Math.ceil(window.devicePixelRatio),r=5,l=n-r*2,s=4,a=n*i,c=o+r,u=o*3,g=(u+r*2)*i,m=`${e},${t},${i},${n}`;if(tn[m]!==void 0)return{el:tn[m],height:a,width:g,middleWidth:s*i,sideWidth:c*i,padding:r*i,dpr:i};const h=document.createElement("canvas"),d=h.getContext("2d");return d===null?null:(h.width=g,h.height=a,d.scale(i,i),tn[m]=h,d.beginPath(),dt(d,r,r,u,l,o),d.shadowColor="rgba(24, 25, 34, 0.4)",d.shadowBlur=1,d.fillStyle=e,d.fill(),d.shadowColor="rgba(24, 25, 34, 0.3)",d.shadowOffsetY=1,d.shadowBlur=5,d.fillStyle=e,d.fill(),d.shadowOffsetY=0,d.shadowBlur=0,d.shadowBlur=0,d.beginPath(),dt(d,r+.5,r+.5,u,l,o),d.strokeStyle=t,d.lineWidth=1,d.stroke(),{el:h,height:a,width:g,sideWidth:c*i,middleWidth:o*i,padding:r*i,dpr:i})}function ws(e,t){const{rect:n,theme:o,ctx:i,imageLoader:r,col:l,row:s}=e,{x:a,width:c}=n,u=o.baseFontFull,g=di(i,u),m=Math.min(n.height,Math.max(16,Math.ceil(g*o.lineHeight)*2)),h=Math.floor(n.y+(n.height-m)/2),d=m-10,f=o.bubblePadding,v=o.bubbleMargin;let w=a+o.cellHorizontalPadding;const p=o.roundingRadius??6,I=ps(o.bgCell,o.drilldownBorder,m,p),B=[];for(const A of t){if(w>a+c)break;const H=rt(A.text,i,u).width;let z=0;if(A.img!==void 0){const D=r.loadOrGetImage(A.img,l,s);D!==void 0&&(D instanceof HTMLImageElement?D.complete&&D.naturalWidth>0&&D.naturalHeight>0:D.width>0&&D.height>0)&&(z=d-8+4)}const x=H+z+f*2;B.push({x:w,width:x}),w+=x+v}if(I!==null){const{el:A,height:E,middleWidth:H,sideWidth:z,width:x,dpr:D,padding:M}=I;if(A.width>0&&A.height>0){const S=z/D,C=M/D;for(const k of B){const Y=Math.floor(k.x),L=Math.floor(k.width),q=L-(S-C)*2;i.imageSmoothingEnabled=!1;try{i.drawImage(A,0,0,z,E,Y-C,h,S,m),q>0&&i.drawImage(A,z,0,H,E,Y+(S-C),h,q,m),i.drawImage(A,x-z,0,z,E,Y+L-(S-C),h,S,m)}catch{const ne=`${o.bgCell}_${o.drilldownBorder}_${m}_${p}`;delete tn[ne]}i.imageSmoothingEnabled=!0}}else{const S=`${o.bgCell}_${o.drilldownBorder}_${m}_${p}`;delete tn[S]}}i.beginPath();for(const[A,E]of B.entries()){const H=t[A];let z=E.x+f;if(H.img!==void 0){const x=r.loadOrGetImage(H.img,l,s);if(x!==void 0&&(x instanceof HTMLImageElement?x.complete&&x.naturalWidth>0&&x.naturalHeight>0:x.width>0&&x.height>0)){const M=d-8;let S=0,C=0,k=x.width,Y=x.height;k>Y?(S+=(k-Y)/2,k=Y):Y>k&&(C+=(Y-k)/2,Y=k),i.beginPath(),dt(i,z,h+m/2-M/2,M,M,o.roundingRadius??3),i.save(),i.clip(),i.drawImage(x,S,C,k,Y,z,h+m/2-M/2,M,M),i.restore(),z+=M+4}}i.beginPath(),i.fillStyle=o.textBubble,i.fillText(H.text,z,h+m/2+kt(i,o))}}const ks=mt("div")({name:"ImageOverlayEditorStyle",class:"i1f2fhaz",propsAsIs:!1}),xs=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:i}=e,r=t.filter(s=>s!=="");if(r.length===0)return null;const l=r.length>1;return b.createElement(ks,{"data-testid":"GDG-default-image-overlay-editor"},b.createElement(er.Carousel,{showArrows:l,showThumbs:!1,swipeable:l,emulateTouch:l,infiniteLoop:l},r.map(s=>{const a=(i==null?void 0:i(s))??b.createElement("img",{draggable:!1,src:s});return b.createElement("div",{className:"gdg-centering-container",key:s},a)})),n&&o&&b.createElement("button",{className:"gdg-edit-icon",onClick:o},b.createElement(no,null)))},Cs={getAccessibilityString:e=>e.data.join(", "),kind:le.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>Ss(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,i=o??xs;return b.createElement(i,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:r=>{n({...t,data:[r]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(i=>{try{return new URL(i),i}catch{return}}).filter(i=>i!==void 0);if(!(o.length===t.data.length&&o.every((i,r)=>i===t.data[r])))return{...t,data:o}}},_n=4;function Ss(e,t,n,o){const{rect:i,col:r,row:l,theme:s,ctx:a,imageLoader:c}=e,{x:u,y:g,height:m,width:h}=i,d=m-s.cellVerticalPadding*2,f=[];let v=0;for(let p=0;p<t.length;p++){const I=t[p];if(I.length===0)continue;const B=c.loadOrGetImage(I,r,l);if(B!==void 0){f[p]=B;const A=B.width*(d/B.height);v+=A+_n}}if(v===0)return;v-=_n;let w=u+s.cellHorizontalPadding;o==="right"?w=Math.floor(u+h-s.cellHorizontalPadding-v):o==="center"&&(w=Math.floor(u+h/2-v/2));for(const p of f){if(p===void 0)continue;const I=p.width*(d/p.height);n>0&&(a.beginPath(),dt(a,w,g+s.cellVerticalPadding,I,d,n),a.save(),a.clip()),a.drawImage(p,w,g+s.cellVerticalPadding,I,d),n>0&&a.restore(),w+=I+_n}}function Is(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const Ms={getAccessibilityString:()=>"",kind:le.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:i,rect:r,theme:l}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let s=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(s+=Math.round(Is(n,o)*t.skeletonWidthVariability));const a=l.cellHorizontalPadding;s+a*2>=r.width&&(s=r.width-a*2-1);const c=t.skeletonHeight??Math.min(18,r.height-2*l.cellVerticalPadding);dt(i,r.x+a,r.y+(r.height-c)/2,s,c,l.roundingRadius??3),i.fillStyle=ln(l.textDark,.1),i.fill()},onPaste:()=>{}},Es=mt("div")({name:"MarkdownContainer",class:"m1ec5h7p",propsAsIs:!1});class Fs extends nn.PureComponent{constructor(){super(...arguments);G(this,"targetElement",null);G(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:i,createNode:r}=o,l=nr(i),s=document.createRange();s.selectNodeContents(n),s.deleteContents();let a=r==null?void 0:r(l);if(a===void 0){const u=document.createElement("template");u.innerHTML=l,a=u.content}n.append(a);const c=n.getElementsByTagName("a");for(const u of c)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),nn.createElement(Es,{ref:this.containerRefHook})}}const Bs=mt("textarea")({name:"InputBox",class:"iotb8b8",propsAsIs:!1}),As=mt("div")({name:"ShadowBox",class:"s1xtsfdl",propsAsIs:!1}),Hs=mt("div")({name:"GrowingEntryStyle",class:"g1d7u5bt",propsAsIs:!1});let jo=0;const Fn=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:i,altNewline:r,validatedSelection:l,...s}=e,{onChange:a,className:c}=s,u=b.useRef(null),g=n??"";ht(a!==void 0,"GrowingEntry must be a controlled input area");const[m]=b.useState(()=>"input-box-"+(jo=(jo+1)%1e7));b.useEffect(()=>{const d=u.current;if(d===null||d.disabled)return;const f=g.toString().length;d.focus(),d.setSelectionRange(i?0:f,f)},[]),b.useLayoutEffect(()=>{var d;if(l!==void 0){const f=typeof l=="number"?[l,null]:l;(d=u.current)==null||d.setSelectionRange(f[0],f[1])}},[l]);const h=b.useCallback(d=>{d.key==="Enter"&&d.shiftKey&&r===!0||o==null||o(d)},[r,o]);return b.createElement(Hs,{className:"gdg-growing-entry"},b.createElement(As,{className:c},g+`
`),b.createElement(Bs,{...s,className:(c??"")+" gdg-input",id:m,ref:u,onKeyDown:h,value:g,placeholder:t,dir:"auto"}))},Ps=()=>e=>e.targetWidth,Ko=mt("div")({name:"MarkdownOverlayEditorStyle",class:"mmv7gx6",propsAsIs:!1,vars:{"mmv7gx6-0":[Ps(),"px"]}}),Ds=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:i,targetRect:r,onFinish:l,validatedSelection:s}=e,a=t.data,c=t.readonly===!0,[u,g]=b.useState(a===""||o),m=b.useCallback(()=>{g(d=>!d)},[]),h=a?"gdg-ml-6":"";return u?b.createElement(Ko,{targetWidth:r.width-20},b.createElement(Fn,{autoFocus:!0,highlight:!1,validatedSelection:s,value:a,onKeyDown:d=>{d.key==="Enter"&&d.stopPropagation()},onChange:n}),b.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${h}`,onClick:()=>l(t)},b.createElement(ar,null))):b.createElement(Ko,{targetWidth:r.width},b.createElement(Fs,{contents:a,createNode:i}),!c&&b.createElement(b.Fragment,null,b.createElement("div",{className:"spacer"}),b.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${h}`,onClick:m},b.createElement(no,null))),b.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},Rs={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:sn,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return rt(o,e,n.baseFontFull).width+2*n.cellHorizontalPadding},draw:e=>gt(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:i,markdownDivCreateNode:r,forceEditMode:l,validatedSelection:s}=e;return b.createElement(Ds,{onFinish:i,targetRect:o,value:n,validatedSelection:s,onChange:a=>t({...n,data:a.target.value}),forceEditMode:l,createNode:r})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},Ts={getAccessibilityString:e=>e.row.toString(),kind:on.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:Ws,measure:()=>44,draw:e=>Ls(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:i}=e,{width:r,height:l}=t,s=n.drawHandle?7+(r-7)/2:r/2,a=l/2;if(Math.abs(o-s)<=10&&Math.abs(i-a)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function Ws(e,t){const{ctx:n,theme:o}=e,i=o.markerFontFull,r=t??{};return(r==null?void 0:r.font)!==i&&(n.font=i,r.font=i),r.deprep=zs,n.textAlign="center",r}function zs(e){const{ctx:t}=e;t.textAlign="start"}function Ls(e,t,n,o,i,r){const{ctx:l,rect:s,hoverAmount:a,theme:c}=e,{x:u,y:g,width:m,height:h}=s,d=n?1:o==="checkbox-visible"?.6+.4*a:a;if(o!=="number"&&d>0){l.globalAlpha=d;const f=7*(n?a:1);if(lo(l,c,n,i?u+f:u,g,i?m-f:m,h,!0,void 0,void 0,c.checkboxMaxSize,"center",r),i){l.globalAlpha=a,l.beginPath();for(const v of[3,6])for(const w of[-5,-1,3])l.rect(u+v,g+h/2+w,2,2);l.fillStyle=c.textLight,l.fill(),l.beginPath()}l.globalAlpha=1}if(o==="number"||o==="both"&&!n){const f=t.toString(),v=c.markerFontFull,w=u+m/2;o==="both"&&a!==0&&(l.globalAlpha=1-a),l.fillStyle=c.textLight,l.font=v,l.fillText(f,w,g+h/2+kt(l,v)),a!==0&&(l.globalAlpha=1)}}const Ns={getAccessibilityString:()=>"",kind:on.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>Os(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function Os(e,t,n){const{ctx:o,rect:i,hoverAmount:r,theme:l,spriteManager:s}=e,{x:a,y:c,width:u,height:g}=i;o.beginPath(),o.globalAlpha=r,o.rect(a+1,c+1,u,g-2),o.fillStyle=l.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const m=t!=="";let h=0;if(n!==void 0){const f=g-8,v=a+8/2,w=c+8/2;s.drawSprite(n,"normal",o,v,w,f,l,m?1:r),h=f}else{h=24;const d=12,f=m?d:r*d,v=m?0:(1-r)*d*.5,w=l.cellHorizontalPadding+4;f>0&&(o.moveTo(a+w+v,c+g/2),o.lineTo(a+w+v+f,c+g/2),o.moveTo(a+w+v+f*.5,c+g/2-f*.5),o.lineTo(a+w+v+f*.5,c+g/2+f*.5),o.lineWidth=2,o.strokeStyle=l.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=l.textMedium,o.fillText(t,h+a+l.cellHorizontalPadding+.5,c+g/2+kt(o,l)),o.beginPath()}function xi(e,t,n,o,i,r,l){e.textBaseline="alphabetic";const s=Xs(e,i,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),dt(e,s.x,s.y,s.width,s.height,t.roundingRadius??4),e.globalAlpha=r,e.fillStyle=(n==null?void 0:n.bgColor)??ln(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",l==null||l("text")}function Xs(e,t,n,o,i){const r=o.cellHorizontalPadding,l=o.cellVerticalPadding;if(i)return{x:t.x+r/2,y:t.y+l/2+1,width:t.width-r,height:t.height-l-1};const s=rt(n,e,o.baseFontFull,"alphabetic"),a=t.height-l,c=Math.min(a,s.actualBoundingBoxAscent*2.5);return{x:t.x+r/2,y:t.y+(t.height-c)/2+1,width:s.width+r*3,height:c-1}}const $s=b.lazy(async()=>await or(()=>import("./number-overlay-editor-CK4Gu6Bp.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)),Ys={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:sn,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:i,rect:r,overrideCursor:l}=e,{hoverEffect:s,displayData:a,hoverEffectTheme:c}=n;s===!0&&t>0&&xi(o,i,c,a,r,t,l),gt(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>rt(t.displayData,e,n.baseFontFull).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:i,initialValue:r}=e;return b.createElement(b.Suspense,{fallback:null},b.createElement($s,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,initialValue:r,validatedSelection:i,onChange:l=>n({...o,data:Number.isNaN(l.floatValue??0)?0:l.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},_s={getAccessibilityString:()=>"",measure:()=>108,kind:le.Protected,needsHover:!1,needsHoverPosition:!1,draw:Vs,onPaste:()=>{}};function Vs(e){const{ctx:t,theme:n,rect:o}=e,{x:i,y:r,height:l}=o;t.beginPath();const s=2.5;let a=i+n.cellHorizontalPadding+s;const c=r+l/2,u=Math.cos(Bo(30))*s,g=Math.sin(Bo(30))*s;for(let m=0;m<12;m++)t.moveTo(a,c-s),t.lineTo(a,c+s),t.moveTo(a+u,c-g),t.lineTo(a-u,c+g),t.moveTo(a-u,c-g),t.lineTo(a+u,c+g),a+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const qs={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>sn(e,t,e.theme.textLight),draw:e=>gt(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>rt(t.data,e,n.baseFontFull).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:i}=e;return nn.createElement(Fn,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:i,onChange:r=>n({...o,data:r.target.value})})},onPaste:()=>{}},Us={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:sn,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:i,rect:r,theme:l,overrideCursor:s}=e,{displayData:a,contentAlign:c,hoverEffect:u,allowWrapping:g,hoverEffectTheme:m}=t;u===!0&&n>0&&xi(i,l,m,a,r,n,s),gt(e,a,c,g,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let i=0;for(const r of o)i=Math.max(i,rt(r,e,n.baseFontFull).width);return i+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:i,validatedSelection:r}=t;return b.createElement(Fn,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:i.readonly!==!0,disabled:i.readonly===!0,altNewline:!0,value:i.data,validatedSelection:r,onChange:l=>o({...i,data:l.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},js=mt("div")({name:"UriOverlayEditorStyle",class:"uwr6ffw",propsAsIs:!1}),Ks=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:i,validatedSelection:r,preview:l}=e,[s,a]=b.useState(!i&&(t===""||o)),c=b.useCallback(()=>{a(!0)},[]);return s?b.createElement(Fn,{validatedSelection:r,highlight:!0,autoFocus:!0,value:t,onChange:n}):b.createElement(js,null,b.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},l),!i&&b.createElement("div",{className:"gdg-edit-icon",onClick:c},b.createElement(no,null)),b.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function Ci(e,t,n,o){let i=n.cellHorizontalPadding;const r=t.height/2-e.actualBoundingBoxAscent/2,l=e.width,s=e.actualBoundingBoxAscent;return o==="right"?i=t.width-l-n.cellHorizontalPadding:o==="center"&&(i=t.width/2-l/2),{x:i,y:r,width:l,height:s}}function Go(e){const{cell:t,bounds:n,posX:o,posY:i,theme:r}=e,l=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const s=ai(l,r.baseFontFull);if(s===void 0)return!1;const a=Ci(s,n,r,t.contentAlign);return Nt({x:a.x-4,y:a.y-4,width:a.width+8,height:a.height+8},o,i)}const Gs={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:sn,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:i,hoverY:r,rect:l,ctx:s}=e,a=t.displayData??t.data,c=t.hoverEffect===!0;if(o!==void 0&&c&&i!==void 0&&r!==void 0){const u=rt(a,s,n.baseFontFull),g=Ci(u,l,n,t.contentAlign),{x:m,y:h,width:d,height:f}=g;if(i>=m-4&&i<=m-4+d+8&&r>=h-4&&r<=h-4+f+8){const v=kt(s,n.baseFontFull);o("pointer");const w=5,p=h-v;s.beginPath(),s.moveTo(l.x+m,Math.floor(l.y+p+f+w)+.5),s.lineTo(l.x+m+d,Math.floor(l.y+p+f+w)+.5),s.strokeStyle=n.linkColor,s.stroke(),s.save(),s.fillStyle=e.cellFillColor,gt({...e,rect:{...l,x:l.x-1}},a,t.contentAlign),gt({...e,rect:{...l,x:l.x-2}},a,t.contentAlign),gt({...e,rect:{...l,x:l.x+1}},a,t.contentAlign),gt({...e,rect:{...l,x:l.x+2}},a,t.contentAlign),s.restore()}}s.fillStyle=c?n.linkColor:n.textDark,gt(e,a,t.contentAlign)},onSelect:e=>{Go(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;Go(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>rt(t.displayData??t.data,e,n.baseFontFull).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:i,validatedSelection:r}=t;return b.createElement(Ks,{forceEditMode:o.readonly!==!0&&(i||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:r,readonly:o.readonly===!0,onChange:l=>n({...o,data:l.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},xl=[Ts,Ns,ds,gs,vs,Cs,Ms,Rs,Ys,_s,qs,Us,Gs],Vn=[];class Cl extends fi{constructor(){super(...arguments);G(this,"imageLoaded",()=>{});G(this,"loadedLocations",[]);G(this,"cache",{});G(this,"sendLoaded",tr(()=>{this.imageLoaded(new en(this.loadedLocations)),this.loadedLocations=[]},20));G(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const i=this.cache[o];let r=!1;for(let l=0;l<i.cells.length;l++){const s=i.cells[l];if(this.isInWindow(s)){r=!0;break}}r?i.cells=i.cells.filter(this.isInWindow):(i.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,i,r){let l=!1;const s=Vn.pop()??new Image;let a=!1;const c={img:void 0,cells:[it(o,i)],url:n,cancel:()=>{a||(a=!0,Vn.length<12?Vn.unshift(s):l||(s.src=""))}},u=new Promise(g=>s.addEventListener("load",()=>g(null)));requestAnimationFrame(async()=>{try{s.src=n,await u,await s.decode();const g=this.cache[r];if(g!==void 0&&!a){g.img=s;for(const m of g.cells)this.loadedLocations.push(so(m));l=!0,this.sendLoaded()}}catch{c.cancel()}}),this.cache[r]=c}loadOrGetImage(n,o,i){const r=n,l=this.cache[r];if(l!==void 0){const s=it(o,i);return l.cells.includes(s)||l.cells.push(s),l.img}else this.loadImage(n,o,i,r)}}export{At as A,es as B,Un as C,ml as D,Zn as E,rr as F,le as G,ll as H,on as I,ul as J,vl as K,wl as L,Ao as M,fl as N,kl as O,xl as P,Cl as Q,yl as R,$o as S,gl as T,Qr as U,sl as V,Ts as W,ir as a,ht as b,bl as c,dl as d,cl as e,pl as f,hl as g,$t as h,il as i,ln as j,ol as k,Yt as l,rt as m,Jt as n,Yo as o,Nt as p,jn as q,rl as r,mr as s,cs as t,et as u,Qo as v,al as w,sr as x,Hr as y,wn as z};
