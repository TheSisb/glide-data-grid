const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-CyV87IsY.js","./iframe-UCKTa6BV.js","./preload-helper-C1FmrZbK.js","./index-BC6MkKXL.js","./marked.esm-B58ZjuzW.js","./throttle-DRnjqVFL.js","./flatten-wdCZvo8x.js","./number-overlay-editor-KarwLo80.js","./react-number-format.es-C14HZXJJ.js"])))=>i.map(i=>d[i]);
var Qs=Object.defineProperty;var ea=(e,t,n)=>t in e?Qs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Le=(e,t,n)=>ea(e,typeof t!="symbol"?t+"":t,n);import{r as s,R as St}from"./iframe-UCKTa6BV.js";import{_ as Ll}from"./preload-helper-C1FmrZbK.js";import{h as ta,g as Wl,j as na,k as oa,v as ra,l as ia,m as sn,r as ho,t as la}from"./throttle-DRnjqVFL.js";import{u as sa,f as cl}from"./flatten-wdCZvo8x.js";import{s as en,a as aa}from"./marked.esm-B58ZjuzW.js";function $l(e="This should not happen"){throw new Error(e)}function Jt(e,t="Assertion failed"){if(!e)return $l(t)}function sr(e,t){return $l(t??"Hell froze over")}function ca(e,t){try{return e()}catch{return t}}const dl=Object.prototype.hasOwnProperty;function Po(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Po(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(dl.call(e,n)&&++o&&!dl.call(t,n)||!(n in t)||!Po(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const Xr=null,Bi=void 0;var Q;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(Q||(Q={}));var ul;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay"})(ul||(ul={}));var Yr;(function(e){e.Triangle="triangle",e.Dots="dots"})(Yr||(Yr={}));function zr(e){return"width"in e&&typeof e.width=="number"}async function fl(e){return typeof e=="object"?e:await e()}function To(e){return!(e.kind===Q.Loading||e.kind===Q.Bubble||e.kind===Q.RowID||e.kind===Q.Protected||e.kind===Q.Drilldown)}function zu(e){return!(e.kind===Q.Loading||e.kind===Q.Bubble||e.kind===Q.RowID||e.kind===Q.Protected||e.kind===Q.Drilldown||e.kind===Q.Boolean||e.kind===Q.Image||e.kind===Q.Custom)}function zo(e){return e.kind===an.Marker||e.kind===an.NewRow}function Ao(e){if(!To(e)||e.kind===Q.Image)return!1;switch(e.kind){case Q.Text:case Q.Number:case Q.Markdown:case Q.Uri:case Q.Custom:case Q.Boolean:return e.readonly!==!0;default:sr(e,"A cell was passed with an invalid kind")}}function da(e){return ta(e,"editor")}function Pi(e){return!(e.readonly??!1)}var an;(function(e){e.NewRow="new-row",e.Marker="marker"})(an||(an={}));const _r={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function xi(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let hl;const qt=class qt{constructor(t){Le(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new qt(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=xi([...this.items,n]);return new qt(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,a]of n.entries()){const[l,c]=a;if(l<=r&&o<=c){const f=[];l<o&&f.push([l,o]),r<c&&f.push([r,c]),n.splice(i,1,...f)}}return new qt(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};Le(qt,"create",t=>new qt(xi(t))),Le(qt,"empty",()=>hl??(hl=new qt([]))),Le(qt,"fromSingleSelection",t=>qt.empty().add(t)),Le(qt,"fromArray",t=>{if(t.length===0)return qt.empty();const n=t.map(r=>[r,r+1]),o=xi(n);return new qt(o)});let rt=qt;const ua=en("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function Wt(e,t,n,o,r=!1){const i=s.useRef();i.current=t,s.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const a=n,l=c=>{var f;(f=i.current)==null||f.call(a,c)};return a.addEventListener(e,l,{passive:o,capture:r}),()=>{a.removeEventListener(e,l,{capture:r})}},[e,n,o,r])}function jn(e,t){return e===void 0?void 0:t}const fa=Math.PI;function gl(e){return e*fa/180}const Ol=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),Nl=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},Xl=(e,t,n)=>Math.min(e,t-n*2),Yl=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Li=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),s.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},ha=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function ga(e,t,n){const[o,r]=s.useState(e),i=s.useRef(!0);s.useEffect(()=>()=>{i.current=!1},[]);const a=s.useRef(Wl(l=>{i.current&&r(l)},n));return s.useLayoutEffect(()=>{i.current&&a.current(()=>e())},t),o}const ma="֑-߿יִ-﷽ﹰ-ﻼ",wa="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",ba=new RegExp("^[^"+wa+"]*["+ma+"]");function Wi(e){return ba.test(e)?"rtl":"not-rtl"}let Br;function Fi(){if(typeof document>"u")return 0;if(Br!==void 0)return Br;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),Br=n-o,Br}const fo=Symbol();function ya(e){const t=s.useRef([fo,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=s.useState(e),[,r]=s.useState(),i=s.useCallback(l=>{const c=t.current[0];c!==fo&&(l=typeof l=="function"?l(c):l,l===c)||(c!==fo&&r({}),o(f=>typeof l=="function"?l(c===fo?f:c):l),t.current[0]=fo)},[]),a=s.useCallback(()=>{t.current[0]=fo,r({})},[]);return[t.current[0]===fo?n:t.current[0],i,a]}function _l(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function pa(e){const t=s.useRef(e);return Po(e,t.current)||(t.current=e),t.current}const va=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(l=>l!=="");if(i.length===0)return null;const a=i.length>1;return s.createElement(ua,{"data-testid":"GDG-default-image-overlay-editor"},s.createElement(na.Carousel,{showArrows:a,showThumbs:!1,swipeable:a,emulateTouch:a,infiniteLoop:a},i.map(l=>{const c=(r==null?void 0:r(l))??s.createElement("img",{draggable:!1,src:l});return s.createElement("div",{className:"gdg-centering-container",key:l},c)})),n&&o&&s.createElement("button",{className:"gdg-edit-icon",onClick:o},s.createElement(Li,null)))},Ca=en("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class xa extends St.PureComponent{constructor(){super(...arguments);Le(this,"targetElement",null);Le(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,a=aa(r),l=document.createRange();l.selectNodeContents(n),l.deleteContents();let c=i==null?void 0:i(a);if(c===void 0){const u=document.createElement("template");u.innerHTML=a,c=u.content}n.append(c);const f=n.getElementsByTagName("a");for(const u of f)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),St.createElement(Ca,{ref:this.containerRefHook})}}const ka=en("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),Sa=en("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),Ma=en("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});let ml=0;const Vr=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:a,...l}=e,{onChange:c,className:f}=l,u=s.useRef(null),g=n??"";Jt(c!==void 0,"GrowingEntry must be a controlled input area");const[m]=s.useState(()=>"input-box-"+(ml=(ml+1)%1e7));s.useEffect(()=>{const h=u.current;if(h===null||h.disabled)return;const b=g.toString().length;h.focus(),h.setSelectionRange(r?0:b,b)},[]),s.useLayoutEffect(()=>{var h;if(a!==void 0){const b=typeof a=="number"?[a,null]:a;(h=u.current)==null||h.setSelectionRange(b[0],b[1])}},[a]);const w=s.useCallback(h=>{h.key==="Enter"&&h.shiftKey&&i===!0||o==null||o(h)},[i,o]);return s.createElement(Ma,{className:"gdg-growing-entry"},s.createElement(Sa,{className:f},g+`
`),s.createElement(ka,{...l,className:(f??"")+" gdg-input",id:m,ref:u,onKeyDown:w,value:g,placeholder:t,dir:"auto"}))},ki={};let Vn=null;function Ra(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Lo(e){const t=e.toLowerCase().trim();if(ki[t]!==void 0)return ki[t];Vn=Vn||Ra(),Vn.style.color="#000",Vn.style.color=t;const n=getComputedStyle(Vn).color;Vn.style.color="#fff",Vn.style.color=t;const o=getComputedStyle(Vn).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),ki[t]=r,r}function mo(e,t){const[n,o,r]=Lo(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const wl=new Map;function bl(e,t){const n=`${e}-${t}`,o=wl.get(n);if(o!==void 0)return o;const r=Qt(e,t);return wl.set(n,r),r}function Qt(e,t){if(t===void 0)return e;const[n,o,r,i]=Lo(e);if(i===1)return e;const[a,l,c,f]=Lo(t),u=i+f*(1-i),g=(i*n+f*a*(1-i))/u,m=(i*o+f*l*(1-i))/u,w=(i*r+f*c*(1-i))/u;return`rgba(${g}, ${m}, ${w}, ${u})`}function Bu(e,t,n){if(n<=0)return e;if(n>=1)return t;const[o,r,i,a]=Lo(e),[l,c,f,u]=Lo(t),g=o*a,m=r*a,w=i*a,h=l*u,b=c*u,k=f*u,x=n,C=1-n,F=a*C+u*x;if(F===0)return"rgba(0, 0, 0, 0)";const N=Math.floor((g*C+h*x)/F),z=Math.floor((m*C+b*x)/F),B=Math.floor((w*C+k*x)/F);return`rgba(${N}, ${z}, ${B}, ${F})`}function Pu(e){if(e==="transparent")return 0;function t(i){const a=i/255;return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}const[n,o,r]=Lo(e);return .2126*t(n)+.7152*t(o)+.0722*t(r)}function Ea(e,t){return St.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,contentAlign:n.contentAlign,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled})),[e,t])}function Ia(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(or(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function ar(e,t){return(e??"")===(t??"")}function Fa(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function Gl(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function or(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function Kl(e){return[e.x+e.width-1,e.y+e.height-1]}function yl(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,a=n.y+n.height-1,[l,c]=e;if(c<i||c>a)return!1;if(t.span===void 0)return l>=o&&l<=r;const[f,u]=t.span;return f>=o&&f<=r||u>=o&&f<=r||f<o&&u>r}function Da(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&yl(e,t,i)&&r++;for(const a of n.current.rangeStack)yl(e,t,a)&&r++;return r}function Ul(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,a)=>({...i,sticky:e[a].sticky})),n=o}return n}function Wo(e,t){let n=0;const o=Ul(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function wo(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function Di(e,t,n,o,r){const i=Ul(e,o),a=[];for(const f of i)if(f.sticky)a.push(f);else break;if(a.length>0)for(const f of a)n-=f.width;let l=t,c=r??0;for(;c<=n&&l<i.length;)c+=i[l].width,l++;for(let f=t;f<l;f++){const u=i[f];u.sticky||a.push(u)}return a}function Ha(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function Ta(e,t,n,o,r,i,a,l,c,f){const u=o+r;if(n&&e<=r)return-2;if(e<=u)return-1;let g=t;for(let h=0;h<f;h++){const b=i-1-h,k=typeof a=="number"?a:a(b);if(g-=k,e>=g)return b}const m=i-f,w=e-(c??0);if(typeof a=="number"){const h=Math.floor((w-u)/a)+l;return h>=m?void 0:h}else{let h=u;for(let b=l;b<m;b++){const k=a(b);if(w<=h+k)return b;h+=k}return}}let Or=0,rr={};const qr=typeof window>"u";let Kt=null,Nr=!1;const Aa=!qr&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent);function Vl(){if(!(qr||Nr)&&!(typeof document>"u"))try{Kt=document.createElement("span"),Kt.style.visibility="hidden",Kt.style.position="absolute",Kt.style.top="-9999px",Kt.style.left="-9999px",Kt.style.whiteSpace="nowrap",Kt.style.padding="0",Kt.style.margin="0",Kt.style.border="none",document.body.append(Kt),Nr=!0}catch{Nr=!1,Kt=null}}async function za(){var e;qr||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,Or=0,rr={},ra(),Vl())}za();qr||setTimeout(Vl,0);function ql(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function cn(e,t,n,o="middle"){const r=ql(e,t,o,n);let i=rr[r];if(i===void 0){if(i=t.measureText(e),Aa&&e.length>5&&Nr&&Kt)try{Kt.style.font=n??t.font,Kt.textContent=e;const a=Kt.getBoundingClientRect().width;a>i.width&&Object.defineProperty(i,"width",{value:a,writable:!0,enumerable:!0,configurable:!0})}catch{}rr[r]=i,Or++}return Or>1e4&&(rr={},Or=0),i}function jl(e,t){const n=ql(e,void 0,"middle",t);return rr[n]}function Jn(e,t){return typeof t!="string"&&(t=t.baseFontFull),Ba(e,t)}function pl(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const vl=[];function Ba(e,t){for(const i of vl)if(i.key===t)return i.val;const n=pl(e,"alphabetic"),r=-(pl(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return vl.push({key:t,val:r}),r}function Pa(e,t,n,o,r,i){const{ctx:a,rect:l,theme:c}=e;let f=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(f=n-t,f<u)){const g=1-f/u;a.globalAlpha=g,a.fillStyle=c.bgSearchResult,a.fillRect(l.x+1,l.y+1,l.width-(r?2:1),l.height-(i?2:1)),a.globalAlpha=1,o!==void 0&&(o.fillStyle=c.bgSearchResult)}return f<u}function dr(e,t,n){const{ctx:o,theme:r}=e,i=t??{},a=n??r.textDark;return a!==i.fillStyle&&(o.fillStyle=a,i.fillStyle=a),i}function Lu(e,t,n,o,r){const{rect:i,ctx:a,theme:l}=e;a.fillStyle=l.textDark,En({ctx:a,rect:i,theme:l},t,n,o,r)}function Zl(e,t,n,o,r,i,a,l,c){c==="right"?e.fillText(t,n+r-(l.cellHorizontalPadding+.5),o+i/2+a):c==="center"?e.fillText(t,n+r/2,o+i/2+a):e.fillText(t,n+l.cellHorizontalPadding+.5,o+i/2+a)}function Jl(e,t){const n=cn("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function La(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Wa(e,t,n,o,r,i,a,l,c,f){const u=l.baseFontFull,g=oa(e,t,u,r-l.cellHorizontalPadding*2,f??!1),m=Jl(e,u),w=l.lineHeight*m,h=m+w*(g.length-1),b=h+l.cellVerticalPadding>i;b&&(e.save(),e.rect(n,o,r,i),e.clip());const k=o+i/2-h/2;let x=Math.max(o+l.cellVerticalPadding,k);for(const C of g)if(Zl(e,C,n,x,r,m,a,l,c),x+=w,x>o+i)break;b&&e.restore()}function En(e,t,n,o,r){const{ctx:i,rect:a,theme:l}=e,{x:c,y:f,width:u,height:g}=a;o=o??!1,o||(t=La(t,u));const m=Jn(i,l),w=Wi(t)==="rtl";if(n===void 0&&w&&(n="right"),w&&(i.direction="rtl"),t.length>0){let h=!1;n==="right"?(i.textAlign="right",h=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,h=!0),o?Wa(i,t,c,f,u,g,m,l,n,r):Zl(i,t,c,f,u,g,m,l,n),h&&(i.textAlign="start"),w&&(i.direction="inherit")}}function In(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function $a(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Oa(e,t,n){const o=function(l,c){const f=c.x-l.x,u=c.y-l.y,g=Math.sqrt(f*f+u*u),m=f/g,w=u/g;return{x:f,y:c.y-l.y,len:g,nx:m,ny:w,ang:Math.atan2(w,m)}};let r;const i=t.length;let a=t[i-1];for(let l=0;l<i;l++){let c=t[l%i];const f=t[(l+1)%i],u=o(c,a),g=o(c,f),m=u.nx*g.ny-u.ny*g.nx,w=u.nx*g.nx-u.ny*-g.ny;let h=Math.asin(m<-1?-1:m>1?1:m),b=1,k=!1;w<0?h<0?h=Math.PI+h:(h=Math.PI-h,b=-1,k=!0):h>0&&(b=-1,k=!0),r=c.radius!==void 0?c.radius:n;const x=h/2;let C=Math.abs(Math.cos(x)*r/Math.sin(x)),F;C>Math.min(u.len/2,g.len/2)?(C=Math.min(u.len/2,g.len/2),F=Math.abs(C*Math.sin(x)/Math.cos(x))):F=r;let N=c.x+g.nx*C,z=c.y+g.ny*C;N+=-g.ny*F*b,z+=g.nx*F*b,e.arc(N,z,F,u.ang+Math.PI/2*b,g.ang-Math.PI/2*b,k),a=c,c=f}e.closePath()}function Hi(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h){const b={x:0,y:i+f,width:0,height:0};if(e>=w.length||t>=u||t<-2||e<0)return b;const k=i-r;if(e>=g){const x=a>e?-1:1,C=Wo(w);b.x+=C+c;for(let F=a;F!==e;F+=x)b.x+=w[x===1?F:F-1].width*x}else for(let x=0;x<e;x++)b.x+=w[x].width;if(b.width=w[e].width+1,t===-1)b.y=r,b.height=k;else if(t===-2){b.y=0,b.height=r;let x=e;const C=w[e].group,F=w[e].sticky;for(;x>0&&ar(w[x-1].group,C)&&w[x-1].sticky===F;){const z=w[x-1];b.x-=z.width,b.width+=z.width,x--}let N=e;for(;N+1<w.length&&ar(w[N+1].group,C)&&w[N+1].sticky===F;){const z=w[N+1];b.width+=z.width,N++}if(!F){const z=Wo(w),B=b.x-z;B<0&&(b.x-=B,b.width+=B),b.x+b.width>n&&(b.width=n-b.x)}}else if(t>=u-m){let x=u-t;for(b.y=o;x>0;){const C=t+x-1;b.height=typeof h=="number"?h:h(C),b.y-=b.height,x--}b.height+=1}else{const x=l>t?-1:1;if(typeof h=="number"){const C=t-l;b.y+=C*h}else for(let C=l;C!==t;C+=x)b.y+=h(C)*x;b.height=(typeof h=="number"?h:h(t))+1}return b}const $i=1<<21;function yn(e,t){return(t+2)*$i+e}function Ql(e){return e%$i}function Oi(e){return Math.floor(e/$i)-2}function Ni(e){const t=Ql(e),n=Oi(e);return[t,n]}class es{constructor(){Le(this,"visibleWindow",{x:0,y:0,width:0,height:0});Le(this,"freezeCols",0);Le(this,"freezeRows",[]);Le(this,"isInWindow",t=>{const n=Ql(t),o=Oi(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,a=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&a})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Po(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Na extends es{constructor(){super(...arguments);Le(this,"cache",new Map);Le(this,"setValue",(n,o)=>{this.cache.set(yn(n[0],n[1]),o)});Le(this,"getValue",n=>this.cache.get(yn(n[0],n[1])));Le(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class ir{constructor(t=[]){Le(this,"cells");this.cells=new Set(t.map(n=>yn(n[0],n[1])))}add(t){this.cells.add(yn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(yn(t[0],t[1]))}remove(t){this.cells.delete(yn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(Oi(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(yn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield Ni(t)}}function Xa(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const ts={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function ns(){return ts}const os=St.createContext(ts);function Wu(){return St.useContext(os)}function Ln(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=Qt(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const Ti=150,Ya=150;function _a(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??Ti}function rs(e,t,n,o,r,i,a,l){let c=0;for(const u of r)c=Math.max(c,_a(e,u[o],t,l));const f=cn((n==null?void 0:n.title)??"#",e,t.headerFontFull).width+t.cellHorizontalPadding*2+((n==null?void 0:n.icon)===void 0?0:28);return c=Math.max(c,f),{...n,width:Math.max(Math.ceil(i),Math.min(Math.floor(a),Math.ceil(c)))}}function Ga(e,t,n,o,r,i,a,l,c){const f=s.useRef(t),u=s.useRef(n),g=s.useRef(a);f.current=t,u.current=n,g.current=a;const[m,w]=s.useMemo(()=>{if(typeof window>"u")return[null,null];const z=document.createElement("canvas");return z.style.display="none",z.style.opacity="0",z.style.position="fixed",[z,z.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>(m&&document.documentElement.append(m),()=>{m==null||m.remove()}),[m]);const h=s.useRef({}),b=s.useRef(new Map),k=s.useRef(),[x,C]=s.useState();s.useLayoutEffect(()=>{const z=u.current;if(z===void 0||e.every(zr))return;let B=Math.max(1,Ya-Math.floor(e.length/10)),X=0;B<f.current&&B>1&&(B--,X=1);const _={x:0,y:0,width:e.length,height:Math.min(f.current,B)},E={x:0,y:f.current-1,width:e.length,height:1};(async()=>{const P=z(_,c.signal),H=X>0?z(E,c.signal):void 0;let I;typeof P=="object"?I=P:I=await fl(P),H!==void 0&&(typeof H=="object"?I=[...I,...H]:I=[...I,...await fl(H)]),k.current=e,C(I)})()},[c.signal,e,t]);const F=b.current,N=new Map;for(const z of e){const B=z.id;B!==void 0&&N.set(B,z)}for(const[z]of F)N.has(z)||delete h.current[z];return b.current=N,s.useMemo(()=>{let B=e.every(zr)?e:w===null?e.map(W=>zr(W)?W:{...W,width:Ti}):(w.font=g.current.baseFontFull,e.map((W,P)=>{var I;if(zr(W))return W;if(h.current[W.id]!==void 0&&h.current[W.id].column===W)return{...W,width:h.current[W.id].width};if(x===void 0||k.current!==e||W.id===void 0)return{...W,width:((I=h.current[W.id])==null?void 0:I.width)??Ti};const H=rs(w,a,W,P,x,r,i,l);return h.current[W.id]={width:H.width,column:W},H})),X=0,_=0;const E=[];for(const[W,P]of B.entries())X+=P.width,P.grow!==void 0&&P.grow>0&&(_+=P.grow,E.push(W));if(X<o&&E.length>0){const W=[...B],P=o-X;let H=P;for(let I=0;I<E.length;I++){const M=E[I],J=(B[M].grow??0)/_,V=I===E.length-1?H:Math.min(H,Math.floor(P*J));W[M]={...B[M],growOffset:V,width:B[M].width+V},H-=V}B=W}return{sizedColumns:B,nonGrowWidth:X}},[o,e,w,x,a,r,i,l])}const yt='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Ka=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},Ua=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},Va=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},qa=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},ja=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},is=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},Za=e=>{const t=e.bgColor;return`${yt}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},Ja=is,Qa=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},ec=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},tc=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},nc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},oc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},rc=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},ic=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},lc=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},sc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},ac=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},cc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},dc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},uc=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},fc=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},hc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},gc=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},mc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},wc=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},bc=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},yc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},pc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},vc={headerRowID:Ka,headerNumber:Va,headerCode:Ua,headerString:qa,headerBoolean:ja,headerAudioUri:Ja,headerVideoUri:Qa,headerEmoji:ec,headerImage:tc,headerUri:is,headerPhone:nc,headerMarkdown:oc,headerDate:rc,headerTime:ic,headerEmail:lc,headerReference:sc,headerIfThenElse:ac,headerSingleValue:cc,headerLookup:dc,headerTextTemplate:uc,headerMath:fc,headerRollup:hc,headerJoinStrings:gc,headerSplitString:mc,headerGeoDistance:wc,headerArray:bc,rowOwnerOverlay:yc,protectedColumnOverlay:pc,renameIcon:Za};function Cc(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class xc{constructor(t,n){Le(this,"onSettled");Le(this,"spriteMap",new Map);Le(this,"headerIcons");Le(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,a,l,c=1){const[f,u]=Cc(n,l),g=a*Math.ceil(window.devicePixelRatio),m=`${f}_${u}_${g}_${t}`;let w=this.spriteMap.get(m);if(w===void 0){const h=this.headerIcons[t];if(h===void 0)return;w=document.createElement("canvas");const b=w.getContext("2d");if(b===null)return;const k=new Image;k.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(h({fgColor:u,bgColor:f}))}`,this.spriteMap.set(m,w);const x=k.decode();if(x===void 0)return;this.inFlight++,x.then(()=>{b.drawImage(k,0,0,g,g)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else c<1&&(o.globalAlpha=c),o.drawImage(w,0,0,g,g,r,i,a,a),c<1&&(o.globalAlpha=1)}}function ls(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function jr(e,t,n,o,r,i,a,l,c){l=l??t;let f=t,u=e;const g=o-i;let m=!1;for(;f<n&&u<g;){const w=r(u);if(f+w>l&&c(f,u,w,!1,a&&u===o-1)===!0){m=!0;break}f+=w,u++}if(!m){f=n;for(let w=0;w<i;w++){u=o-1-w;const h=r(u);f-=h,c(f,u,h,!0,a&&u===o-1)}}}function Qn(e,t,n,o,r,i){let a=0,l=0;const c=r+o;for(const f of e){const u=f.sticky?l:a+n;if(i(f,u,c,f.sticky?0:l,t)===!0)break;a+=f.width,l+=f.sticky?f.width:0}}function ss(e,t,n,o,r){let i=0,a=0;for(let l=0;l<e.length;l++){const c=e[l];let f=l+1,u=c.width;for(c.sticky&&(a+=u);f<e.length&&ar(e[f].group,c.group)&&e[f].sticky===e[l].sticky;){const b=e[f];u+=b.width,f++,l++,b.sticky&&(a+=b.width)}const g=c.sticky?0:n,m=i+g,w=c.sticky?0:Math.max(0,a-m),h=Math.min(u-w,t-(m+w));r([c.sourceIndex,e[f-1].sourceIndex],c.group??"",m+w,0,h,o),i+=u}}function as(e,t,n,o,r,i,a){var m;const[l,c]=e;let f,u;const g=((m=a.find(w=>!w.sticky))==null?void 0:m.sourceIndex)??0;if(c>g){const w=Math.max(l,g);let h=t,b=o;for(let k=i.sourceIndex-1;k>=w;k--)h-=a[k].width,b+=a[k].width;for(let k=i.sourceIndex+1;k<=c;k++)b+=a[k].width;u={x:h,y:n,width:b,height:r}}if(g>l){const w=Math.min(c,g-1);let h=t,b=o;for(let k=i.sourceIndex-1;k>=l;k--)h-=a[k].width,b+=a[k].width;for(let k=i.sourceIndex+1;k<=w;k++)b+=a[k].width;f={x:h,y:n,width:b,height:r}}return[f,u]}function kc(e,t,n,o){if(o==="any")return cs(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),Gl([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,a=n-e.y+1,l=e.y+e.height-n,c=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:a,o==="horizontal"?Number.MAX_SAFE_INTEGER:l);return c===l?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:c===a?{x:e.x,y:n,width:e.width,height:e.y-n}:c===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function cr(e,t,n,o,r,i,a,l){return e<=r+a&&r<=e+n&&t<=i+l&&i<=t+o}function go(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function cs(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function Sc(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function Mc(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,a=t+4,l=n+4,c=r-e.x,f=e.x+e.width-a,u=i-e.y,g=e.y+e.height-l,m=c>0?e.x+Math.floor(c/o)*o:e.x,w=f>0?e.x+e.width-Math.floor(f/o)*o:e.x+e.width,h=u>0?e.y+Math.floor(u/o)*o:e.y,b=g>0?e.y+e.height-Math.floor(g/o)*o:e.y+e.height;return{x:m,y:h,width:w-m,height:b-h}}function Rc(e,t,n,o,r){const[i,a,l,c]=t,[f,u,g,m]=r,{x:w,y:h,width:b,height:k}=e,x=[];if(b<=0||k<=0)return x;const C=w+b,F=h+k,N=w<i,z=h<a,B=w+b>l,X=h+k>c,_=w>=i&&w<l||C>i&&C<=l||w<i&&C>l,E=h>=a&&h<c||F>a&&F<=c||h<a&&F>c;if(_&&E){const P=Math.max(w,i),H=Math.max(h,a),I=Math.min(C,l),M=Math.min(F,c);x.push({rect:{x:P,y:H,width:I-P,height:M-H},clip:{x:f,y:u,width:g-f+1,height:m-u+1}})}if(N&&z){const P=w,H=h,I=Math.min(C,i),M=Math.min(F,a);x.push({rect:{x:P,y:H,width:I-P,height:M-H},clip:{x:0,y:0,width:f+1,height:u+1}})}if(z&&_){const P=Math.max(w,i),H=h,I=Math.min(C,l),M=Math.min(F,a);x.push({rect:{x:P,y:H,width:I-P,height:M-H},clip:{x:f,y:0,width:g-f+1,height:u+1}})}if(z&&B){const P=Math.max(w,l),H=h,I=C,M=Math.min(F,a);x.push({rect:{x:P,y:H,width:I-P,height:M-H},clip:{x:g,y:0,width:n-g+1,height:u+1}})}if(N&&E){const P=w,H=Math.max(h,a),I=Math.min(C,i),M=Math.min(F,c);x.push({rect:{x:P,y:H,width:I-P,height:M-H},clip:{x:0,y:u,width:f+1,height:m-u+1}})}if(B&&E){const P=Math.max(w,l),H=Math.max(h,a),I=C,M=Math.min(F,c);x.push({rect:{x:P,y:H,width:I-P,height:M-H},clip:{x:g,y:u,width:n-g+1,height:m-u+1}})}if(N&&X){const P=w,H=Math.max(h,c),I=Math.min(C,i),M=F;x.push({rect:{x:P,y:H,width:I-P,height:M-H},clip:{x:0,y:m,width:f+1,height:o-m+1}})}if(X&&_){const P=Math.max(w,i),H=Math.max(h,c),I=Math.min(C,l),M=F;x.push({rect:{x:P,y:H,width:I-P,height:M-H},clip:{x:f,y:m,width:g-f+1,height:o-m+1}})}if(B&&X){const P=Math.max(w,l),H=Math.max(h,c),I=C,M=F;x.push({rect:{x:P,y:H,width:I-P,height:M-H},clip:{x:g,y:m,width:n-g+1,height:o-m+1}})}return x}const Ec={kind:Q.Loading,allowOverlay:!1};function Cl(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,k,x,C,F,N,z,B,X,_,E,W,P,H,I,M,J,V,se,be){let ve=(F==null?void 0:F.size)??Number.MAX_SAFE_INTEGER;const ee=performance.now();let G=I.baseFontFull;e.font=G;const Re={ctx:e},Z=[0,0],fe=k>0?wo(c,k,f):0;let Oe,K;const re=ls(C);return Qn(t,l,i,a,r,(he,Xe,Ne,Ke,nt)=>{const De=Math.max(0,Ke-Xe),Ye=Xe+De,Ie=r+1,dt=he.width-De,ht=o-r-1;if(C.length>0){let Qe=!1;for(let Ue=0;Ue<C.length;Ue++){const Ze=C[Ue];if(cr(Ye,Ie,dt,ht,Ze.x,Ze.y,Ze.width,Ze.height)){Qe=!0;break}}if(!Qe)return}const gt=()=>{e.save(),e.beginPath(),e.rect(Ye,Ie,dt,ht),e.clip()},te=N.columns.hasIndex(he.sourceIndex),Ce=g(he.group??"").overrideTheme,ae=he.themeOverride===void 0&&Ce===void 0?I:Ln(I,Ce,he.themeOverride),ge=ae.baseFontFull;ge!==G&&(G=ge,e.font=ge),gt();let me;return jr(nt,Ne,o,c,f,k,x,re,(Qe,Ue,Ze,le,we)=>{var Fn,tn,Be;if(Ue<0||(Z[0]=he.sourceIndex,Z[1]=Ue,F!==void 0&&!F.has(Z)))return;if(C.length>0){let He=!1;for(let It=0;It<C.length;It++){const vt=C[It];if(cr(Xe,Qe,he.width,Ze,vt.x,vt.y,vt.width,vt.height)){He=!0;break}}if(!He)return}const Ve=N.rows.hasIndex(Ue),qe=w.hasIndex(Ue),ze=Ue<c?u(Z):Ec;let pt=Xe,et=he.width,Ae=!1,Mt=!1;if(ze.span!==void 0){const[He,It]=ze.span,vt=`${Ue},${He},${It},${he.sticky}`;if(K===void 0&&(K=new Set),K.has(vt)){ve--;return}else{const nn=as(ze.span,Xe,Qe,he.width,Ze,he,n),Ht=he.sticky?nn[0]:nn[1];if(!he.sticky&&nn[0]!==void 0&&(Mt=!0),Ht!==void 0){pt=Ht.x,et=Ht.width,K.add(vt),e.restore(),me=void 0,e.save(),e.beginPath();const pn=Math.max(0,Ke-Ht.x);e.rect(Ht.x+pn,Qe,Ht.width-pn,Ze),Oe===void 0&&(Oe=[]),Oe.push({x:Ht.x+pn,y:Qe,width:Ht.width-pn,height:Ze}),e.clip(),Ae=!0}}}const At=m==null?void 0:m(Ue),zt=we&&((Fn=he.trailingRowOptions)==null?void 0:Fn.themeOverride)!==void 0?(tn=he.trailingRowOptions)==null?void 0:tn.themeOverride:void 0,st=ze.themeOverride===void 0&&At===void 0&&zt===void 0?ae:Ln(ae,At,zt,ze.themeOverride);e.beginPath();const $t=Fa(Z,ze,N);let Dt=Da(Z,ze,N,b);const Xt=ze.span!==void 0&&N.columns.some(He=>ze.span!==void 0&&He>=ze.span[0]&&He<=ze.span[1]);$t&&!h&&b?Dt=0:$t&&b&&(Dt=Math.max(Dt,1)),Xt&&Dt++,$t||(Ve&&Dt++,te&&!we&&Dt++);const Wn=ze.kind===Q.Protected?st.bgCellMedium:st.bgCell;let it;if((le||Wn!==I.bgCell)&&(it=Qt(Wn,it)),Dt>0||qe){qe&&(it=Qt(st.bgHeader,it));for(let He=0;He<Dt;He++)it=Qt(st.accentLight,it)}else if(z!==void 0){for(const He of z)if(He[0]===he.sourceIndex&&He[1]===Ue){it=Qt(st.bgSearchResult,it);break}}if(B!==void 0)for(let He=0;He<B.length;He++){const It=B[He],vt=It.range;It.style!=="solid-outline"&&vt.x<=he.sourceIndex&&he.sourceIndex<vt.x+vt.width&&vt.y<=Ue&&Ue<vt.y+vt.height&&(it=Qt(It.color,it))}let Yt=!1;if(F!==void 0){const He=Qe+1,vt=(le?He+Ze-1:Math.min(He+Ze-1,o-fe))-He;(vt!==Ze-1||pt+1<=Ke)&&(Yt=!0,e.save(),e.beginPath(),e.rect(pt+1,He,et-1,vt),e.clip()),it=it===void 0?st.bgCell:Qt(it,st.bgCell)}const jt=he.sourceIndex===n.length-1,mt=Ue===c-1;it!==void 0&&(e.fillStyle=it,me!==void 0&&(me.fillStyle=it),F!==void 0?e.fillRect(pt+1,Qe+1,et-(jt?2:1),Ze-(mt?2:1)):e.fillRect(pt,Qe,et,Ze)),ze.style==="faded"&&(e.globalAlpha=.6);let Ot;for(let He=0;He<E.length;He++){const It=E[He];if(It.item[0]===he.sourceIndex&&It.item[1]===Ue){Ot=It;break}}if(et>be&&!Mt){const He=st.baseFontFull;He!==G&&(e.font=He,G=He),me=ds(e,ze,he.sourceIndex,Ue,jt,mt,pt,Qe,et,Ze,Dt>0,st,it??st.bgCell,X,_,(Ot==null?void 0:Ot.hoverAmount)??0,W,H,ee,P,me,M,J,V,se)}return Yt&&e.restore(),ze.style==="faded"&&(e.globalAlpha=1),ve--,Ae&&(e.restore(),(Be=me==null?void 0:me.deprep)==null||Be.call(me,Re),me=void 0,gt(),G=ge,e.font=ge),ve<=0}),e.restore(),ve<=0}),Oe}const Qo=[0,0],er={x:0,y:0,width:0,height:0},Si=[void 0,()=>{}];let Ai=!1;function Ic(){Ai=!0}function ds(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,k,x,C,F,N,z,B,X,_){var J,V;let E,W;k!==void 0&&k[0][0]===n&&k[0][1]===o&&(E=k[1][0],W=k[1][1]);let P;Qo[0]=n,Qo[1]=o,er.x=a,er.y=l,er.width=c,er.height=f,Si[0]=B.getValue(Qo),Si[1]=se=>B.setValue(Qo,se),Ai=!1;const H={ctx:e,theme:g,col:n,row:o,cell:t,rect:er,highlighted:u,cellFillColor:m,hoverAmount:b,frameTime:C,hoverX:E,drawState:Si,hoverY:W,imageLoader:w,spriteManager:h,hyperWrapping:x,overrideCursor:E!==void 0?_:void 0,requestAnimationFrame:Ic},I=Pa(H,t.lastUpdated,C,N,r,i),M=X(t);if(M!==void 0){(N==null?void 0:N.renderer)!==M&&((J=N==null?void 0:N.deprep)==null||J.call(N,H),N=void 0);const se=(V=M.drawPrep)==null?void 0:V.call(M,H,N);F!==void 0&&!zo(H.cell)?F(H,()=>M.draw(H,t)):M.draw(H,t),P=se===void 0?void 0:{deprep:se==null?void 0:se.deprep,fillStyle:se==null?void 0:se.fillStyle,font:se==null?void 0:se.font,renderer:M}}return(I||Ai)&&(z==null||z(Qo)),P}function Xi(e,t,n,o,r,i,a,l,c=-20,f=-20,u=void 0,g="center",m="square"){const w=Math.floor(r+a/2),h=m==="circle"?1e4:t.roundingRadius??4;let b=Xl(u??t.checkboxMaxSize,a,t.cellVerticalPadding),k=b/2;const x=Nl(g,o,i,t.cellHorizontalPadding,b),C=Ol(x,w,b),F=Yl(o+c,r+f,C);switch(n){case!0:{e.beginPath(),In(e,x-b/2,w-b/2,b,b,h),m==="circle"&&(k*=.8,b*=.8),e.fillStyle=l?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(x-k+b/4.23,w-k+b/1.97),e.lineTo(x-k+b/2.42,w-k+b/1.44),e.lineTo(x-k+b/1.29,w-k+b/3.25),e.strokeStyle=t.rowMarkerIcon??t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case Xr:case!1:{e.beginPath(),In(e,x-b/2+.5,w-b/2+.5,b-1,b-1,h),e.lineWidth=1,e.strokeStyle=F?t.textDark:t.textMedium,e.stroke();break}case Bi:{e.beginPath(),In(e,x-b/2,w-b/2,b,b,h),e.fillStyle=F?t.textMedium:t.textLight,e.fill(),m==="circle"&&(k*=.8,b*=.8),e.beginPath(),e.moveTo(x-b/3,w),e.lineTo(x+b/3,w),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:sr()}}function Fc(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,k,x,C){var E,W,P,H;const F=a+l;if(F<=0)return;e.fillStyle=g.bgHeader,e.fillRect(0,0,r,F);const N=(E=o==null?void 0:o[0])==null?void 0:E[0],z=(W=o==null?void 0:o[0])==null?void 0:W[1],B=(P=o==null?void 0:o[1])==null?void 0:P[0],X=(H=o==null?void 0:o[1])==null?void 0:H[1],_=g.headerFontFull;e.font=_,Qn(t,0,i,0,F,(I,M,J,V)=>{var he;if(k!==void 0&&!k.has([I.sourceIndex,-1]))return;const se=Math.max(0,V-M);e.save(),e.beginPath(),e.rect(M+se,l,I.width-se,a),e.clip();const be=b(I.group??"").overrideTheme,ve=I.themeOverride===void 0&&be===void 0?g:Ln(g,be,I.themeOverride);ve.bgHeader!==g.bgHeader&&(e.fillStyle=ve.bgHeader,e.fill()),ve!==g&&(e.font=ve.headerFontFull);const ee=u.columns.hasIndex(I.sourceIndex),G=c!==void 0||f||I.headerRowMarkerDisabled===!0,Re=!G&&z===-1&&N===I.sourceIndex,Z=G?0:((he=w.find(Xe=>Xe.item[0]===I.sourceIndex&&Xe.item[1]===-1))==null?void 0:he.hoverAmount)??0,fe=(u==null?void 0:u.current)!==void 0&&u.current.cell[0]===I.sourceIndex,Oe=ee?ve.accentColor:fe?ve.bgHeaderHasFocus:ve.bgHeader,K=n?l:0,re=I.sourceIndex===0?0:1;ee?(e.fillStyle=Oe,e.fillRect(M+re,K,I.width-re,a)):(fe||Z>0)&&(e.beginPath(),e.rect(M+re,K,I.width-re,a),fe&&(e.fillStyle=ve.bgHeaderHasFocus,e.fill()),Z>0&&(e.globalAlpha=Z,e.fillStyle=ve.bgHeaderHovered,e.fill(),e.globalAlpha=1)),hs(e,M,K,I.width,a,I,ee,ve,Re,Re?B:void 0,Re?X:void 0,fe,Z,m,x,C),e.restore()}),n&&Dc(e,t,r,i,l,o,g,m,w,h,b,k)}function Dc(e,t,n,o,r,i,a,l,c,f,u,g){const m=a.cellHorizontalPadding,[w,h]=(i==null?void 0:i[0])??[];let b=0;ss(t,n,o,r,(k,x,C,F,N,z)=>{if(g!==void 0&&!g.hasItemInRectangle({x:k[0],y:-2,width:k[1]-k[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(C,F,N,z),e.clip();const B=u(x),X=(B==null?void 0:B.overrideTheme)===void 0?a:Ln(a,B.overrideTheme),_=h===-2&&w!==void 0&&w>=k[0]&&w<=k[1],E=_?X.bgGroupHeaderHovered??X.bgHeaderHovered:X.bgGroupHeader??X.bgHeader;if(E!==a.bgHeader&&(e.fillStyle=E,e.fill()),e.fillStyle=X.textGroupHeader??X.textHeader,B!==void 0){let W=C;if(B.icon!==void 0&&(l.drawSprite(B.icon,"normal",e,W+m,(r-20)/2,20,X),W+=26),e.fillText(B.name,W+m,r/2+Jn(e,a.headerFontFull)),B.actions!==void 0&&_){const P=us({x:C,y:F,width:N,height:z},B.actions);e.beginPath();const H=P[0].x-10,I=C+N-H;e.rect(H,0,I,r);const M=e.createLinearGradient(H,0,H+I,0),J=mo(E,0);M.addColorStop(0,J),M.addColorStop(10/I,E),M.addColorStop(1,E),e.fillStyle=M,e.fill(),e.globalAlpha=.6;const[V,se]=(i==null?void 0:i[1])??[-1,-1];for(let be=0;be<B.actions.length;be++){const ve=B.actions[be],ee=P[be],G=go(ee,V+C,se);G&&(e.globalAlpha=1),l.drawSprite(ve.icon,"normal",e,ee.x+ee.width/2-10,ee.y+ee.height/2-10,20,X),G&&(e.globalAlpha=.6)}e.globalAlpha=1}}C!==0&&f(k[0])&&(e.beginPath(),e.moveTo(C+.5,0),e.lineTo(C+.5,r),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()),e.restore(),b=C+N}),e.beginPath(),e.moveTo(b+.5,0),e.lineTo(b+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()}const Pr=30;function Hc(e,t,n,o,r){return{x:e+n-Pr,y:Math.max(t,t+o/2-Pr/2),width:Pr,height:Math.min(Pr,o)}}function us(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,a=26;for(let l=0;l<t.length;l++)n.push({x:o,y:r,width:a,height:i}),o+=26;return n}function tr(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function fs(e,t,n,o,r,i,a,l){var z;const c=a.cellHorizontalPadding,f=a.headerIconSize,u=Hc(n,o,r,i),g=l||t.contentAlign==="right",m=t.contentAlign==="center";let w=n+c,h,b;const k=t.icon!==void 0&&t.icon!==null;k&&(h={x:g?n+r-c-f:w,y:o+(i-f)/2,width:f,height:f},g||(w+=Math.ceil(f*1.3)),t.overlayIcon!==void 0&&(b={x:h.x+9,y:h.y+6,width:18,height:18}));const x=e===void 0?((z=jl(t.title,a.headerFontFull))==null?void 0:z.width)??0:cn(t.title,e,a.headerFontFull).width,C={x:m?n+(r-x)/2:g?n:w,y:o,width:m?x:g?r-(k?f+c:c):r-(w-n)-c,height:i};let F;t.indicatorIcon!==void 0&&(F={x:g?k?h.x-f-c:n+r-f-c:w+x+c,y:o+(i-f)/2,width:f,height:f});const N=n+r/2;return{menuBounds:tr(u,N,l),iconBounds:tr(h,N,l),iconOverlayBounds:tr(b,N,l),textBounds:tr(C,N,l),indicatorIconBounds:tr(F,N,l)}}function xl(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){const C=i.rowMarkerChecked;C!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=g);const F=i.headerRowMarkerTheme!==void 0?Ln(l,i.headerRowMarkerTheme):l;Xi(e,F,C,t,n,o,r,!1,void 0,void 0,l.checkboxMaxSize,"center",i.rowMarker),C!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const k=a?l.textHeaderSelected:l.textHeader,x=i.hasMenu===!0&&(c||w&&a)&&b.menuBounds!==void 0;if(i.icon!==void 0&&b.iconBounds!==void 0){let C=a?"selected":"normal";i.style==="highlight"&&(C=a?"selected":"special"),m.drawSprite(i.icon,C,e,b.iconBounds.x,b.iconBounds.y,b.iconBounds.width,l),i.overlayIcon!==void 0&&b.iconOverlayBounds!==void 0&&m.drawSprite(i.overlayIcon,a?"selected":"special",e,b.iconOverlayBounds.x,b.iconOverlayBounds.y,b.iconOverlayBounds.width,l)}if(x&&o>35){const F=h?35:o-35,N=h?35*.7:o-35*.7,z=F/o,B=N/o,X=e.createLinearGradient(t,0,t+o,0),_=mo(k,0);X.addColorStop(h?1:0,k),X.addColorStop(z,k),X.addColorStop(B,_),X.addColorStop(h?0:1,_),e.fillStyle=X}else e.fillStyle=k;if(b.textBounds!==void 0){const C=h||i.contentAlign==="right";e.textAlign=C?"right":"left";const F=C?b.textBounds.x+b.textBounds.width:b.textBounds.x;e.fillText(i.title,F,n+r/2+Jn(e,l.headerFontFull))}if(i.indicatorIcon!==void 0&&b.indicatorIconBounds!==void 0&&(!x||!cr(b.menuBounds.x,b.menuBounds.y,b.menuBounds.width,b.menuBounds.height,b.indicatorIconBounds.x,b.indicatorIconBounds.y,b.indicatorIconBounds.width,b.indicatorIconBounds.height))){let C=a?"selected":"normal";i.style==="highlight"&&(C=a?"selected":"special"),m.drawSprite(i.indicatorIcon,C,e,b.indicatorIconBounds.x,b.indicatorIconBounds.y,b.indicatorIconBounds.width,l)}if(x&&b.menuBounds!==void 0){const C=b.menuBounds,F=f!==void 0&&u!==void 0&&go(C,f+t,u+n);if(F||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===Yr.Triangle){e.beginPath();const N=C.x+C.width/2-5.5,z=C.y+C.height/2-3;Oa(e,[{x:N,y:z},{x:N+11,y:z},{x:N+5.5,y:z+6}],1),e.fillStyle=k,e.fill()}else if(i.menuIcon===Yr.Dots){e.beginPath();const N=C.x+C.width/2,z=C.y+C.height/2;$a(e,N,z),e.fillStyle=k,e.fill()}else{const N=C.x+(C.width-l.headerIconSize)/2,z=C.y+(C.height-l.headerIconSize)/2;m.drawSprite(i.menuIcon,"normal",e,N,z,l.headerIconSize,l)}F||(e.globalAlpha=1)}}function hs(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b){const k=Wi(i.title)==="rtl",x=fs(e,i,t,n,o,r,l,k);h!==void 0?h({ctx:e,theme:l,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:a,hoverAmount:m,isHovered:c,hasSelectedCell:g,spriteManager:w,menuBounds:(x==null?void 0:x.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:f,hoverY:u},()=>xl(e,t,n,o,r,i,a,l,c,f,u,m,w,b,k,x)):xl(e,t,n,o,r,i,a,l,c,f,u,m,w,b,k,x)}function Tc(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,k,x,C){if(x!==void 0||t[t.length-1]!==n[t.length-1])return;const F=ls(k);Qn(t,c,a,l,i,(N,z,B,X,_)=>{if(N!==t[t.length-1])return;z+=N.width;const E=Math.max(z,X);E>o||(e.save(),e.beginPath(),e.rect(E,i+1,1e4,r-i-1),e.clip(),jr(_,B,r,f,u,h,b,F,(W,P,H,I)=>{if(!I&&k.length>0&&!k.some(be=>cr(z,W,1e4,H,be.x,be.y,be.width,be.height)))return;const M=m.hasIndex(P),J=w.hasIndex(P);e.beginPath();const V=g==null?void 0:g(P),se=V===void 0?C:Ln(C,V);se.bgCell!==C.bgCell&&(e.fillStyle=se.bgCell,e.fillRect(z,W,1e4,H)),J&&(e.fillStyle=se.bgHeader,e.fillRect(z,W,1e4,H)),M&&(e.fillStyle=se.accentLight,e.fillRect(z,W,1e4,H))}),e.restore())})}function Ac(e,t,n,o,r,i,a,l,c){let f=!1;for(const h of t)if(!h.sticky){f=a(h.sourceIndex);break}const u=c.horizontalBorderColor??c.borderColor,g=c.borderColor,m=f?Wo(t):0;let w;if(m!==0&&(w=bl(g,c.bgCell),e.beginPath(),e.moveTo(m+.5,0),e.lineTo(m+.5,o),e.strokeStyle=w,e.stroke()),r>0){const h=g===u&&w!==void 0?w:bl(u,c.bgCell),b=wo(i,r,l);e.beginPath(),e.moveTo(0,o-b+.5),e.lineTo(n,o-b+.5),e.strokeStyle=h,e.stroke()}}const gs=(e,t,n)=>{let o=0,r=t,i=0,a=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;for(const l of e)o=Math.min(o,l.x-1),r=Math.max(r,l.x+l.width+1),i=Math.min(i,l.y-1),a=Math.max(a,l.y+l.height+1)}return{minX:o,maxX:r,minY:i,maxY:a}};function zc(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h){var H;const b=h.bgCell,{minX:k,maxX:x,minY:C,maxY:F}=gs(l,i,a),N=[],z=a-wo(w,m,f);let B=c,X=n,_=0;for(;B+r<z;){const I=B+r,M=f(X);if(I>=C&&I<=F-1){const J=u==null?void 0:u(X),V=J==null?void 0:J.bgCell;V!==void 0&&V!==b&&X>=w-m&&N.push({x:k,y:I,w:x-k,h:M,color:V})}B+=M,X<w-m&&(_=B),X++}let E=0;const W=Math.min(z,F)-_;if(W>0)for(let I=0;I<t.length;I++){const M=t[I];if(M.width===0)continue;const J=M.sticky?E:E+o,V=(H=M.themeOverride)==null?void 0:H.bgCell;V!==void 0&&V!==b&&J>=k&&J<=x&&g(I+1)&&N.push({x:J,y:_,w:M.width,h:W,color:V}),E+=M.width}if(N.length===0)return;let P;e.beginPath();for(let I=N.length-1;I>=0;I--){const M=N[I];P===void 0?P=M.color:M.color!==P&&(e.fillStyle=P,e.fill(),e.beginPath(),P=M.color),e.rect(M.x,M.y,M.w,M.h)}P!==void 0&&(e.fillStyle=P,e.fill()),e.beginPath()}function kl(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,k,x=!1){if(c!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,a);for(const H of c)e.rect(H.x+1,H.y+1,H.width-1,H.height-1);e.clip("evenodd")}const C=k.horizontalBorderColor??k.borderColor,F=k.borderColor,{minX:N,maxX:z,minY:B,maxY:X}=gs(l,i,a),_=[];e.beginPath();let E=.5;for(let H=0;H<t.length;H++){const I=t[H];if(I.width===0)continue;E+=I.width;const M=I.sticky?E:E+o;M>=N&&M<=z&&w(H+1)&&_.push({x1:M,y1:Math.max(f,B),x2:M,y2:Math.min(a,X),color:F})}let W=a+.5;for(let H=b-h;H<b;H++){const I=g(H);W-=I,_.push({x1:N,y1:W,x2:z,y2:W,color:C})}if(x!==!0){let H=u+.5,I=n;const M=W;for(;H+r<M;){const J=H+r;if(J>=B&&J<=X-1){const V=m==null?void 0:m(I);_.push({x1:N,y1:J,x2:z,y2:J,color:(V==null?void 0:V.horizontalBorderColor)??(V==null?void 0:V.borderColor)??C})}H+=g(I),I++}}const P=ia(_,H=>H.color);for(const H of Object.keys(P)){e.strokeStyle=H;for(const I of P[H])e.moveTo(I.x1,I.y1),e.lineTo(I.x2,I.y2);e.stroke(),e.beginPath()}c!==void 0&&e.restore()}function Bc(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,k,x,C){const F=[];e.imageSmoothingEnabled=!1;const N=Math.min(r.cellYOffset,a),z=Math.max(r.cellYOffset,a);let B=0;if(typeof x=="number")B+=(z-N)*x;else for(let M=N;M<z;M++)B+=x(M);a>r.cellYOffset&&(B=-B),B+=c-r.translateY;const X=Math.min(r.cellXOffset,i),_=Math.max(r.cellXOffset,i);let E=0;for(let M=X;M<_;M++)E+=b[M].width;i>r.cellXOffset&&(E=-E),E+=l-r.translateX;const W=Wo(k);if(E!==0&&B!==0)return{regions:[]};const P=f>0?wo(m,f,x):0,H=u-W-Math.abs(E),I=g-w-P-Math.abs(B)-1;if(H>150&&I>150){const M={sx:0,sy:0,sw:u*h,sh:g*h,dx:0,dy:0,dw:u*h,dh:g*h};if(B>0?(M.sy=(w+1)*h,M.sh=I*h,M.dy=(B+w+1)*h,M.dh=I*h,F.push({x:0,y:w,width:u,height:B+1})):B<0&&(M.sy=(-B+w+1)*h,M.sh=I*h,M.dy=(w+1)*h,M.dh=I*h,F.push({x:0,y:g+B-P,width:u,height:-B+P})),E>0?(M.sx=W*h,M.sw=H*h,M.dx=(E+W)*h,M.dw=H*h,F.push({x:W-1,y:0,width:E+2,height:g})):E<0&&(M.sx=(W-E)*h,M.sw=H*h,M.dx=W*h,M.dw=H*h,F.push({x:u+E,y:0,width:-E,height:g})),e.setTransform(1,0,0,1,0,0),C){if(W>0&&E!==0&&B===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const J=W*h,V=g*h;e.drawImage(t,0,0,J,V,0,0,J,V)}if(P>0&&E===0&&B!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const J=(g-P)*h,V=u*h,se=P*h;e.drawImage(t,0,J,V,se,0,J,V,se)}}e.drawImage(t,M.sx,M.sy,M.sw,M.sh,M.dx,M.dy,M.dw,M.dh),e.scale(h,h)}return e.imageSmoothingEnabled=!0,{regions:F}}function Pc(e,t,n,o,r,i,a,l,c,f){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||Qn(c,n,o,r,l,(g,m,w,h)=>{if(g.sourceIndex===f){const b=Math.max(m,h)+1;return u.push({x:b,y:0,width:i-b,height:a}),!0}}),u}function Lc(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if(Po(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:a,...l}=r,{width:c,...f}=i;if(!Po(l,f))return!1;n=o}return n===void 0?!0:n}return!0}function Sl(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b){const k=h==null?void 0:h.filter(X=>X.style!=="no-outline");if(k===void 0||k.length===0)return;const x=Wo(l),C=wo(w,m,g),F=[c,0,l.length,w-m],N=[x,0,t,n-C],z=k.map(X=>{const _=X.range,E=X.style??"dashed";return Rc(_,F,t,n,N).map(W=>{const P=W.rect,H=Hi(P.x,P.y,t,n,u,f+u,o,r,i,a,w,c,m,l,g),I=P.width===1&&P.height===1?H:Hi(P.x+P.width-1,P.y+P.height-1,t,n,u,f+u,o,r,i,a,w,c,m,l,g);return P.x+P.width>=l.length&&(I.width-=1),P.y+P.height>=w&&(I.height-=1),{color:X.color,style:E,clip:W.clip,rect:Mc({x:H.x,y:H.y,width:I.x+I.width-H.x,height:I.y+I.height-H.y},t,n,8)}})}),B=()=>{e.lineWidth=1;let X=!1;for(const _ of z)for(const E of _)if((E==null?void 0:E.rect)!==void 0&&cr(0,0,t,n,E.rect.x,E.rect.y,E.rect.width,E.rect.height)){const W=X,P=!Sc(E.clip,E.rect);e.beginPath(),P&&(e.save(),e.rect(E.clip.x,E.clip.y,E.clip.width,E.clip.height),e.clip()),E.style==="dashed"&&!X?(e.setLineDash([5,3]),X=!0):(E.style==="solid"||E.style==="solid-outline")&&X&&(e.setLineDash([]),X=!1),e.strokeStyle=E.style==="solid-outline"?Qt(Qt(E.color,b.borderColor),b.bgCell):mo(E.color,1),e.closePath(),e.strokeRect(E.rect.x+.5,E.rect.y+.5,E.rect.width-1,E.rect.height-1),P&&(e.restore(),X=W)}X&&e.setLineDash([])};return B(),B}function Ml(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function Mi(e,t,n,o,r,i,a,l,c,f,u,g,m,w,h,b,k){if(u.current===void 0)return;const x=b!==!1&&b!==void 0;if(!x)return;const C=typeof b=="object"?{..._r,...b}:_r,F=u.current.range,N=u.current.cell,z=[F.x+F.width-1,F.y+F.height-1];if(N[1]>=k&&z[1]>=k||!a.some(V=>V.sourceIndex===N[0]||V.sourceIndex===z[0]))return;const[X,_]=u.current.cell,E=m(u.current.cell),W=E.span??[X,X],P=_>=k-w,H=w>0&&!P?wo(k,w,g)-1:0,I=z[1];let M;if(Qn(a,o,r,i,f,(V,se,be,ve,ee)=>{if(V.sticky&&X>V.sourceIndex)return;const G=V.sourceIndex<W[0],Re=V.sourceIndex>W[1],Z=V.sourceIndex===z[0];if(!(!Z&&(G||Re)))return jr(ee,be,n,k,g,w,h,void 0,(fe,Oe,K)=>{if(Oe!==_&&Oe!==I)return;let re=se,he=V.width;if(E.span!==void 0){const Ne=as(E.span,se,fe,V.width,K,V,l),Ke=V.sticky?Ne[0]:Ne[1];Ke!==void 0&&(re=Ke.x,he=Ke.width)}return Oe===I&&Z&&x&&(M=()=>{var Ye;ve>re&&!V.sticky&&(e.beginPath(),e.rect(ve,0,t-ve,n),e.clip());const Ne=C.size,Ke=Ne/2,nt=re+he+C.offsetX-Ke+.5,De=fe+K+C.offsetY-Ke+.5;e.beginPath(),C.shape==="circle"?e.arc(nt+Ke,De+Ke,Ke,0,Math.PI*2):e.rect(nt,De,Ne,Ne),e.fillStyle=((Ye=V.themeOverride)==null?void 0:Ye.accentColor)??c.accentColor,e.fill(),C.outline>0&&(e.lineWidth=C.outline,e.strokeStyle=c.bgCell,C.shape==="circle"?(e.beginPath(),e.arc(nt+Ke,De+Ke,Ke+C.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(nt-C.outline/2,De-C.outline/2,Ne+C.outline,Ne+C.outline))}),M!==void 0}),M!==void 0}),M===void 0)return;const J=()=>{e.save(),e.beginPath(),e.rect(0,f,t,n-f-H),e.clip(),M==null||M(),e.restore()};return J(),J}function Wc(e,t,n,o,r,i,a,l,c){c===void 0||c.size===0||(e.beginPath(),ss(t,n,i,o,(f,u,g,m,w,h)=>{c.hasItemInRectangle({x:f[0],y:-2,width:f[1]-f[0]+1,height:1})&&e.rect(g,m,w,h)}),Qn(t,l,i,a,r,(f,u,g,m)=>{const w=Math.max(0,m-u),h=u+w+1,b=f.width-w-1;c.has([f.sourceIndex,-1])&&e.rect(h,o,b,r-o)}),e.clip())}function $c(e,t,n,o,r,i,a,l,c,f){let u=0;return Qn(e,i,o,r,n,(g,m,w,h,b)=>(jr(b,w,t,a,l,c,f,void 0,(k,x,C,F)=>{F||(u=Math.max(x,u))}),!0)),u}function Rl(e,t){var jt;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:a,cellYOffset:l,translateX:c,translateY:f,mappedColumns:u,enableGroups:g,freezeColumns:m,dragAndDropState:w,theme:h,drawFocus:b,headerHeight:k,groupHeaderHeight:x,disabledRows:C,rowHeight:F,verticalBorder:N,overrideCursor:z,isResizing:B,selection:X,fillHandle:_,freezeTrailingRows:E,rows:W,getCellContent:P,getGroupDetails:H,getRowThemeOverride:I,isFocused:M,drawHeaderCallback:J,prelightCells:V,drawCellCallback:se,highlightRegions:be,resizeCol:ve,imageLoader:ee,lastBlitData:G,hoverValues:Re,hyperWrapping:Z,hoverInfo:fe,spriteManager:Oe,maxScaleFactor:K,hasAppendRow:re,touchMode:he,enqueue:Xe,renderStateProvider:Ne,getCellRenderer:Ke,renderStrategy:nt,bufferACtx:De,bufferBCtx:Ye,damage:Ie,minimumCellWidth:dt,resizeIndicator:ht}=e;if(r===0||i===0)return;const gt=nt==="double-buffer",te=Math.min(K,Math.ceil(window.devicePixelRatio??1)),Ce=nt!=="direct"&&Lc(e,t),ae=n.canvas;(ae.width!==r*te||ae.height!==i*te)&&(ae.width=r*te,ae.height=i*te,ae.style.width=r+"px",ae.style.height=i+"px");const ge=o.canvas,me=g?x+k:k,Qe=me+1;(ge.width!==r*te||ge.height!==Qe*te)&&(ge.width=r*te,ge.height=Qe*te,ge.style.width=r+"px",ge.style.height=Qe+"px");const Ue=De.canvas,Ze=Ye.canvas;gt&&(Ue.width!==r*te||Ue.height!==i*te)&&(Ue.width=r*te,Ue.height=i*te,G.current!==void 0&&(G.current.aBufferScroll=void 0)),gt&&(Ze.width!==r*te||Ze.height!==i*te)&&(Ze.width=r*te,Ze.height=i*te,G.current!==void 0&&(G.current.bBufferScroll=void 0));const le=G.current;if(Ce===!0&&a===(le==null?void 0:le.cellXOffset)&&l===(le==null?void 0:le.cellYOffset)&&c===(le==null?void 0:le.translateX)&&f===(le==null?void 0:le.translateY))return;let we=null;gt&&(we=n);const Ve=o;let qe;gt?Ie!==void 0?qe=(le==null?void 0:le.lastBuffer)==="b"?Ye:De:qe=(le==null?void 0:le.lastBuffer)==="b"?De:Ye:qe=n;const ze=qe.canvas,pt=gt?ze===Ue?Ze:Ue:ae,et=typeof F=="number"?()=>F:F;Ve.save(),qe.save(),Ve.beginPath(),qe.beginPath(),Ve.textBaseline="middle",qe.textBaseline="middle",te!==1&&(Ve.scale(te,te),qe.scale(te,te));const Ae=Di(u,a,r,w,c);let Mt=[];const At=b&&((jt=X.current)==null?void 0:jt.cell[1])===l&&f===0;let zt=!1;if(be!==void 0){for(const mt of be)if(mt.style!=="no-outline"&&mt.range.y===l&&f===0){zt=!0;break}}const st=()=>{Fc(Ve,Ae,g,fe,r,c,k,x,w,B,X,h,Oe,Re,N,H,Ie,J,he),kl(Ve,Ae,l,c,f,r,i,void 0,void 0,x,me,et,I,N,E,W,h,!0),Ve.beginPath(),Ve.moveTo(0,Qe-.5),Ve.lineTo(r,Qe-.5),Ve.strokeStyle=Qt(h.headerBottomBorderColor??h.horizontalBorderColor??h.borderColor,h.bgHeader),Ve.stroke(),zt&&Sl(Ve,r,i,a,l,c,f,u,m,k,x,F,E,W,be,h),At&&Mi(Ve,r,i,l,c,f,Ae,u,h,me,X,et,P,E,re,_,W)};if(Ie!==void 0){const mt=Ae[Ae.length-1].sourceIndex+1,Ot=Ie.hasItemInRegion([{x:a,y:-2,width:mt,height:2},{x:a,y:l,width:mt,height:300},{x:0,y:l,width:m,height:300},{x:0,y:-2,width:m,height:2},{x:a,y:W-E,width:mt,height:E,when:E>0}]),Fn=tn=>{Cl(tn,Ae,u,i,me,c,f,l,W,et,P,H,I,C,M,b,E,re,Mt,Ie,X,V,be,ee,Oe,Re,fe,se,Z,h,Xe,Ne,Ke,z,dt);const Be=X.current;_!==!1&&_!==void 0&&b&&Be!==void 0&&Ie.has(Kl(Be.range))&&Mi(tn,r,i,l,c,f,Ae,u,h,me,X,et,P,E,re,_,W)};Ot&&(Fn(qe),we!==null&&(we.save(),we.scale(te,te),we.textBaseline="middle",Fn(we),we.restore()),Ie.hasHeader()&&(Wc(Ve,Ae,r,x,me,c,f,l,Ie),st())),qe.restore(),Ve.restore();return}if((Ce!==!0||a!==(le==null?void 0:le.cellXOffset)||c!==(le==null?void 0:le.translateX)||At!==(le==null?void 0:le.mustDrawFocusOnHeader)||zt!==(le==null?void 0:le.mustDrawHighlightRingsOnHeader))&&st(),Ce===!0){Jt(pt!==void 0&&le!==void 0);const{regions:mt}=Bc(qe,pt,pt===Ue?le.aBufferScroll:le.bBufferScroll,pt===Ue?le.bBufferScroll:le.aBufferScroll,le,a,l,c,f,E,r,i,W,me,te,u,Ae,F,gt);Mt=mt}else Ce!==!1&&(Jt(le!==void 0),Mt=Pc(le,a,l,c,f,r,i,me,Ae,Ce));Ac(qe,Ae,r,i,E,W,N,et,h);const $t=Sl(qe,r,i,a,l,c,f,u,m,k,x,F,E,W,be,h),Dt=b?Mi(qe,r,i,l,c,f,Ae,u,h,me,X,et,P,E,re,_,W):void 0;if(qe.fillStyle=h.bgCell,Mt.length>0){qe.beginPath();for(const mt of Mt)qe.rect(mt.x,mt.y,mt.width,mt.height);qe.clip(),qe.fill(),qe.beginPath()}else qe.fillRect(0,0,r,i);Tc(qe,Ae,u,r,i,me,c,f,l,W,et,I,X.rows,C,E,re,Mt,Ie,h),zc(qe,Ae,l,c,f,r,i,Mt,me,et,I,N,E,W,h);const Xt=Cl(qe,Ae,u,i,me,c,f,l,W,et,P,H,I,C,M,b,E,re,Mt,Ie,X,V,be,ee,Oe,Re,fe,se,Z,h,Xe,Ne,Ke,z,dt);kl(qe,Ae,l,c,f,r,i,Mt,Xt,x,me,et,I,N,E,W,h),$t==null||$t(),Dt==null||Dt(),B&&ht!=="none"&&Qn(Ae,0,c,0,me,(mt,Ot)=>mt.sourceIndex===ve?(Ml(Ve,Ot+mt.width,0,me+1,Qt(h.resizeIndicatorColor??h.accentLight,h.bgHeader)),ht==="full"&&Ml(qe,Ot+mt.width,me,i,Qt(h.resizeIndicatorColor??h.accentLight,h.bgCell)),!0):!1),we!==null&&(we.fillStyle=h.bgCell,we.fillRect(0,0,r,i),we.drawImage(qe.canvas,0,0));const Wn=$c(Ae,i,me,c,f,l,W,et,E,re);ee==null||ee.setWindow({x:a,y:l,width:Ae.length,height:Wn-l},m,Array.from({length:E},(mt,Ot)=>W-1-Ot));const it=le!==void 0&&(a!==le.cellXOffset||c!==le.translateX),Yt=le!==void 0&&(l!==le.cellYOffset||f!==le.translateY);G.current={cellXOffset:a,cellYOffset:l,translateX:c,translateY:f,mustDrawFocusOnHeader:At,mustDrawHighlightRingsOnHeader:zt,lastBuffer:gt?ze===Ue?"a":"b":void 0,aBufferScroll:ze===Ue?[it,Yt]:le==null?void 0:le.aBufferScroll,bBufferScroll:ze===Ze?[it,Yt]:le==null?void 0:le.bBufferScroll},qe.restore(),Ve.restore()}const Oc=80;function Nc(e){const t=e-1;return t*t*t+1}class Xc{constructor(t){Le(this,"callback");Le(this,"currentHoveredItem");Le(this,"leavingItems",[]);Le(this,"lastAnimationTime");Le(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>or(o.item,t.item))||this.leavingItems.push(t)});Le(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>or(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});Le(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});Le(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});Le(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:Nc(t.hoverAmount)})));Le(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/Oc;for(const i of this.leavingItems)i.hoverAmount=sn(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=sn(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});Le(this,"setHovered",t=>{var n;if(!or((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Yc{constructor(t){Le(this,"fn");Le(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function Yi(e){return new Yc(e)}const _c=Yi(()=>window.navigator.userAgent.includes("Firefox")),Gr=Yi(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),Kr=Yi(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Gc(e){const t=s.useRef([]),n=s.useRef(0),o=s.useRef(e);o.current=e;const r=s.useCallback(()=>{const i=()=>window.requestAnimationFrame(a),a=()=>{const l=t.current.map(Ni);t.current=[],o.current(new ir(l)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:a)},[]);return s.useCallback(i=>{t.current.length===0&&r();const a=yn(i[0],i[1]);t.current.includes(a)||t.current.push(a)},[r])}const Zn="header",bn="group-header",Ur="out-of-bounds";var Bo;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(Bo||(Bo={}));function ms(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const Kc=(e,t)=>{if(e.kind===Q.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},Uc=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:a,cellYOffset:l,headerHeight:c,fillHandle:f=!1,groupHeaderHeight:u,rowHeight:g,rows:m,getCellContent:w,getRowThemeOverride:h,onHeaderMenuClick:b,onHeaderIndicatorClick:k,enableGroups:x,isFilling:C,onCanvasFocused:F,onCanvasBlur:N,isFocused:z,selection:B,freezeColumns:X,onContextMenu:_,freezeTrailingRows:E,fixedShadowX:W=!0,fixedShadowY:P=!0,drawFocusRing:H,onMouseDown:I,onMouseUp:M,onMouseMoveRaw:J,onMouseMove:V,onItemHovered:se,dragAndDropState:be,firstColAccessible:ve,onKeyDown:ee,onKeyUp:G,highlightRegions:Re,canvasRef:Z,onDragStart:fe,onDragEnd:Oe,eventTargetRef:K,isResizing:re,resizeColumn:he,isDragging:Xe,isDraggable:Ne=!1,allowResize:Ke,disabledRows:nt,hasAppendRow:De,getGroupDetails:Ye,theme:Ie,prelightCells:dt,headerIcons:ht,verticalBorder:gt,drawCell:te,drawHeader:Ce,onCellFocused:ae,onDragOverCell:ge,onDrop:me,onDragLeave:Qe,imageWindowLoader:Ue,smoothScrollX:Ze=!1,smoothScrollY:le=!1,experimental:we,getCellRenderer:Ve,resizeIndicator:qe="full"}=e,ze=e.translateX??0,pt=e.translateY??0,et=Math.max(X,Math.min(i.length-1,a)),Ae=s.useRef(null),Mt=s.useRef((we==null?void 0:we.eventTarget)??window),At=Mt.current,zt=Ue,st=s.useRef(),[$t,Dt]=s.useState(!1),Xt=s.useRef([]),Wn=s.useRef(),[it,Yt]=s.useState(),[jt,mt]=s.useState(),Ot=s.useRef(null),[Fn,tn]=s.useState(),[Be,He]=s.useState(!1),It=s.useRef(Be);It.current=Be;const vt=s.useMemo(()=>new xc(ht,()=>{yo.current=void 0,eo.current()}),[ht]),nn=x?u+c:c,Ht=s.useRef(-1),pn=((we==null?void 0:we.enableFirefoxRescaling)??!1)&&_c.value,$o=((we==null?void 0:we.enableSafariRescaling)??!1)&&Gr.value;s.useLayoutEffect(()=>{window.devicePixelRatio===1||!pn&&!$o||(Ht.current!==-1&&Dt(!0),window.clearTimeout(Ht.current),Ht.current=window.setTimeout(()=>{Dt(!1),Ht.current=-1},200))},[l,et,ze,pt,pn,$o]);const at=Ea(i,X),Dn=s.useMemo(()=>W?Wo(at,be):0,[at,be,W]),Ct=s.useCallback((R,y,ne)=>{const q=R.getBoundingClientRect();if(y>=at.length||ne>=m)return;const j=q.width/n,ie=Hi(y,ne,n,o,u,nn,et,l,ze,pt,m,X,E,at,g);return j!==1&&(ie.x*=j,ie.y*=j,ie.width*=j,ie.height*=j),ie.x+=q.x,ie.y+=q.y,ie},[n,o,u,nn,et,l,ze,pt,m,X,E,at,g]),Rt=s.useCallback((R,y,ne,q)=>{const j=R.getBoundingClientRect(),ie=j.width/n,ke=(y-j.left)/ie,Se=(ne-j.top)/ie,ce=5,Tt=Di(at,et,n,void 0,ze);let ye=0,tt=0;q instanceof MouseEvent&&(ye=q.button,tt=q.buttons);const je=Ha(ke,Tt,ze),Te=Ta(Se,o,x,c,u,m,g,l,pt,E),Je=(q==null?void 0:q.shiftKey)===!0,ut=(q==null?void 0:q.ctrlKey)===!0,_e=(q==null?void 0:q.metaKey)===!0,wt=q!==void 0&&!(q instanceof MouseEvent)||(q==null?void 0:q.pointerType)==="touch",on=[ke<0?-1:n<ke?1:0,Se<nn?-1:o<Se?1:0];let Zt;if(je===-1||Se<0||ke<0||Te===void 0||ke>n||Se>o){const ot=ke>n?1:ke<0?-1:0,ft=Se>o?1:Se<0?-1:0;let kt=ot*2,Mo=ft*2;ot===0&&(kt=je===-1?Bo.EndPadding:Bo.Center),ft===0&&(Mo=Te===void 0?Bo.EndPadding:Bo.Center);let kn=!1;if(je===-1&&Te===-1){const Bn=Ct(R,at.length-1,-1);Jt(Bn!==void 0),kn=y<Bn.x+Bn.width+ce}const hn=ke>n&&ke<n+Fi()||Se>o&&Se<o+Fi();Zt={kind:Ur,location:[je!==-1?je:ke<0?0:at.length-1,Te??m-1],region:[kt,Mo],shiftKey:Je,ctrlKey:ut,metaKey:_e,isEdge:kn,isTouch:wt,button:ye,buttons:tt,scrollEdge:on,isMaybeScrollbar:hn}}else if(Te<=-1){let ot=Ct(R,je,Te);Jt(ot!==void 0);let ft=ot!==void 0&&ot.x+ot.width-y<=ce;const kt=je-1;y-ot.x<=ce&&kt>=0?(ft=!0,ot=Ct(R,kt,Te),Jt(ot!==void 0),Zt={kind:x&&Te===-2?bn:Zn,location:[kt,Te],bounds:ot,group:at[kt].group??"",isEdge:ft,shiftKey:Je,ctrlKey:ut,metaKey:_e,isTouch:wt,localEventX:y-ot.x,localEventY:ne-ot.y,button:ye,buttons:tt,scrollEdge:on}):Zt={kind:x&&Te===-2?bn:Zn,group:at[je].group??"",location:[je,Te],bounds:ot,isEdge:ft,shiftKey:Je,ctrlKey:ut,metaKey:_e,isTouch:wt,localEventX:y-ot.x,localEventY:ne-ot.y,button:ye,buttons:tt,scrollEdge:on}}else{const ot=Ct(R,je,Te);Jt(ot!==void 0);const ft=ot!==void 0&&ot.x+ot.width-y<ce;let kt=!1;if(f!==!1&&f!==void 0&&B.current!==void 0){const kn=typeof f=="object"?{..._r,...f}:_r,hn=kn.size,Bn=hn/2,Ko=Kl(B.current.range),Pe=Ct(R,Ko[0],Ko[1]);if(Pe!==void 0){const _t=Pe.x+Pe.width+kn.offsetX-Bn+.5,Ro=Pe.y+Pe.height+kn.offsetY-Bn+.5;kt=Math.abs(_t-y)<hn&&Math.abs(Ro-ne)<hn}}Zt={kind:"cell",location:[je,Te],bounds:ot,isEdge:ft,shiftKey:Je,ctrlKey:ut,isFillHandle:kt,metaKey:_e,isTouch:wt,localEventX:y-ot.x,localEventY:ne-ot.y,button:ye,buttons:tt,scrollEdge:on}}return Zt},[n,at,et,ze,o,x,c,u,m,g,l,pt,E,Ct,f,B,nn]),[Hn]=it??[],Ft=s.useRef(()=>{}),$n=s.useRef(it);$n.current=it;const[Tn,An]=s.useMemo(()=>{const R=document.createElement("canvas"),y=document.createElement("canvas");return R.style.display="none",R.style.opacity="0",R.style.position="fixed",y.style.display="none",y.style.opacity="0",y.style.position="fixed",[R.getContext("2d",{alpha:!1}),y.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>{if(!(Tn===null||An===null))return document.documentElement.append(Tn.canvas),document.documentElement.append(An.canvas),()=>{Tn.canvas.remove(),An.canvas.remove()}},[Tn,An]);const bo=s.useMemo(()=>new Na,[]),ur=pn&&$t?1:$o&&$t?2:5,fr=(we==null?void 0:we.disableMinimumCellWidth)===!0?1:10,yo=s.useRef(),vn=s.useRef(null),po=s.useRef(null),vo=s.useCallback(()=>{var ke;const R=Ae.current,y=Ot.current;if(R===null||y===null||(vn.current===null&&(vn.current=R.getContext("2d",{alpha:!1}),R.width=0,R.height=0),po.current===null&&(po.current=y.getContext("2d",{alpha:!1}),y.width=0,y.height=0),vn.current===null||po.current===null||Tn===null||An===null))return;let ne=!1;const q=Se=>{ne=!0,tn(Se)},j=yo.current,ie={headerCanvasCtx:po.current,canvasCtx:vn.current,bufferACtx:Tn,bufferBCtx:An,width:n,height:o,cellXOffset:et,cellYOffset:l,translateX:Math.round(ze),translateY:Math.round(pt),mappedColumns:at,enableGroups:x,freezeColumns:X,dragAndDropState:be,theme:Ie,headerHeight:c,groupHeaderHeight:u,disabledRows:nt??rt.empty(),rowHeight:g,verticalBorder:gt,isResizing:re,resizeCol:he,isFocused:z,selection:B,fillHandle:f,drawCellCallback:te,hasAppendRow:De,overrideCursor:q,maxScaleFactor:ur,freezeTrailingRows:E,rows:m,drawFocus:H,getCellContent:w,getGroupDetails:Ye??(Se=>({name:Se})),getRowThemeOverride:h,drawHeaderCallback:Ce,prelightCells:dt,highlightRegions:Re,imageLoader:zt,lastBlitData:Wn,damage:st.current,hoverValues:Xt.current,hoverInfo:$n.current,spriteManager:vt,scrolling:$t,hyperWrapping:(we==null?void 0:we.hyperWrapping)??!1,touchMode:Be,enqueue:Ft.current,renderStateProvider:bo,renderStrategy:(we==null?void 0:we.renderStrategy)??(Gr.value?"double-buffer":"single-buffer"),getCellRenderer:Ve,minimumCellWidth:fr,resizeIndicator:qe};ie.damage===void 0?(yo.current=ie,Rl(ie,j)):Rl(ie,void 0),!ne&&(ie.damage===void 0||ie.damage.has((ke=$n==null?void 0:$n.current)==null?void 0:ke[0]))&&tn(void 0)},[Tn,An,n,o,et,l,ze,pt,at,x,X,be,Ie,c,u,nt,g,gt,re,De,he,z,B,f,E,m,H,ur,w,Ye,h,te,Ce,dt,Re,zt,vt,$t,we==null?void 0:we.hyperWrapping,we==null?void 0:we.renderStrategy,Be,bo,Ve,fr,qe]),eo=s.useRef(vo);s.useLayoutEffect(()=>{vo(),eo.current=vo},[vo]),s.useLayoutEffect(()=>{(async()=>{var y;((y=document==null?void 0:document.fonts)==null?void 0:y.ready)!==void 0&&(await document.fonts.ready,yo.current=void 0,eo.current())})()},[]);const On=s.useCallback(R=>{st.current=R,eo.current(),st.current=void 0},[]),Zr=Gc(On);Ft.current=Zr;const Oo=s.useCallback(R=>{On(new ir(R.map(y=>y.cell)))},[On]);zt.setCallback(On);const[Jr,Qr]=s.useState(!1),[zn,Nn]=Hn??[],hr=zn!==void 0&&Nn===-1&&zn>=0&&zn<at.length&&at[zn].headerRowMarkerDisabled!==!0,ei=zn!==void 0&&Nn===-2;let gr=!1,mr=!1,Xn=Fn;if(Xn===void 0&&zn!==void 0&&Nn!==void 0&&Nn>-1&&Nn<m){const R=w([zn,Nn],!0);gr=R.kind===an.NewRow||R.kind===an.Marker&&R.markerKind!=="number",mr=R.kind===Q.Boolean&&Pi(R),Xn=R.cursor}const No=Xe?"grabbing":(jt??!1)||re?"col-resize":Jr||C?"crosshair":Xn!==void 0?Xn:hr||gr||mr||ei?"pointer":"default",Co=s.useMemo(()=>({contain:"strict",display:"block",cursor:No}),[No]),wr=s.useRef("default"),xo=K==null?void 0:K.current;xo!=null&&wr.current!==Co.cursor&&(xo.style.cursor=wr.current=Co.cursor);const lt=s.useCallback((R,y,ne,q)=>{if(Ye===void 0)return;const j=Ye(R);if(j.actions!==void 0){const ie=us(y,j.actions);for(const[ke,Se]of ie.entries())if(go(Se,ne+y.x,q+Se.y))return j.actions[ke]}},[Ye]),Bt=s.useCallback((R,y,ne,q)=>{const j=at[y];if(!Xe&&!re&&!(jt??!1)){const ie=Ct(R,y,-1);Jt(ie!==void 0);const ke=fs(void 0,j,ie.x,ie.y,ie.width,ie.height,Ie,Wi(j.title)==="rtl");if(j.hasMenu===!0&&ke.menuBounds!==void 0&&go(ke.menuBounds,ne,q))return{area:"menu",bounds:ke.menuBounds};if(j.indicatorIcon!==void 0&&ke.indicatorIconBounds!==void 0&&go(ke.indicatorIconBounds,ne,q))return{area:"indicator",bounds:ke.indicatorIconBounds}}},[at,Ct,jt,Xe,re,Ie]),Xo=s.useRef(0),Yn=s.useRef(),ko=s.useRef(!1),Yo=s.useCallback(R=>{const y=Ae.current,ne=K==null?void 0:K.current;if(y===null||R.target!==y&&R.target!==ne)return;ko.current=!0;let q,j;if(R instanceof MouseEvent?(q=R.clientX,j=R.clientY):(q=R.touches[0].clientX,j=R.touches[0].clientY),R.target===ne&&ne!==null){const ke=ne.getBoundingClientRect();if(q>ke.right||j>ke.bottom)return}const ie=Rt(y,q,j,R);Yn.current=ie.location,ie.isTouch&&(Xo.current=Date.now()),It.current!==ie.isTouch&&He(ie.isTouch),!(ie.kind===Zn&&Bt(y,ie.location[0],q,j)!==void 0)&&(ie.kind===bn&&lt(ie.group,ie.bounds,ie.localEventX,ie.localEventY)!==void 0||(I==null||I(ie),!ie.isTouch&&Ne!==!0&&Ne!==ie.kind&&ie.button<3&&ie.button!==1&&R.preventDefault()))},[K,Ne,Rt,lt,Bt,I]);Wt("touchstart",Yo,At,!1),Wt("mousedown",Yo,At,!1);const _o=s.useRef(0),to=s.useCallback(R=>{var tt,je;const y=_o.current;_o.current=Date.now();const ne=Ae.current;if(ko.current=!1,M===void 0||ne===null)return;const q=K==null?void 0:K.current,j=R.target!==ne&&R.target!==q;let ie,ke,Se=!0;if(R instanceof MouseEvent){if(ie=R.clientX,ke=R.clientY,Se=R.button<3,R.pointerType==="touch")return}else ie=R.changedTouches[0].clientX,ke=R.changedTouches[0].clientY;let ce=Rt(ne,ie,ke,R);ce.isTouch&&Xo.current!==0&&Date.now()-Xo.current>500&&(ce={...ce,isLongTouch:!0}),y!==0&&Date.now()-y<(ce.isTouch?1e3:500)&&(ce={...ce,isDoubleClick:!0}),It.current!==ce.isTouch&&He(ce.isTouch),!j&&R.cancelable&&Se&&R.preventDefault();const[Tt]=ce.location,ye=Bt(ne,Tt,ie,ke);if(ce.kind===Zn&&ye!==void 0){(ce.button!==0||((tt=Yn.current)==null?void 0:tt[0])!==Tt||((je=Yn.current)==null?void 0:je[1])!==-1)&&M(ce,!0);return}else if(ce.kind===bn){const Te=lt(ce.group,ce.bounds,ce.localEventX,ce.localEventY);if(Te!==void 0){ce.button===0&&Te.onClick(ce);return}}M(ce,j)},[M,K,Rt,Bt,lt]);Wt("mouseup",to,At,!1),Wt("touchend",to,At,!1);const So=s.useCallback(R=>{var Tt,ye;const y=Ae.current;if(y===null)return;const ne=K==null?void 0:K.current,q=R.target!==y&&R.target!==ne;let j,ie,ke=!0;R instanceof MouseEvent?(j=R.clientX,ie=R.clientY,ke=R.button<3):(j=R.changedTouches[0].clientX,ie=R.changedTouches[0].clientY);const Se=Rt(y,j,ie,R);It.current!==Se.isTouch&&He(Se.isTouch),!q&&R.cancelable&&ke&&R.preventDefault();const[ce]=Se.location;if(Se.kind===Zn){const tt=Bt(y,ce,j,ie);tt!==void 0&&Se.button===0&&((Tt=Yn.current)==null?void 0:Tt[0])===ce&&((ye=Yn.current)==null?void 0:ye[1])===-1&&(tt.area==="menu"?b==null||b(ce,tt.bounds):tt.area==="indicator"&&(k==null||k(ce,tt.bounds)))}},[K,Rt,Bt,b,k]);Wt("click",So,At,!1);const _n=s.useCallback(R=>{const y=Ae.current,ne=K==null?void 0:K.current;if(y===null||R.target!==y&&R.target!==ne||_===void 0)return;const q=Rt(y,R.clientX,R.clientY,R);_(q,()=>{R.cancelable&&R.preventDefault()})},[K,Rt,_]);Wt("contextmenu",_n,(K==null?void 0:K.current)??null,!1);const no=s.useCallback(R=>{st.current=new ir(R.map(y=>y.item)),Xt.current=R,eo.current(),st.current=void 0},[]),br=s.useMemo(()=>new Xc(no),[no]),Go=s.useRef(br);Go.current=br,s.useLayoutEffect(()=>{const R=Go.current;if(Hn===void 0||Hn[1]<0){R.setHovered(Hn);return}const y=w(Hn,!0),ne=Ve(y),q=ne===void 0&&y.kind===Q.Custom||(ne==null?void 0:ne.needsHover)!==void 0&&(typeof ne.needsHover=="boolean"?ne.needsHover:ne.needsHover(y));R.setHovered(q?Hn:void 0)},[w,Ve,Hn]);const xe=s.useRef(),yr=s.useCallback(R=>{var Se;const y=Ae.current;if(y===null)return;const ne=K==null?void 0:K.current,q=R.target!==y&&R.target!==ne,j=Rt(y,R.clientX,R.clientY,R);if(j.kind!=="out-of-bounds"&&q&&!ko.current&&!j.isTouch)return;const ie=(ce,Tt)=>{Yt(ye=>ye===ce||(ye==null?void 0:ye[0][0])===(ce==null?void 0:ce[0][0])&&(ye==null?void 0:ye[0][1])===(ce==null?void 0:ce[0][1])&&((ye==null?void 0:ye[1][0])===(ce==null?void 0:ce[1][0])&&(ye==null?void 0:ye[1][1])===(ce==null?void 0:ce[1][1])||!Tt)?ye:ce)};if(!ms(j,xe.current))tn(void 0),se==null||se(j),ie(j.kind===Ur?void 0:[j.location,[j.localEventX,j.localEventY]],!0),xe.current=j;else if(j.kind==="cell"||j.kind===Zn||j.kind===bn){let ce=!1,Tt=!0;if(j.kind==="cell"){const tt=w(j.location);Tt=((Se=Ve(tt))==null?void 0:Se.needsHoverPosition)??tt.kind===Q.Custom,ce=Tt}else ce=!0;const ye=[j.location,[j.localEventX,j.localEventY]];ie(ye,Tt),$n.current=ye,ce&&On(new ir([j.location]))}const ke=j.location[0]>=(ve?0:1);mt(j.kind===Zn&&j.isEdge&&ke&&Ke===!0),Qr(j.kind==="cell"&&j.isFillHandle),J==null||J(R),V(j)},[K,Rt,ve,Ke,J,V,se,w,Ve,On]);Wt("mousemove",yr,At,!0);const ti=s.useCallback(R=>{const y=Ae.current;if(y===null)return;let ne,q;B.current!==void 0&&(ne=Ct(y,B.current.cell[0],B.current.cell[1]),q=B.current.cell),ee==null||ee({bounds:ne,stopPropagation:()=>R.stopPropagation(),preventDefault:()=>R.preventDefault(),cancel:()=>{},ctrlKey:R.ctrlKey,metaKey:R.metaKey,shiftKey:R.shiftKey,altKey:R.altKey,key:R.key,keyCode:R.keyCode,rawEvent:R,location:q})},[ee,B,Ct]),dn=s.useCallback(R=>{const y=Ae.current;if(y===null)return;let ne,q;B.current!==void 0&&(ne=Ct(y,B.current.cell[0],B.current.cell[1]),q=B.current.cell),G==null||G({bounds:ne,stopPropagation:()=>R.stopPropagation(),preventDefault:()=>R.preventDefault(),cancel:()=>{},ctrlKey:R.ctrlKey,metaKey:R.metaKey,shiftKey:R.shiftKey,altKey:R.altKey,key:R.key,keyCode:R.keyCode,rawEvent:R,location:q})},[G,B,Ct]),ni=s.useCallback(R=>{if(Ae.current=R,Z!==void 0&&(Z.current=R),we!=null&&we.eventTarget)Mt.current=we.eventTarget;else if(R===null)Mt.current=window;else{const y=R.getRootNode();y===document&&(Mt.current=window),Mt.current=y}},[Z,we==null?void 0:we.eventTarget]),Cn=s.useCallback(R=>{const y=Ae.current;if(y===null||Ne===!1||re){R.preventDefault();return}let ne,q;const j=Rt(y,R.clientX,R.clientY);if(Ne!==!0&&j.kind!==Ne){R.preventDefault();return}const ie=(tt,je)=>{ne=tt,q=je};let ke,Se,ce;const Tt=(tt,je,Te)=>{ke=tt,Se=je,ce=Te};let ye=!1;if(fe==null||fe({...j,setData:ie,setDragImage:Tt,preventDefault:()=>ye=!0,defaultPrevented:()=>ye}),!ye&&ne!==void 0&&q!==void 0&&R.dataTransfer!==null)if(R.dataTransfer.setData(ne,q),R.dataTransfer.effectAllowed="copyLink",ke!==void 0&&Se!==void 0&&ce!==void 0)R.dataTransfer.setDragImage(ke,Se,ce);else{const[tt,je]=j.location;if(je!==void 0){const Te=document.createElement("canvas"),Je=Ct(y,tt,je);Jt(Je!==void 0);const ut=Math.ceil(window.devicePixelRatio??1);Te.width=Je.width*ut,Te.height=Je.height*ut;const _e=Te.getContext("2d");_e!==null&&(_e.scale(ut,ut),_e.textBaseline="middle",je===-1?(_e.font=Ie.headerFontFull,_e.fillStyle=Ie.bgHeader,_e.fillRect(0,0,Te.width,Te.height),hs(_e,0,0,Je.width,Je.height,at[tt],!1,Ie,!1,void 0,void 0,!1,0,vt,Ce,!1)):(_e.font=Ie.baseFontFull,_e.fillStyle=Ie.bgCell,_e.fillRect(0,0,Te.width,Te.height),ds(_e,w([tt,je]),0,je,!1,!1,0,0,Je.width,Je.height,!1,Ie,Ie.bgCell,zt,vt,1,void 0,!1,0,void 0,void 0,void 0,bo,Ve,()=>{}))),Te.style.left="-100%",Te.style.position="absolute",Te.style.width=`${Je.width}px`,Te.style.height=`${Je.height}px`,document.body.append(Te),R.dataTransfer.setDragImage(Te,Je.width/2,Je.height/2),window.setTimeout(()=>{Te.remove()},0)}}else R.preventDefault()},[Ne,re,Rt,fe,Ct,Ie,at,vt,Ce,w,zt,bo,Ve]);Wt("dragstart",Cn,(K==null?void 0:K.current)??null,!1,!1);const oo=s.useRef(),pr=s.useCallback(R=>{const y=Ae.current;if(me!==void 0&&R.preventDefault(),y===null||ge===void 0)return;const ne=Rt(y,R.clientX,R.clientY),[q,j]=ne.location,ie=q-(ve?0:1),[ke,Se]=oo.current??[];(ke!==ie||Se!==j)&&(oo.current=[ie,j],ge([ie,j],R.dataTransfer))},[ve,Rt,ge,me]);Wt("dragover",pr,(K==null?void 0:K.current)??null,!1,!1);const vr=s.useCallback(()=>{oo.current=void 0,Oe==null||Oe()},[Oe]);Wt("dragend",vr,(K==null?void 0:K.current)??null,!1,!1);const oi=s.useCallback(R=>{const y=Ae.current;if(y===null||me===void 0)return;R.preventDefault();const ne=Rt(y,R.clientX,R.clientY),[q,j]=ne.location,ie=q-(ve?0:1);me([ie,j],R.dataTransfer)},[ve,Rt,me]);Wt("drop",oi,(K==null?void 0:K.current)??null,!1,!1);const ri=s.useCallback(()=>{Qe==null||Qe()},[Qe]);Wt("dragleave",ri,(K==null?void 0:K.current)??null,!1,!1);const un=s.useRef(B);un.current=B;const fn=s.useRef(null),Ut=s.useCallback(R=>{var y;Ae.current===null||!Ae.current.contains(document.activeElement)||(R===null&&un.current.current!==void 0?(y=Z==null?void 0:Z.current)==null||y.focus({preventScroll:!0}):R!==null&&R.focus({preventScroll:!0}),fn.current=R)},[Z]);s.useImperativeHandle(t,()=>({focus:()=>{var y;const R=fn.current;R===null||!document.contains(R)?(y=Z==null?void 0:Z.current)==null||y.focus({preventScroll:!0}):R.focus({preventScroll:!0})},getBounds:(R,y)=>{if(!(Z===void 0||Z.current===null))return Ct(Z.current,R??0,y??-1)},damage:Oo,getMouseArgsForPosition:(R,y,ne)=>{if(!(Z===void 0||Z.current===null))return Rt(Z.current,R,y,ne)}}),[Z,Oo,Ct,Rt]);const D=s.useRef(),xt=ga(()=>{var Se,ce,Tt;if(n<50||(we==null?void 0:we.disableAccessibilityTree)===!0)return null;let R=Di(at,et,n,be,ze);const y=ve?0:-1;!ve&&((Se=R[0])==null?void 0:Se.sourceIndex)===0&&(R=R.slice(1));const[ne,q]=((ce=B.current)==null?void 0:ce.cell)??[],j=(Tt=B.current)==null?void 0:Tt.range,ie=R.map(ye=>ye.sourceIndex),ke=ho(l,Math.min(m,l+r));return ne!==void 0&&q!==void 0&&!(ie.includes(ne)&&ke.includes(q))&&Ut(null),s.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":m+1,"aria-multiselectable":"true","aria-colcount":at.length+y},s.createElement("thead",{role:"rowgroup"},s.createElement("tr",{role:"row","aria-rowindex":1},R.map(ye=>s.createElement("th",{role:"columnheader","aria-selected":B.columns.hasIndex(ye.sourceIndex),"aria-colindex":ye.sourceIndex+1+y,tabIndex:-1,onFocus:tt=>{if(tt.target!==fn.current)return ae==null?void 0:ae([ye.sourceIndex,-1])},key:ye.sourceIndex},ye.title)))),s.createElement("tbody",{role:"rowgroup"},ke.map(ye=>s.createElement("tr",{role:"row","aria-selected":B.rows.hasIndex(ye),key:ye,"aria-rowindex":ye+2},R.map(tt=>{const je=tt.sourceIndex,Te=yn(je,ye),Je=ne===je&&q===ye,ut=j!==void 0&&je>=j.x&&je<j.x+j.width&&ye>=j.y&&ye<j.y+j.height,_e=`glide-cell-${je}-${ye}`,wt=[je,ye],on=w(wt,!0);return s.createElement("td",{key:Te,role:"gridcell","aria-colindex":je+1+y,"aria-selected":ut,"aria-readonly":zo(on)||!Ao(on),id:_e,"data-testid":_e,onClick:()=>{const Zt=Z==null?void 0:Z.current;if(Zt!=null)return ee==null?void 0:ee({bounds:Ct(Zt,je,ye),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:wt})},onFocusCapture:Zt=>{var ot,ft;if(!(Zt.target===fn.current||((ot=D.current)==null?void 0:ot[0])===je&&((ft=D.current)==null?void 0:ft[1])===ye))return D.current=wt,ae==null?void 0:ae(wt)},ref:Je?Ut:void 0,tabIndex:-1},Kc(on,Ve))})))))},[n,at,et,be,ze,m,l,r,B,Ut,w,Z,ee,Ct,ae],200),xn=X===0||!W?0:et>X?1:sn(-ze/100,0,1),ii=-l*32+pt,ro=P?sn(-ii/100,0,1):0,li=s.useMemo(()=>{if(!xn&&!ro)return null;const R={position:"absolute",top:0,left:Dn,width:n-Dn,height:o,opacity:xn,pointerEvents:"none",transition:Ze?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},y={position:"absolute",top:nn,left:0,width:n,height:o,opacity:ro,pointerEvents:"none",transition:le?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return s.createElement(s.Fragment,null,xn>0&&s.createElement("div",{id:"shadow-x",style:R}),ro>0&&s.createElement("div",{id:"shadow-y",style:y}))},[xn,ro,Dn,n,Ze,nn,o,le]),si=s.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return s.createElement(s.Fragment,null,s.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:ti,onKeyUp:dn,onFocus:F,onBlur:N,ref:ni,style:Co},xt),s.createElement("canvas",{ref:Ot,style:si}),li)},Vc=s.memo(s.forwardRef(Uc));function nr(e,t,n,o){return sn(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const qc=e=>{const[t,n]=s.useState(),[o,r]=s.useState(),[i,a]=s.useState(),[l,c]=s.useState(),[f,u]=s.useState(!1),[g,m]=s.useState(),[w,h]=s.useState(),[b,k]=s.useState(),[x,C]=s.useState(!1),[F,N]=s.useState(),{onHeaderMenuClick:z,onHeaderIndicatorClick:B,getCellContent:X,onColumnMoved:_,onColumnResize:E,onColumnResizeStart:W,onColumnResizeEnd:P,gridRef:H,maxColumnWidth:I,minColumnWidth:M,onRowMoved:J,lockColumns:V,onColumnProposeMove:se,onMouseDown:be,onMouseUp:ve,onItemHovered:ee,onDragStart:G,canvasRef:Re}=e,Z=(E??P??W)!==void 0,{columns:fe,selection:Oe}=e,K=Oe.columns,re=s.useCallback(te=>{const[Ce,ae]=te.location;i!==void 0&&l!==Ce&&Ce>=V?(u(!0),c(Ce)):w!==void 0&&ae!==void 0?(C(!0),k(Math.max(0,ae))):o===void 0&&!f&&!x&&(ee==null||ee(te))},[i,w,l,ee,V,o,f,x]),he=_!==void 0,Xe=s.useCallback(te=>{var Ce;if(te.button===0){const[ae,ge]=te.location;if(te.kind==="out-of-bounds"&&te.isEdge&&Z){const me=(Ce=H==null?void 0:H.current)==null?void 0:Ce.getBounds(fe.length-1,-1);me!==void 0&&(n(me.x),r(fe.length-1))}else if(te.kind==="header"&&ae>=V){const me=Re==null?void 0:Re.current;if(te.isEdge&&Z&&me){n(te.bounds.x),r(ae);const Ue=me.getBoundingClientRect().width/me.offsetWidth,Ze=te.bounds.width/Ue;W==null||W(fe[ae],Ze,ae,Ze+(fe[ae].growOffset??0))}else te.kind==="header"&&he&&(m(te.bounds.x),a(ae))}else te.kind==="cell"&&V>0&&ae===0&&ge!==void 0&&J!==void 0&&(N(te.bounds.y),h(ge))}be==null||be(te)},[be,Z,V,J,H,fe,he,W,Re]),Ne=s.useCallback((te,Ce)=>{f||x||z==null||z(te,Ce)},[f,x,z]),Ke=s.useCallback((te,Ce)=>{f||x||B==null||B(te,Ce)},[f,x,B]),nt=s.useRef(-1),De=s.useCallback(()=>{nt.current=-1,h(void 0),k(void 0),N(void 0),C(!1),a(void 0),c(void 0),m(void 0),u(!1),r(void 0),n(void 0)},[]),Ye=s.useCallback((te,Ce)=>{if(te.button===0){if(o!==void 0){if((K==null?void 0:K.hasIndex(o))===!0)for(const ge of K){if(ge===o)continue;const me=fe[ge],Qe=nr(me,nt.current,M,I);E==null||E(me,Qe,ge,Qe+(me.growOffset??0))}const ae=nr(fe[o],nt.current,M,I);if(P==null||P(fe[o],ae,o,ae+(fe[o].growOffset??0)),K.hasIndex(o))for(const ge of K){if(ge===o)continue;const me=fe[ge],Qe=nr(me,nt.current,M,I);P==null||P(me,Qe,ge,Qe+(me.growOffset??0))}}De(),i!==void 0&&l!==void 0&&(se==null?void 0:se(i,l))!==!1&&(_==null||_(i,l)),w!==void 0&&b!==void 0&&(J==null||J(w,b))}ve==null||ve(te,Ce)},[ve,o,i,l,w,b,K,P,fe,M,I,E,_,J,De,se]),Ie=s.useMemo(()=>{if(!(i===void 0||l===void 0)&&i!==l&&(se==null?void 0:se(i,l))!==!1)return{src:i,dest:l}},[i,l,se]),dt=s.useCallback(te=>{const Ce=Re==null?void 0:Re.current;if(i!==void 0&&g!==void 0)Math.abs(te.clientX-g)>20&&u(!0);else if(w!==void 0&&F!==void 0)Math.abs(te.clientY-F)>20&&C(!0);else if(o!==void 0&&t!==void 0&&Ce){const ge=Ce.getBoundingClientRect().width/Ce.offsetWidth,me=(te.clientX-t)/ge,Qe=fe[o],Ue=nr(Qe,me,M,I);if(E==null||E(Qe,Ue,o,Ue+(Qe.growOffset??0)),nt.current=me,(K==null?void 0:K.first())===o)for(const Ze of K){if(Ze===o)continue;const le=fe[Ze],we=nr(le,nt.current,M,I);E==null||E(le,we,Ze,we+(le.growOffset??0))}}},[i,g,w,F,o,t,fe,M,I,E,K,Re]),ht=s.useCallback((te,Ce)=>{if(w===void 0||b===void 0)return X(te,Ce);let[ae,ge]=te;return ge===b?ge=w:(ge>b&&(ge-=1),ge>=w&&(ge+=1)),X([ae,ge],Ce)},[w,b,X]),gt=s.useCallback(te=>{G==null||G(te),te.defaultPrevented()||De()},[De,G]);return s.createElement(Vc,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:ht,isResizing:o!==void 0,onHeaderMenuClick:Ne,onHeaderIndicatorClick:Ke,isDragging:f,onItemHovered:re,onDragStart:gt,onMouseDown:Xe,allowResize:Z,onMouseUp:Ye,dragAndDropState:Ie,onMouseMoveRaw:dt,ref:H})};function jc(e){const t=s.useRef(null),[n,o]=s.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return s.useLayoutEffect(()=>{const r=a=>{for(const l of a){const{width:c,height:f}=l&&l.contentRect||{};o(u=>u.width===c&&u.height===f?u:{width:c,height:f})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const Zc=(e,t,n)=>{const o=s.useRef(null),r=s.useRef(null),i=s.useRef(null),a=s.useRef(0),l=s.useRef(t);l.current=t;const c=n.current;s.useEffect(()=>{const f=()=>{var m,w;if(r.current===!1&&c!==null){const h=[c.scrollLeft,c.scrollTop];if(((m=i.current)==null?void 0:m[0])===h[0]&&((w=i.current)==null?void 0:w[1])===h[1])if(a.current>10){i.current=null,r.current=null;return}else a.current++;else a.current=0,l.current(h[0],h[1]),i.current=h;o.current=window.setTimeout(f,8.333333333333334)}},u=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},g=m=>{m.touches.length===0&&(r.current=!1,a.current=0,o.current=window.setTimeout(f,8.333333333333334))};if(e&&c!==null){const m=c;return m.addEventListener("touchstart",u),m.addEventListener("touchend",g),()=>{m.removeEventListener("touchstart",u),m.removeEventListener("touchend",g),o.current!==null&&window.clearTimeout(o.current)}}},[e,c])},Jc=()=>e=>e.isSafari?"scroll":"auto",Qc=en("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[Jc()]}}),ed=33554400,td=5e6;function nd(e){const[t,n]=s.useState(!1),o=typeof window>"u"?null:window,r=s.useRef(0);return Wt("touchstart",s.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),Wt("touchend",s.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const od=e=>{var Oe,K;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:a,className:l,preventDiagonalScrolling:c=!1,paddingBottom:f=0,paddingRight:u=0,rightElement:g,rightElementProps:m,kineticScrollPerfHack:w=!1,scrollRef:h,initialSize:b}=e,k=[],x=(m==null?void 0:m.sticky)??!1,C=(m==null?void 0:m.fill)??!1,F=s.useRef(0),N=s.useRef(0),z=s.useRef(null),B=typeof window>"u"?1:window.devicePixelRatio,X=s.useRef(B);s.useEffect(()=>{if(X.current!==B){F.current=0,N.current=0,X.current=B;const re=z.current;re!==null&&J.current(re.scrollLeft,re.scrollTop)}},[B]);const _=s.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),E=s.useRef(null),W=nd(200),[P,H]=s.useState(!0),I=s.useRef(0);s.useLayoutEffect(()=>{if(!P||W||_.current.lockDirection===void 0)return;const re=z.current;if(re===null)return;const[he,Xe]=_.current.lockDirection;he!==void 0?re.scrollLeft=he:Xe!==void 0&&(re.scrollTop=Xe),_.current.lockDirection=void 0},[W,P]);const M=s.useCallback((re,he)=>{var ae;const Xe=z.current;if(Xe===null)return;he=he??Xe.scrollTop,re=re??Xe.scrollLeft;const Ne=_.current.scrollTop,Ke=_.current.scrollLeft,nt=re-Ke,De=he-Ne;W&&nt!==0&&De!==0&&(Math.abs(nt)>3||Math.abs(De)>3)&&c&&_.current.lockDirection===void 0&&(_.current.lockDirection=Math.abs(nt)<Math.abs(De)?[Ke,void 0]:[void 0,Ne]);const Ye=_.current.lockDirection;re=(Ye==null?void 0:Ye[0])??re,he=(Ye==null?void 0:Ye[1])??he,_.current.scrollLeft=re,_.current.scrollTop=he;const Ie=Xe.clientWidth,dt=Xe.clientHeight,ht=he,gt=N.current-ht,te=Xe.scrollHeight-dt;N.current=ht;let Ce;if(te>0&&o>Xe.scrollHeight+5)if(Math.abs(gt)>2e3||ht===0||ht===te){const ge=Math.max(0,Math.min(1,ht/te)),me=o-dt;Ce=ge*me,F.current=Ce}else F.current-=gt,Ce=F.current;else Ce=ht,F.current=Ce;Ce=Math.max(0,Math.min(Ce,o-dt)),F.current=Ce,Ye!==void 0&&(window.clearTimeout(I.current),H(!1),I.current=window.setTimeout(()=>H(!0),200)),i({x:re,y:Ce,width:Ie-u,height:dt-f,paddingRight:((ae=E.current)==null?void 0:ae.clientWidth)??0})},[f,u,o,i,c,W]);Zc(w&&Gr.value,M,z);const J=s.useRef(M);J.current=M;const V=s.useRef(),se=s.useRef(!1);s.useLayoutEffect(()=>{se.current?M():se.current=!0},[M,f,u]);const be=s.useCallback(re=>{z.current=re,h!==void 0&&(h.current=re)},[h]);let ve=0,ee=0;const G=Math.min(o,ed);for(k.push(s.createElement("div",{key:ve++,style:{width:r,height:0}}));ee<G;){const re=Math.min(td,G-ee);k.push(s.createElement("div",{key:ve++,style:{width:0,height:re}})),ee+=re}const{ref:Re,width:Z,height:fe}=jc(b);return typeof window<"u"&&(((Oe=V.current)==null?void 0:Oe.height)!==fe||((K=V.current)==null?void 0:K.width)!==Z)&&(window.setTimeout(()=>J.current(),0),V.current={width:Z,height:fe}),(Z??0)===0||(fe??0)===0?s.createElement("div",{ref:Re}):s.createElement("div",{ref:Re},s.createElement(Qc,{isSafari:Gr.value},s.createElement("div",{className:"dvn-underlay"},t),s.createElement("div",{ref:be,style:V.current,draggable:a,onDragStart:re=>{a||(re.stopPropagation(),re.preventDefault())},className:"dvn-scroller "+(l??""),onScroll:()=>M()},s.createElement("div",{className:"dvn-scroll-inner"+(g===void 0?" dvn-hidden":"")},s.createElement("div",{className:"dvn-stack"},k),g!==void 0&&s.createElement(s.Fragment,null,!C&&s.createElement("div",{className:"dvn-spacer"}),s.createElement("div",{ref:E,style:{height:fe,maxHeight:n-Math.ceil(B%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:u,flexGrow:C?1:void 0,right:x?u??0:void 0,pointerEvents:"auto"}},g))))))},rd=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:a,freezeColumns:l,experimental:c,nonGrowWidth:f,clientSize:u,className:g,onVisibleRegionChanged:m,scrollRef:w,preventDiagonalScrolling:h,rightElement:b,rightElementProps:k,overscrollX:x,overscrollY:C,initialSize:F,smoothScrollX:N=!1,smoothScrollY:z=!1,isDraggable:B}=e,{paddingRight:X,paddingBottom:_}=c??{},[E,W]=u,P=s.useRef(),H=s.useRef(),I=s.useRef(),M=s.useRef(),J=f+Math.max(0,x??0);let V=a?r+i:r;if(typeof o=="number")V+=n*o;else for(let ee=0;ee<n;ee++)V+=o(ee);C!==void 0&&(V+=C);const se=s.useRef(),be=s.useCallback(()=>{var Ke,nt;if(se.current===void 0)return;const ee={...se.current};let G=0,Re=ee.x<0?-ee.x:0,Z=0,fe=0;ee.x=ee.x<0?0:ee.x;let Oe=0;for(let De=0;De<l;De++)Oe+=t[De].width;for(const De of t){const Ye=G-Oe;if(ee.x>=Ye+De.width)G+=De.width,fe++,Z++;else if(ee.x>Ye)G+=De.width,N?Re+=Ye-ee.x:fe++,Z++;else if(ee.x+ee.width>Ye)G+=De.width,Z++;else break}let K=0,re=0,he=0;if(typeof o=="number")z?(re=Math.floor(ee.y/o),K=re*o-ee.y):re=Math.ceil(ee.y/o),he=Math.ceil(ee.height/o)+re,K<0&&he++;else{let De=0;for(let Ye=0;Ye<n;Ye++){const Ie=o(Ye),dt=De+(z?0:Ie/2);if(ee.y>=De+Ie)De+=Ie,re++,he++;else if(ee.y>dt)De+=Ie,z?K+=dt-ee.y:re++,he++;else if(ee.y+ee.height>Ie/2+De)De+=Ie,he++;else break}}re=Math.max(0,Math.min(re,n-1)),he=Math.max(re,Math.min(he,n));const Xe={x:fe,y:re,width:Z-fe,height:he-re},Ne=P.current;(Ne===void 0||Ne.y!==Xe.y||Ne.x!==Xe.x||Ne.height!==Xe.height||Ne.width!==Xe.width||H.current!==Re||I.current!==K||ee.width!==((Ke=M.current)==null?void 0:Ke[0])||ee.height!==((nt=M.current)==null?void 0:nt[1]))&&(m==null||m({x:fe,y:re,width:Z-fe,height:he-re},ee.width,ee.height,ee.paddingRight??0,Re,K),P.current=Xe,H.current=Re,I.current=K,M.current=[ee.width,ee.height])},[t,o,n,m,l,N,z]),ve=s.useCallback(ee=>{se.current=ee,be()},[be]);return s.useEffect(()=>{be()},[be]),s.createElement(od,{scrollRef:w,className:g,kineticScrollPerfHack:c==null?void 0:c.kineticScrollPerfHack,preventDiagonalScrolling:h,draggable:B===!0||typeof B=="string",scrollWidth:J+(X??0),scrollHeight:V+(_??0),clientHeight:W,rightElement:b,paddingBottom:_,paddingRight:X,rightElementProps:k,update:ve,initialSize:F},s.createElement(qc,{eventTargetRef:w,width:E,height:W,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},id=en("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),ld=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),sd=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),ad=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),cd=10,dd=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:a,searchResults:l,onSearchValueChange:c,getCellsForSelection:f,onSearchResultsChanged:u,showSearch:g=!1,onSearchClose:m}=e,[w]=s.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[h,b]=s.useState(""),k=a??h,x=s.useCallback(G=>{b(G),c==null||c(G)},[c]),[C,F]=s.useState(),N=s.useRef(C);N.current=C,s.useEffect(()=>{l!==void 0&&(l.length>0?F(G=>({rowsSearched:o,results:l.length,selectedIndex:(G==null?void 0:G.selectedIndex)??-1})):F(void 0))},[o,l]);const z=s.useRef();z.current===void 0&&(z.current=new AbortController);const B=s.useRef(),[X,_]=s.useState([]),E=l??X,W=s.useCallback(()=>{B.current!==void 0&&(window.cancelAnimationFrame(B.current),B.current=void 0),z.current!==void 0&&z.current.abort(),z.current=new AbortController},[]),P=s.useRef(n);P.current=n;const H=s.useCallback(G=>{const Re=new RegExp(G.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let Z=P.current,fe=Math.min(10,o),Oe=0;F(void 0),_([]);const K=[],re=async()=>{var ht;if(f===void 0)return;const he=performance.now(),Xe=o-Oe;let Ne=f({x:0,y:Z,width:r.length,height:Math.min(fe,Xe,o-Z)},z.current.signal);typeof Ne=="function"&&(Ne=await Ne());let Ke=!1;for(const[gt,te]of Ne.entries())for(const[Ce,ae]of te.entries()){let ge;switch(ae.kind){case Q.Text:case Q.Number:ge=ae.displayData;break;case Q.Uri:case Q.Markdown:ge=ae.data;break;case Q.Boolean:ge=typeof ae.data=="boolean"?ae.data.toString():void 0;break;case Q.Image:case Q.Bubble:ge=ae.data.join("🐳");break;case Q.Custom:ge=ae.copyData;break}ge!==void 0&&Re.test(ge)&&(K.push([Ce,gt+Z]),Ke=!0)}const nt=performance.now();Ke&&_([...K]),Oe+=Ne.length,Jt(Oe<=o);const De=((ht=N.current)==null?void 0:ht.selectedIndex)??-1;F({results:K.length,rowsSearched:Oe,selectedIndex:De}),u==null||u(K,De),Z+fe>=o?Z=0:Z+=fe;const Ye=nt-he,Ie=Math.max(Ye,1),dt=cd/Ie;fe=Math.ceil(fe*dt),Oe<o&&K.length<1e3&&(B.current=window.requestAnimationFrame(re))};W(),B.current=window.requestAnimationFrame(re)},[W,r.length,f,u,o]),I=s.useCallback(()=>{var G;m==null||m(),F(void 0),_([]),u==null||u([],-1),W(),(G=t==null?void 0:t.current)==null||G.focus()},[W,t,m,u]),M=s.useCallback(G=>{x(G.target.value),l===void 0&&(G.target.value===""?(F(void 0),_([]),W()):H(G.target.value))},[H,W,x,l]);s.useEffect(()=>{i.current!==null&&(x(""),F(void 0),X.length>0&&(_([]),u==null||u([],-1)),g?i.current.focus({preventScroll:!0}):W())},[g,i]);const J=s.useCallback(G=>{var Z;if((Z=G==null?void 0:G.stopPropagation)==null||Z.call(G),C===void 0||C.results===0)return;const Re=(C.selectedIndex+1)%C.results;F({...C,selectedIndex:Re}),u==null||u(E,Re)},[C,u,E]),V=s.useCallback(G=>{var Z;if((Z=G==null?void 0:G.stopPropagation)==null||Z.call(G),C===void 0||C.results===0)return;let Re=(C.selectedIndex-1)%C.results;Re<0&&(Re+=C.results),F({...C,selectedIndex:Re}),u==null||u(E,Re)},[u,E,C]),se=s.useCallback(G=>{(G.ctrlKey||G.metaKey)&&G.nativeEvent.code==="KeyF"||G.key==="Escape"?(I(),G.stopPropagation(),G.preventDefault()):G.key==="Enter"&&(G.shiftKey?V():J())},[I,J,V]);s.useEffect(()=>()=>{W()},[W]);const[be,ve]=s.useState(!1);s.useEffect(()=>{if(g)ve(!0);else{const G=setTimeout(()=>ve(!1),150);return()=>clearTimeout(G)}},[g]);const ee=s.useMemo(()=>{if(!g&&!be)return null;let G;C!==void 0&&(G=C.results>=1e3?"over 1000":`${C.results} result${C.results!==1?"s":""}`,C.selectedIndex>=0&&(G=`${C.selectedIndex+1} of ${G}`));const Re=Oe=>{Oe.stopPropagation()},fe={width:`${o>0?Math.floor(((C==null?void 0:C.rowsSearched)??0)/o*100):0}%`};return s.createElement(id,{className:"gdg-search-bar"+(g?"":" out"),onMouseDown:Re,onMouseMove:Re,onMouseUp:Re,onClick:Re},s.createElement("div",{className:"gdg-search-bar-inner"},s.createElement("input",{id:w,"aria-hidden":!g,"data-testid":"search-input",ref:i,onChange:M,value:k,tabIndex:g?void 0:-1,onKeyDownCapture:se}),s.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!g,tabIndex:g?void 0:-1,onClick:V,disabled:((C==null?void 0:C.results)??0)===0},ld),s.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!g,tabIndex:g?void 0:-1,onClick:J,disabled:((C==null?void 0:C.results)??0)===0},sd),m!==void 0&&s.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!g,"data-testid":"search-close-button",tabIndex:g?void 0:-1,onClick:I},ad)),C!==void 0?s.createElement(s.Fragment,null,s.createElement("div",{className:"gdg-search-status"},s.createElement("div",{"data-testid":"search-result-area"},G)),s.createElement("div",{className:"gdg-search-progress",style:fe})):s.createElement("div",{className:"gdg-search-status"},s.createElement("label",{htmlFor:w},"Type to search")))},[g,be,C,o,w,i,M,k,se,V,J,m,I]);return s.createElement(s.Fragment,null,s.createElement(rd,{prelightCells:E,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),ee)};class ud extends s.PureComponent{constructor(){super(...arguments);Le(this,"wrapperRef",s.createRef());Le(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){const n=this.props.customEventTarget??document;n.addEventListener("touchend",this.clickOutside,!0),n.addEventListener("mousedown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const n=this.props.customEventTarget??document;n.removeEventListener("touchend",this.clickOutside,!0),n.removeEventListener("mousedown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,customEventTarget:r,...i}=this.props;return s.createElement("div",{...i,ref:this.wrapperRef},this.props.children)}}const fd=()=>e=>Math.max(16,e.targetHeight-10),hd=en("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[fd(),"px"]}}),gd=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[a,l]=St.useState(n);return St.createElement(ud,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},St.createElement(hd,{targetHeight:t.height,"data-testid":"group-rename-input",value:a,onBlur:o,onFocus:c=>c.target.setSelectionRange(0,a.length),onChange:c=>l(c.target.value),onKeyDown:c=>{c.key==="Enter"?i(a):c.key==="Escape"&&o()},autoFocus:!0}))};function md(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function We(e,t,n){const o=ws(e,t);return o&&(n.didMatch=!0),o}function ws(e,t){if(e.length===0)return!1;if(e.includes("|")){const c=e.split("|");for(const f of c)if(ws(f,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const a=e.split("+"),l=a.pop();if(!md(l,t))return!1;if(a[0]==="any")return!0;for(const c of a)switch(c){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":Kr.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function wd(e,t,n,o,r,i,a){const l=St.useCallback((u,g,m,w)=>{var F;(i==="cell"||i==="multi-cell")&&u!==void 0&&(u={...u,range:{x:u.cell[0],y:u.cell[1],width:1,height:1}}),!a&&u!==void 0&&u.range.width>1&&(u={...u,range:{...u.range,width:1,x:u.cell[0]}});const h=n==="mixed"&&(m||w==="drag")||n==="additive",b=(o==="mixed"||o==="additive")&&h,k=(r==="mixed"||r==="additive")&&h;let x={current:u===void 0?void 0:{...u,rangeStack:w==="drag"?((F=e.current)==null?void 0:F.rangeStack)??[]:[]},columns:b?e.columns:rt.empty(),rows:k?e.rows:rt.empty()};m&&(i==="multi-rect"||i==="multi-cell")&&x.current!==void 0&&e.current!==void 0&&(x={...x,current:{...x.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(x,g)},[o,e,n,i,a,r,t]),c=St.useCallback((u,g,m)=>{u=u??e.rows,g!==void 0&&(u=u.add(g));let w;if(r==="exclusive"&&u.length>0)w={current:void 0,columns:rt.empty(),rows:u};else{const h=m&&n==="mixed"||n==="additive",b=m&&o==="mixed"||o==="additive";w={current:h?e.current:void 0,columns:b?e.columns:rt.empty(),rows:u}}t(w,!1)},[o,e,n,r,t]),f=St.useCallback((u,g,m)=>{u=u??e.columns,g!==void 0&&(u=u.add(g));let w;if(o==="exclusive"&&u.length>0)w={current:void 0,rows:rt.empty(),columns:u};else{const h=m&&n==="mixed"||n==="additive",b=m&&r==="mixed"||r==="additive";w={current:h?e.current:void 0,rows:b?e.rows:rt.empty(),columns:u}}t(w,!1)},[o,e,n,r,t]);return[l,c,f]}function bd(e,t,n,o,r){const i=s.useCallback(f=>{if(e===!0){const u=[];for(let g=f.y;g<f.y+f.height;g++){const m=[];for(let w=f.x;w<f.x+f.width;w++)w<0||g>=r?m.push({kind:Q.Loading,allowOverlay:!1}):m.push(t([w,g]));u.push(m)}return u}return(e==null?void 0:e(f,o.signal))??[]},[o.signal,t,e,r]),a=e!==void 0?i:void 0,l=s.useCallback(f=>{if(a===void 0)return[];const u={...f,x:f.x-n};if(u.x<0){u.x=0,u.width--;const g=a(u,o.signal);return typeof g=="function"?async()=>(await g()).map(m=>[{kind:Q.Loading,allowOverlay:!1},...m]):g.map(m=>[{kind:Q.Loading,allowOverlay:!1},...m])}return a(u,o.signal)},[o.signal,a,n]);return[e!==void 0?l:void 0,a]}function yd(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case Q.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Bi?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case Q.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case Q.Image:case Q.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case Q.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case Q.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case Q.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case Q.Markdown:case Q.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case Q.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case Q.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case Q.Protected:return{formatted:"************",rawValue:"",format:"string"};default:sr()}}function pd(e,t){return e.map((o,r)=>{const i=t[r];return o.map(a=>a.span!==void 0&&a.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:yd(a))})}function El(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function vd(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(a=>El(a,!0)).join(",")):r.push(i.doNotEscape===!0?i.formatted:El(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function Ri(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function Il(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function Cd(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function xd(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${Ri(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((a,l)=>`<li gdg-raw-value=${Il(r.rawValue[l])}>`+Ri(a)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${Il(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${Ri(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function kd(e,t){const n=pd(e,t),o=vd(n),r=xd(n);return{textPlain:o,textHtml:r}}function Fl(e){var a;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const l=o.pop();if(l===void 0)break;if(l instanceof HTMLTableElement||l.nodeName==="TBODY")o.push(...[...l.children].reverse());else if(l instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...l.children].reverse());else if(l instanceof HTMLTableCellElement){const c=l.cloneNode(!0),u=c.children.length===1&&c.children[0].nodeName==="P"?c.children[0]:null,g=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",m=c.querySelectorAll("br");for(const b of m)b.replaceWith(`
`);const w=c.getAttribute("gdg-raw-value"),h=c.getAttribute("gdg-format")??"string";if(c.querySelector("a")!==null)i==null||i.push({rawValue:((a=c.querySelector("a"))==null?void 0:a.getAttribute("href"))??"",formatted:c.textContent??"",format:h});else if(c.querySelector("ol")!==null){const b=c.querySelectorAll("li");i==null||i.push({rawValue:[...b].map(k=>k.getAttribute("gdg-raw-value")??""),formatted:[...b].map(k=>k.textContent??""),format:"string-array"})}else if(w!==null)i==null||i.push({rawValue:Cd(w),formatted:c.textContent??"",format:h});else{let b=c.textContent??"";g&&(b=b.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:b??"",formatted:b??"",format:h})}}}return i!==void 0&&r.push(i),r}function Sd(e,t,n,o,r){var l;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let a=!1;do{if((e==null?void 0:e.current)===void 0)break;const c=(l=e.current)==null?void 0:l.range,f=[];if(c.width>2){const m=t({x:c.x,y:c.y,width:1,height:c.height},r.signal);if(typeof m=="function")return i;f.push(...m);const w=t({x:c.x+c.width-1,y:c.y,width:1,height:c.height},r.signal);if(typeof w=="function")return i;f.push(...w)}else{const m=t({x:c.x,y:c.y,width:c.width,height:c.height},r.signal);if(typeof m=="function")return i;f.push(...m)}let u=c.x-n,g=c.x+c.width-1-n;for(const m of f)for(const w of m)w.span!==void 0&&(u=Math.min(w.span[0],u),g=Math.max(w.span[1],g));u===c.x-n&&g===c.x+c.width-1-n?a=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:c.y,width:g-u+1,height:c.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!a);return e}function Dl(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function Md(e){let t;(function(l){l[l.None=0]="None",l[l.inString=1]="inString",l[l.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let a=0;for(const l of e){switch(i){case t.None:l==="	"||l===`
`?(o.push(e.slice(r,a)),r=a+1,l===`
`&&(n.push(o),o=[])):l==='"'&&(i=t.inString);break;case t.inString:l==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:l==='"'?i=t.inString:((l==="	"||l===`
`)&&(o.push(Dl(e.slice(r,a))),r=a+1,l===`
`&&(n.push(o),o=[])),i=t.None);break}a++}return r<e.length&&o.push(Dl(e.slice(r,e.length))),n.push(o),n.map(l=>l.map(c=>({rawValue:c,formatted:c,format:"string"})))}function Hl(e,t,n){var l;const o=kd(e,t),r=c=>{var f;(f=window.navigator.clipboard)==null||f.writeText(c)},i=(c,f)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([c],{type:"text/plain"}),"text/html":new Blob([f],{type:"text/html"})})]),!0)},a=(c,f)=>{var u,g;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",c),(g=n==null?void 0:n.clipboardData)==null||g.setData("text/html",f)}catch{i(c,f)||r(c)}};((l=window.navigator.clipboard)==null?void 0:l.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?a(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function bs(e){return e!==!0}function Tl(e){return typeof e=="string"?e:`${e}px`}const Rd=()=>e=>e.innerWidth,Ed=()=>e=>e.innerHeight,Id=en("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[Rd()],"wmyidgi-1":[Ed()]}}),Fd=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return s.createElement(Id,{innerHeight:Tl(n),innerWidth:Tl(t),...r},o)},Dd=2,Hd=1300;function Td(e,t,n){const o=St.useRef(0),[r,i]=e??[0,0];St.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let a=!1,l=0;const c=f=>{var u;if(!a){if(l===0)l=f;else{const g=f-l;o.current=Math.min(1,o.current+g/Hd);const m=o.current**1.618*g*Dd;(u=t.current)==null||u.scrollBy(r*m,i*m),l=f,n==null||n()}window.requestAnimationFrame(c)}};return window.requestAnimationFrame(c),()=>{a=!0}},[t,r,i,n])}function Ad({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:a,remSize:l}){const[c,f,u,g,m,w]=St.useMemo(()=>{if(!a||l===16)return[e,t,n,o,r,i];const h=l/16,b=e,k=ns();return[typeof b=="number"?b*h:x=>Math.ceil(b(x)*h),Math.ceil(t*h),Math.ceil(n*h),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??k.headerIconSize)*h,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??k.cellHorizontalPadding)*h,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??k.cellVerticalPadding)*h},Math.ceil((r??0)*h),Math.ceil((i??0)*h)]},[n,t,r,i,l,e,a,o]);return{rowHeight:c,headerHeight:f,groupHeaderHeight:u,theme:g,overscrollX:m,overscrollY:w}}const qn={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function $e(e,t){return e===!0?t:e===!1?"":e}function Al(e){const t=Kr.value;return{activateCell:$e(e.activateCell," |Enter|shift+Enter"),clear:$e(e.clear,"any+Escape"),closeOverlay:$e(e.closeOverlay,"any+Escape"),acceptOverlayDown:$e(e.acceptOverlayDown,"Enter"),acceptOverlayUp:$e(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:$e(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:$e(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:$e(e.delete,t?"Backspace|Delete":"Delete"),downFill:$e(e.downFill,"primary+_68"),scrollToSelectedCell:$e(e.scrollToSelectedCell,"primary+Enter"),goDownCell:$e(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:$e(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:$e(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:$e(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:$e(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:$e(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:$e(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:$e(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:$e(e.goToFirstCell,"primary+Home"),goToFirstColumn:$e(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:$e(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:$e(e.goToLastCell,"primary+End"),goToLastColumn:$e(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:$e(e.goToLastRow,"primary+ArrowDown"),goToNextPage:$e(e.goToNextPage,"PageDown"),goToPreviousPage:$e(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:$e(e.rightFill,"primary+_82"),search:$e(e.search,"primary+f"),selectAll:$e(e.selectAll,"primary+a"),selectColumn:$e(e.selectColumn,"ctrl+ "),selectGrowDown:$e(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:$e(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:$e(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:$e(e.selectGrowUp,"shift+ArrowUp"),selectRow:$e(e.selectRow,"shift+ "),selectToFirstCell:$e(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:$e(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:$e(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:$e(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:$e(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:$e(e.selectToLastRow,"primary+shift+ArrowDown")}}function zd(e){const t=pa(e);return St.useMemo(()=>{if(t===void 0)return Al(qn);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??qn.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??qn.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??qn.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??qn.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??qn.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??qn.selectToLastCell};return Al({...qn,...n})},[t])}function Bd(e){function t(o,r,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:r,path:i};const a={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:r,path:i};return o.subGroups!==void 0&&(a.subGroups=o.subGroups.map((l,c)=>t(l,r+1,[...i,c])).sort((l,c)=>l.headerIndex-c.headerIndex)),a}return e.map((o,r)=>t(o,0,[r])).sort((o,r)=>o.headerIndex-r.headerIndex)}function _i(e,t){const n=[];function o(l,c,f=!1){let u=c!==null?c-l.headerIndex:t-l.headerIndex;if(l.subGroups!==void 0&&(u=l.subGroups[0].headerIndex-l.headerIndex),u--,n.push({rowIndex:-1,headerIndex:l.headerIndex,contentIndex:-1,skip:f,isCollapsed:l.isCollapsed,depth:l.depth,path:l.path,rows:u}),l.subGroups)for(let g=0;g<l.subGroups.length;g++){const m=g<l.subGroups.length-1?l.subGroups[g+1].headerIndex:c;o(l.subGroups[g],m,f||l.isCollapsed)}}const r=Bd(e.groups);for(let l=0;l<r.length;l++){const c=l<r.length-1?r[l+1].headerIndex:null;o(r[l],c)}let i=0,a=0;for(const l of n)l.contentIndex=a,a+=l.rows,l.rowIndex=i,i+=l.isCollapsed?1:l.rows+1;return n.filter(l=>l.skip===!1).map(l=>{const{skip:c,...f}=l;return f})}function zi(e,t){if(t===void 0||_i.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(o.isCollapsed)n--;else{if(n<=o.rows)return{path:[...o.path,n-1],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n-1,contentIndex:o.contentIndex+n-1,groupRows:o.rows};n=n-o.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function Pd(e,t,n,o){const r=St.useMemo(()=>e===void 0?void 0:_i(e,t),[e,t]),i=St.useMemo(()=>r==null?void 0:r.reduce((u,g)=>(u[g.rowIndex]=g,u),{}),[r]),a=St.useMemo(()=>r===void 0?t:r.reduce((u,g)=>u+(g.isCollapsed?1:g.rows+1),0),[r,t]),l=St.useMemo(()=>e===void 0||typeof n=="number"&&e.height===n?n:u=>i!=null&&i[u]?e.height:typeof n=="number"?n:n(u),[i,e,n]),c=St.useCallback(u=>{if(r===void 0)return u;let g=u;for(const m of r){if(g===0)return;if(g--,!m.isCollapsed){if(g<m.rows)return m.contentIndex+g;g-=m.rows}}return u},[r]),f=jn(o??(e==null?void 0:e.themeOverride),St.useCallback(u=>{if(e===void 0)return o==null?void 0:o(u,u,u);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:g,contentIndex:m,groupIndex:w}=zi(u,r);return g?e.themeOverride:o==null?void 0:o(u,w,m)},[r,o,e]));return e===void 0?{rowHeight:l,rows:t,rowNumberMapper:c,getRowThemeOverride:f}:{rowHeight:l,rows:a,rowNumberMapper:c,getRowThemeOverride:f}}function Ld(e,t){const n=St.useMemo(()=>e===void 0?void 0:_i(e,t),[e,t]);return{getRowGroupingForPath:ps,updateRowGroupingByPath:ys,mapper:St.useCallback(o=>{if(typeof o=="number")return zi(o,n);const r=zi(o[1],n);return{...r,originalIndex:[o[0],r.originalIndex]}},[n])}}function ys(e,t,n){const[o,...r]=t;return r[0]===-1?e.map((i,a)=>a===o?{...i,...n}:i):e.map((i,a)=>a===o?{...i,subGroups:ys(i.subGroups??[],r,n)}:i)}function ps(e,t){const[n,...o]=t;return o[0]===-1?e[n]:ps(e[n].subGroups??[],o)}function Wd(e,t){const[n]=s.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const r=n.value;r!==o&&(n.value=o,n.callback(o,r))}}}));return n.callback=t,n.facade}function $d(e,t,n,o,r){const[i,a]=s.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),l=s.useMemo(()=>({x:o.current.x,y:i,width:o.current.width??1,height:o.current.height??1,ty:a}),[o,a,i]),[c,f,u]=ya(l),g=s.useRef(r);g.current=r;const m=Wd(null,b=>{b!==null&&t!==void 0?b.scrollTop=t:b!==null&&e!==void 0&&(b.scrollLeft=e)}),w=(c.height??1)>1;s.useLayoutEffect(()=>{if(t!==void 0&&m.current!==null&&w){if(m.current.scrollTop===t)return;m.current.scrollTop=t,m.current.scrollTop!==t&&u(),g.current()}},[t,w,u,m]);const h=(c.width??1)>1;return s.useLayoutEffect(()=>{if(e!==void 0&&m.current!==null&&h){if(m.current.scrollLeft===e)return;m.current.scrollLeft=e,m.current.scrollLeft!==e&&u(),g.current()}},[e,h,u,m]),{visibleRegion:c,setVisibleRegion:f,scrollRef:m}}const Od=s.lazy(async()=>await Ll(()=>import("./data-grid-overlay-editor-CyV87IsY.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url));let Nd=0;function Xd(e){return sa(cl(cl(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return ho((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function Lr(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const Wr={kind:Q.Loading,allowOverlay:!1},$r={columns:rt.empty(),rows:rt.empty(),current:void 0},Yd=(e,t)=>{var ll,sl,al;const[n,o]=s.useState($r),[r,i]=s.useState(),a=s.useRef(null),l=s.useRef(null),[c,f]=s.useState(),u=s.useRef(),g=typeof window>"u"?null:window,{imageEditorOverride:m,getRowThemeOverride:w,markdownDivCreateNode:h,width:b,height:k,columns:x,rows:C,getCellContent:F,onCellClicked:N,onCellActivated:z,onGridFocused:B,onGridBlurred:X,onFillPattern:_,onFinishedEditing:E,coercePasteValue:W,drawHeader:P,drawCell:H,editorBloom:I,onHeaderClicked:M,onColumnProposeMove:J,rangeSelectionColumnSpanning:V=!0,spanRangeBehavior:se="default",onGroupHeaderClicked:be,onCellContextMenu:ve,className:ee,onHeaderContextMenu:G,getCellsForSelection:Re,onGroupHeaderContextMenu:Z,onGroupHeaderRenamed:fe,onCellEdited:Oe,onCellsEdited:K,onSearchResultsChanged:re,searchResults:he,onSearchValueChange:Xe,searchValue:Ne,onKeyDown:Ke,onKeyUp:nt,keybindings:De,editOnType:Ye=!0,onRowAppended:Ie,onColumnAppended:dt,onColumnMoved:ht,validateCell:gt,highlightRegions:te,rangeSelect:Ce="rect",columnSelect:ae="multi",rowSelect:ge="multi",rangeSelectionBlending:me="exclusive",columnSelectionBlending:Qe="exclusive",rowSelectionBlending:Ue="exclusive",onDelete:Ze,onDragStart:le,onMouseMove:we,onPaste:Ve,copyHeaders:qe=!1,freezeColumns:ze=0,cellActivationBehavior:pt="second-click",rowSelectionMode:et="auto",columnSelectionMode:Ae="auto",onHeaderMenuClick:Mt,onHeaderIndicatorClick:At,getGroupDetails:zt,rowGrouping:st,onSearchClose:$t,onItemHovered:Dt,onSelectionCleared:Xt,showSearch:Wn,onVisibleRegionChanged:it,gridSelection:Yt,onGridSelectionChange:jt,minColumnWidth:mt=50,maxColumnWidth:Ot=500,maxColumnAutoWidth:Fn,provideEditor:tn,trailingRowOptions:Be,freezeTrailingRows:He=0,allowedFillDirections:It="orthogonal",scrollOffsetX:vt,scrollOffsetY:nn,verticalBorder:Ht,onDragOverCell:pn,onDrop:$o,onColumnResize:at,onColumnResizeEnd:Dn,onColumnResizeStart:Ct,customRenderers:Rt,fillHandle:Hn,experimental:Ft,fixedShadowX:$n,fixedShadowY:Tn,headerIcons:An,imageWindowLoader:bo,initialSize:ur,isDraggable:fr,onDragLeave:yo,onRowMoved:vn,overscrollX:po,overscrollY:vo,preventDiagonalScrolling:eo,rightElement:On,rightElementProps:Zr,trapFocus:Oo=!1,smoothScrollX:Jr,smoothScrollY:Qr,scaleToRem:zn=!1,rowHeight:Nn=34,headerHeight:hr=36,groupHeaderHeight:ei=hr,theme:gr,isOutsideClick:mr,renderers:Xn,resizeIndicator:Gi,scrollToActiveCell:No=!0,drawFocusRing:Co=!0,portalElementRef:wr}=e,xo=Co==="no-editor"?r===void 0:Co,lt=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,Bt=(lt==null?void 0:lt.kind)??e.rowMarkers??"none",Xo=(lt==null?void 0:lt.width)??e.rowMarkerWidth,Yn=(lt==null?void 0:lt.startIndex)??e.rowMarkerStartIndex??1,ko=(lt==null?void 0:lt.theme)??e.rowMarkerTheme,Yo=lt==null?void 0:lt.headerTheme,_o=lt==null?void 0:lt.headerAlwaysVisible,to=ge!=="multi"||(lt==null?void 0:lt.headerDisabled)===!0,So=(lt==null?void 0:lt.checkboxStyle)??"square",_n=Math.max(mt,20),no=Math.max(Ot,_n),br=Math.max(Fn??no,_n),Go=s.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:xe,rowNumberMapper:yr,rowHeight:ti,getRowThemeOverride:dn}=Pd(st,C,Nn,w),ni=s.useMemo(()=>Number.parseFloat(Go.fontSize),[Go]),{rowHeight:Cn,headerHeight:oo,groupHeaderHeight:pr,theme:vr,overscrollX:oi,overscrollY:ri}=Ad({groupHeaderHeight:ei,headerHeight:hr,overscrollX:po,overscrollY:vo,remSize:ni,rowHeight:ti,scaleToRem:zn,theme:gr}),un=zd(De),fn=Xo??(C>1e4?48:C>1e3?44:C>100?36:32),Ut=Bt!=="none",D=Ut?1:0,xt=Be!==void 0,xn=(Be==null?void 0:Be.sticky)===!0,[ii,ro]=s.useState(!1),li=Wn??ii,si=s.useCallback(()=>{$t!==void 0?$t():ro(!1)},[$t]),y=s.useMemo(()=>Yt===void 0?void 0:Lr(Yt,D),[Yt,D])??n,ne=s.useRef();ne.current===void 0&&(ne.current=new AbortController),s.useEffect(()=>()=>ne==null?void 0:ne.current.abort(),[]);const[q,j]=bd(Re,F,D,ne.current,xe),ie=s.useCallback((d,p,v)=>{if(gt===void 0)return!0;const S=[d[0]-D,d[1]];return gt==null?void 0:gt(S,p,v)},[D,gt]),ke=s.useRef(Yt),Se=s.useCallback((d,p)=>{p&&(d=Sd(d,q,D,se,ne.current)),jt!==void 0?(ke.current=Lr(d,-D),jt(ke.current)):o(d)},[jt,q,D,se]),ce=jn(at,s.useCallback((d,p,v,S)=>{at==null||at(x[v-D],p,v-D,S)},[at,D,x])),Tt=jn(Dn,s.useCallback((d,p,v,S)=>{Dn==null||Dn(x[v-D],p,v-D,S)},[Dn,D,x])),ye=jn(Ct,s.useCallback((d,p,v,S)=>{Ct==null||Ct(x[v-D],p,v-D,S)},[Ct,D,x])),tt=jn(P,s.useCallback((d,p)=>(P==null?void 0:P({...d,columnIndex:d.columnIndex-D},p))??!1,[P,D])),je=jn(H,s.useCallback((d,p)=>(H==null?void 0:H({...d,col:d.col-D},p))??!1,[H,D])),Te=s.useCallback(d=>{if(Ze!==void 0){const p=Ze(Lr(d,-D));return typeof p=="boolean"?p:Lr(p,D)}return!0},[Ze,D]),[Je,ut,_e]=wd(y,Se,me,Qe,Ue,Ce,V),wt=s.useMemo(()=>Ln(ns(),vr),[vr]),[on,Zt]=s.useState([0,0,0]),ot=s.useMemo(()=>{if(Xn===void 0)return{};const d={};for(const p of Xn)d[p.kind]=p;return d},[Xn]),ft=s.useCallback(d=>d.kind!==Q.Custom?ot[d.kind]:Rt==null?void 0:Rt.find(p=>p.isMatch(d)),[Rt,ot]);let{sizedColumns:kt,nonGrowWidth:Mo}=Ga(x,xe,j,on[0]-(D===0?0:fn)-on[2],_n,br,wt,ft,ne.current);Bt!=="none"&&(Mo+=fn);const kn=s.useMemo(()=>kt.some(d=>d.group!==void 0),[kt]),hn=kn?oo+pr:oo,Bn=y.rows.length,Ko=Bt==="none"?void 0:Bn===0?!1:Bn===xe?!0:void 0,Pe=s.useMemo(()=>Bt==="none"?kt:[{title:"",width:fn,icon:void 0,hasMenu:!1,style:"normal",themeOverride:ko,rowMarker:So,rowMarkerChecked:Ko,headerRowMarkerTheme:Yo,headerRowMarkerAlwaysVisible:_o,headerRowMarkerDisabled:to},...kt],[Bt,kt,fn,ko,So,Ko,Yo,_o,to]),_t=s.useRef({height:1,width:1,x:0,y:0}),Ro=s.useRef(!1),{setVisibleRegion:Ki,visibleRegion:io,scrollRef:bt}=$d(vt,nn,Cn,_t,()=>Ro.current=!0);_t.current=io;const xs=io.x+D,Cr=io.y,Pt=s.useRef(null),Gt=s.useCallback(d=>{var p;d===!0?(p=Pt.current)==null||p.focus():window.requestAnimationFrame(()=>{var v;(v=Pt.current)==null||v.focus()})},[]),Nt=xt?xe+1:xe,rn=s.useCallback(d=>{const p=D===0?d:d.map(S=>({...S,location:[S.location[0]-D,S.location[1]]})),v=K==null?void 0:K(p);if(v!==!0)for(const S of p)Oe==null||Oe(S.location,S.value);return v},[Oe,K,D]),[lo,ai]=s.useState(),xr=y.current!==void 0&&y.current.range.width*y.current.range.height>1?y.current.range:void 0,Eo=xo?(ll=y.current)==null?void 0:ll.cell:void 0,kr=Eo==null?void 0:Eo[0],Sr=Eo==null?void 0:Eo[1],ks=s.useMemo(()=>{if((te===void 0||te.length===0)&&(xr??kr??Sr??lo)===void 0)return;const d=[];if(te!==void 0)for(const p of te){const v=Pe.length-p.range.x-D;v>0&&d.push({color:p.color,range:{...p.range,x:p.range.x+D,width:Math.min(v,p.range.width)},style:p.style})}return lo!==void 0&&d.push({color:mo(wt.accentColor,0),range:lo,style:"dashed"}),xr!==void 0&&d.push({color:mo(wt.accentColor,.5),range:xr,style:"solid-outline"}),kr!==void 0&&Sr!==void 0&&d.push({color:wt.accentColor,range:{x:kr,y:Sr,width:1,height:1},style:"solid-outline"}),d.length>0?d:void 0},[lo,xr,kr,Sr,te,Pe.length,wt.accentColor,D]),Ui=s.useRef(Pe);Ui.current=Pe;const Vt=s.useCallback(([d,p],v=!1)=>{var $,T,L,O,Y,oe,de;const S=xt&&p===Nt-1;if(d===0&&Ut){if(S)return Wr;const U=yr(p);return U===void 0?Wr:{kind:an.Marker,allowOverlay:!1,checkboxStyle:So,checked:(y==null?void 0:y.rows.hasIndex(p))===!0,markerKind:Bt==="clickable-number"?"number":Bt,row:Yn+U,drawHandle:vn!==void 0,cursor:Bt==="clickable-number"?"pointer":void 0}}else if(S){const Me=d===D?(Be==null?void 0:Be.hint)??"":"",ue=Ui.current[d];if((($=ue==null?void 0:ue.trailingRowOptions)==null?void 0:$.disabled)===!0)return Wr;{const Fe=((T=ue==null?void 0:ue.trailingRowOptions)==null?void 0:T.hint)??Me,Ee=((L=ue==null?void 0:ue.trailingRowOptions)==null?void 0:L.addIcon)??(Be==null?void 0:Be.addIcon);return{kind:an.NewRow,hint:Fe,allowOverlay:!1,icon:Ee}}}else{const U=d-D;if(v||(Ft==null?void 0:Ft.strict)===!0){const ue=_t.current,Fe=ue.x>U||U>ue.x+ue.width||ue.y>p||p>ue.y+ue.height||p>=fi.current,Ee=U===((Y=(O=ue.extras)==null?void 0:O.selected)==null?void 0:Y[0])&&p===((oe=ue.extras)==null?void 0:oe.selected[1]);let pe=!1;if(((de=ue.extras)==null?void 0:de.freezeRegions)!==void 0){for(const Ge of ue.extras.freezeRegions)if(go(Ge,U,p)){pe=!0;break}}if(Fe&&!Ee&&!pe)return Wr}let Me=F([U,p]);return D!==0&&Me.span!==void 0&&(Me={...Me,span:[Me.span[0]+D,Me.span[1]+D]}),Me}},[xt,Nt,Ut,yr,So,y==null?void 0:y.rows,Bt,Yn,vn,D,Be==null?void 0:Be.hint,Be==null?void 0:Be.addIcon,Ft==null?void 0:Ft.strict,F]),ci=s.useCallback(d=>{let p=(zt==null?void 0:zt(d))??{name:d};return fe!==void 0&&d!==""&&(p={icon:p.icon,name:p.name,overrideTheme:p.overrideTheme,actions:[...p.actions??[],{title:"Rename",icon:"renameIcon",onClick:v=>gi({group:p.name,bounds:v.bounds})}]}),p},[zt,fe]),Mr=s.useCallback(d=>{var L;const[p,v]=d.cell,S=Pe[p],A=(S==null?void 0:S.group)!==void 0?(L=ci(S.group))==null?void 0:L.overrideTheme:void 0,$=S==null?void 0:S.themeOverride,T=dn==null?void 0:dn(v);i({...d,theme:Ln(wt,A,$,T,d.content.themeOverride)})},[dn,Pe,ci,wt]),Io=s.useCallback((d,p,v)=>{var T;if(y.current===void 0)return;const[S,A]=y.current.cell,$=Vt([S,A]);if($.kind!==Q.Boolean&&$.allowOverlay){let L=$;if(v!==void 0)switch(L.kind){case Q.Number:{const O=ca(()=>v==="-"?-0:Number.parseFloat(v),0);L={...L,data:Number.isNaN(O)?0:O};break}case Q.Text:case Q.Markdown:case Q.Uri:L={...L,data:v};break}Mr({target:d,content:L,initialValue:v,cell:[S,A],highlight:v===void 0,forceEditMode:v!==void 0,activation:p})}else $.kind===Q.Boolean&&p.inputType==="keyboard"&&$.readonly!==!0&&(rn([{location:y.current.cell,value:{...$,data:bs($.data)}}]),(T=Pt.current)==null||T.damage([{cell:y.current.cell}]))},[Vt,y,rn,Mr]),Vi=s.useCallback((d,p)=>{var A;const v=(A=Pt.current)==null?void 0:A.getBounds(d,p);if(v===void 0||bt.current===null)return;const S=Vt([d,p]);S.allowOverlay&&Mr({target:v,content:S,initialValue:void 0,highlight:!0,cell:[d,p],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[Vt,bt,Mr]),Et=s.useCallback((d,p,v="both",S=0,A=0,$=void 0)=>{if(bt.current!==null){const T=Pt.current,L=l.current,O=typeof d!="number"?d.unit==="cell"?d.amount:void 0:d,Y=typeof p!="number"?p.unit==="cell"?p.amount:void 0:p,oe=typeof d!="number"&&d.unit==="px"?d.amount:void 0,de=typeof p!="number"&&p.unit==="px"?p.amount:void 0;if(T!==null&&L!==null){let U={x:0,y:0,width:0,height:0},Me=0,ue=0;if((O!==void 0||Y!==void 0)&&(U=T.getBounds((O??0)+D,Y??0)??U,U.width===0||U.height===0))return;const Fe=L.getBoundingClientRect(),Ee=Fe.width/L.offsetWidth;if(oe!==void 0&&(U={...U,x:oe-Fe.left-bt.current.scrollLeft,width:1}),de!==void 0&&(U={...U,y:de+Fe.top-bt.current.scrollTop,height:1}),U!==void 0){const pe={x:U.x-S,y:U.y-A,width:U.width+2*S,height:U.height+2*A};let Ge=0;for(let Ci=0;Ci<ze;Ci++)Ge+=kt[Ci].width;let ct=0;const Lt=He+(xn?1:0);Lt>0&&(ct=wo(Nt,Lt,Cn));let wn=Ge*Ee+Fe.left+D*fn*Ee,Mn=Fe.right,Rn=Fe.top+hn*Ee,Pn=Fe.bottom-ct*Ee;const Tr=U.width+S*2;switch($==null?void 0:$.hAlign){case"start":Mn=wn+Tr;break;case"end":wn=Mn-Tr;break;case"center":wn=Math.floor((wn+Mn)/2)-Tr/2,Mn=wn+Tr;break}const Ar=U.height+A*2;switch($==null?void 0:$.vAlign){case"start":Pn=Rn+Ar;break;case"end":Rn=Pn-Ar;break;case"center":Rn=Math.floor((Rn+Pn)/2)-Ar/2,Pn=Rn+Ar;break}wn>pe.x?Me=pe.x-wn:Mn<pe.x+pe.width&&(Me=pe.x+pe.width-Mn),Rn>pe.y?ue=pe.y-Rn:Pn<pe.y+pe.height&&(ue=pe.y+pe.height-Pn),v==="vertical"||typeof d=="number"&&d<ze?Me=0:(v==="horizontal"||typeof p=="number"&&p>=Nt-Lt)&&(ue=0),(Me!==0||ue!==0)&&(Ee!==1&&(Me/=Ee,ue/=Ee),bt.current.scrollTo({left:Me+bt.current.scrollLeft,top:ue+bt.current.scrollTop,behavior:($==null?void 0:$.behavior)??"auto"}))}}}},[D,He,fn,bt,hn,ze,kt,Nt,xn,Cn]),di=s.useRef(Vi),ui=s.useRef(F);di.current=Vi,ui.current=F;const fi=s.useRef(xe);fi.current=xe;const qi=s.useRef(Pe.length);qi.current=Pe.length;const Gn=s.useCallback(async(d,p=!0,v)=>{var Y;const S=Pe[d];if(((Y=S==null?void 0:S.trailingRowOptions)==null?void 0:Y.disabled)===!0)return;const A=Ie==null?void 0:Ie();let $,T=!0;A!==void 0&&($=await A,$==="top"&&(T=!1),typeof $=="number"&&(T=!1));let L=0;const O=()=>{if(fi.current<=xe){L<500&&window.setTimeout(O,L),L=50+L*2;return}const oe=typeof $=="number"?$:T?xe:0;Hr.current(d-D,oe,"both",0,0,v?{behavior:v}:void 0),Je({cell:[d,oe],range:{x:d,y:oe,width:1,height:1}},!1,!1,"edit");const de=ui.current([d-D,oe]);de.allowOverlay&&Ao(de)&&de.readonly!==!0&&p&&window.setTimeout(()=>{di.current(d,oe)},0)};O()},[Pe,Ie,D,xe,Je]),Rr=s.useCallback(async(d,p=!0)=>{const v=dt==null?void 0:dt();let S,A=!0;v!==void 0&&(S=await v,S==="left"&&(A=!1),typeof S=="number"&&(A=!1));let $=0;const T=()=>{if(qi.current<=Pe.length){$<500&&window.setTimeout(T,$),$=50+$*2;return}const L=typeof S=="number"?S:A?Pe.length:0;Et(L-D,d),Je({cell:[L,d],range:{x:L,y:d,width:1,height:1}},!1,!1,"edit");const O=ui.current([L-D,d]);O.allowOverlay&&Ao(O)&&O.readonly!==!0&&p&&window.setTimeout(()=>{di.current(L,d)},0)};T()},[Pe,dt,D,Et,Je]),Fo=s.useCallback(d=>{var v,S;const p=((S=(v=kt[d])==null?void 0:v.trailingRowOptions)==null?void 0:S.targetColumn)??(Be==null?void 0:Be.targetColumn);if(typeof p=="number")return p+(Ut?1:0);if(typeof p=="object"){const A=x.indexOf(p);if(A>=0)return A+(Ut?1:0)}},[kt,x,Ut,Be==null?void 0:Be.targetColumn]),Kn=s.useRef(),Do=s.useRef(),Uo=s.useCallback((d,p)=>{var A;const[v,S]=p;return Ln(wt,(A=Pe[v])==null?void 0:A.themeOverride,dn==null?void 0:dn(S),d.themeOverride)},[dn,Pe,wt]),{mapper:so}=Ld(st,C),gn=st==null?void 0:st.navigationBehavior,Vo=s.useCallback(d=>{var Y,oe,de;const p=Kr.value?d.metaKey:d.ctrlKey,v=p&&ge==="multi",[S,A]=d.location,$=y.columns,T=y.rows,[L,O]=((Y=y.current)==null?void 0:Y.cell)??[];if(d.kind==="cell"){if(Do.current=void 0,ao.current=[S,A],S===0&&Ut){if(xt===!0&&A===xe||Bt==="number"||ge==="none")return;const U=Vt(d.location);if(U.kind!==an.Marker)return;if(vn!==void 0){const Fe=ft(U);Jt((Fe==null?void 0:Fe.kind)===an.Marker);const Ee=(oe=Fe==null?void 0:Fe.onClick)==null?void 0:oe.call(Fe,{...d,cell:U,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,theme:Uo(U,d.location),preventDefault:()=>{}});if(Ee===void 0||Ee.checked===U.checked)return}i(void 0),Gt();const Me=T.hasIndex(A),ue=Kn.current;if(ge==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&ue!==void 0&&T.hasIndex(ue)){const Fe=[Math.min(ue,A),Math.max(ue,A)+1];v||et==="multi"?ut(void 0,Fe,!0):ut(rt.fromSingleSelection(Fe),void 0,v)}else ge==="multi"&&(v||d.isTouch||et==="multi")?Me?ut(T.remove(A),void 0,!0):(ut(void 0,A,!0),Kn.current=A):Me&&T.length===1?ut(rt.empty(),void 0,p):(ut(rt.fromSingleSelection(A),void 0,p),Kn.current=A)}else if(S>=D&&xt&&A===xe){const U=Fo(S);Gn(U??S)}else if(L!==S||O!==A){const U=Vt(d.location),Me=ft(U);if((Me==null?void 0:Me.onSelect)!==void 0){let Ee=!1;if(Me.onSelect({...d,cell:U,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,preventDefault:()=>Ee=!0,theme:Uo(U,d.location)}),Ee)return}if(gn==="block"&&so(A).isGroupHeader)return;const ue=xn&&A===xe,Fe=xn&&y!==void 0&&((de=y.current)==null?void 0:de.cell[1])===xe;if((d.shiftKey||d.isLongTouch===!0)&&L!==void 0&&O!==void 0&&y.current!==void 0&&!Fe){if(ue)return;const Ee=Math.min(S,L),pe=Math.max(S,L),Ge=Math.min(A,O),ct=Math.max(A,O);Je({...y.current,range:{x:Ee,y:Ge,width:pe-Ee+1,height:ct-Ge+1}},!0,p,"click"),Kn.current=void 0,Gt()}else Je({cell:[S,A],range:{x:S,y:A,width:1,height:1}},!0,p,"click"),Kn.current=void 0,i(void 0),Gt()}}else if(d.kind==="header")if(ao.current=[S,A],i(void 0),Ut&&S===0)Kn.current=void 0,Do.current=void 0,!to&&ge==="multi"&&(T.length!==xe?ut(rt.fromSingleSelection([0,xe]),void 0,p):ut(rt.empty(),void 0,p),Gt());else{const U=Do.current;if(ae==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&U!==void 0&&$.hasIndex(U)){const Me=[Math.min(U,S),Math.max(U,S)+1];p||d.isTouch||Ae==="multi"?_e(void 0,Me,p):_e(rt.fromSingleSelection(Me),void 0,p)}else ae==="multi"&&(p||d.isTouch||Ae==="multi")?($.hasIndex(S)?_e($.remove(S),void 0,p):_e(void 0,S,p),Do.current=S):ae!=="none"&&($.hasIndex(S)?_e($.remove(S),void 0,p):_e(rt.fromSingleSelection(S),void 0,p),Do.current=S);Kn.current=void 0,Gt()}else d.kind===bn?ao.current=[S,A]:d.kind===Ur&&!d.isMaybeScrollbar&&(Se($r,!1),i(void 0),Gt(),Xt==null||Xt(),Kn.current=void 0,Do.current=void 0)},[ge,ae,y,Ut,D,xt,xe,Bt,Vt,vn,Gt,et,Ae,ft,Uo,ut,Fo,Gn,gn,so,xn,Je,to,_e,Se,Xt]),qo=s.useRef(!1),ao=s.useRef(),ji=s.useRef(io),ln=s.useRef(),Ss=s.useCallback(d=>{if(co.current=!1,ji.current=_t.current,d.button!==0&&d.button!==1){ln.current=void 0;return}const p=performance.now();ln.current={button:d.button,time:p,location:d.location},(d==null?void 0:d.kind)==="header"&&(qo.current=!0);const v=d.kind==="cell"&&d.isFillHandle;!v&&d.kind!=="cell"&&d.isEdge||(f({previousSelection:y,fillHandle:v}),ao.current=void 0,!d.isTouch&&d.button===0&&!v?Vo(d):!d.isTouch&&d.button===1&&(ao.current=d.location))},[y,Vo]),[hi,gi]=s.useState(),Zi=s.useCallback(d=>{if(d.kind!==bn||ae!=="multi")return;const p=Kr.value?d.metaKey:d.ctrlKey,[v]=d.location,S=y.columns;if(v<D)return;const A=Pe[v];let $=v,T=v;for(let L=v-1;L>=D&&ar(A.group,Pe[L].group);L--)$--;for(let L=v+1;L<Pe.length&&ar(A.group,Pe[L].group);L++)T++;if(Gt(),p||d.isTouch||Ae==="multi")if(S.hasAll([$,T+1])){let L=S;for(let O=$;O<=T;O++)L=L.remove(O);_e(L,void 0,p)}else _e(void 0,[$,T+1],p);else _e(rt.fromSingleSelection([$,T+1]),void 0,p)},[ae,Gt,y.columns,Pe,D,_e,Ae]),co=s.useRef(!1),Er=s.useCallback(async d=>{if(q!==void 0&&ce!==void 0){const p=_t.current.y,v=_t.current.height;let S=q({x:d,y:p,width:1,height:Math.min(v,xe-p)},ne.current.signal);typeof S!="object"&&(S=await S());const A=kt[d-D],T=document.createElement("canvas").getContext("2d",{alpha:!1});if(T!==null){T.font=wt.baseFontFull;const L=rs(T,wt,A,0,S,_n,no,ft);ce==null||ce(A,L.width,d,L.width)}}},[kt,q,no,wt,_n,ce,D,xe,ft]),[Ms,mi]=s.useState(),Ho=s.useCallback(async(d,p)=>{var L,O;const v=(L=d.current)==null?void 0:L.range;if(v===void 0||q===void 0||p.current===void 0)return;const S=p.current.range;if(_!==void 0){let Y=!1;if(_({fillDestination:{...S,x:S.x-D},patternSource:{...v,x:v.x-D},preventDefault:()=>Y=!0}),Y)return}let A=q(v,ne.current.signal);typeof A!="object"&&(A=await A());const $=A,T=[];for(let Y=0;Y<S.width;Y++)for(let oe=0;oe<S.height;oe++){const de=[S.x+Y,S.y+oe];if(Gl(de,v))continue;const U=$[oe%v.height][Y%v.width];zo(U)||!Ao(U)||T.push({location:de,value:{...U}})}rn(T),(O=Pt.current)==null||O.damage(T.map(Y=>({cell:Y.location})))},[q,rn,_,D]),Ji=s.useCallback(()=>{if(y.current===void 0||y.current.range.width<=1)return;const d={...y,current:{...y.current,range:{...y.current.range,width:1}}};Ho(d,y)},[Ho,y]),Qi=s.useCallback(()=>{if(y.current===void 0||y.current.range.height<=1)return;const d={...y,current:{...y.current,range:{...y.current.range,height:1}}};Ho(d,y)},[Ho,y]),Rs=s.useCallback((d,p)=>{var oe,de;const v=c;if(f(void 0),ai(void 0),mi(void 0),qo.current=!1,p)return;if((v==null?void 0:v.fillHandle)===!0&&y.current!==void 0&&((oe=v.previousSelection)==null?void 0:oe.current)!==void 0){if(lo===void 0)return;const U={...y,current:{...y.current,range:cs(v.previousSelection.current.range,lo)}};Ho(v.previousSelection,U),Se(U,!0);return}const[S,A]=d.location,[$,T]=ao.current??[],L=()=>{co.current=!0},O=U=>{var ue,Fe,Ee;const Me=U.isTouch||$===S&&T===A;if(Me&&(N==null||N([S-D,A],{...U,preventDefault:L})),!co.current&&Me){const pe=Vt(d.location),Ge=ft(pe);if(Ge!==void 0&&Ge.onClick!==void 0){const ct=Ge.onClick({...U,cell:pe,posX:U.localEventX,posY:U.localEventY,bounds:U.bounds,theme:Uo(pe,d.location),preventDefault:L});ct!==void 0&&!zo(ct)&&To(ct)&&(rn([{location:U.location,value:ct}]),(ue=Pt.current)==null||ue.damage([{cell:U.location}]))}}if(U.button===1)return!co.current;if(!co.current){if(co.current||y.current===void 0)return!1;const pe=Vt(d.location);let Ge=!1;switch(pe.activationBehaviorOverride??pt){case"double-click":case"second-click":{if(((Ee=(Fe=v==null?void 0:v.previousSelection)==null?void 0:Fe.current)==null?void 0:Ee.cell)===void 0)break;const[ct,Lt]=y.current.cell,[wn,Mn]=v.previousSelection.current.cell;Ge=S===ct&&S===wn&&A===Lt&&A===Mn&&(U.isDoubleClick===!0||pt==="second-click");break}case"single-click":{Ge=!0;break}}if(Ge){const Lt={inputType:"pointer",pointerActivation:U.isDoubleClick===!0?"double-click":pe.activationBehaviorOverride??pt,pointerType:U.isTouch?"touch":"mouse"};return z==null||z([S-D,A],Lt),Io(U.bounds,Lt),!0}}return!1},Y=d.location[0]-D;if(d.isTouch){const U=_t.current,Me=ji.current;if(U.x!==Me.x||U.y!==Me.y)return;if(d.isLongTouch===!0){if(d.kind==="cell"&&or((de=y.current)==null?void 0:de.cell,d.location)){ve==null||ve([Y,d.location[1]],{...d,preventDefault:L});return}else if(d.kind==="header"&&y.columns.hasIndex(S)){G==null||G(Y,{...d,preventDefault:L});return}else if(d.kind===bn){if(Y<0)return;Z==null||Z(Y,{...d,preventDefault:L});return}}d.kind==="cell"?O(d)||Vo(d):d.kind===bn?be==null||be(Y,{...d,preventDefault:L}):(d.kind===Zn&&(M==null||M(Y,{...d,preventDefault:L})),Vo(d));return}d.kind==="header"&&(d.isEdge?d.isDoubleClick===!0&&Er(S):d.button===0&&S===$&&A===T&&(M==null||M(Y,{...d,preventDefault:L}))),d.kind===bn&&d.button===0&&S===$&&A===T&&(be==null||be(Y,{...d,preventDefault:L}),co.current||Zi(d)),d.kind==="cell"&&(d.button===0||d.button===1)&&O(d),ao.current=void 0},[c,y,D,lo,Ho,Se,N,Vt,ft,pt,Uo,rn,z,Io,ve,G,Z,Vo,be,M,Er,Zi]),Es=s.useCallback(d=>{const p={...d,location:[d.location[0]-D,d.location[1]]};we==null||we(p),c!==void 0&&d.buttons===0&&(f(void 0),ai(void 0),mi(void 0),qo.current=!1),mi(v=>{var S;return qo.current?[d.scrollEdge[0],0]:d.scrollEdge[0]===(v==null?void 0:v[0])&&d.scrollEdge[1]===v[1]?v:c===void 0||(((S=ln.current)==null?void 0:S.location[0])??0)<D?void 0:d.scrollEdge})},[c,we,D]),Is=s.useCallback((d,p)=>{Mt==null||Mt(d-D,p)},[Mt,D]),Fs=s.useCallback((d,p)=>{At==null||At(d-D,p)},[At,D]),Sn=(sl=y==null?void 0:y.current)==null?void 0:sl.cell,Ds=s.useCallback((d,p,v,S,A,$)=>{Ro.current=!1;let T=Sn;T!==void 0&&(T=[T[0]-D,T[1]]);const L=ze===0?void 0:{x:0,y:d.y,width:ze,height:d.height},O=[];L!==void 0&&O.push(L),He>0&&(O.push({x:d.x-D,y:xe-He,width:d.width,height:He}),ze>0&&O.push({x:0,y:xe-He,width:ze,height:He}));const Y={x:d.x-D,y:d.y,width:d.width,height:xt&&d.y+d.height>=xe?d.height-1:d.height,tx:A,ty:$,extras:{selected:T,freezeRegion:L,freezeRegions:O}};_t.current=Y,Ki(Y),Zt([p,v,S]),it==null||it(Y,Y.tx,Y.ty,Y.extras)},[Sn,D,xt,xe,ze,He,Ki,it]),Hs=jn(J,s.useCallback((d,p)=>(J==null?void 0:J(d-D,p-D))!==!1,[J,D])),Ts=jn(ht,s.useCallback((d,p)=>{ht==null||ht(d-D,p-D),ae!=="none"&&_e(rt.fromSingleSelection(p),void 0,!0)},[ae,ht,D,_e])),wi=s.useRef(!1),As=s.useCallback(d=>{if(d.location[0]===0&&D>0){d.preventDefault();return}le==null||le({...d,location:[d.location[0]-D,d.location[1]]}),d.defaultPrevented()||(wi.current=!0),f(void 0)},[le,D]),zs=s.useCallback(()=>{wi.current=!1},[]),el=st==null?void 0:st.selectionBehavior,Ir=s.useCallback(d=>{if(el!=="block-spanning")return;const{isGroupHeader:p,path:v,groupRows:S}=so(d);if(p)return[d,d];const A=v[v.length-1],$=d-A,T=d+S-A-1;return[$,T]},[so,el]),bi=s.useRef(),yi=s.useCallback(d=>{var p,v,S;if(!ms(d,bi.current)&&(bi.current=d,!(((p=ln==null?void 0:ln.current)==null?void 0:p.button)!==void 0&&ln.current.button>=1))){if(d.buttons!==0&&c!==void 0&&((v=ln.current)==null?void 0:v.location[0])===0&&D===1&&ge==="multi"&&c.previousSelection&&!c.previousSelection.rows.hasIndex(ln.current.location[1])&&y.rows.hasIndex(ln.current.location[1])){const A=Math.min(ln.current.location[1],d.location[1]),$=Math.max(ln.current.location[1],d.location[1])+1;ut(rt.fromSingleSelection([A,$]),void 0,!1)}else if(d.buttons!==0&&c!==void 0&&y.current!==void 0&&!wi.current&&!qo.current&&(Ce==="rect"||Ce==="multi-rect")){const[A,$]=y.current.cell;let[T,L]=d.location;if(L<0&&(L=_t.current.y),c.fillHandle===!0&&((S=c.previousSelection)==null?void 0:S.current)!==void 0){const O=c.previousSelection.current.range;L=Math.min(L,xt?xe-1:xe);const Y=kc(O,T,L,It);ai(Y)}else{if(xt&&$===xe)return;if(xt&&L===xe)if(d.kind===Ur)L--;else return;T=Math.max(T,D);const oe=Ir($);L=oe===void 0?L:sn(L,oe[0],oe[1]);const de=T-A,U=L-$,Me={x:de>=0?A:T,y:U>=0?$:L,width:Math.abs(de)+1,height:Math.abs(U)+1};Je({...y.current,range:Me},!0,!1,"drag")}}Dt==null||Dt({...d,location:[d.location[0]-D,d.location[1]]})}},[c,D,ge,y,Ce,Dt,ut,xt,xe,It,Ir,Je]),Bs=s.useCallback(()=>{var T,L;const d=bi.current;if(d===void 0)return;const[p,v]=d.scrollEdge;let[S,A]=d.location;const $=_t.current;p===-1?S=((L=(T=$.extras)==null?void 0:T.freezeRegion)==null?void 0:L.x)??$.x:p===1&&(S=$.x+$.width),v===-1?A=Math.max(0,$.y):v===1&&(A=Math.min(xe-1,$.y+$.height)),S=sn(S,0,Pe.length-1),A=sn(A,0,xe-1),yi({...d,location:[S,A]})},[Pe.length,yi,xe]);Td(Ms,bt,Bs);const mn=s.useCallback(d=>{if(y.current===void 0)return;const[p,v]=d,[S,A]=y.current.cell,$=y.current.range;let T=$.x,L=$.x+$.width,O=$.y,Y=$.y+$.height;const[oe,de]=Ir(A)??[0,xe-1],U=de+1;if(v!==0)switch(v){case 2:{Y=U,O=A,Et(0,Y,"vertical");break}case-2:{O=oe,Y=A+1,Et(0,O,"vertical");break}case 1:{O<A?(O++,Et(0,O,"vertical")):(Y=Math.min(U,Y+1),Et(0,Y,"vertical"));break}case-1:{Y>A+1?(Y--,Et(0,Y,"vertical")):(O=Math.max(oe,O-1),Et(0,O,"vertical"));break}default:sr()}if(p!==0)if(p===2)L=Pe.length,T=S,Et(L-1-D,0,"horizontal");else if(p===-2)T=D,L=S+1,Et(T-D,0,"horizontal");else{let Me=[];if(q!==void 0){const ue=q({x:T,y:O,width:L-T-D,height:Y-O},ne.current.signal);typeof ue=="object"&&(Me=Xd(ue))}if(p===1){let ue=!1;if(T<S){if(Me.length>0){const Fe=ho(T+1,S+1).find(Ee=>!Me.includes(Ee-D));Fe!==void 0&&(T=Fe,ue=!0)}else T++,ue=!0;ue&&Et(T,0,"horizontal")}ue||(L=Math.min(Pe.length,L+1),Et(L-1-D,0,"horizontal"))}else if(p===-1){let ue=!1;if(L>S+1){if(Me.length>0){const Fe=ho(L-1,S,-1).find(Ee=>!Me.includes(Ee-D));Fe!==void 0&&(L=Fe,ue=!0)}else L--,ue=!0;ue&&Et(L-D,0,"horizontal")}ue||(T=Math.max(D,T-1),Et(T-D,0,"horizontal"))}else sr()}Je({cell:y.current.cell,range:{x:T,y:O,width:L-T,height:Y-O}},!0,!1,"keyboard-select")},[q,Ir,y,Pe.length,D,xe,Et,Je]),pi=s.useRef(No);pi.current=No;const Un=s.useCallback((d,p,v,S)=>{const A=Nt-(v?0:1);d=sn(d,D,kt.length-1+D),p=sn(p,0,A);const $=Sn==null?void 0:Sn[0],T=Sn==null?void 0:Sn[1];if(d===$&&p===T)return!1;if(S&&y.current!==void 0){const L=[...y.current.rangeStack];(y.current.range.width>1||y.current.range.height>1)&&L.push(y.current.range),Se({...y,current:{cell:[d,p],range:{x:d,y:p,width:1,height:1},rangeStack:L}},!0)}else Je({cell:[d,p],range:{x:d,y:p,width:1,height:1}},!0,!1,"keyboard-nav");return u.current!==void 0&&u.current[0]===d&&u.current[1]===p&&(u.current=void 0),pi.current&&Et(d-D,p),!0},[Nt,D,kt.length,Sn,y,Et,Se,Je]),Ps=s.useCallback((d,p)=>{(r==null?void 0:r.cell)!==void 0&&d!==void 0&&To(d)&&(rn([{location:r.cell,value:d}]),window.requestAnimationFrame(()=>{var A;(A=Pt.current)==null||A.damage([{cell:r.cell}])})),Gt(!0),i(void 0);const[v,S]=p;if(y.current!==void 0&&(v!==0||S!==0)){const A=y.current.cell[1]===Nt-1&&d!==void 0,$=y.current.cell[0]===Pe.length-1&&d!==void 0;let T=!0;if(A&&S===1&&Ie!==void 0){T=!1;const L=y.current.cell[0]+v,O=Fo(L);Gn(O??L,!1)}if($&&v===1&&dt!==void 0){T=!1;const L=y.current.cell[1]+S;Rr(L,!1)}T&&Un(sn(y.current.cell[0]+v,0,Pe.length-1),sn(y.current.cell[1]+S,0,Nt-1),A,!1)}E==null||E(d,p)},[r==null?void 0:r.cell,Gt,y,E,rn,Nt,Un,Pe.length,Gn,Rr,Ie,dt,Fo]),Ls=s.useMemo(()=>`gdg-overlay-${Nd++}`,[]),uo=s.useCallback(d=>{var v,S,A,$;Gt();const p=[];for(let T=d.x;T<d.x+d.width;T++)for(let L=d.y;L<d.y+d.height;L++){const O=F([T-D,L]);if(!O.allowOverlay&&O.kind!==Q.Boolean)continue;let Y;if(O.kind===Q.Custom){const oe=ft(O),de=(v=oe==null?void 0:oe.provideEditor)==null?void 0:v.call(oe,{...O,location:[T-D,L]});(oe==null?void 0:oe.onDelete)!==void 0?Y=oe.onDelete(O):da(de)&&(Y=(S=de==null?void 0:de.deletedValue)==null?void 0:S.call(de,O))}else if(To(O)&&O.allowOverlay||O.kind===Q.Boolean){const oe=ft(O);Y=(A=oe==null?void 0:oe.onDelete)==null?void 0:A.call(oe,O)}Y!==void 0&&!zo(Y)&&To(Y)&&p.push({location:[T,L],value:Y})}rn(p),($=Pt.current)==null||$.damage(p.map(T=>({cell:T.location})))},[Gt,F,ft,rn,D]),jo=r!==void 0,tl=s.useCallback(d=>{var Fe,Ee;const p=()=>{d.stopPropagation(),d.preventDefault()},v={didMatch:!1},{bounds:S}=d,A=y.columns,$=y.rows,T=un;if(!jo&&We(T.clear,d,v))Se($r,!1),Xt==null||Xt();else if(!jo&&We(T.selectAll,d,v))Se({columns:rt.empty(),rows:rt.empty(),current:{cell:((Fe=y.current)==null?void 0:Fe.cell)??[D,0],range:{x:D,y:0,width:x.length,height:xe},rangeStack:[]}},!1);else if(We(T.search,d,v))(Ee=a==null?void 0:a.current)==null||Ee.focus({preventScroll:!0}),ro(!0);else if(We(T.delete,d,v)){const pe=(Te==null?void 0:Te(y))??!0;if(pe!==!1){const Ge=pe===!0?y:pe;if(Ge.current!==void 0){uo(Ge.current.range);for(const ct of Ge.current.rangeStack)uo(ct)}for(const ct of Ge.rows)uo({x:D,y:ct,width:x.length,height:1});for(const ct of Ge.columns)uo({x:ct,y:0,width:1,height:xe})}}if(v.didMatch)return p(),!0;if(y.current===void 0)return!1;let[L,O]=y.current.cell;const[,Y]=y.current.cell;let oe=!1,de=!1;if(We(T.scrollToSelectedCell,d,v))Hr.current(L-D,O);else if(ae!=="none"&&We(T.selectColumn,d,v))A.hasIndex(L)?_e(A.remove(L),void 0,!0):ae==="single"?_e(rt.fromSingleSelection(L),void 0,!0):_e(void 0,L,!0);else if(ge!=="none"&&We(T.selectRow,d,v))$.hasIndex(O)?ut($.remove(O),void 0,!0):ge==="single"?ut(rt.fromSingleSelection(O),void 0,!0):ut(void 0,O,!0);else if(!jo&&S!==void 0&&We(T.activateCell,d,v))if(O===xe&&xt)window.setTimeout(()=>{const pe=Fo(L);Gn(pe??L)},0);else{const pe={inputType:"keyboard",key:d.key};z==null||z([L-D,O],pe),Io(S,pe)}else y.current.range.height>1&&We(T.downFill,d,v)?Qi():y.current.range.width>1&&We(T.rightFill,d,v)?Ji():We(T.goToNextPage,d,v)?O+=Math.max(1,_t.current.height-4):We(T.goToPreviousPage,d,v)?O-=Math.max(1,_t.current.height-4):We(T.goToFirstCell,d,v)?(i(void 0),O=0,L=0):We(T.goToLastCell,d,v)?(i(void 0),O=Number.MAX_SAFE_INTEGER,L=Number.MAX_SAFE_INTEGER):We(T.selectToFirstCell,d,v)?(i(void 0),mn([-2,-2])):We(T.selectToLastCell,d,v)?(i(void 0),mn([2,2])):jo?(We(T.closeOverlay,d,v)&&i(void 0),We(T.acceptOverlayDown,d,v)&&(i(void 0),O++),We(T.acceptOverlayUp,d,v)&&(i(void 0),O--),We(T.acceptOverlayLeft,d,v)&&(i(void 0),L--),We(T.acceptOverlayRight,d,v)&&(i(void 0),L++)):(We(T.goDownCell,d,v)?O+=1:We(T.goUpCell,d,v)?O-=1:We(T.goRightCell,d,v)?L+=1:We(T.goLeftCell,d,v)?L-=1:We(T.goDownCellRetainSelection,d,v)?(O+=1,oe=!0):We(T.goUpCellRetainSelection,d,v)?(O-=1,oe=!0):We(T.goRightCellRetainSelection,d,v)?(L+=1,oe=!0):We(T.goLeftCellRetainSelection,d,v)?(L-=1,oe=!0):We(T.goToLastRow,d,v)?O=xe-1:We(T.goToFirstRow,d,v)?O=Number.MIN_SAFE_INTEGER:We(T.goToLastColumn,d,v)?L=Number.MAX_SAFE_INTEGER:We(T.goToFirstColumn,d,v)?L=Number.MIN_SAFE_INTEGER:(Ce==="rect"||Ce==="multi-rect")&&(We(T.selectGrowDown,d,v)?mn([0,1]):We(T.selectGrowUp,d,v)?mn([0,-1]):We(T.selectGrowRight,d,v)?mn([1,0]):We(T.selectGrowLeft,d,v)?mn([-1,0]):We(T.selectToLastRow,d,v)?mn([0,2]):We(T.selectToFirstRow,d,v)?mn([0,-2]):We(T.selectToLastColumn,d,v)?mn([2,0]):We(T.selectToFirstColumn,d,v)&&mn([-2,0])),de=v.didMatch);if(gn!==void 0&&gn!=="normal"&&O!==Y){const pe=gn==="skip-up"||gn==="skip"||gn==="block",Ge=gn==="skip-down"||gn==="skip"||gn==="block",ct=O<Y;if(ct&&pe){for(;O>=0&&so(O).isGroupHeader;)O--;O<0&&(O=Y)}else if(!ct&&Ge){for(;O<xe&&so(O).isGroupHeader;)O++;O>=xe&&(O=Y)}}const Me=Un(L,O,!1,oe),ue=v.didMatch;return ue&&(Me||!de||Oo)&&p(),ue},[gn,jo,y,un,ae,ge,Ce,D,so,xe,Un,Se,Xt,x.length,Te,Oo,uo,_e,ut,xt,Fo,Gn,z,Io,Qi,Ji,mn]),Zo=s.useCallback(d=>{let p=!1;if(Ke!==void 0&&Ke({...d,...d.location&&{location:[d.location[0]-D,d.location[1]]},cancel:()=>{p=!0}}),p||tl(d)||y.current===void 0)return;const[v,S]=y.current.cell,A=_t.current;if(Ye&&!d.metaKey&&!d.ctrlKey&&y.current!==void 0&&d.key.length===1&&/[\p{L}\p{M}\p{N}\p{S}\p{P}]/u.test(d.key)&&d.bounds!==void 0&&Ao(F([v-D,Math.max(0,Math.min(S,xe-1))]))){if((!xt||S!==xe)&&(A.y>S||S>A.y+A.height||A.x>v||v>A.x+A.width))return;const $={inputType:"keyboard",key:d.key};z==null||z([v-D,S],$),Io(d.bounds,$,d.key),d.stopPropagation(),d.preventDefault()}},[Ye,Ke,tl,y,F,D,xe,xt,z,Io]),Ws=s.useCallback((d,p)=>{const v=d.location[0]-D;if(d.kind==="header"&&(G==null||G(v,{...d,preventDefault:p})),d.kind===bn){if(v<0)return;Z==null||Z(v,{...d,preventDefault:p})}if(d.kind==="cell"){const[S,A]=d.location;ve==null||ve([v,A],{...d,preventDefault:p}),Ia(y,d.location)||Un(S,A,!1,!1)}},[y,ve,Z,G,D,Un]),vi=s.useCallback(async d=>{var T,L,O;if(!un.paste)return;function p(Y,oe,de,U){var ue,Fe;const Me=typeof de=="object"?(de==null?void 0:de.join(`
`))??"":(de==null?void 0:de.toString())??"";if(!zo(Y)&&Ao(Y)&&Y.readonly!==!0){const Ee=W==null?void 0:W(Me,Y);if(Ee!==void 0&&To(Ee))return{location:oe,value:Ee};const pe=ft(Y);if(pe===void 0)return;if(pe.kind===Q.Custom){Jt(Y.kind===Q.Custom);const Ge=(ue=pe.onPaste)==null?void 0:ue.call(pe,Me,Y.data);return Ge===void 0?void 0:{location:oe,value:{...Y,data:Ge}}}else{const Ge=(Fe=pe.onPaste)==null?void 0:Fe.call(pe,Me,Y,{formatted:U,formattedString:typeof U=="string"?U:U==null?void 0:U.join(`
`),rawValue:de});return Ge===void 0?void 0:(Jt(Ge.kind===Y.kind),{location:oe,value:Ge})}}}const v=y.columns,S=y.rows,A=((T=bt.current)==null?void 0:T.contains(document.activeElement))===!0||((L=l.current)==null?void 0:L.contains(document.activeElement))===!0;let $;if(y.current!==void 0?$=[y.current.range.x,y.current.range.y]:v.length===1?$=[v.first()??0,0]:S.length===1&&($=[D,S.first()??0]),A&&$!==void 0){let Y,oe;const de="text/plain",U="text/html";if(navigator.clipboard.read!==void 0){const Ee=await navigator.clipboard.read();for(const pe of Ee){if(pe.types.includes(U)){const ct=await(await pe.getType(U)).text(),Lt=Fl(ct);if(Lt!==void 0){Y=Lt;break}}pe.types.includes(de)&&(oe=await(await pe.getType(de)).text())}}else if(navigator.clipboard.readText!==void 0)oe=await navigator.clipboard.readText();else if(d!==void 0&&(d==null?void 0:d.clipboardData)!==null){if(d.clipboardData.types.includes(U)){const Ee=d.clipboardData.getData(U);Y=Fl(Ee)}Y===void 0&&d.clipboardData.types.includes(de)&&(oe=d.clipboardData.getData(de))}else return;const[Me,ue]=$,Fe=[];do{if(Ve===void 0){const Ee=Vt($),pe=oe??(Y==null?void 0:Y.map(ct=>ct.map(Lt=>Lt.rawValue).join("	")).join("	"))??"",Ge=p(Ee,$,pe,void 0);Ge!==void 0&&Fe.push(Ge);break}if(Y===void 0){if(oe===void 0)return;Y=Md(oe)}if(Ve===!1||typeof Ve=="function"&&(Ve==null?void 0:Ve([$[0]-D,$[1]],Y.map(Ee=>Ee.map(pe=>{var Ge;return((Ge=pe.rawValue)==null?void 0:Ge.toString())??""}))))!==!0)return;for(const[Ee,pe]of Y.entries()){if(Ee+ue>=xe)break;for(const[Ge,ct]of pe.entries()){const Lt=[Ge+Me,Ee+ue],[wn,Mn]=Lt;if(wn>=Pe.length||Mn>=Nt)continue;const Rn=Vt(Lt),Pn=p(Rn,Lt,ct.rawValue,ct.formatted);Pn!==void 0&&Fe.push(Pn)}}}while(!1);rn(Fe),(O=Pt.current)==null||O.damage(Fe.map(Ee=>({cell:Ee.location})))}},[W,ft,Vt,y,un.paste,bt,Pe.length,rn,Nt,Ve,D,xe]);Wt("paste",vi,g,!1,!0);const Jo=s.useCallback(async(d,p)=>{var T,L;if(!un.copy)return;const v=p===!0||((T=bt.current)==null?void 0:T.contains(document.activeElement))===!0||((L=l.current)==null?void 0:L.contains(document.activeElement))===!0,S=y.columns,A=y.rows,$=(O,Y)=>{if(!qe)Hl(O,Y,d);else{const oe=Y.map(de=>({kind:Q.Text,data:x[de].title,displayData:x[de].title,allowOverlay:!1}));Hl([oe,...O],Y,d)}};if(v&&q!==void 0){if(y.current!==void 0){let O=q(y.current.range,ne.current.signal);typeof O!="object"&&(O=await O()),$(O,ho(y.current.range.x-D,y.current.range.x+y.current.range.width-D))}else if(A!==void 0&&A.length>0){const Y=[...A].map(oe=>{const de=q({x:D,y:oe,width:x.length,height:1},ne.current.signal);return typeof de=="object"?de[0]:de().then(U=>U[0])});if(Y.some(oe=>oe instanceof Promise)){const oe=await Promise.all(Y);$(oe,ho(x.length))}else $(Y,ho(x.length))}else if(S.length>0){const O=[],Y=[];for(const oe of S){let de=q({x:oe,y:0,width:1,height:xe},ne.current.signal);typeof de!="object"&&(de=await de()),O.push(de),Y.push(oe-D)}if(O.length===1)$(O[0],Y);else{const oe=O.reduce((de,U)=>de.map((Me,ue)=>[...Me,...U[ue]]));$(oe,Y)}}}},[x,q,y,un.copy,D,bt,xe,qe]);Wt("copy",Jo,g,!1,!1);const $s=s.useCallback(async d=>{var v,S;if(!(!un.cut||!(((v=bt.current)==null?void 0:v.contains(document.activeElement))===!0||((S=l.current)==null?void 0:S.contains(document.activeElement))===!0))&&(await Jo(d),y.current!==void 0)){let A={current:{cell:y.current.cell,range:y.current.range,rangeStack:[]},rows:rt.empty(),columns:rt.empty()};const $=Te==null?void 0:Te(A);if($===!1||(A=$===!0?A:$,A.current===void 0))return;uo(A.current.range)}},[uo,y,un.cut,Jo,bt,Te]);Wt("cut",$s,g,!1,!1);const Os=s.useCallback((d,p)=>{if(re!==void 0){D!==0&&(d=d.map(A=>[A[0]-D,A[1]])),re(d,p);return}if(d.length===0||p===-1)return;const[v,S]=d[p];u.current!==void 0&&u.current[0]===v&&u.current[1]===S||(u.current=[v,S],Un(v,S,!1,!1))},[re,D,Un]),[Fr,Dr]=((al=Yt==null?void 0:Yt.current)==null?void 0:al.cell)??[],Hr=s.useRef(Et);Hr.current=Et,s.useLayoutEffect(()=>{var d,p,v,S;pi.current&&!Ro.current&&Fr!==void 0&&Dr!==void 0&&(Fr!==((p=(d=ke.current)==null?void 0:d.current)==null?void 0:p.cell[0])||Dr!==((S=(v=ke.current)==null?void 0:v.current)==null?void 0:S.cell[1]))&&Hr.current(Fr,Dr),Ro.current=!1},[Fr,Dr]);const nl=y.current!==void 0&&(y.current.cell[0]>=Pe.length||y.current.cell[1]>=Nt);s.useLayoutEffect(()=>{nl&&Se($r,!1)},[nl,Se]);const Ns=s.useMemo(()=>xt===!0&&(Be==null?void 0:Be.tint)===!0?rt.fromSingleSelection(Nt-1):rt.empty(),[Nt,xt,Be==null?void 0:Be.tint]),Xs=s.useCallback(d=>typeof Ht=="boolean"?Ht:(Ht==null?void 0:Ht(d-D))??!0,[D,Ht]),Ys=s.useMemo(()=>{if(hi===void 0||l.current===null)return null;const{bounds:d,group:p}=hi,v=l.current.getBoundingClientRect();return s.createElement(gd,{bounds:d,group:p,canvasBounds:v,onClose:()=>gi(void 0),onFinish:S=>{gi(void 0),fe==null||fe(p,S)}})},[fe,hi]),_s=Math.min(Pe.length,ze+(Ut?1:0));s.useImperativeHandle(t,()=>({appendRow:(d,p)=>Gn(d+D,p),appendColumn:(d,p)=>Rr(d,p),updateCells:d=>{var p;return D!==0&&(d=d.map(v=>({cell:[v.cell[0]+D,v.cell[1]]}))),(p=Pt.current)==null?void 0:p.damage(d)},getBounds:(d,p)=>{var v;if(!((l==null?void 0:l.current)===null||(bt==null?void 0:bt.current)===null)){if(d===void 0&&p===void 0){const S=l.current.getBoundingClientRect(),A=S.width/bt.current.clientWidth;return{x:S.x-bt.current.scrollLeft*A,y:S.y-bt.current.scrollTop*A,width:bt.current.scrollWidth*A,height:bt.current.scrollHeight*A}}return(v=Pt.current)==null?void 0:v.getBounds((d??0)+D,p)}},focus:()=>{var d;return(d=Pt.current)==null?void 0:d.focus()},emit:async d=>{switch(d){case"delete":Zo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Zo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Zo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await Jo(void 0,!0);break;case"paste":await vi();break}},scrollTo:Et,remeasureColumns:d=>{for(const p of d)Er(p+D)},getMouseArgsForPosition:(d,p,v)=>{if((Pt==null?void 0:Pt.current)===null)return;const S=Pt.current.getMouseArgsForPosition(d,p,v);if(S!==void 0)return{...S,location:[S.location[0]-D,S.location[1]]}}}),[Gn,Rr,Er,bt,Jo,Zo,vi,D,Et]);const[ol,rl]=Sn??[],Gs=s.useCallback(d=>{const[p,v]=d;if(v===-1){ae!=="none"&&(_e(rt.fromSingleSelection(p),void 0,!1),Gt());return}ol===p&&rl===v||(Je({cell:d,range:{x:p,y:v,width:1,height:1}},!0,!1,"keyboard-nav"),Et(p,v))},[ae,Gt,Et,ol,rl,Je,_e]),[Ks,Us]=s.useState(!1),il=s.useRef(Wl(d=>{Us(d)},5)),Vs=s.useCallback(()=>{il.current(!0),B==null||B(),y.current===void 0&&y.columns.length===0&&y.rows.length===0&&c===void 0&&Je({cell:[D,Cr],range:{x:D,y:Cr,width:1,height:1}},!0,!1,"keyboard-select")},[Cr,y,c,D,Je]),qs=s.useCallback(()=>{il.current(!1),X==null||X()},[X]),[js,Zs]=s.useMemo(()=>{let d;const p=(Ft==null?void 0:Ft.scrollbarWidthOverride)??Fi(),v=xe+(xt?1:0);if(typeof Cn=="number")d=hn+v*Cn;else{let A=0;const $=Math.min(v,10);for(let T=0;T<$;T++)A+=Cn(T);A=Math.floor(A/$),d=hn+v*A}d+=p;const S=Pe.reduce((A,$)=>$.width+A,0)+p;return[`${Math.min(1e5,S)}px`,`${Math.min(1e5,d)}px`]},[Pe,Ft==null?void 0:Ft.scrollbarWidthOverride,Cn,xe,xt,hn]),Js=s.useMemo(()=>Xa(wt),[wt]);return s.createElement(os.Provider,{value:wt},s.createElement(Fd,{style:Js,className:ee,inWidth:b??js,inHeight:k??Zs},s.createElement(dd,{fillHandle:Hn,drawFocusRing:xo,experimental:Ft,fixedShadowX:$n,fixedShadowY:Tn,getRowThemeOverride:dn,headerIcons:An,imageWindowLoader:bo,initialSize:ur,isDraggable:fr,onDragLeave:yo,onRowMoved:vn,overscrollX:oi,overscrollY:ri,preventDiagonalScrolling:eo,rightElement:On,rightElementProps:Zr,smoothScrollX:Jr,smoothScrollY:Qr,className:ee,enableGroups:kn,onCanvasFocused:Vs,onCanvasBlur:qs,canvasRef:l,onContextMenu:Ws,theme:wt,cellXOffset:xs,cellYOffset:Cr,accessibilityHeight:io.height,onDragEnd:zs,columns:Pe,nonGrowWidth:Mo,drawHeader:tt,onColumnProposeMove:Hs,drawCell:je,disabledRows:Ns,freezeColumns:_s,lockColumns:D,firstColAccessible:D===0,getCellContent:Vt,minColumnWidth:_n,maxColumnWidth:no,searchInputRef:a,showSearch:li,onSearchClose:si,highlightRegions:ks,getCellsForSelection:q,getGroupDetails:ci,headerHeight:oo,isFocused:Ks,groupHeaderHeight:kn?pr:0,freezeTrailingRows:He+(xt&&(Be==null?void 0:Be.sticky)===!0?1:0),hasAppendRow:xt,onColumnResize:ce,onColumnResizeEnd:Tt,onColumnResizeStart:ye,onCellFocused:Gs,onColumnMoved:Ts,onDragStart:As,onHeaderMenuClick:Is,onHeaderIndicatorClick:Fs,onItemHovered:yi,isFilling:(c==null?void 0:c.fillHandle)===!0,onMouseMove:Es,onKeyDown:Zo,onKeyUp:nt,onMouseDown:Ss,onMouseUp:Rs,onDragOverCell:pn,onDrop:$o,onSearchResultsChanged:Os,onVisibleRegionChanged:Ds,clientSize:on,rowHeight:Cn,searchResults:he,searchValue:Ne,onSearchValueChange:Xe,rows:Nt,scrollRef:bt,selection:y,translateX:io.tx,translateY:io.ty,verticalBorder:Xs,gridRef:Pt,getCellRenderer:ft,resizeIndicator:Gi}),Ys,r!==void 0&&s.createElement(s.Suspense,{fallback:null},s.createElement(Od,{...r,validateCell:ie,bloom:I,id:Ls,getCellRenderer:ft,className:(Ft==null?void 0:Ft.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:tn,imageEditorOverride:m,portalElementRef:wr,onFinishEditing:Ps,markdownDivCreateNode:h,isOutsideClick:mr,customEventTarget:Ft==null?void 0:Ft.eventTarget}))))},_d=s.forwardRef(Yd);function zl(e){const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:a,height:l,x:c,y:f}=r,u=t.maxSize??i.checkboxMaxSize,g=Math.floor(r.y+l/2),m=Xl(u,l,i.cellVerticalPadding),w=Nl(t.contentAlign??"center",c,a,i.cellHorizontalPadding,m),h=Ol(w,g,m),b=Yl(c+n,f+o,h);return Pi(t)&&b}const Gd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:Q.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>Kd(e,e.cell.data,Pi(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{zl(e)&&e.preventDefault()},onClick:e=>{if(zl(e))return{...e.cell,data:bs(e.cell.data)}},onPaste:(e,t)=>{let n=Xr;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Bi),n===t.data?void 0:{...t,data:n}}};function Kd(e,t,n,o,r){if(!n&&t===Xr)return;const{ctx:i,hoverAmount:a,theme:l,rect:c,highlighted:f,hoverX:u,hoverY:g,cell:{contentAlign:m}}=e,{x:w,y:h,width:b,height:k}=c;let x=!1;if(r>0){let C=n?1-r+r*a:.4;if(t===Xr&&(C*=a),C===0)return;C<1&&(x=!0,i.globalAlpha=C)}Xi(i,l,t,w,h,b,k,f,u,g,o,m),x&&(i.globalAlpha=1)}const Ud=en("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),Vd=e=>{const{bubbles:t}=e;return s.createElement(Ud,null,t.map((n,o)=>s.createElement("div",{key:o,className:"boe-bubble"},n)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},qd={getAccessibilityString:e=>_l(e.data),kind:Q.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((r,i)=>e.measureText(i).width+r+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>jd(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(Vd,{bubbles:t.data})},onPaste:()=>{}};function jd(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:a,y:l,width:c,height:f}=n;let u=a+o.cellHorizontalPadding;const g=[];for(const m of t){if(u>a+c)break;const w=cn(m,r,o.baseFontFull).width;g.push({x:u,width:w}),u+=w+o.bubblePadding*2+o.bubbleMargin}r.beginPath();for(const m of g)In(r,m.x,l+(f-o.bubbleHeight)/2,m.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[m,w]of g.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[m],w.x+o.bubblePadding,l+f/2+Jn(r,o))}const Zd=en("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),Jd=e=>{const{drilldowns:t}=e;return s.createElement(Zd,null,t.map((n,o)=>s.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&s.createElement("img",{src:n.img}),s.createElement("div",null,n.text))))},Qd={getAccessibilityString:e=>_l(e.data.map(t=>t.text)),kind:Q.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+n.bubblePadding*2+n.bubbleMargin+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>tu(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(Jd,{drilldowns:t.data})},onPaste:()=>{}},lr={};function eu(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,a=n-i*2,l=4,c=n*r,f=o+i,u=o*3,g=(u+i*2)*r,m=`${e},${t},${r},${n}`;if(lr[m]!==void 0)return{el:lr[m],height:c,width:g,middleWidth:l*r,sideWidth:f*r,padding:i*r,dpr:r};const w=document.createElement("canvas"),h=w.getContext("2d");return h===null?null:(w.width=g,w.height=c,h.scale(r,r),lr[m]=w,h.beginPath(),In(h,i,i,u,a,o),h.shadowColor="rgba(24, 25, 34, 0.4)",h.shadowBlur=1,h.fillStyle=e,h.fill(),h.shadowColor="rgba(24, 25, 34, 0.3)",h.shadowOffsetY=1,h.shadowBlur=5,h.fillStyle=e,h.fill(),h.shadowOffsetY=0,h.shadowBlur=0,h.shadowBlur=0,h.beginPath(),In(h,i+.5,i+.5,u,a,o),h.strokeStyle=t,h.lineWidth=1,h.stroke(),{el:w,height:c,width:g,sideWidth:f*r,middleWidth:o*r,padding:i*r,dpr:r})}function tu(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:a,row:l}=e,{x:c,width:f}=n,u=o.baseFontFull,g=Jl(r,u),m=Math.min(n.height,Math.max(16,Math.ceil(g*o.lineHeight)*2)),w=Math.floor(n.y+(n.height-m)/2),h=m-10,b=o.bubblePadding,k=o.bubbleMargin;let x=c+o.cellHorizontalPadding;const C=o.roundingRadius??6,F=eu(o.bgCell,o.drilldownBorder,m,C),N=[];for(const z of t){if(x>c+f)break;const X=cn(z.text,r,u).width;let _=0;if(z.img!==void 0){const W=i.loadOrGetImage(z.img,a,l);W!==void 0&&(W instanceof HTMLImageElement?W.complete&&W.naturalWidth>0&&W.naturalHeight>0:W.width>0&&W.height>0)&&(_=h-8+4)}const E=X+_+b*2;N.push({x,width:E}),x+=E+k}if(F!==null){const{el:z,height:B,middleWidth:X,sideWidth:_,width:E,dpr:W,padding:P}=F;if(z.width>0&&z.height>0){const H=_/W,I=P/W;for(const M of N){const J=Math.floor(M.x),V=Math.floor(M.width),se=V-(H-I)*2;r.imageSmoothingEnabled=!1;try{r.drawImage(z,0,0,_,B,J-I,w,H,m),se>0&&r.drawImage(z,_,0,X,B,J+(H-I),w,se,m),r.drawImage(z,E-_,0,_,B,J+V-(H-I),w,H,m)}catch{const be=`${o.bgCell}_${o.drilldownBorder}_${m}_${C}`;delete lr[be]}r.imageSmoothingEnabled=!0}}else{const H=`${o.bgCell}_${o.drilldownBorder}_${m}_${C}`;delete lr[H]}}r.beginPath();for(const[z,B]of N.entries()){const X=t[z];let _=B.x+b;if(X.img!==void 0){const E=i.loadOrGetImage(X.img,a,l);if(E!==void 0&&(E instanceof HTMLImageElement?E.complete&&E.naturalWidth>0&&E.naturalHeight>0:E.width>0&&E.height>0)){const P=h-8;let H=0,I=0,M=E.width,J=E.height;M>J?(H+=(M-J)/2,M=J):J>M&&(I+=(J-M)/2,J=M),r.beginPath(),In(r,_,w+m/2-P/2,P,P,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(E,H,I,M,J,_,w+m/2-P/2,P,P),r.restore(),_+=P+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(X.text,_,w+m/2+Jn(r,o))}}const nu={getAccessibilityString:e=>e.data.join(", "),kind:Q.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>ou(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??va;return s.createElement(r,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},Ei=4;function ou(e,t,n,o){const{rect:r,col:i,row:a,theme:l,ctx:c,imageLoader:f}=e,{x:u,y:g,height:m,width:w}=r,h=m-l.cellVerticalPadding*2,b=[];let k=0;for(let C=0;C<t.length;C++){const F=t[C];if(F.length===0)continue;const N=f.loadOrGetImage(F,i,a);if(N!==void 0){b[C]=N;const z=N.width*(h/N.height);k+=z+Ei}}if(k===0)return;k-=Ei;let x=u+l.cellHorizontalPadding;o==="right"?x=Math.floor(u+w-l.cellHorizontalPadding-k):o==="center"&&(x=Math.floor(u+w/2-k/2));for(const C of b){if(C===void 0)continue;const F=C.width*(h/C.height);n>0&&(c.beginPath(),In(c,x,g+l.cellVerticalPadding,F,h,n),c.save(),c.clip()),c.drawImage(C,x,g+l.cellVerticalPadding,F,h),n>0&&c.restore(),x+=F+Ei}}function ru(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const iu={getAccessibilityString:()=>"",kind:Q.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:a}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let l=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(l+=Math.round(ru(n,o)*t.skeletonWidthVariability));const c=a.cellHorizontalPadding;l+c*2>=i.width&&(l=i.width-c*2-1);const f=t.skeletonHeight??Math.min(18,i.height-2*a.cellVerticalPadding);In(r,i.x+c,i.y+(i.height-f)/2,l,f,a.roundingRadius??3),r.fillStyle=mo(a.textDark,.1),r.fill()},onPaste:()=>{}},lu=()=>e=>e.targetWidth,Bl=en("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[lu(),"px"]}}),su=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:a,validatedSelection:l}=e,c=t.data,f=t.readonly===!0,[u,g]=s.useState(c===""||o),m=s.useCallback(()=>{g(h=>!h)},[]),w=c?"gdg-ml-6":"";return u?s.createElement(Bl,{targetWidth:i.width-20},s.createElement(Vr,{autoFocus:!0,highlight:!1,validatedSelection:l,value:c,onKeyDown:h=>{h.key==="Enter"&&h.stopPropagation()},onChange:n}),s.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${w}`,onClick:()=>a(t)},s.createElement(ha,null))):s.createElement(Bl,{targetWidth:i.width},s.createElement(xa,{contents:c,createNode:r}),!f&&s.createElement(s.Fragment,null,s.createElement("div",{className:"spacer"}),s.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${w}`,onClick:m},s.createElement(Li,null))),s.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},au={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:Q.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:dr,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return cn(o,e,n.baseFontFull).width+2*n.cellHorizontalPadding},draw:e=>En(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:a,validatedSelection:l}=e;return s.createElement(su,{onFinish:r,targetRect:o,value:n,validatedSelection:l,onChange:c=>t({...n,data:c.target.value}),forceEditMode:a,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},cu={getAccessibilityString:e=>e.row.toString(),kind:an.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:du,measure:()=>44,draw:e=>fu(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e,{width:i,height:a}=t,l=n.drawHandle?7+(i-7)/2:i/2,c=a/2;if(Math.abs(o-l)<=10&&Math.abs(r-c)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function du(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=uu,n.textAlign="center",i}function uu(e){const{ctx:t}=e;t.textAlign="start"}function fu(e,t,n,o,r,i){const{ctx:a,rect:l,hoverAmount:c,theme:f}=e,{x:u,y:g,width:m,height:w}=l,h=n?1:o==="checkbox-visible"?.6+.4*c:c;if(o!=="number"&&h>0){a.globalAlpha=h;const b=7*(n?c:1);if(Xi(a,f,n,r?u+b:u,g,r?m-b:m,w,!0,void 0,void 0,f.checkboxMaxSize,"center",i),r){a.globalAlpha=c,a.beginPath();for(const k of[3,6])for(const x of[-5,-1,3])a.rect(u+k,g+w/2+x,2,2);a.fillStyle=f.textLight,a.fill(),a.beginPath()}a.globalAlpha=1}if(o==="number"||o==="both"&&!n){const b=t.toString(),k=f.markerFontFull,x=u+m/2;o==="both"&&c!==0&&(a.globalAlpha=1-c),a.fillStyle=f.textLight,a.font=k,a.fillText(b,x,g+w/2+Jn(a,k)),c!==0&&(a.globalAlpha=1)}}const hu={getAccessibilityString:()=>"",kind:an.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>gu(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function gu(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:a,spriteManager:l}=e,{x:c,y:f,width:u,height:g}=r;o.beginPath(),o.globalAlpha=i,o.rect(c+1,f+1,u,g-2),o.fillStyle=a.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const m=t!=="";let w=0;if(n!==void 0){const b=g-8,k=c+8/2,x=f+8/2;l.drawSprite(n,"normal",o,k,x,b,a,m?1:i),w=b}else{w=24;const h=12,b=m?h:i*h,k=m?0:(1-i)*h*.5,x=a.cellHorizontalPadding+4;b>0&&(o.moveTo(c+x+k,f+g/2),o.lineTo(c+x+k+b,f+g/2),o.moveTo(c+x+k+b*.5,f+g/2-b*.5),o.lineTo(c+x+k+b*.5,f+g/2+b*.5),o.lineWidth=2,o.strokeStyle=a.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=a.textMedium,o.fillText(t,w+c+a.cellHorizontalPadding+.5,f+g/2+Jn(o,a)),o.beginPath()}function vs(e,t,n,o,r,i,a){e.textBaseline="alphabetic";const l=mu(e,r,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),In(e,l.x,l.y,l.width,l.height,t.roundingRadius??4),e.globalAlpha=i,e.fillStyle=(n==null?void 0:n.bgColor)??mo(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",a==null||a("text")}function mu(e,t,n,o,r){const i=o.cellHorizontalPadding,a=o.cellVerticalPadding;if(r)return{x:t.x+i/2,y:t.y+a/2+1,width:t.width-i,height:t.height-a-1};const l=cn(n,e,o.baseFontFull,"alphabetic"),c=t.height-a,f=Math.min(c,l.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-f)/2+1,width:l.width+i*3,height:f-1}}const wu=s.lazy(async()=>await Ll(()=>import("./number-overlay-editor-KarwLo80.js"),__vite__mapDeps([7,1,2,4,8]),import.meta.url)),bu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:Q.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:dr,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:r,rect:i,overrideCursor:a}=e,{hoverEffect:l,displayData:c,hoverEffectTheme:f}=n;l===!0&&t>0&&vs(o,r,f,c,i,t,a),En(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>cn(t.displayData,e,n.baseFontFull).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r,initialValue:i}=e;return s.createElement(s.Suspense,{fallback:null},s.createElement(wu,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,initialValue:i,validatedSelection:r,onChange:a=>n({...o,data:Number.isNaN(a.floatValue??0)?0:a.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},yu={getAccessibilityString:()=>"",measure:()=>108,kind:Q.Protected,needsHover:!1,needsHoverPosition:!1,draw:pu,onPaste:()=>{}};function pu(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:a}=o;t.beginPath();const l=2.5;let c=r+n.cellHorizontalPadding+l;const f=i+a/2,u=Math.cos(gl(30))*l,g=Math.sin(gl(30))*l;for(let m=0;m<12;m++)t.moveTo(c,f-l),t.lineTo(c,f+l),t.moveTo(c+u,f-g),t.lineTo(c-u,f+g),t.moveTo(c-u,f-g),t.lineTo(c+u,f+g),c+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const vu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:Q.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>dr(e,t,e.theme.textLight),draw:e=>En(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>cn(t.data,e,n.baseFontFull).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return St.createElement(Vr,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:r,onChange:i=>n({...o,data:i.target.value})})},onPaste:()=>{}},Cu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:Q.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:dr,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:a,overrideCursor:l}=e,{displayData:c,contentAlign:f,hoverEffect:u,allowWrapping:g,hoverEffectTheme:m}=t;u===!0&&n>0&&vs(r,a,m,c,i,n,l),En(e,c,f,g,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,cn(i,e,n.baseFontFull).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return s.createElement(Vr,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:a=>o({...r,data:a.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},xu=en("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),ku=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:a}=e,[l,c]=s.useState(!r&&(t===""||o)),f=s.useCallback(()=>{c(!0)},[]);return l?s.createElement(Vr,{validatedSelection:i,highlight:!0,autoFocus:!0,value:t,onChange:n}):s.createElement(xu,null,s.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},a),!r&&s.createElement("div",{className:"gdg-edit-icon",onClick:f},s.createElement(Li,null)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function Cs(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,a=e.width,l=e.actualBoundingBoxAscent;return o==="right"?r=t.width-a-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-a/2),{x:r,y:i,width:a,height:l}}function Pl(e){const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,a=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const l=jl(a,i.baseFontFull);if(l===void 0)return!1;const c=Cs(l,n,i,t.contentAlign);return go({x:c.x-4,y:c.y-4,width:c.width+8,height:c.height+8},o,r)}const Su={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:Q.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:dr,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:a,ctx:l}=e,c=t.displayData??t.data,f=t.hoverEffect===!0;if(o!==void 0&&f&&r!==void 0&&i!==void 0){const u=cn(c,l,n.baseFontFull),g=Cs(u,a,n,t.contentAlign),{x:m,y:w,width:h,height:b}=g;if(r>=m-4&&r<=m-4+h+8&&i>=w-4&&i<=w-4+b+8){const k=Jn(l,n.baseFontFull);o("pointer");const x=5,C=w-k;l.beginPath(),l.moveTo(a.x+m,Math.floor(a.y+C+b+x)+.5),l.lineTo(a.x+m+h,Math.floor(a.y+C+b+x)+.5),l.strokeStyle=n.linkColor,l.stroke(),l.save(),l.fillStyle=e.cellFillColor,En({...e,rect:{...a,x:a.x-1}},c,t.contentAlign),En({...e,rect:{...a,x:a.x-2}},c,t.contentAlign),En({...e,rect:{...a,x:a.x+1}},c,t.contentAlign),En({...e,rect:{...a,x:a.x+2}},c,t.contentAlign),l.restore()}}l.fillStyle=f?n.linkColor:n.textDark,En(e,c,t.contentAlign)},onSelect:e=>{Pl(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;Pl(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>cn(t.displayData??t.data,e,n.baseFontFull).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return s.createElement(ku,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:a=>n({...o,data:a.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Mu=[cu,hu,Gd,qd,Qd,nu,iu,au,bu,yu,vu,Cu,Su],Ii=[];class Ru extends es{constructor(){super(...arguments);Le(this,"imageLoaded",()=>{});Le(this,"loadedLocations",[]);Le(this,"cache",{});Le(this,"sendLoaded",la(()=>{this.imageLoaded(new ir(this.loadedLocations)),this.loadedLocations=[]},20));Le(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let a=0;a<r.cells.length;a++){const l=r.cells[a];if(this.isInWindow(l)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let a=!1;const l=Ii.pop()??new Image;let c=!1;const f={img:void 0,cells:[yn(o,r)],url:n,cancel:()=>{c||(c=!0,Ii.length<12?Ii.unshift(l):a||(l.src=""))}},u=new Promise(g=>l.addEventListener("load",()=>g(null)));requestAnimationFrame(async()=>{try{l.src=n,await u,await l.decode();const g=this.cache[i];if(g!==void 0&&!c){g.img=l;for(const m of g.cells)this.loadedLocations.push(Ni(m));a=!0,this.sendLoaded()}}catch{f.cancel()}}),this.cache[i]=f}loadOrGetImage(n,o,r){const i=n,a=this.cache[i];if(a!==void 0){const l=yn(o,r);return a.cells.includes(l)||a.cells.push(l),a.img}else this.loadImage(n,o,r,i)}}const Eu=(e,t)=>{const n=s.useMemo(()=>({...vc,...e.headerIcons}),[e.headerIcons]),o=s.useMemo(()=>e.renderers??Mu,[e.renderers]),r=s.useMemo(()=>e.imageWindowLoader??new Ru,[e.imageWindowLoader]);return s.createElement(_d,{...e,renderers:o,headerIcons:n,ref:t,imageWindowLoader:r})},$u=s.forwardRef(Eu);export{ud as C,$u as D,Q as G,os as T,Vr as a,Jl as b,Qt as c,Lu as d,Pu as e,zu as f,Jn as g,To as h,Bu as i,ul as j,zo as k,da as l,cn as m,Xa as n,Lo as p,In as r,Wu as u};
