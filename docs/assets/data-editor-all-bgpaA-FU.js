var _s=Object.defineProperty;var Vs=(e,t,n)=>t in e?_s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var $e=(e,t,n)=>(Vs(e,typeof t!="symbol"?t+"":t,n),n);import{r as a,R as xt}from"./index-KtDdPitk.js";import{_ as Hl}from"./iframe-DzV9Zd2n.js";import{h as qs,d as Tl,j as js,v as Zs,_ as Js,g as Qs,c as cn,r as ho,t as ea}from"./throttle-UPaD_CsS.js";import{u as ta,f as nl}from"./flatten-5Fd1fcTu.js";import{s as tn,b as na}from"./marked.esm-I79JNzkl.js";function Al(e="This should not happen"){throw new Error(e)}function Qt(e,t="Assertion failed"){if(!e)return Al(t)}function lr(e,t){return Al(t??"Hell froze over")}function oa(e,t){try{return e()}catch{return t}}const ol=Object.prototype.hasOwnProperty;function Bo(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Bo(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(ol.call(e,n)&&++o&&!ol.call(t,n)||!(n in t)||!Bo(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const Or=null,Ei=void 0;var q;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(q||(q={}));var rl;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay"})(rl||(rl={}));var Nr;(function(e){e.Triangle="triangle",e.Dots="dots"})(Nr||(Nr={}));function Ar(e){return"width"in e&&typeof e.width=="number"}async function il(e){return typeof e=="object"?e:await e()}function To(e){return!(e.kind===q.Loading||e.kind===q.Bubble||e.kind===q.RowID||e.kind===q.Protected||e.kind===q.Drilldown)}function Lu(e){return!(e.kind===q.Loading||e.kind===q.Bubble||e.kind===q.RowID||e.kind===q.Protected||e.kind===q.Drilldown||e.kind===q.Boolean||e.kind===q.Image||e.kind===q.Custom)}function Ao(e){return e.kind===un.Marker||e.kind===un.NewRow}function tr(e){if(!To(e)||e.kind===q.Image)return!1;if(e.kind===q.Text||e.kind===q.Number||e.kind===q.Markdown||e.kind===q.Uri||e.kind===q.Custom||e.kind===q.Boolean)return e.readonly!==!0;lr(e,"A cell was passed with an invalid kind")}function ra(e){return qs(e,"editor")}function Ii(e){return!(e.readonly??!1)}var un;(function(e){e.NewRow="new-row",e.Marker="marker"})(un||(un={}));function ia(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let ll;const Pn=class Pn{constructor(t){$e(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new Pn(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=ia([...this.items,n]);return new Pn(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,l]of n.entries()){const[s,c]=l;if(s<=r&&o<=c){const f=[];s<o&&f.push([s,o]),r<c&&f.push([r,c]),n.splice(i,1,...f)}}return new Pn(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};$e(Pn,"empty",()=>ll??(ll=new Pn([]))),$e(Pn,"fromSingleSelection",t=>Pn.empty().add(t));let rt=Pn;const la=tn("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function Bt(e,t,n,o,r=!1){const i=a.useRef();i.current=t,a.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const l=n,s=c=>{var f;(f=i.current)==null||f.call(l,c)};return l.addEventListener(e,s,{passive:o,capture:r}),()=>{l.removeEventListener(e,s,{capture:r})}},[e,n,o,r])}function fo(e,t){return e===void 0?void 0:t}const sa=Math.PI;function sl(e){return e*sa/180}const zl=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),Bl=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},Ll=(e,t,n)=>Math.min(e,t-n*2),Pl=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Fi=e=>{const t=e.fgColor??"currentColor";return a.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),a.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},aa=e=>{const t=e.fgColor??"currentColor";return a.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function ca(e,t,n){const[o,r]=a.useState(e),i=a.useRef(!0);a.useEffect(()=>()=>{i.current=!1},[]);const l=a.useRef(Tl(s=>{i.current&&r(s)},n));return a.useLayoutEffect(()=>{i.current&&l.current(()=>e())},t),o}const da="֑-߿יִ-﷽ﹰ-ﻼ",ua="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",fa=new RegExp("^[^"+ua+"]*["+da+"]");function Di(e){return fa.test(e)?"rtl":"not-rtl"}let zr;function xi(){if(typeof document>"u")return 0;if(zr!==void 0)return zr;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),zr=n-o,zr}const uo=Symbol();function ha(e){const t=a.useRef([uo,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=a.useState(e),[,r]=a.useState(),i=a.useCallback(s=>{const c=t.current[0];c!==uo&&(s=typeof s=="function"?s(c):s,s===c)||(c!==uo&&r({}),o(f=>typeof s=="function"?s(c===uo?f:c):s),t.current[0]=uo)},[]),l=a.useCallback(()=>{t.current[0]=uo,r({})},[]);return[t.current[0]===uo?n:t.current[0],i,l]}function Wl(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function ga(e){const t=a.useRef(e);return Bo(e,t.current)||(t.current=e),t.current}const ma=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(s=>s!=="");if(i.length===0)return null;const l=i.length>1;return a.createElement(la,{"data-testid":"GDG-default-image-overlay-editor"},a.createElement(js.Carousel,{showArrows:l,showThumbs:!1,swipeable:l,emulateTouch:l,infiniteLoop:l},i.map(s=>{const c=(r==null?void 0:r(s))??a.createElement("img",{draggable:!1,src:s});return a.createElement("div",{className:"gdg-centering-container",key:s},c)})),n&&o&&a.createElement("button",{className:"gdg-edit-icon",onClick:o},a.createElement(Fi,null)))},wa=tn("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class ba extends xt.PureComponent{constructor(){super(...arguments);$e(this,"targetElement",null);$e(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,l=na(r),s=document.createRange();s.selectNodeContents(n),s.deleteContents();let c=i==null?void 0:i(l);if(c===void 0){const u=document.createElement("template");u.innerHTML=l,c=u.content}n.append(c);const f=n.getElementsByTagName("a");for(const u of f)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),xt.createElement(wa,{ref:this.containerRefHook})}}const ya=tn("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),pa=tn("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),va=tn("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});let al=0;const Ur=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:l,...s}=e,{onChange:c,className:f}=s,u=a.useRef(null),w=n??"";Qt(c!==void 0,"GrowingEntry must be a controlled input area");const[b]=a.useState(()=>"input-box-"+(al=(al+1)%1e7));a.useEffect(()=>{const h=u.current;if(h===null||h.disabled)return;const m=w.toString().length;h.focus(),h.setSelectionRange(r?0:m,m)},[]),a.useLayoutEffect(()=>{var h;if(l!==void 0){const m=typeof l=="number"?[l,null]:l;(h=u.current)==null||h.setSelectionRange(m[0],m[1])}},[l]);const g=a.useCallback(h=>{h.key==="Enter"&&h.shiftKey&&i===!0||o==null||o(h)},[i,o]);return a.createElement(va,{className:"gdg-growing-entry"},a.createElement(pa,{className:f},w+`
`),a.createElement(ya,{...s,className:(f??"")+" gdg-input",id:b,ref:u,onKeyDown:g,value:w,placeholder:t,dir:"auto"}))},wi={};let Vn=null;function Ca(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Lo(e){const t=e.toLowerCase().trim();if(wi[t]!==void 0)return wi[t];Vn=Vn||Ca(),Vn.style.color="#000",Vn.style.color=t;const n=getComputedStyle(Vn).color;Vn.style.color="#fff",Vn.style.color=t;const o=getComputedStyle(Vn).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),wi[t]=r,r}function mo(e,t){const[n,o,r]=Lo(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const cl=new Map;function dl(e,t){const n=`${e}-${t}`,o=cl.get(n);if(o!==void 0)return o;const r=en(e,t);return cl.set(n,r),r}function en(e,t){if(t===void 0)return e;const[n,o,r,i]=Lo(e);if(i===1)return e;const[l,s,c,f]=Lo(t),u=i+f*(1-i),w=(i*n+f*l*(1-i))/u,b=(i*o+f*s*(1-i))/u,g=(i*r+f*c*(1-i))/u;return`rgba(${w}, ${b}, ${g}, ${u})`}function Pu(e,t,n){if(n<=0)return e;if(n>=1)return t;const o=[...Lo(e)];o[0]=o[0]*o[3],o[1]=o[1]*o[3],o[2]=o[2]*o[3];const r=[...Lo(t)];r[0]=r[0]*r[3],r[1]=r[1]*r[3],r[2]=r[2]*r[3];const i=n,l=1-n,s=o[3]*l+r[3]*i,c=Math.floor((o[0]*l+r[0]*i)/s),f=Math.floor((o[1]*l+r[1]*i)/s),u=Math.floor((o[2]*l+r[2]*i)/s);return`rgba(${c}, ${f}, ${u}, ${s})`}function Wu(e){if(e==="transparent")return 0;function t(i){const l=i/255;return l<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}const[n,o,r]=Lo(e);return .2126*t(n)+.7152*t(o)+.0722*t(r)}function xa(e,t){return xt.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,contentAlign:n.contentAlign,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled})),[e,t])}function ka(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(nr(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function sr(e,t){return(e??"")===(t??"")}function Sa(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function $l(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function nr(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function Ol(e){return[e.x+e.width-1,e.y+e.height-1]}function ul(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,l=n.y+n.height-1,[s,c]=e;if(c<i||c>l)return!1;if(t.span===void 0)return s>=o&&s<=r;const[f,u]=t.span;return f>=o&&f<=r||u>=o&&f<=r||f<o&&u>r}function Ma(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&ul(e,t,i)&&r++;for(const l of n.current.rangeStack)ul(e,t,l)&&r++;return r}function Nl(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,l)=>({...i,sticky:e[l].sticky})),n=o}return n}function Po(e,t){let n=0;const o=Nl(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function wo(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function ki(e,t,n,o,r){const i=Nl(e,o),l=[];for(const f of i)if(f.sticky)l.push(f);else break;if(l.length>0)for(const f of l)n-=f.width;let s=t,c=r??0;for(;c<=n&&s<i.length;)c+=i[s].width,s++;for(let f=t;f<s;f++){const u=i[f];u.sticky||l.push(u)}return l}function Ra(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function Ea(e,t,n,o,r,i,l,s,c,f){const u=o+r;if(n&&e<=r)return-2;if(e<=u)return-1;let w=t;for(let h=0;h<f;h++){const m=i-1-h,x=typeof l=="number"?l:l(m);if(w-=x,e>=w)return m}const b=i-f,g=e-(c??0);if(typeof l=="number"){const h=Math.floor((g-u)/l)+s;return h>=b?void 0:h}else{let h=u;for(let m=s;m<b;m++){const x=l(m);if(g<=h+x)return m;h+=x}return}}let Wr=0,or={};const Hi=typeof window>"u";let Kt=null,$r=!1;function Xl(){if(!(Hi||$r)&&!(typeof document>"u"))try{Kt=document.createElement("span"),Kt.style.visibility="hidden",Kt.style.position="absolute",Kt.style.top="-9999px",Kt.style.left="-9999px",Kt.style.whiteSpace="nowrap",Kt.style.padding="0",Kt.style.margin="0",Kt.style.border="none",document.body.append(Kt),$r=!0}catch{$r=!1,Kt=null}}async function Ia(){var e;Hi||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,Wr=0,or={},Zs(),Xl())}Ia();Hi||setTimeout(Xl,0);function Yl(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Zt(e,t,n,o="middle"){const r=Yl(e,t,o,n);let i=or[r];if(i===void 0){if(i=t.measureText(e),e.length>5&&$r&&Kt)try{Kt.style.font=n??t.font,Kt.textContent=e;const l=Kt.getBoundingClientRect().width;l>i.width&&Object.defineProperty(i,"width",{value:l,writable:!0,enumerable:!0,configurable:!0})}catch{}or[r]=i,Wr++}return Wr>1e4&&(or={},Wr=0),i}function Gl(e,t){const n=Yl(e,void 0,"middle",t);return or[n]}function Zn(e,t){return typeof t!="string"&&(t=t.baseFontFull),Fa(e,t)}function fl(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const hl=[];function Fa(e,t){for(const i of hl)if(i.key===t)return i.val;const n=fl(e,"alphabetic"),r=-(fl(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return hl.push({key:t,val:r}),r}function Da(e,t,n,o,r,i){const{ctx:l,rect:s,theme:c}=e;let f=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(f=n-t,f<u)){const w=1-f/u;l.globalAlpha=w,l.fillStyle=c.bgSearchResult,l.fillRect(s.x+1,s.y+1,s.width-(r?2:1),s.height-(i?2:1)),l.globalAlpha=1,o!==void 0&&(o.fillStyle=c.bgSearchResult)}return f<u}function cr(e,t,n){const{ctx:o,theme:r}=e,i=t??{},l=n??r.textDark;return l!==i.fillStyle&&(o.fillStyle=l,i.fillStyle=l),i}function $u(e,t,n){const{rect:o,ctx:r,theme:i}=e;r.fillStyle=i.textDark,Sn({ctx:r,rect:o,theme:i},t,n)}function Kl(e,t,n,o,r,i,l,s,c){c==="right"?e.fillText(t,n+r-(s.cellHorizontalPadding+.5),o+i/2+l):c==="center"?e.fillText(t,n+r/2,o+i/2+l):e.fillText(t,n+s.cellHorizontalPadding+.5,o+i/2+l)}function Ul(e,t){const n=Zt("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function Ha(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Ta(e,t,n,o,r,i,l,s,c,f){const u=s.baseFontFull,w=Js(e,t,u,r-s.cellHorizontalPadding*2,f??!1),b=Ul(e,u),g=s.lineHeight*b,h=b+g*(w.length-1),m=h+s.cellVerticalPadding>i;m&&(e.save(),e.rect(n,o,r,i),e.clip());const x=o+i/2-h/2;let C=Math.max(o+s.cellVerticalPadding,x);for(const v of w)if(Kl(e,v,n,C,r,b,l,s,c),C+=g,C>o+i)break;m&&e.restore()}function Sn(e,t,n,o,r){const{ctx:i,rect:l,theme:s}=e,{x:c,y:f,width:u,height:w}=l;o=o??!1,o||(t=Ha(t,u));const b=Zn(i,s),g=Di(t)==="rtl";if(n===void 0&&g&&(n="right"),g&&(i.direction="rtl"),t.length>0){let h=!1;n==="right"?(i.textAlign="right",h=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,h=!0),o?Ta(i,t,c,f,u,w,b,s,n,r):Kl(i,t,c,f,u,w,b,s,n),h&&(i.textAlign="start"),g&&(i.direction="inherit")}}function Mn(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function Aa(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function za(e,t,n){const o=function(s,c){const f=c.x-s.x,u=c.y-s.y,w=Math.sqrt(f*f+u*u),b=f/w,g=u/w;return{x:f,y:c.y-s.y,len:w,nx:b,ny:g,ang:Math.atan2(g,b)}};let r;const i=t.length;let l=t[i-1];for(let s=0;s<i;s++){let c=t[s%i];const f=t[(s+1)%i],u=o(c,l),w=o(c,f),b=u.nx*w.ny-u.ny*w.nx,g=u.nx*w.nx-u.ny*-w.ny;let h=Math.asin(b<-1?-1:b>1?1:b),m=1,x=!1;g<0?h<0?h=Math.PI+h:(h=Math.PI-h,m=-1,x=!0):h>0&&(m=-1,x=!0),r=c.radius!==void 0?c.radius:n;const C=h/2;let v=Math.abs(Math.cos(C)*r/Math.sin(C)),R;v>Math.min(u.len/2,w.len/2)?(v=Math.min(u.len/2,w.len/2),R=Math.abs(v*Math.sin(C)/Math.cos(C))):R=r;let O=c.x+w.nx*v,$=c.y+w.ny*v;O+=-w.ny*R*m,$+=w.nx*R*m,e.arc(O,$,R,u.ang+Math.PI/2*m,w.ang-Math.PI/2*m,x),l=c,c=f}e.closePath()}function Si(e,t,n,o,r,i,l,s,c,f,u,w,b,g,h){const m={x:0,y:i+f,width:0,height:0};if(e>=g.length||t>=u||t<-2||e<0)return m;const x=i-r;if(e>=w){const C=l>e?-1:1,v=Po(g);m.x+=v+c;for(let R=l;R!==e;R+=C)m.x+=g[C===1?R:R-1].width*C}else for(let C=0;C<e;C++)m.x+=g[C].width;if(m.width=g[e].width+1,t===-1)m.y=r,m.height=x;else if(t===-2){m.y=0,m.height=r;let C=e;const v=g[e].group,R=g[e].sticky;for(;C>0&&sr(g[C-1].group,v)&&g[C-1].sticky===R;){const $=g[C-1];m.x-=$.width,m.width+=$.width,C--}let O=e;for(;O+1<g.length&&sr(g[O+1].group,v)&&g[O+1].sticky===R;){const $=g[O+1];m.width+=$.width,O++}if(!R){const $=Po(g),z=m.x-$;z<0&&(m.x-=z,m.width+=z),m.x+m.width>n&&(m.width=n-m.x)}}else if(t>=u-b){let C=u-t;for(m.y=o;C>0;){const v=t+C-1;m.height=typeof h=="number"?h:h(v),m.y-=m.height,C--}m.height+=1}else{const C=s>t?-1:1;if(typeof h=="number"){const v=t-s;m.y+=v*h}else for(let v=s;v!==t;v+=C)m.y+=h(v)*C;m.height=(typeof h=="number"?h:h(t))+1}return m}const Ti=1<<21;function yn(e,t){return(t+2)*Ti+e}function _l(e){return e%Ti}function Ai(e){return Math.floor(e/Ti)-2}function zi(e){const t=_l(e),n=Ai(e);return[t,n]}class Vl{constructor(){$e(this,"visibleWindow",{x:0,y:0,width:0,height:0});$e(this,"freezeCols",0);$e(this,"freezeRows",[]);$e(this,"isInWindow",t=>{const n=_l(t),o=Ai(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,l=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&l})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Bo(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Ba extends Vl{constructor(){super(...arguments);$e(this,"cache",new Map);$e(this,"setValue",(n,o)=>{this.cache.set(yn(n[0],n[1]),o)});$e(this,"getValue",n=>this.cache.get(yn(n[0],n[1])));$e(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class rr{constructor(t=[]){$e(this,"cells");this.cells=new Set(t.map(n=>yn(n[0],n[1])))}add(t){this.cells.add(yn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(yn(t[0],t[1]))}remove(t){this.cells.delete(yn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(Ai(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(yn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield zi(t)}}function La(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const ql={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4};function jl(){return ql}const Zl=xt.createContext(ql);function Ou(){return xt.useContext(Zl)}function Wn(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=en(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const Mi=150,Pa=150;function Wa(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??Mi}function Jl(e,t,n,o,r,i,l,s){let c=0;for(const u of r)c=Math.max(c,Wa(e,u[o],t,s));const f=Zt((n==null?void 0:n.title)??"#",e,t.headerFontFull).width+t.cellHorizontalPadding*2+((n==null?void 0:n.icon)===void 0?0:28);return c=Math.max(c,f),{...n,width:Math.max(Math.ceil(i),Math.min(Math.floor(l),Math.ceil(c)))}}function $a(e,t,n,o,r,i,l,s,c){const f=a.useRef(t),u=a.useRef(n),w=a.useRef(l);f.current=t,u.current=n,w.current=l;const[b,g]=a.useMemo(()=>{if(typeof window>"u")return[null,null];const v=document.createElement("canvas");return v.style.display="none",v.style.opacity="0",v.style.position="fixed",[v,v.getContext("2d",{alpha:!1})]},[]);a.useLayoutEffect(()=>(b&&document.documentElement.append(b),()=>{b==null||b.remove()}),[b]);const h=a.useRef({}),m=a.useRef(),[x,C]=a.useState();return a.useLayoutEffect(()=>{const v=u.current;if(v===void 0||e.every(Ar))return;let R=Math.max(1,Pa-Math.floor(e.length/10)),O=0;R<f.current&&R>1&&(R--,O=1);const $={x:0,y:0,width:e.length,height:Math.min(f.current,R)},z={x:0,y:f.current-1,width:e.length,height:1};(async()=>{const _=v($,c.signal),S=O>0?v(z,c.signal):void 0;let N;typeof _=="object"?N=_:N=await il(_),S!==void 0&&(typeof S=="object"?N=[...N,...S]:N=[...N,...await il(S)]),m.current=e,C(N)})()},[c.signal,e]),a.useMemo(()=>{let R=e.every(Ar)?e:g===null?e.map(B=>Ar(B)?B:{...B,width:Mi}):(g.font=w.current.baseFontFull,e.map((B,_)=>{if(Ar(B))return B;if(h.current[B.id]!==void 0)return{...B,width:h.current[B.id]};if(x===void 0||m.current!==e||B.id===void 0)return{...B,width:Mi};const S=Jl(g,l,B,_,x,r,i,s);return h.current[B.id]=S.width,S})),O=0,$=0;const z=[];for(const[B,_]of R.entries())O+=_.width,_.grow!==void 0&&_.grow>0&&($+=_.grow,z.push(B));if(O<o&&z.length>0){const B=[...R],_=o-O;let S=_;for(let N=0;N<z.length;N++){const A=z[N],F=(R[A].grow??0)/$,E=N===z.length-1?S:Math.min(S,Math.floor(_*F));B[A]={...R[A],growOffset:E,width:R[A].width+E},S-=E}R=B}return{sizedColumns:R,nonGrowWidth:O}},[o,e,g,x,l,r,i,s])}const ft='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Oa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ft}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},Na=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ft}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},Xa=e=>{const t=e.fgColor,n=e.bgColor;return`${ft}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},Ya=e=>{const t=e.fgColor,n=e.bgColor;return`${ft}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},Ga=e=>{const t=e.fgColor,n=e.bgColor;return`${ft}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},Ql=e=>{const t=e.fgColor,n=e.bgColor;return`${ft}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},Ka=e=>{const t=e.bgColor;return`${ft}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},Ua=Ql,_a=e=>{const t=e.fgColor,n=e.bgColor;return`${ft}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},Va=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ft}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},qa=e=>{const t=e.fgColor,n=e.bgColor;return`${ft}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},ja=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ft}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},Za=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ft}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},Ja=e=>{const t=e.fgColor,n=e.bgColor;return`${ft}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},Qa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ft}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},ec=e=>{const t=e.fgColor,n=e.bgColor;return`${ft}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},tc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ft}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},nc=e=>{const t=e.fgColor,n=e.bgColor;return`${ft}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},oc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ft}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},rc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ft}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},ic=e=>{const t=e.fgColor,n=e.bgColor;return`${ft}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},lc=e=>{const t=e.fgColor,n=e.bgColor;return`${ft}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},sc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ft}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},ac=e=>{const t=e.fgColor,n=e.bgColor;return`${ft}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},cc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ft}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},dc=e=>{const t=e.fgColor,n=e.bgColor;return`${ft}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},uc=e=>{const t=e.fgColor,n=e.bgColor;return`${ft}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},fc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},hc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},gc={headerRowID:Oa,headerNumber:Xa,headerCode:Na,headerString:Ya,headerBoolean:Ga,headerAudioUri:Ua,headerVideoUri:_a,headerEmoji:Va,headerImage:qa,headerUri:Ql,headerPhone:ja,headerMarkdown:Za,headerDate:Ja,headerTime:Qa,headerEmail:ec,headerReference:tc,headerIfThenElse:nc,headerSingleValue:oc,headerLookup:rc,headerTextTemplate:ic,headerMath:lc,headerRollup:sc,headerJoinStrings:ac,headerSplitString:cc,headerGeoDistance:dc,headerArray:uc,rowOwnerOverlay:fc,protectedColumnOverlay:hc,renameIcon:Ka};function mc(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class wc{constructor(t,n){$e(this,"onSettled");$e(this,"spriteMap",new Map);$e(this,"headerIcons");$e(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,l,s,c=1){const[f,u]=mc(n,s),w=l*Math.ceil(window.devicePixelRatio),b=`${f}_${u}_${w}_${t}`;let g=this.spriteMap.get(b);if(g===void 0){const h=this.headerIcons[t];if(h===void 0)return;g=document.createElement("canvas");const m=g.getContext("2d");if(m===null)return;const x=new Image;x.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(h({fgColor:u,bgColor:f}))}`,this.spriteMap.set(b,g);const C=x.decode();if(C===void 0)return;this.inFlight++,C.then(()=>{m.drawImage(x,0,0,w,w)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else c<1&&(o.globalAlpha=c),o.drawImage(g,0,0,w,w,r,i,l,l),c<1&&(o.globalAlpha=1)}}function es(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y)}function _r(e,t,n,o,r,i,l,s,c){s=s??t;let f=t,u=e;const w=o-i;let b=!1;for(;f<n&&u<w;){const g=r(u);if(f+g>s&&c(f,u,g,!1,l&&u===o-1)===!0){b=!0;break}f+=g,u++}if(!b){f=n;for(let g=0;g<i;g++){u=o-1-g;const h=r(u);f-=h,c(f,u,h,!0,l&&u===o-1)}}}function Jn(e,t,n,o,r,i){let l=0,s=0;const c=r+o;for(const f of e){const u=f.sticky?s:l+n;if(i(f,u,c,f.sticky?0:s,t)===!0)break;l+=f.width,s+=f.sticky?f.width:0}}function ts(e,t,n,o,r){let i=0,l=0;for(let s=0;s<e.length;s++){const c=e[s];let f=s+1,u=c.width;for(c.sticky&&(l+=u);f<e.length&&sr(e[f].group,c.group)&&e[f].sticky===e[s].sticky;){const m=e[f];u+=m.width,f++,s++,m.sticky&&(l+=m.width)}const w=c.sticky?0:n,b=i+w,g=c.sticky?0:Math.max(0,l-b),h=Math.min(u-g,t-(b+g));r([c.sourceIndex,e[f-1].sourceIndex],c.group??"",b+g,0,h,o),i+=u}}function ns(e,t,n,o,r,i,l){var b;const[s,c]=e;let f,u;const w=((b=l.find(g=>!g.sticky))==null?void 0:b.sourceIndex)??0;if(c>w){const g=Math.max(s,w);let h=t,m=o;for(let x=i.sourceIndex-1;x>=g;x--)h-=l[x].width,m+=l[x].width;for(let x=i.sourceIndex+1;x<=c;x++)m+=l[x].width;u={x:h,y:n,width:m,height:r}}if(w>s){const g=Math.min(c,w-1);let h=t,m=o;for(let x=i.sourceIndex-1;x>=s;x--)h-=l[x].width,m+=l[x].width;for(let x=i.sourceIndex+1;x<=g;x++)m+=l[x].width;f={x:h,y:n,width:m,height:r}}return[f,u]}function bc(e,t,n,o){if(o==="any")return os(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),$l([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,l=n-e.y+1,s=e.y+e.height-n,c=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:l,o==="horizontal"?Number.MAX_SAFE_INTEGER:s);return c===s?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:c===l?{x:e.x,y:n,width:e.width,height:e.y-n}:c===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function ar(e,t,n,o,r,i,l,s){return e<=r+l&&r<=e+n&&t<=i+s&&i<=t+o}function go(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function os(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function yc(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function pc(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,l=t+4,s=n+4,c=r-e.x,f=e.x+e.width-l,u=i-e.y,w=e.y+e.height-s,b=c>0?e.x+Math.floor(c/o)*o:e.x,g=f>0?e.x+e.width-Math.floor(f/o)*o:e.x+e.width,h=u>0?e.y+Math.floor(u/o)*o:e.y,m=w>0?e.y+e.height-Math.floor(w/o)*o:e.y+e.height;return{x:b,y:h,width:g-b,height:m-h}}function vc(e,t,n,o,r){const[i,l,s,c]=t,[f,u,w,b]=r,{x:g,y:h,width:m,height:x}=e,C=[];if(m<=0||x<=0)return C;const v=g+m,R=h+x,O=g<i,$=h<l,z=g+m>s,B=h+x>c,_=g>=i&&g<s||v>i&&v<=s||g<i&&v>s,S=h>=l&&h<c||R>l&&R<=c||h<l&&R>c;if(_&&S){const A=Math.max(g,i),F=Math.max(h,l),E=Math.min(v,s),M=Math.min(R,c);C.push({rect:{x:A,y:F,width:E-A,height:M-F},clip:{x:f,y:u,width:w-f+1,height:b-u+1}})}if(O&&$){const A=g,F=h,E=Math.min(v,i),M=Math.min(R,l);C.push({rect:{x:A,y:F,width:E-A,height:M-F},clip:{x:0,y:0,width:f+1,height:u+1}})}if($&&_){const A=Math.max(g,i),F=h,E=Math.min(v,s),M=Math.min(R,l);C.push({rect:{x:A,y:F,width:E-A,height:M-F},clip:{x:f,y:0,width:w-f+1,height:u+1}})}if($&&z){const A=Math.max(g,s),F=h,E=v,M=Math.min(R,l);C.push({rect:{x:A,y:F,width:E-A,height:M-F},clip:{x:w,y:0,width:n-w+1,height:u+1}})}if(O&&S){const A=g,F=Math.max(h,l),E=Math.min(v,i),M=Math.min(R,c);C.push({rect:{x:A,y:F,width:E-A,height:M-F},clip:{x:0,y:u,width:f+1,height:b-u+1}})}if(z&&S){const A=Math.max(g,s),F=Math.max(h,l),E=v,M=Math.min(R,c);C.push({rect:{x:A,y:F,width:E-A,height:M-F},clip:{x:w,y:u,width:n-w+1,height:b-u+1}})}if(O&&B){const A=g,F=Math.max(h,c),E=Math.min(v,i),M=R;C.push({rect:{x:A,y:F,width:E-A,height:M-F},clip:{x:0,y:b,width:f+1,height:o-b+1}})}if(B&&_){const A=Math.max(g,i),F=Math.max(h,c),E=Math.min(v,s),M=R;C.push({rect:{x:A,y:F,width:E-A,height:M-F},clip:{x:f,y:b,width:w-f+1,height:o-b+1}})}if(z&&B){const A=Math.max(g,s),F=Math.max(h,c),E=v,M=R;C.push({rect:{x:A,y:F,width:E-A,height:M-F},clip:{x:w,y:b,width:n-w+1,height:o-b+1}})}return C}const Cc={kind:q.Loading,allowOverlay:!1};function gl(e,t,n,o,r,i,l,s,c,f,u,w,b,g,h,m,x,C,v,R,O,$,z,B,_,S,N,A,F,E,M,ne,le,ae,be){let Ce=(R==null?void 0:R.size)??Number.MAX_SAFE_INTEGER;const Z=performance.now();let U=E.baseFontFull;e.font=U;const Me={ctx:e},J=[0,0],ue=x>0?wo(c,x,f):0;let fe,G;const pe=es(v);return Jn(t,s,i,l,r,(xe,qe,Qe,ht,it)=>{const Ye=Math.max(0,ht-qe),et=qe+Ye,Re=r+1,vt=xe.width-Ye,Ct=o-r-1;if(v.length>0){let _e=!1;for(let We=0;We<v.length;We++){const Ge=v[We];if(ar(et,Re,vt,Ct,Ge.x,Ge.y,Ge.width,Ge.height)){_e=!0;break}}if(!_e)return}const ct=()=>{e.save(),e.beginPath(),e.rect(et,Re,vt,Ct),e.clip()},j=O.columns.hasIndex(xe.sourceIndex),Ee=w(xe.group??"").overrideTheme,de=xe.themeOverride===void 0&&Ee===void 0?E:Wn(E,Ee,xe.themeOverride),He=de.baseFontFull;He!==U&&(U=He,e.font=He),ct();let ye;return _r(it,Qe,o,c,f,x,C,pe,(_e,We,Ge,re,Fe)=>{var Oe,Ft,Jt;if(We<0||(J[0]=xe.sourceIndex,J[1]=We,R!==void 0&&!R.has(J)))return;if(v.length>0){let Ue=!1;for(let Rt=0;Rt<v.length;Rt++){const nt=v[Rt];if(ar(qe,_e,xe.width,Ge,nt.x,nt.y,nt.width,nt.height)){Ue=!0;break}}if(!Ue)return}const tt=O.rows.hasIndex(We),ze=g.hasIndex(We),Ke=We<c?u(J):Cc;let bt=qe,je=xe.width,Be=!1,kt=!1;if(Ke.span!==void 0){const[Ue,Rt]=Ke.span,nt=`${We},${Ue},${Rt},${xe.sticky}`;if(G===void 0&&(G=new Set),G.has(nt)){Ce--;return}else{const nn=ns(Ke.span,qe,_e,xe.width,Ge,xe,n),Nt=xe.sticky?nn[0]:nn[1];if(!xe.sticky&&nn[0]!==void 0&&(kt=!0),Nt!==void 0){bt=Nt.x,je=Nt.width,G.add(nt),e.restore(),ye=void 0,e.save(),e.beginPath();const _t=Math.max(0,ht-Nt.x);e.rect(Nt.x+_t,_e,Nt.width-_t,Ge),fe===void 0&&(fe=[]),fe.push({x:Nt.x+_t,y:_e,width:Nt.width-_t,height:Ge}),e.clip(),Be=!0}}}const St=b==null?void 0:b(We),zt=Fe&&((Oe=xe.trailingRowOptions)==null?void 0:Oe.themeOverride)!==void 0?(Ft=xe.trailingRowOptions)==null?void 0:Ft.themeOverride:void 0,yt=Ke.themeOverride===void 0&&St===void 0&&zt===void 0?de:Wn(de,St,zt,Ke.themeOverride);e.beginPath();const Mt=Sa(J,Ke,O);let At=Ma(J,Ke,O,m);const fn=Ke.span!==void 0&&O.columns.some(Ue=>Ke.span!==void 0&&Ue>=Ke.span[0]&&Ue<=Ke.span[1]);Mt&&!h&&m?At=0:Mt&&m&&(At=Math.max(At,1)),fn&&At++,Mt||(tt&&At++,j&&!Fe&&At++);const Ut=Ke.kind===q.Protected?yt.bgCellMedium:yt.bgCell;let lt;if((re||Ut!==E.bgCell)&&(lt=en(Ut,lt)),At>0||ze){ze&&(lt=en(yt.bgHeader,lt));for(let Ue=0;Ue<At;Ue++)lt=en(yt.accentLight,lt)}else if($!==void 0){for(const Ue of $)if(Ue[0]===xe.sourceIndex&&Ue[1]===We){lt=en(yt.bgSearchResult,lt);break}}if(z!==void 0)for(let Ue=0;Ue<z.length;Ue++){const Rt=z[Ue],nt=Rt.range;Rt.style!=="solid-outline"&&nt.x<=xe.sourceIndex&&xe.sourceIndex<nt.x+nt.width&&nt.y<=We&&We<nt.y+nt.height&&(lt=en(Rt.color,lt))}let Rn=!1;if(R!==void 0){const Ue=_e+1,nt=(re?Ue+Ge-1:Math.min(Ue+Ge-1,o-ue))-Ue;(nt!==Ge-1||bt+1<=ht)&&(Rn=!0,e.save(),e.beginPath(),e.rect(bt+1,Ue,je-1,nt),e.clip()),lt=lt===void 0?yt.bgCell:en(lt,yt.bgCell)}const hn=xe.sourceIndex===n.length-1,dt=We===c-1;lt!==void 0&&(e.fillStyle=lt,ye!==void 0&&(ye.fillStyle=lt),R!==void 0?e.fillRect(bt+1,_e+1,je-(hn?2:1),Ge-(dt?2:1)):e.fillRect(bt,_e,je,Ge)),Ke.style==="faded"&&(e.globalAlpha=.6);let Lt;for(let Ue=0;Ue<S.length;Ue++){const Rt=S[Ue];if(Rt.item[0]===xe.sourceIndex&&Rt.item[1]===We){Lt=Rt;break}}if(je>be&&!kt){const Ue=yt.baseFontFull;Ue!==U&&(e.font=Ue,U=Ue),ye=rs(e,Ke,xe.sourceIndex,We,hn,dt,bt,_e,je,Ge,At>0,yt,lt??yt.bgCell,B,_,(Lt==null?void 0:Lt.hoverAmount)??0,N,F,Z,A,ye,M,ne,le,ae)}return Rn&&e.restore(),Ke.style==="faded"&&(e.globalAlpha=1),Ce--,Be&&(e.restore(),(Jt=ye==null?void 0:ye.deprep)==null||Jt.call(ye,Me),ye=void 0,ct(),U=He,e.font=He),Ce<=0}),e.restore(),Ce<=0}),fe}const Zo=[0,0],Jo={x:0,y:0,width:0,height:0},bi=[void 0,()=>{}];let Ri=!1;function xc(){Ri=!0}function rs(e,t,n,o,r,i,l,s,c,f,u,w,b,g,h,m,x,C,v,R,O,$,z,B,_){var ne,le;let S,N;x!==void 0&&x[0][0]===n&&x[0][1]===o&&(S=x[1][0],N=x[1][1]);let A;Zo[0]=n,Zo[1]=o,Jo.x=l,Jo.y=s,Jo.width=c,Jo.height=f,bi[0]=z.getValue(Zo),bi[1]=ae=>z.setValue(Zo,ae),Ri=!1;const F={ctx:e,theme:w,col:n,row:o,cell:t,rect:Jo,highlighted:u,cellFillColor:b,hoverAmount:m,frameTime:v,hoverX:S,drawState:bi,hoverY:N,imageLoader:g,spriteManager:h,hyperWrapping:C,overrideCursor:S!==void 0?_:void 0,requestAnimationFrame:xc},E=Da(F,t.lastUpdated,v,O,r,i),M=B(t);if(M!==void 0){(O==null?void 0:O.renderer)!==M&&((ne=O==null?void 0:O.deprep)==null||ne.call(O,F),O=void 0);const ae=(le=M.drawPrep)==null?void 0:le.call(M,F,O);R!==void 0&&!Ao(F.cell)?R(F,()=>M.draw(F,t)):M.draw(F,t),A=ae===void 0?void 0:{deprep:ae==null?void 0:ae.deprep,fillStyle:ae==null?void 0:ae.fillStyle,font:ae==null?void 0:ae.font,renderer:M}}return(E||Ri)&&($==null||$(Zo)),A}function Bi(e,t,n,o,r,i,l,s,c=-20,f=-20,u=32,w="center",b="square"){const g=Math.floor(r+l/2),h=b==="circle"?1e4:t.roundingRadius??4;let m=Ll(u,l,t.cellVerticalPadding),x=m/2;const C=Bl(w,o,i,t.cellHorizontalPadding,m),v=zl(C,g,m),R=Pl(o+c,r+f,v);switch(n){case!0:{e.beginPath(),Mn(e,C-m/2,g-m/2,m,m,h),b==="circle"&&(x*=.8,m*=.8),e.fillStyle=s?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(C-x+m/4.23,g-x+m/1.97),e.lineTo(C-x+m/2.42,g-x+m/1.44),e.lineTo(C-x+m/1.29,g-x+m/3.25),e.strokeStyle=t.rowMarkerIcon??t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case Or:case!1:{e.beginPath(),Mn(e,C-m/2+.5,g-m/2+.5,m-1,m-1,h),e.lineWidth=1,e.strokeStyle=R?t.textDark:t.textMedium,e.stroke();break}case Ei:{e.beginPath(),Mn(e,C-m/2,g-m/2,m,m,h),e.fillStyle=R?t.textMedium:t.textLight,e.fill(),b==="circle"&&(x*=.8,m*=.8),e.beginPath(),e.moveTo(C-m/3,g),e.lineTo(C+m/3,g),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:lr()}}function kc(e,t,n,o,r,i,l,s,c,f,u,w,b,g,h,m,x,C,v){var S,N,A,F;const R=l+s;if(R<=0)return;e.fillStyle=w.bgHeader,e.fillRect(0,0,r,R);const O=(S=o==null?void 0:o[0])==null?void 0:S[0],$=(N=o==null?void 0:o[0])==null?void 0:N[1],z=(A=o==null?void 0:o[1])==null?void 0:A[0],B=(F=o==null?void 0:o[1])==null?void 0:F[1],_=w.headerFontFull;e.font=_,Jn(t,0,i,0,R,(E,M,ne,le)=>{var xe;if(x!==void 0&&!x.has([E.sourceIndex,-1]))return;const ae=Math.max(0,le-M);e.save(),e.beginPath(),e.rect(M+ae,s,E.width-ae,l),e.clip();const be=m(E.group??"").overrideTheme,Ce=E.themeOverride===void 0&&be===void 0?w:Wn(w,be,E.themeOverride);Ce.bgHeader!==w.bgHeader&&(e.fillStyle=Ce.bgHeader,e.fill()),Ce!==w&&(e.font=Ce.baseFontFull);const Z=u.columns.hasIndex(E.sourceIndex),U=c!==void 0||f,Me=!U&&$===-1&&O===E.sourceIndex,J=U?0:((xe=g.find(qe=>qe.item[0]===E.sourceIndex&&qe.item[1]===-1))==null?void 0:xe.hoverAmount)??0,ue=(u==null?void 0:u.current)!==void 0&&u.current.cell[0]===E.sourceIndex,fe=Z?Ce.accentColor:ue?Ce.bgHeaderHasFocus:Ce.bgHeader,G=n?s:0,pe=E.sourceIndex===0?0:1;Z?(e.fillStyle=fe,e.fillRect(M+pe,G,E.width-pe,l)):(ue||J>0)&&(e.beginPath(),e.rect(M+pe,G,E.width-pe,l),ue&&(e.fillStyle=Ce.bgHeaderHasFocus,e.fill()),J>0&&(e.globalAlpha=J,e.fillStyle=Ce.bgHeaderHovered,e.fill(),e.globalAlpha=1)),ss(e,M,G,E.width,l,E,Z,Ce,Me,Me?z:void 0,Me?B:void 0,ue,J,b,C,v),e.restore()}),n&&Sc(e,t,r,i,s,o,w,b,g,h,m,x)}function Sc(e,t,n,o,r,i,l,s,c,f,u,w){const b=l.cellHorizontalPadding,[g,h]=(i==null?void 0:i[0])??[];let m=0;ts(t,n,o,r,(x,C,v,R,O,$)=>{if(w!==void 0&&!w.hasItemInRectangle({x:x[0],y:-2,width:x[1]-x[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(v,R,O,$),e.clip();const z=u(C),B=(z==null?void 0:z.overrideTheme)===void 0?l:Wn(l,z.overrideTheme),_=h===-2&&g!==void 0&&g>=x[0]&&g<=x[1],S=_?B.bgHeaderHovered:B.bgHeader;if(S!==l.bgHeader&&(e.fillStyle=S,e.fill()),e.fillStyle=B.textGroupHeader??B.textHeader,z!==void 0){let N=v;if(z.icon!==void 0&&(s.drawSprite(z.icon,"normal",e,N+b,(r-20)/2,20,B),N+=26),e.fillText(z.name,N+b,r/2+Zn(e,l.headerFontFull)),z.actions!==void 0&&_){const A=is({x:v,y:R,width:O,height:$},z.actions);e.beginPath();const F=A[0].x-10,E=v+O-F;e.rect(F,0,E,r);const M=e.createLinearGradient(F,0,F+E,0),ne=mo(S,0);M.addColorStop(0,ne),M.addColorStop(10/E,S),M.addColorStop(1,S),e.fillStyle=M,e.fill(),e.globalAlpha=.6;const[le,ae]=(i==null?void 0:i[1])??[-1,-1];for(let be=0;be<z.actions.length;be++){const Ce=z.actions[be],Z=A[be],U=go(Z,le+v,ae);U&&(e.globalAlpha=1),s.drawSprite(Ce.icon,"normal",e,Z.x+Z.width/2-10,Z.y+Z.height/2-10,20,B),U&&(e.globalAlpha=.6)}e.globalAlpha=1}}v!==0&&f(x[0])&&(e.beginPath(),e.moveTo(v+.5,0),e.lineTo(v+.5,r),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()),e.restore(),m=v+O}),e.beginPath(),e.moveTo(m+.5,0),e.lineTo(m+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()}const Ho=30;function Mc(e,t,n,o,r){return r?{x:e,y:t,width:Ho,height:Math.min(Ho,o)}:{x:e+n-Ho,y:Math.max(t,t+o/2-Ho/2),width:Ho,height:Math.min(Ho,o)}}function is(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,l=26;for(let s=0;s<t.length;s++)n.push({x:o,y:r,width:l,height:i}),o+=26;return n}function Qo(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function ls(e,t,n,o,r,i,l,s){var $;const c=l.cellHorizontalPadding,f=l.headerIconSize,u=Mc(n,o,r,i,!1),w=s||t.contentAlign==="right",b=t.contentAlign==="center";let g=n+c,h,m;const x=t.icon!==void 0&&t.icon!==null;x&&(h={x:w?n+r-c-f:g,y:o+(i-f)/2,width:f,height:f},w||(g+=Math.ceil(f*1.3)),t.overlayIcon!==void 0&&(m={x:h.x+9,y:h.y+6,width:18,height:18}));const C=e===void 0?(($=Gl(t.title,l.headerFontFull))==null?void 0:$.width)??0:Zt(t.title,e,l.headerFontFull).width,v={x:b?n+(r-C)/2:w?n:g,y:o,width:b?C:w?r-(x?f+c:c):r-(g-n)-c,height:i};let R;t.indicatorIcon!==void 0&&(R={x:w?x?h.x-f-c:n+r-f-c:g+C+c,y:o+(i-f)/2,width:f,height:f});const O=n+r/2;return{menuBounds:Qo(u,O,s),iconBounds:Qo(h,O,s),iconOverlayBounds:Qo(m,O,s),textBounds:Qo(v,O,s),indicatorIconBounds:Qo(R,O,s)}}function ml(e,t,n,o,r,i,l,s,c,f,u,w,b,g,h,m){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){const v=i.rowMarkerChecked;v!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=w);const R=i.headerRowMarkerTheme!==void 0?Wn(s,i.headerRowMarkerTheme):s;Bi(e,R,v,t,n,o,r,!1,void 0,void 0,18,"center",i.rowMarker),v!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const x=l?s.textHeaderSelected:s.textHeader,C=i.hasMenu===!0&&(c||g&&l)&&m.menuBounds!==void 0;if(i.icon!==void 0&&m.iconBounds!==void 0){let v=l?"selected":"normal";i.style==="highlight"&&(v=l?"selected":"special"),b.drawSprite(i.icon,v,e,m.iconBounds.x,m.iconBounds.y,m.iconBounds.width,s),i.overlayIcon!==void 0&&m.iconOverlayBounds!==void 0&&b.drawSprite(i.overlayIcon,l?"selected":"special",e,m.iconOverlayBounds.x,m.iconOverlayBounds.y,m.iconOverlayBounds.width,s)}if(C&&o>35){const R=h?35:o-35,O=h?35*.7:o-35*.7,$=R/o,z=O/o,B=e.createLinearGradient(t,0,t+o,0),_=mo(x,0);B.addColorStop(h?1:0,x),B.addColorStop($,x),B.addColorStop(z,_),B.addColorStop(h?0:1,_),e.fillStyle=B}else e.fillStyle=x;if(m.textBounds!==void 0){const v=h||i.contentAlign==="right";e.textAlign=v?"right":"left";const R=v?m.textBounds.x+m.textBounds.width:m.textBounds.x;e.fillText(i.title,R,n+r/2+Zn(e,s.headerFontFull))}if(i.indicatorIcon!==void 0&&m.indicatorIconBounds!==void 0&&(!C||!ar(m.menuBounds.x,m.menuBounds.y,m.menuBounds.width,m.menuBounds.height,m.indicatorIconBounds.x,m.indicatorIconBounds.y,m.indicatorIconBounds.width,m.indicatorIconBounds.height))){let v=l?"selected":"normal";i.style==="highlight"&&(v=l?"selected":"special"),b.drawSprite(i.indicatorIcon,v,e,m.indicatorIconBounds.x,m.indicatorIconBounds.y,m.indicatorIconBounds.width,s)}if(C&&m.menuBounds!==void 0){const v=m.menuBounds,R=f!==void 0&&u!==void 0&&go(v,f+t,u+n);if(R||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===Nr.Triangle){e.beginPath();const O=v.x+v.width/2-5.5,$=v.y+v.height/2-3;za(e,[{x:O,y:$},{x:O+11,y:$},{x:O+5.5,y:$+6}],1),e.fillStyle=x,e.fill()}else if(i.menuIcon===Nr.Dots){e.beginPath();const O=v.x+v.width/2,$=v.y+v.height/2;Aa(e,O,$),e.fillStyle=x,e.fill()}else{const O=v.x+(v.width-s.headerIconSize)/2,$=v.y+(v.height-s.headerIconSize)/2;b.drawSprite(i.menuIcon,"normal",e,O,$,s.headerIconSize,s)}R||(e.globalAlpha=1)}}function ss(e,t,n,o,r,i,l,s,c,f,u,w,b,g,h,m){const x=Di(i.title)==="rtl",C=ls(e,i,t,n,o,r,s,x);h!==void 0?h({ctx:e,theme:s,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:l,hoverAmount:b,isHovered:c,hasSelectedCell:w,spriteManager:g,menuBounds:(C==null?void 0:C.menuBounds)??{x:0,y:0,height:0,width:0}},()=>ml(e,t,n,o,r,i,l,s,c,f,u,b,g,m,x,C)):ml(e,t,n,o,r,i,l,s,c,f,u,b,g,m,x,C)}function Rc(e,t,n,o,r,i,l,s,c,f,u,w,b,g,h,m,x,C,v){if(C!==void 0||t[t.length-1]!==n[t.length-1])return;const R=es(x);Jn(t,c,l,s,i,(O,$,z,B,_)=>{if(O!==t[t.length-1])return;$+=O.width;const S=Math.max($,B);S>o||(e.save(),e.beginPath(),e.rect(S,i+1,1e4,r-i-1),e.clip(),_r(_,z,r,f,u,h,m,R,(N,A,F,E)=>{if(!E&&x.length>0&&!x.some(be=>ar($,N,1e4,F,be.x,be.y,be.width,be.height)))return;const M=b.hasIndex(A),ne=g.hasIndex(A);e.beginPath();const le=w==null?void 0:w(A),ae=le===void 0?v:Wn(v,le);ae.bgCell!==v.bgCell&&(e.fillStyle=ae.bgCell,e.fillRect($,N,1e4,F)),ne&&(e.fillStyle=ae.bgHeader,e.fillRect($,N,1e4,F)),M&&(e.fillStyle=ae.accentLight,e.fillRect($,N,1e4,F))}),e.restore())})}function Ec(e,t,n,o,r,i,l,s,c){let f=!1;for(const h of t)if(!h.sticky){f=l(h.sourceIndex);break}const u=c.horizontalBorderColor??c.borderColor,w=c.borderColor,b=f?Po(t):0;let g;if(b!==0&&(g=dl(w,c.bgCell),e.beginPath(),e.moveTo(b+.5,0),e.lineTo(b+.5,o),e.strokeStyle=g,e.stroke()),r>0){const h=w===u&&g!==void 0?g:dl(u,c.bgCell),m=wo(i,r,s);e.beginPath(),e.moveTo(0,o-m+.5),e.lineTo(n,o-m+.5),e.strokeStyle=h,e.stroke()}}const as=(e,t,n)=>{let o=0,r=t,i=0,l=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;for(const s of e)o=Math.min(o,s.x-1),r=Math.max(r,s.x+s.width+1),i=Math.min(i,s.y-1),l=Math.max(l,s.y+s.height+1)}return{minX:o,maxX:r,minY:i,maxY:l}};function Ic(e,t,n,o,r,i,l,s,c,f,u,w,b,g,h){var F;const m=h.bgCell,{minX:x,maxX:C,minY:v,maxY:R}=as(s,i,l),O=[],$=l-wo(g,b,f);let z=c,B=n,_=0;for(;z+r<$;){const E=z+r,M=f(B);if(E>=v&&E<=R-1){const ne=u==null?void 0:u(B),le=ne==null?void 0:ne.bgCell;le!==void 0&&le!==m&&B>=g-b&&O.push({x,y:E,w:C-x,h:M,color:le})}z+=M,B<g-b&&(_=z),B++}let S=0;const N=Math.min($,R)-_;if(N>0)for(let E=0;E<t.length;E++){const M=t[E];if(M.width===0)continue;const ne=M.sticky?S:S+o,le=(F=M.themeOverride)==null?void 0:F.bgCell;le!==void 0&&le!==m&&ne>=x&&ne<=C&&w(E+1)&&O.push({x:ne,y:_,w:M.width,h:N,color:le}),S+=M.width}if(O.length===0)return;let A;e.beginPath();for(let E=O.length-1;E>=0;E--){const M=O[E];A===void 0?A=M.color:M.color!==A&&(e.fillStyle=A,e.fill(),e.beginPath(),A=M.color),e.rect(M.x,M.y,M.w,M.h)}A!==void 0&&(e.fillStyle=A,e.fill()),e.beginPath()}function wl(e,t,n,o,r,i,l,s,c,f,u,w,b,g,h,m,x,C=!1){if(c!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,l);for(const F of c)e.rect(F.x+1,F.y+1,F.width-1,F.height-1);e.clip("evenodd")}const v=x.horizontalBorderColor??x.borderColor,R=x.borderColor,{minX:O,maxX:$,minY:z,maxY:B}=as(s,i,l),_=[];e.beginPath();let S=.5;for(let F=0;F<t.length;F++){const E=t[F];if(E.width===0)continue;S+=E.width;const M=E.sticky?S:S+o;M>=O&&M<=$&&g(F+1)&&_.push({x1:M,y1:Math.max(f,z),x2:M,y2:Math.min(l,B),color:R})}let N=l+.5;for(let F=m-h;F<m;F++){const E=w(F);N-=E,_.push({x1:O,y1:N,x2:$,y2:N,color:v})}if(C!==!0){let F=u+.5,E=n;const M=N;for(;F+r<M;){const ne=F+r;if(ne>=z&&ne<=B-1){const le=b==null?void 0:b(E);_.push({x1:O,y1:ne,x2:$,y2:ne,color:(le==null?void 0:le.horizontalBorderColor)??(le==null?void 0:le.borderColor)??v})}F+=w(E),E++}}const A=Qs(_,F=>F.color);for(const F of Object.keys(A)){e.strokeStyle=F;for(const E of A[F])e.moveTo(E.x1,E.y1),e.lineTo(E.x2,E.y2);e.stroke(),e.beginPath()}c!==void 0&&e.restore()}function Fc(e,t,n,o,r,i,l,s,c,f,u,w,b,g,h,m,x,C,v){const R=[];e.imageSmoothingEnabled=!1;const O=Math.min(r.cellYOffset,l),$=Math.max(r.cellYOffset,l);let z=0;if(typeof C=="number")z+=($-O)*C;else for(let M=O;M<$;M++)z+=C(M);l>r.cellYOffset&&(z=-z),z+=c-r.translateY;const B=Math.min(r.cellXOffset,i),_=Math.max(r.cellXOffset,i);let S=0;for(let M=B;M<_;M++)S+=m[M].width;i>r.cellXOffset&&(S=-S),S+=s-r.translateX;const N=Po(x);if(S!==0&&z!==0)return{regions:[]};const A=f>0?wo(b,f,C):0,F=u-N-Math.abs(S),E=w-g-A-Math.abs(z)-1;if(F>150&&E>150){const M={sx:0,sy:0,sw:u*h,sh:w*h,dx:0,dy:0,dw:u*h,dh:w*h};if(z>0?(M.sy=(g+1)*h,M.sh=E*h,M.dy=(z+g+1)*h,M.dh=E*h,R.push({x:0,y:g,width:u,height:z+1})):z<0&&(M.sy=(-z+g+1)*h,M.sh=E*h,M.dy=(g+1)*h,M.dh=E*h,R.push({x:0,y:w+z-A,width:u,height:-z+A})),S>0?(M.sx=N*h,M.sw=F*h,M.dx=(S+N)*h,M.dw=F*h,R.push({x:N-1,y:0,width:S+2,height:w})):S<0&&(M.sx=(N-S)*h,M.sw=F*h,M.dx=N*h,M.dw=F*h,R.push({x:u+S,y:0,width:-S,height:w})),e.setTransform(1,0,0,1,0,0),v){if(N>0&&S!==0&&z===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const ne=N*h,le=w*h;e.drawImage(t,0,0,ne,le,0,0,ne,le)}if(A>0&&S===0&&z!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const ne=(w-A)*h,le=u*h,ae=A*h;e.drawImage(t,0,ne,le,ae,0,ne,le,ae)}}e.drawImage(t,M.sx,M.sy,M.sw,M.sh,M.dx,M.dy,M.dw,M.dh),e.scale(h,h)}return e.imageSmoothingEnabled=!0,{regions:R}}function Dc(e,t,n,o,r,i,l,s,c,f){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||Jn(c,n,o,r,s,(w,b,g,h)=>{if(w.sourceIndex===f){const m=Math.max(b,h)+1;return u.push({x:m,y:0,width:i-m,height:l}),!0}}),u}function Hc(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if(Bo(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:l,...s}=r,{width:c,...f}=i;if(!Bo(s,f))return!1;n=o}return n===void 0?!0:n}return!0}function bl(e,t,n,o,r,i,l,s,c,f,u,w,b,g,h,m){const x=h==null?void 0:h.filter(B=>B.style!=="no-outline");if(x===void 0||x.length===0)return;const C=Po(s),v=wo(g,b,w),R=[c,0,s.length,g-b],O=[C,0,t,n-v],$=x.map(B=>{const _=B.range,S=B.style??"dashed";return vc(_,R,t,n,O).map(N=>{const A=N.rect,F=Si(A.x,A.y,t,n,u,f+u,o,r,i,l,g,c,b,s,w),E=A.width===1&&A.height===1?F:Si(A.x+A.width-1,A.y+A.height-1,t,n,u,f+u,o,r,i,l,g,c,b,s,w);return A.x+A.width>=s.length&&(E.width-=1),A.y+A.height>=g&&(E.height-=1),{color:B.color,style:S,clip:N.clip,rect:pc({x:F.x,y:F.y,width:E.x+E.width-F.x,height:E.y+E.height-F.y},t,n,8)}})}),z=()=>{e.lineWidth=1;let B=!1;for(const _ of $)for(const S of _)if((S==null?void 0:S.rect)!==void 0&&ar(0,0,t,n,S.rect.x,S.rect.y,S.rect.width,S.rect.height)){const N=B,A=!yc(S.clip,S.rect);A&&(e.save(),e.rect(S.clip.x,S.clip.y,S.clip.width,S.clip.height),e.clip()),S.style==="dashed"&&!B?(e.setLineDash([5,3]),B=!0):(S.style==="solid"||S.style==="solid-outline")&&B&&(e.setLineDash([]),B=!1),e.strokeStyle=S.style==="solid-outline"?en(en(S.color,m.borderColor),m.bgCell):mo(S.color,1),e.strokeRect(S.rect.x+.5,S.rect.y+.5,S.rect.width-1,S.rect.height-1),A&&(e.restore(),B=N)}B&&e.setLineDash([])};return z(),z}function yl(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function yi(e,t,n,o,r,i,l,s,c,f,u,w,b,g,h,m,x){if(u.current===void 0)return;const C=u.current.range,v=u.current.cell,R=[C.x+C.width-1,C.y+C.height-1];if(v[1]>=x&&R[1]>=x||!l.some(M=>M.sourceIndex===v[0]||M.sourceIndex===R[0]))return;const[$,z]=u.current.cell,B=b(u.current.cell),_=B.span??[$,$],S=z>=x-g,N=g>0&&!S?wo(x,g,w)-1:0,A=R[1];let F;if(Jn(l,o,r,i,f,(M,ne,le,ae,be)=>{if(M.sticky&&$>M.sourceIndex)return;const Ce=M.sourceIndex<_[0],Z=M.sourceIndex>_[1],U=M.sourceIndex===R[0];if(!(!U&&(Ce||Z)))return _r(be,le,n,x,w,g,h,void 0,(Me,J,ue)=>{if(J!==z&&J!==A)return;let fe=ne,G=M.width;if(B.span!==void 0){const xe=ns(B.span,ne,Me,M.width,ue,M,s),qe=M.sticky?xe[0]:xe[1];qe!==void 0&&(fe=qe.x,G=qe.width)}return J===A&&U&&m&&(F=()=>{var xe;ae>fe&&!M.sticky&&(e.beginPath(),e.rect(ae,0,t-ae,n),e.clip()),e.beginPath(),e.rect(fe+G-4,Me+ue-4,4,4),e.fillStyle=((xe=M.themeOverride)==null?void 0:xe.accentColor)??c.accentColor,e.fill()}),F!==void 0}),F!==void 0}),F===void 0)return;const E=()=>{e.save(),e.beginPath(),e.rect(0,f,t,n-f-N),e.clip(),F==null||F(),e.restore()};return E(),E}function Tc(e,t,n,o,r,i,l,s,c){c===void 0||c.size===0||(e.beginPath(),ts(t,n,i,o,(f,u,w,b,g,h)=>{c.hasItemInRectangle({x:f[0],y:-2,width:f[1]-f[0]+1,height:1})&&e.rect(w,b,g,h)}),Jn(t,s,i,l,r,(f,u,w,b)=>{const g=Math.max(0,b-u),h=u+g+1,m=f.width-g-1;c.has([f.sourceIndex,-1])&&e.rect(h,o,m,r-o)}),e.clip())}function Ac(e,t,n,o,r,i,l,s,c,f){let u=0;return Jn(e,i,o,r,n,(w,b,g,h,m)=>(_r(m,g,t,l,s,c,f,void 0,(x,C,v,R)=>{R||(u=Math.max(C,u))}),!0)),u}function pl(e,t){var hn;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:l,cellYOffset:s,translateX:c,translateY:f,mappedColumns:u,enableGroups:w,freezeColumns:b,dragAndDropState:g,theme:h,drawFocus:m,headerHeight:x,groupHeaderHeight:C,disabledRows:v,rowHeight:R,verticalBorder:O,overrideCursor:$,isResizing:z,selection:B,fillHandle:_,freezeTrailingRows:S,rows:N,getCellContent:A,getGroupDetails:F,getRowThemeOverride:E,isFocused:M,drawHeaderCallback:ne,prelightCells:le,drawCellCallback:ae,highlightRegions:be,resizeCol:Ce,imageLoader:Z,lastBlitData:U,hoverValues:Me,hyperWrapping:J,hoverInfo:ue,spriteManager:fe,maxScaleFactor:G,hasAppendRow:pe,touchMode:xe,enqueue:qe,renderStateProvider:Qe,getCellRenderer:ht,renderStrategy:it,bufferACtx:Ye,bufferBCtx:et,damage:Re,minimumCellWidth:vt,resizeIndicator:Ct}=e;if(r===0||i===0)return;const ct=it==="double-buffer",j=Math.min(G,Math.ceil(window.devicePixelRatio??1)),Ee=it!=="direct"&&Hc(e,t),de=n.canvas;(de.width!==r*j||de.height!==i*j)&&(de.width=r*j,de.height=i*j,de.style.width=r+"px",de.style.height=i+"px");const He=o.canvas,ye=w?C+x:x,_e=ye+1;(He.width!==r*j||He.height!==_e*j)&&(He.width=r*j,He.height=_e*j,He.style.width=r+"px",He.style.height=_e+"px");const We=Ye.canvas,Ge=et.canvas;ct&&(We.width!==r*j||We.height!==i*j)&&(We.width=r*j,We.height=i*j,U.current!==void 0&&(U.current.aBufferScroll=void 0)),ct&&(Ge.width!==r*j||Ge.height!==i*j)&&(Ge.width=r*j,Ge.height=i*j,U.current!==void 0&&(U.current.bBufferScroll=void 0));const re=U.current;if(Ee===!0&&l===(re==null?void 0:re.cellXOffset)&&s===(re==null?void 0:re.cellYOffset)&&c===(re==null?void 0:re.translateX)&&f===(re==null?void 0:re.translateY))return;let Fe=null;ct&&(Fe=n);const tt=o;let ze;ct?Re!==void 0?ze=(re==null?void 0:re.lastBuffer)==="b"?et:Ye:ze=(re==null?void 0:re.lastBuffer)==="b"?Ye:et:ze=n;const Ke=ze.canvas,bt=ct?Ke===We?Ge:We:de,je=typeof R=="number"?()=>R:R;tt.save(),ze.save(),tt.beginPath(),ze.beginPath(),tt.textBaseline="middle",ze.textBaseline="middle",j!==1&&(tt.scale(j,j),ze.scale(j,j));const Be=ki(u,l,r,g,c);let kt=[];const St=m&&((hn=B.current)==null?void 0:hn.cell[1])===s&&f===0;let zt=!1;if(be!==void 0){for(const dt of be)if(dt.style!=="no-outline"&&dt.range.y===s&&f===0){zt=!0;break}}const yt=()=>{kc(tt,Be,w,ue,r,c,x,C,g,z,B,h,fe,Me,O,F,Re,ne,xe),wl(tt,Be,s,c,f,r,i,void 0,void 0,C,ye,je,E,O,S,N,h,!0),tt.beginPath(),tt.moveTo(0,_e-.5),tt.lineTo(r,_e-.5),tt.strokeStyle=en(h.headerBottomBorderColor??h.horizontalBorderColor??h.borderColor,h.bgHeader),tt.stroke(),zt&&bl(tt,r,i,l,s,c,f,u,b,x,C,R,S,N,be,h),St&&yi(tt,r,i,s,c,f,Be,u,h,ye,B,je,A,S,pe,_,N)};if(Re!==void 0){const dt=Be[Be.length-1].sourceIndex+1,Lt=Re.hasItemInRegion([{x:l,y:-2,width:dt,height:2},{x:l,y:s,width:dt,height:300},{x:0,y:s,width:b,height:300},{x:0,y:-2,width:b,height:2},{x:l,y:N-S,width:dt,height:S,when:S>0}]),Oe=Ft=>{gl(Ft,Be,u,i,ye,c,f,s,N,je,A,F,E,v,M,m,S,pe,kt,Re,B,le,be,Z,fe,Me,ue,ae,J,h,qe,Qe,ht,$,vt);const Jt=B.current;_&&m&&Jt!==void 0&&Re.has(Ol(Jt.range))&&yi(Ft,r,i,s,c,f,Be,u,h,ye,B,je,A,S,pe,_,N)};Lt&&(Oe(ze),Fe!==null&&(Fe.save(),Fe.scale(j,j),Fe.textBaseline="middle",Oe(Fe),Fe.restore()),Re.hasHeader()&&(Tc(tt,Be,r,C,ye,c,f,s,Re),yt())),ze.restore(),tt.restore();return}if((Ee!==!0||l!==(re==null?void 0:re.cellXOffset)||c!==(re==null?void 0:re.translateX)||St!==(re==null?void 0:re.mustDrawFocusOnHeader)||zt!==(re==null?void 0:re.mustDrawHighlightRingsOnHeader))&&yt(),Ee===!0){Qt(bt!==void 0&&re!==void 0);const{regions:dt}=Fc(ze,bt,bt===We?re.aBufferScroll:re.bBufferScroll,bt===We?re.bBufferScroll:re.aBufferScroll,re,l,s,c,f,S,r,i,N,ye,j,u,Be,R,ct);kt=dt}else Ee!==!1&&(Qt(re!==void 0),kt=Dc(re,l,s,c,f,r,i,ye,Be,Ee));Ec(ze,Be,r,i,S,N,O,je,h);const Mt=bl(ze,r,i,l,s,c,f,u,b,x,C,R,S,N,be,h),At=m?yi(ze,r,i,s,c,f,Be,u,h,ye,B,je,A,S,pe,_,N):void 0;if(ze.fillStyle=h.bgCell,kt.length>0){ze.beginPath();for(const dt of kt)ze.rect(dt.x,dt.y,dt.width,dt.height);ze.clip(),ze.fill(),ze.beginPath()}else ze.fillRect(0,0,r,i);const fn=gl(ze,Be,u,i,ye,c,f,s,N,je,A,F,E,v,M,m,S,pe,kt,Re,B,le,be,Z,fe,Me,ue,ae,J,h,qe,Qe,ht,$,vt);Rc(ze,Be,u,r,i,ye,c,f,s,N,je,E,B.rows,v,S,pe,kt,Re,h),Ic(ze,Be,s,c,f,r,i,kt,ye,je,E,O,S,N,h),wl(ze,Be,s,c,f,r,i,kt,fn,C,ye,je,E,O,S,N,h),Mt==null||Mt(),At==null||At(),z&&Ct!=="none"&&Jn(Be,0,c,0,ye,(dt,Lt)=>dt.sourceIndex===Ce?(yl(tt,Lt+dt.width,0,ye+1,en(h.resizeIndicatorColor??h.accentLight,h.bgHeader)),Ct==="full"&&yl(ze,Lt+dt.width,ye,i,en(h.resizeIndicatorColor??h.accentLight,h.bgCell)),!0):!1),Fe!==null&&(Fe.fillStyle=h.bgCell,Fe.fillRect(0,0,r,i),Fe.drawImage(ze.canvas,0,0));const Ut=Ac(Be,i,ye,c,f,s,N,je,S,pe);Z==null||Z.setWindow({x:l,y:s,width:Be.length,height:Ut-s},b,Array.from({length:S},(dt,Lt)=>N-1-Lt));const lt=re!==void 0&&(l!==re.cellXOffset||c!==re.translateX),Rn=re!==void 0&&(s!==re.cellYOffset||f!==re.translateY);U.current={cellXOffset:l,cellYOffset:s,translateX:c,translateY:f,mustDrawFocusOnHeader:St,mustDrawHighlightRingsOnHeader:zt,lastBuffer:ct?Ke===We?"a":"b":void 0,aBufferScroll:Ke===We?[lt,Rn]:re==null?void 0:re.aBufferScroll,bBufferScroll:Ke===Ge?[lt,Rn]:re==null?void 0:re.bBufferScroll},ze.restore(),tt.restore()}const zc=80;function Bc(e){const t=e-1;return t*t*t+1}class Lc{constructor(t){$e(this,"callback");$e(this,"currentHoveredItem");$e(this,"leavingItems",[]);$e(this,"lastAnimationTime");$e(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>nr(o.item,t.item))||this.leavingItems.push(t)});$e(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>nr(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});$e(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});$e(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});$e(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:Bc(t.hoverAmount)})));$e(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/zc;for(const i of this.leavingItems)i.hoverAmount=cn(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=cn(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});$e(this,"setHovered",t=>{var n;if(!nr((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Pc{constructor(t){$e(this,"fn");$e(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function Li(e){return new Pc(e)}const Wc=Li(()=>window.navigator.userAgent.includes("Firefox")),Xr=Li(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),Yr=Li(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function $c(e){const t=a.useRef([]),n=a.useRef(0),o=a.useRef(e);o.current=e;const r=a.useCallback(()=>{const i=()=>window.requestAnimationFrame(l),l=()=>{const s=t.current.map(zi);t.current=[],o.current(new rr(s)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:l)},[]);return a.useCallback(i=>{t.current.length===0&&r();const l=yn(i[0],i[1]);t.current.includes(l)||t.current.push(l)},[r])}const jn="header",dn="group-header",Gr="out-of-bounds";var zo;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(zo||(zo={}));function cs(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const vl=6,Oc=(e,t)=>{if(e.kind===q.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},Nc=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:l,cellYOffset:s,headerHeight:c,fillHandle:f=!1,groupHeaderHeight:u,rowHeight:w,rows:b,getCellContent:g,getRowThemeOverride:h,onHeaderMenuClick:m,onHeaderIndicatorClick:x,enableGroups:C,isFilling:v,onCanvasFocused:R,onCanvasBlur:O,isFocused:$,selection:z,freezeColumns:B,onContextMenu:_,freezeTrailingRows:S,fixedShadowX:N=!0,fixedShadowY:A=!0,drawFocusRing:F,onMouseDown:E,onMouseUp:M,onMouseMoveRaw:ne,onMouseMove:le,onItemHovered:ae,dragAndDropState:be,firstColAccessible:Ce,onKeyDown:Z,onKeyUp:U,highlightRegions:Me,canvasRef:J,onDragStart:ue,onDragEnd:fe,eventTargetRef:G,isResizing:pe,resizeColumn:xe,isDragging:qe,isDraggable:Qe=!1,allowResize:ht,disabledRows:it,hasAppendRow:Ye,getGroupDetails:et,theme:Re,prelightCells:vt,headerIcons:Ct,verticalBorder:ct,drawCell:j,drawHeader:Ee,onCellFocused:de,onDragOverCell:He,onDrop:ye,onDragLeave:_e,imageWindowLoader:We,smoothScrollX:Ge=!1,smoothScrollY:re=!1,experimental:Fe,getCellRenderer:tt,resizeIndicator:ze="full"}=e,Ke=e.translateX??0,bt=e.translateY??0,je=Math.max(B,Math.min(i.length-1,l)),Be=a.useRef(null),kt=a.useRef(window),St=kt.current,zt=We,yt=a.useRef(),[Mt,At]=a.useState(!1),fn=a.useRef([]),Ut=a.useRef(),[lt,Rn]=a.useState(),[hn,dt]=a.useState(),Lt=a.useRef(null),[Oe,Ft]=a.useState(),[Jt,Ue]=a.useState(!1),Rt=a.useRef(Jt);Rt.current=Jt;const nt=a.useMemo(()=>new wc(Ct,()=>{yo.current=void 0,Qn.current()}),[Ct]),nn=C?u+c:c,Nt=a.useRef(-1),_t=((Fe==null?void 0:Fe.enableFirefoxRescaling)??!1)&&Wc.value,En=((Fe==null?void 0:Fe.enableSafariRescaling)??!1)&&Xr.value;a.useLayoutEffect(()=>{window.devicePixelRatio===1||!_t&&!En||(Nt.current!==-1&&At(!0),window.clearTimeout(Nt.current),Nt.current=window.setTimeout(()=>{At(!1),Nt.current=-1},200))},[s,je,Ke,bt,_t,En]);const gt=xa(i,B),$n=N?Po(gt,be):0,Dt=a.useCallback((k,K,ce)=>{const oe=k.getBoundingClientRect();if(K>=gt.length||ce>=b)return;const V=oe.width/n,te=Si(K,ce,n,o,u,nn,je,s,Ke,bt,b,B,S,gt,w);return V!==1&&(te.x*=V,te.y*=V,te.width*=V,te.height*=V),te.x+=oe.x,te.y+=oe.y,te},[n,o,u,nn,je,s,Ke,bt,b,B,S,gt,w]),Ze=a.useCallback((k,K,ce,oe)=>{const V=k.getBoundingClientRect(),te=V.width/n,Te=(K-V.left)/te,Ae=(ce-V.top)/te,he=5,Ht=ki(gt,je,n,void 0,Ke);let se=0,De=0;oe instanceof MouseEvent&&(se=oe.button,De=oe.buttons);const Ie=Ra(Te,Ht,Ke),ve=Ea(Ae,o,C,c,u,b,w,s,bt,S),Ve=(oe==null?void 0:oe.shiftKey)===!0,Xt=(oe==null?void 0:oe.ctrlKey)===!0,Et=(oe==null?void 0:oe.metaKey)===!0,ln=oe!==void 0&&!(oe instanceof MouseEvent)||(oe==null?void 0:oe.pointerType)==="touch",pt=[Te<0?-1:n<Te?1:0,Ae<nn?-1:o<Ae?1:0];let wt;if(Ie===-1||Ae<0||Te<0||ve===void 0||Te>n||Ae>o){const ot=Te>n?1:Te<0?-1:0,Yt=Ae>o?1:Ae<0?-1:0;let Wt=ot*2,Kn=Yt*2;ot===0&&(Wt=Ie===-1?zo.EndPadding:zo.Center),Yt===0&&(Kn=ve===void 0?zo.EndPadding:zo.Center);let gn=!1;if(Ie===-1&&ve===-1){const Tt=Dt(k,gt.length-1,-1);Qt(Tt!==void 0),gn=K<Tt.x+Tt.width+he}const Je=Te>n&&Te<n+xi()||Ae>o&&Ae<o+xi();wt={kind:Gr,location:[Ie!==-1?Ie:Te<0?0:gt.length-1,ve??b-1],region:[Wt,Kn],shiftKey:Ve,ctrlKey:Xt,metaKey:Et,isEdge:gn,isTouch:ln,button:se,buttons:De,scrollEdge:pt,isMaybeScrollbar:Je}}else if(ve<=-1){let ot=Dt(k,Ie,ve);Qt(ot!==void 0);let Yt=ot!==void 0&&ot.x+ot.width-K<=he;const Wt=Ie-1;K-ot.x<=he&&Wt>=0?(Yt=!0,ot=Dt(k,Wt,ve),Qt(ot!==void 0),wt={kind:C&&ve===-2?dn:jn,location:[Wt,ve],bounds:ot,group:gt[Wt].group??"",isEdge:Yt,shiftKey:Ve,ctrlKey:Xt,metaKey:Et,isTouch:ln,localEventX:K-ot.x,localEventY:ce-ot.y,button:se,buttons:De,scrollEdge:pt}):wt={kind:C&&ve===-2?dn:jn,group:gt[Ie].group??"",location:[Ie,ve],bounds:ot,isEdge:Yt,shiftKey:Ve,ctrlKey:Xt,metaKey:Et,isTouch:ln,localEventX:K-ot.x,localEventY:ce-ot.y,button:se,buttons:De,scrollEdge:pt}}else{const ot=Dt(k,Ie,ve);Qt(ot!==void 0);const Yt=ot!==void 0&&ot.x+ot.width-K<he;let Wt=!1;if(f&&z.current!==void 0){const Kn=Ol(z.current.range),gn=Dt(k,Kn[0],Kn[1]);if(gn!==void 0){const Je=gn.x+gn.width-2,Tt=gn.y+gn.height-2;Wt=Math.abs(Je-K)<vl&&Math.abs(Tt-ce)<vl}}wt={kind:"cell",location:[Ie,ve],bounds:ot,isEdge:Yt,shiftKey:Ve,ctrlKey:Xt,isFillHandle:Wt,metaKey:Et,isTouch:ln,localEventX:K-ot.x,localEventY:ce-ot.y,button:se,buttons:De,scrollEdge:pt}}return wt},[n,gt,je,Ke,o,C,c,u,b,w,s,bt,S,Dt,f,z,nn]),[In]=lt??[],dr=a.useRef(()=>{}),On=a.useRef(lt);On.current=lt;const[Fn,Dn]=a.useMemo(()=>{const k=document.createElement("canvas"),K=document.createElement("canvas");return k.style.display="none",k.style.opacity="0",k.style.position="fixed",K.style.display="none",K.style.opacity="0",K.style.position="fixed",[k.getContext("2d",{alpha:!1}),K.getContext("2d",{alpha:!1})]},[]);a.useLayoutEffect(()=>{if(!(Fn===null||Dn===null))return document.documentElement.append(Fn.canvas),document.documentElement.append(Dn.canvas),()=>{Fn.canvas.remove(),Dn.canvas.remove()}},[Fn,Dn]);const bo=a.useMemo(()=>new Ba,[]),ur=_t&&Mt?1:En&&Mt?2:5,Nn=(Fe==null?void 0:Fe.disableMinimumCellWidth)===!0?1:10,yo=a.useRef(),po=a.useRef(null),vo=a.useRef(null),Co=a.useCallback(()=>{var Te;const k=Be.current,K=Lt.current;if(k===null||K===null||(po.current===null&&(po.current=k.getContext("2d",{alpha:!1}),k.width=0,k.height=0),vo.current===null&&(vo.current=K.getContext("2d",{alpha:!1}),K.width=0,K.height=0),po.current===null||vo.current===null||Fn===null||Dn===null))return;let ce=!1;const oe=Ae=>{ce=!0,Ft(Ae)},V=yo.current,te={headerCanvasCtx:vo.current,canvasCtx:po.current,bufferACtx:Fn,bufferBCtx:Dn,width:n,height:o,cellXOffset:je,cellYOffset:s,translateX:Math.round(Ke),translateY:Math.round(bt),mappedColumns:gt,enableGroups:C,freezeColumns:B,dragAndDropState:be,theme:Re,headerHeight:c,groupHeaderHeight:u,disabledRows:it??rt.empty(),rowHeight:w,verticalBorder:ct,isResizing:pe,resizeCol:xe,isFocused:$,selection:z,fillHandle:f,drawCellCallback:j,hasAppendRow:Ye,overrideCursor:oe,maxScaleFactor:ur,freezeTrailingRows:S,rows:b,drawFocus:F,getCellContent:g,getGroupDetails:et??(Ae=>({name:Ae})),getRowThemeOverride:h,drawHeaderCallback:Ee,prelightCells:vt,highlightRegions:Me,imageLoader:zt,lastBlitData:Ut,damage:yt.current,hoverValues:fn.current,hoverInfo:On.current,spriteManager:nt,scrolling:Mt,hyperWrapping:(Fe==null?void 0:Fe.hyperWrapping)??!1,touchMode:Jt,enqueue:dr.current,renderStateProvider:bo,renderStrategy:(Fe==null?void 0:Fe.renderStrategy)??(Xr.value?"double-buffer":"single-buffer"),getCellRenderer:tt,minimumCellWidth:Nn,resizeIndicator:ze};te.damage===void 0?(yo.current=te,pl(te,V)):pl(te,void 0),!ce&&(te.damage===void 0||te.damage.has((Te=On==null?void 0:On.current)==null?void 0:Te[0]))&&Ft(void 0)},[Fn,Dn,n,o,je,s,Ke,bt,gt,C,B,be,Re,c,u,it,w,ct,pe,Ye,xe,$,z,f,S,b,F,ur,g,et,h,j,Ee,vt,Me,zt,nt,Mt,Fe==null?void 0:Fe.hyperWrapping,Fe==null?void 0:Fe.renderStrategy,Jt,bo,tt,Nn,ze]),Qn=a.useRef(Co);a.useLayoutEffect(()=>{Co(),Qn.current=Co},[Co]),a.useLayoutEffect(()=>{(async()=>{var K;((K=document==null?void 0:document.fonts)==null?void 0:K.ready)!==void 0&&(await document.fonts.ready,yo.current=void 0,Qn.current())})()},[]);const Hn=a.useCallback(k=>{yt.current=k,Qn.current(),yt.current=void 0},[]),Vr=$c(Hn);dr.current=Vr;const fr=a.useCallback(k=>{Hn(new rr(k.map(K=>K.cell)))},[Hn]);zt.setCallback(Hn);const[qr,jr]=a.useState(!1),[eo,Xn]=In??[],Zr=eo!==void 0&&Xn===-1,Jr=eo!==void 0&&Xn===-2;let xo=!1,hr=!1,to=Oe;if(to===void 0&&eo!==void 0&&Xn!==void 0&&Xn>-1&&Xn<b){const k=g([eo,Xn],!0);xo=k.kind===un.NewRow||k.kind===un.Marker&&k.markerKind!=="number",hr=k.kind===q.Boolean&&Ii(k),to=k.cursor}const Wo=qe?"grabbing":(hn??!1)||pe?"col-resize":qr||v?"crosshair":to!==void 0?to:Zr||xo||hr||Jr?"pointer":"default",mt=a.useMemo(()=>({contain:"strict",display:"block",cursor:Wo}),[Wo]),Vt=a.useRef("default"),$o=G==null?void 0:G.current;$o!=null&&Vt.current!==mt.cursor&&($o.style.cursor=Vt.current=mt.cursor);const Tn=a.useCallback((k,K,ce,oe)=>{if(et===void 0)return;const V=et(k);if(V.actions!==void 0){const te=is(K,V.actions);for(const[Te,Ae]of te.entries())if(go(Ae,ce+K.x,oe+Ae.y))return V.actions[Te]}},[et]),An=a.useCallback((k,K,ce,oe)=>{const V=gt[K];if(!qe&&!pe&&!(hn??!1)){const te=Dt(k,K,-1);Qt(te!==void 0);const Te=ls(void 0,V,te.x,te.y,te.width,te.height,Re,Di(V.title)==="rtl");if(V.hasMenu===!0&&Te.menuBounds!==void 0&&go(Te.menuBounds,ce,oe))return{area:"menu",bounds:Te.menuBounds};if(V.indicatorIcon!==void 0&&Te.indicatorIconBounds!==void 0&&go(Te.indicatorIconBounds,ce,oe))return{area:"indicator",bounds:Te.indicatorIconBounds}}},[gt,Dt,hn,qe,pe,Re]),ko=a.useRef(0),Yn=a.useRef(),So=a.useRef(!1),no=a.useCallback(k=>{const K=Be.current,ce=G==null?void 0:G.current;if(K===null||k.target!==K&&k.target!==ce)return;So.current=!0;let oe,V;if(k instanceof MouseEvent?(oe=k.clientX,V=k.clientY):(oe=k.touches[0].clientX,V=k.touches[0].clientY),k.target===ce&&ce!==null){const Te=ce.getBoundingClientRect();if(oe>Te.right||V>Te.bottom)return}const te=Ze(K,oe,V,k);Yn.current=te.location,te.isTouch&&(ko.current=Date.now()),Rt.current!==te.isTouch&&Ue(te.isTouch),!(te.kind===jn&&An(K,te.location[0],oe,V)!==void 0)&&(te.kind===dn&&Tn(te.group,te.bounds,te.localEventX,te.localEventY)!==void 0||(E==null||E(te),!te.isTouch&&Qe!==!0&&Qe!==te.kind&&te.button<3&&te.button!==1&&k.preventDefault()))},[G,Qe,Ze,Tn,An,E]);Bt("touchstart",no,St,!1),Bt("mousedown",no,St,!1);const zn=a.useRef(0),oo=a.useCallback(k=>{var De,Ie;const K=zn.current;zn.current=Date.now();const ce=Be.current;if(So.current=!1,M===void 0||ce===null)return;const oe=G==null?void 0:G.current,V=k.target!==ce&&k.target!==oe;let te,Te,Ae=!0;if(k instanceof MouseEvent){if(te=k.clientX,Te=k.clientY,Ae=k.button<3,k.pointerType==="touch")return}else te=k.changedTouches[0].clientX,Te=k.changedTouches[0].clientY;let he=Ze(ce,te,Te,k);he.isTouch&&ko.current!==0&&Date.now()-ko.current>500&&(he={...he,isLongTouch:!0}),K!==0&&Date.now()-K<(he.isTouch?1e3:500)&&(he={...he,isDoubleClick:!0}),Rt.current!==he.isTouch&&Ue(he.isTouch),!V&&k.cancelable&&Ae&&k.preventDefault();const[Ht]=he.location,se=An(ce,Ht,te,Te);if(he.kind===jn&&se!==void 0){(he.button!==0||((De=Yn.current)==null?void 0:De[0])!==Ht||((Ie=Yn.current)==null?void 0:Ie[1])!==-1)&&M(he,!0);return}else if(he.kind===dn){const ve=Tn(he.group,he.bounds,he.localEventX,he.localEventY);if(ve!==void 0){he.button===0&&ve.onClick(he);return}}M(he,V)},[M,G,Ze,An,Tn]);Bt("mouseup",oo,St,!1),Bt("touchend",oo,St,!1);const ei=a.useCallback(k=>{var Ht,se;const K=Be.current;if(K===null)return;const ce=G==null?void 0:G.current,oe=k.target!==K&&k.target!==ce;let V,te,Te=!0;k instanceof MouseEvent?(V=k.clientX,te=k.clientY,Te=k.button<3):(V=k.changedTouches[0].clientX,te=k.changedTouches[0].clientY);const Ae=Ze(K,V,te,k);Rt.current!==Ae.isTouch&&Ue(Ae.isTouch),!oe&&k.cancelable&&Te&&k.preventDefault();const[he]=Ae.location;if(Ae.kind===jn){const De=An(K,he,V,te);De!==void 0&&Ae.button===0&&((Ht=Yn.current)==null?void 0:Ht[0])===he&&((se=Yn.current)==null?void 0:se[1])===-1&&(De.area==="menu"?m==null||m(he,De.bounds):De.area==="indicator"&&(x==null||x(he,De.bounds)))}else if(Ae.kind===dn){const De=Tn(Ae.group,Ae.bounds,Ae.localEventX,Ae.localEventY);De!==void 0&&Ae.button===0&&De.onClick(Ae)}},[G,Ze,An,m,x,Tn]);Bt("click",ei,St,!1);const gr=a.useCallback(k=>{const K=Be.current,ce=G==null?void 0:G.current;if(K===null||k.target!==K&&k.target!==ce||_===void 0)return;const oe=Ze(K,k.clientX,k.clientY,k);_(oe,()=>{k.cancelable&&k.preventDefault()})},[G,Ze,_]);Bt("contextmenu",gr,(G==null?void 0:G.current)??null,!1);const ke=a.useCallback(k=>{yt.current=new rr(k.map(K=>K.item)),fn.current=k,Qn.current(),yt.current=void 0},[]),Oo=a.useMemo(()=>new Lc(ke),[ke]),mr=a.useRef(Oo);mr.current=Oo,a.useLayoutEffect(()=>{const k=mr.current;if(In===void 0||In[1]<0){k.setHovered(In);return}const K=g(In,!0),ce=tt(K),oe=ce===void 0&&K.kind===q.Custom||(ce==null?void 0:ce.needsHover)!==void 0&&(typeof ce.needsHover=="boolean"?ce.needsHover:ce.needsHover(K));k.setHovered(oe?In:void 0)},[g,tt,In]);const on=a.useRef(),ti=a.useCallback(k=>{var Ae;const K=Be.current;if(K===null)return;const ce=G==null?void 0:G.current,oe=k.target!==K&&k.target!==ce,V=Ze(K,k.clientX,k.clientY,k);if(V.kind!=="out-of-bounds"&&oe&&!So.current&&!V.isTouch)return;const te=(he,Ht)=>{Rn(se=>se===he||(se==null?void 0:se[0][0])===(he==null?void 0:he[0][0])&&(se==null?void 0:se[0][1])===(he==null?void 0:he[0][1])&&((se==null?void 0:se[1][0])===(he==null?void 0:he[1][0])&&(se==null?void 0:se[1][1])===(he==null?void 0:he[1][1])||!Ht)?se:he)};if(!cs(V,on.current))Ft(void 0),ae==null||ae(V),te(V.kind===Gr?void 0:[V.location,[V.localEventX,V.localEventY]],!0),on.current=V;else if(V.kind==="cell"||V.kind===jn||V.kind===dn){let he=!1,Ht=!0;if(V.kind==="cell"){const De=g(V.location);Ht=((Ae=tt(De))==null?void 0:Ae.needsHoverPosition)??De.kind===q.Custom,he=Ht}else he=!0;const se=[V.location,[V.localEventX,V.localEventY]];te(se,Ht),On.current=se,he&&Hn(new rr([V.location]))}const Te=V.location[0]>=(Ce?0:1);dt(V.kind===jn&&V.isEdge&&Te&&ht===!0),jr(V.kind==="cell"&&V.isFillHandle),ne==null||ne(k),le(V)},[G,Ze,Ce,ht,ne,le,ae,g,tt,Hn]);Bt("mousemove",ti,St,!0);const pn=a.useCallback(k=>{const K=Be.current;if(K===null)return;let ce,oe;z.current!==void 0&&(ce=Dt(K,z.current.cell[0],z.current.cell[1]),oe=z.current.cell),Z==null||Z({bounds:ce,stopPropagation:()=>k.stopPropagation(),preventDefault:()=>k.preventDefault(),cancel:()=>{},ctrlKey:k.ctrlKey,metaKey:k.metaKey,shiftKey:k.shiftKey,altKey:k.altKey,key:k.key,keyCode:k.keyCode,rawEvent:k,location:oe})},[Z,z,Dt]),No=a.useCallback(k=>{const K=Be.current;if(K===null)return;let ce,oe;z.current!==void 0&&(ce=Dt(K,z.current.cell[0],z.current.cell[1]),oe=z.current.cell),U==null||U({bounds:ce,stopPropagation:()=>k.stopPropagation(),preventDefault:()=>k.preventDefault(),cancel:()=>{},ctrlKey:k.ctrlKey,metaKey:k.metaKey,shiftKey:k.shiftKey,altKey:k.altKey,key:k.key,keyCode:k.keyCode,rawEvent:k,location:oe})},[U,z,Dt]),wr=a.useCallback(k=>{if(Be.current=k,J!==void 0&&(J.current=k),k===null)kt.current=window;else{const K=k.getRootNode();K===document&&(kt.current=window),kt.current=K}},[J]),br=a.useCallback(k=>{const K=Be.current;if(K===null||Qe===!1||pe){k.preventDefault();return}let ce,oe;const V=Ze(K,k.clientX,k.clientY);if(Qe!==!0&&V.kind!==Qe){k.preventDefault();return}const te=(De,Ie)=>{ce=De,oe=Ie};let Te,Ae,he;const Ht=(De,Ie,ve)=>{Te=De,Ae=Ie,he=ve};let se=!1;if(ue==null||ue({...V,setData:te,setDragImage:Ht,preventDefault:()=>se=!0,defaultPrevented:()=>se}),!se&&ce!==void 0&&oe!==void 0&&k.dataTransfer!==null)if(k.dataTransfer.setData(ce,oe),k.dataTransfer.effectAllowed="copyLink",Te!==void 0&&Ae!==void 0&&he!==void 0)k.dataTransfer.setDragImage(Te,Ae,he);else{const[De,Ie]=V.location;if(Ie!==void 0){const ve=document.createElement("canvas"),Ve=Dt(K,De,Ie);Qt(Ve!==void 0);const Xt=Math.ceil(window.devicePixelRatio??1);ve.width=Ve.width*Xt,ve.height=Ve.height*Xt;const Et=ve.getContext("2d");Et!==null&&(Et.scale(Xt,Xt),Et.textBaseline="middle",Ie===-1?(Et.font=Re.headerFontFull,Et.fillStyle=Re.bgHeader,Et.fillRect(0,0,ve.width,ve.height),ss(Et,0,0,Ve.width,Ve.height,gt[De],!1,Re,!1,void 0,void 0,!1,0,nt,Ee,!1)):(Et.font=Re.baseFontFull,Et.fillStyle=Re.bgCell,Et.fillRect(0,0,ve.width,ve.height),rs(Et,g([De,Ie]),0,Ie,!1,!1,0,0,Ve.width,Ve.height,!1,Re,Re.bgCell,zt,nt,1,void 0,!1,0,void 0,void 0,void 0,bo,tt,()=>{}))),ve.style.left="-100%",ve.style.position="absolute",ve.style.width=`${Ve.width}px`,ve.style.height=`${Ve.height}px`,document.body.append(ve),k.dataTransfer.setDragImage(ve,Ve.width/2,Ve.height/2),window.setTimeout(()=>{ve.remove()},0)}}else k.preventDefault()},[Qe,pe,Ze,ue,Dt,Re,gt,nt,Ee,g,zt,bo,tt]);Bt("dragstart",br,(G==null?void 0:G.current)??null,!1,!1);const Xo=a.useRef(),ni=a.useCallback(k=>{const K=Be.current;if(ye!==void 0&&k.preventDefault(),K===null||He===void 0)return;const ce=Ze(K,k.clientX,k.clientY),[oe,V]=ce.location,te=oe-(Ce?0:1),[Te,Ae]=Xo.current??[];(Te!==te||Ae!==V)&&(Xo.current=[te,V],He([te,V],k.dataTransfer))},[Ce,Ze,He,ye]);Bt("dragover",ni,(G==null?void 0:G.current)??null,!1,!1);const vn=a.useCallback(()=>{Xo.current=void 0,fe==null||fe()},[fe]);Bt("dragend",vn,(G==null?void 0:G.current)??null,!1,!1);const Gn=a.useCallback(k=>{const K=Be.current;if(K===null||ye===void 0)return;k.preventDefault();const ce=Ze(K,k.clientX,k.clientY),[oe,V]=ce.location,te=oe-(Ce?0:1);ye([te,V],k.dataTransfer)},[Ce,Ze,ye]);Bt("drop",Gn,(G==null?void 0:G.current)??null,!1,!1);const rn=a.useCallback(()=>{_e==null||_e()},[_e]);Bt("dragleave",rn,(G==null?void 0:G.current)??null,!1,!1);const H=a.useRef(z);H.current=z;const at=a.useRef(null),Bn=a.useCallback(k=>{var K;Be.current===null||!Be.current.contains(document.activeElement)||(k===null&&H.current.current!==void 0?(K=J==null?void 0:J.current)==null||K.focus({preventScroll:!0}):k!==null&&k.focus({preventScroll:!0}),at.current=k)},[J]);a.useImperativeHandle(t,()=>({focus:()=>{var K;const k=at.current;k===null||!document.contains(k)?(K=J==null?void 0:J.current)==null||K.focus({preventScroll:!0}):k.focus({preventScroll:!0})},getBounds:(k,K)=>{if(!(J===void 0||J.current===null))return Dt(J.current,k??0,K??-1)},damage:fr}),[J,fr,Dt]);const Yo=a.useRef(),yr=ca(()=>{var Ae,he,Ht;if(n<50||(Fe==null?void 0:Fe.disableAccessibilityTree)===!0)return null;let k=ki(gt,je,n,be,Ke);const K=Ce?0:-1;!Ce&&((Ae=k[0])==null?void 0:Ae.sourceIndex)===0&&(k=k.slice(1));const[ce,oe]=((he=z.current)==null?void 0:he.cell)??[],V=(Ht=z.current)==null?void 0:Ht.range,te=k.map(se=>se.sourceIndex),Te=ho(s,Math.min(b,s+r));return ce!==void 0&&oe!==void 0&&!(te.includes(ce)&&Te.includes(oe))&&Bn(null),a.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":b+1,"aria-multiselectable":"true","aria-colcount":gt.length+K},a.createElement("thead",{role:"rowgroup"},a.createElement("tr",{role:"row","aria-rowindex":1},k.map(se=>a.createElement("th",{role:"columnheader","aria-selected":z.columns.hasIndex(se.sourceIndex),"aria-colindex":se.sourceIndex+1+K,tabIndex:-1,onFocus:De=>{if(De.target!==at.current)return de==null?void 0:de([se.sourceIndex,-1])},key:se.sourceIndex},se.title)))),a.createElement("tbody",{role:"rowgroup"},Te.map(se=>a.createElement("tr",{role:"row","aria-selected":z.rows.hasIndex(se),key:se,"aria-rowindex":se+2},k.map(De=>{const Ie=De.sourceIndex,ve=yn(Ie,se),Ve=ce===Ie&&oe===se,Xt=V!==void 0&&Ie>=V.x&&Ie<V.x+V.width&&se>=V.y&&se<V.y+V.height,Et=`glide-cell-${Ie}-${se}`,ln=[Ie,se],pt=g(ln,!0);return a.createElement("td",{key:ve,role:"gridcell","aria-colindex":Ie+1+K,"aria-selected":Xt,"aria-readonly":Ao(pt)||!tr(pt),id:Et,"data-testid":Et,onClick:()=>{const wt=J==null?void 0:J.current;if(wt!=null)return Z==null?void 0:Z({bounds:Dt(wt,Ie,se),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:ln})},onFocusCapture:wt=>{var ot,Yt;if(!(wt.target===at.current||((ot=Yo.current)==null?void 0:ot[0])===Ie&&((Yt=Yo.current)==null?void 0:Yt[1])===se))return Yo.current=ln,de==null?void 0:de(ln)},ref:Ve?Bn:void 0,tabIndex:-1},Oc(pt,tt))})))))},[n,gt,je,be,Ke,b,s,r,z,Bn,g,J,Z,Dt,de],200),Mo=B===0||!N?0:je>B?1:cn(-Ke/100,0,1),oi=-s*32+bt,Go=A?cn(-oi/100,0,1):0,L=a.useMemo(()=>{if(!Mo&&!Go)return null;const k={position:"absolute",top:0,left:$n,width:n-$n,height:o,opacity:Mo,pointerEvents:"none",transition:Ge?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},K={position:"absolute",top:nn,left:0,width:n,height:o,opacity:Go,pointerEvents:"none",transition:re?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return a.createElement(a.Fragment,null,Mo>0&&a.createElement("div",{id:"shadow-x",style:k}),Go>0&&a.createElement("div",{id:"shadow-y",style:K}))},[Mo,Go,$n,n,Ge,nn,o,re]),Pt=a.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return a.createElement(a.Fragment,null,a.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:pn,onKeyUp:No,onFocus:R,onBlur:O,ref:wr,style:mt},yr),a.createElement("canvas",{ref:Lt,style:Pt}),L)},Xc=a.memo(a.forwardRef(Nc));function er(e,t,n,o){return cn(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const Yc=e=>{const[t,n]=a.useState(),[o,r]=a.useState(),[i,l]=a.useState(),[s,c]=a.useState(),[f,u]=a.useState(!1),[w,b]=a.useState(),[g,h]=a.useState(),[m,x]=a.useState(),[C,v]=a.useState(!1),[R,O]=a.useState(),{onHeaderMenuClick:$,onHeaderIndicatorClick:z,getCellContent:B,onColumnMoved:_,onColumnResize:S,onColumnResizeStart:N,onColumnResizeEnd:A,gridRef:F,maxColumnWidth:E,minColumnWidth:M,onRowMoved:ne,lockColumns:le,onColumnProposeMove:ae,onMouseDown:be,onMouseUp:Ce,onItemHovered:Z,onDragStart:U,canvasRef:Me}=e,J=(S??A??N)!==void 0,{columns:ue,selection:fe}=e,G=fe.columns,pe=a.useCallback(j=>{const[Ee,de]=j.location;i!==void 0&&s!==Ee&&Ee>=le?(u(!0),c(Ee)):g!==void 0&&de!==void 0?(v(!0),x(Math.max(0,de))):o===void 0&&!f&&!C&&(Z==null||Z(j))},[i,g,s,Z,le,o,f,C]),xe=_!==void 0,qe=a.useCallback(j=>{var Ee;if(j.button===0){const[de,He]=j.location;if(j.kind==="out-of-bounds"&&j.isEdge&&J){const ye=(Ee=F==null?void 0:F.current)==null?void 0:Ee.getBounds(ue.length-1,-1);ye!==void 0&&(n(ye.x),r(ue.length-1))}else if(j.kind==="header"&&de>=le){const ye=Me==null?void 0:Me.current;if(j.isEdge&&J&&ye){n(j.bounds.x),r(de);const We=ye.getBoundingClientRect().width/ye.offsetWidth,Ge=j.bounds.width/We;N==null||N(ue[de],Ge,de,Ge+(ue[de].growOffset??0))}else j.kind==="header"&&xe&&(b(j.bounds.x),l(de))}else j.kind==="cell"&&le>0&&de===0&&He!==void 0&&ne!==void 0&&(O(j.bounds.y),h(He))}be==null||be(j)},[be,J,le,ne,F,ue,xe,N,Me]),Qe=a.useCallback((j,Ee)=>{f||C||$==null||$(j,Ee)},[f,C,$]),ht=a.useCallback((j,Ee)=>{f||C||z==null||z(j,Ee)},[f,C,z]),it=a.useRef(-1),Ye=a.useCallback(()=>{it.current=-1,h(void 0),x(void 0),O(void 0),v(!1),l(void 0),c(void 0),b(void 0),u(!1),r(void 0),n(void 0)},[]),et=a.useCallback((j,Ee)=>{if(j.button===0){if(o!==void 0){if((G==null?void 0:G.hasIndex(o))===!0)for(const He of G){if(He===o)continue;const ye=ue[He],_e=er(ye,it.current,M,E);S==null||S(ye,_e,He,_e+(ye.growOffset??0))}const de=er(ue[o],it.current,M,E);if(A==null||A(ue[o],de,o,de+(ue[o].growOffset??0)),G.hasIndex(o))for(const He of G){if(He===o)continue;const ye=ue[He],_e=er(ye,it.current,M,E);A==null||A(ye,_e,He,_e+(ye.growOffset??0))}}Ye(),i!==void 0&&s!==void 0&&(_==null||_(i,s)),g!==void 0&&m!==void 0&&(ne==null||ne(g,m))}Ce==null||Ce(j,Ee)},[Ce,o,i,s,g,m,G,A,ue,M,E,S,_,ne,Ye]),Re=a.useMemo(()=>{if(!(i===void 0||s===void 0)&&i!==s&&(ae==null?void 0:ae(i,s))!==!1)return{src:i,dest:s}},[i,s,ae]),vt=a.useCallback(j=>{const Ee=Me==null?void 0:Me.current;if(i!==void 0&&w!==void 0)Math.abs(j.clientX-w)>20&&u(!0);else if(g!==void 0&&R!==void 0)Math.abs(j.clientY-R)>20&&v(!0);else if(o!==void 0&&t!==void 0&&Ee){const He=Ee.getBoundingClientRect().width/Ee.offsetWidth,ye=(j.clientX-t)/He,_e=ue[o],We=er(_e,ye,M,E);if(S==null||S(_e,We,o,We+(_e.growOffset??0)),it.current=ye,(G==null?void 0:G.first())===o)for(const Ge of G){if(Ge===o)continue;const re=ue[Ge],Fe=er(re,it.current,M,E);S==null||S(re,Fe,Ge,Fe+(re.growOffset??0))}}},[i,w,g,R,o,t,ue,M,E,S,G,Me]),Ct=a.useCallback((j,Ee)=>{if(g===void 0||m===void 0)return B(j,Ee);let[de,He]=j;return He===m?He=g:(He>m&&(He-=1),He>=g&&(He+=1)),B([de,He],Ee)},[g,m,B]),ct=a.useCallback(j=>{U==null||U(j),j.defaultPrevented()||Ye()},[Ye,U]);return a.createElement(Xc,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:Ct,isResizing:o!==void 0,onHeaderMenuClick:Qe,onHeaderIndicatorClick:ht,isDragging:f,onItemHovered:pe,onDragStart:ct,onMouseDown:qe,allowResize:J,onMouseUp:et,dragAndDropState:Re,onMouseMoveRaw:vt,ref:F})},Gc=Yc;function Kc(e){const t=a.useRef(null),[n,o]=a.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return a.useLayoutEffect(()=>{const r=l=>{for(const s of l){const{width:c,height:f}=s&&s.contentRect||{};o(u=>u.width===c&&u.height===f?u:{width:c,height:f})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const Uc=(e,t,n)=>{const o=a.useRef(null),r=a.useRef(null),i=a.useRef(null),l=a.useRef(0),s=a.useRef(t);s.current=t;const c=n.current;a.useEffect(()=>{const f=()=>{var b,g;if(r.current===!1&&c!==null){const h=[c.scrollLeft,c.scrollTop];if(((b=i.current)==null?void 0:b[0])===h[0]&&((g=i.current)==null?void 0:g[1])===h[1])if(l.current>10){i.current=null,r.current=null;return}else l.current++;else l.current=0,s.current(h[0],h[1]),i.current=h;o.current=window.setTimeout(f,8.333333333333334)}},u=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},w=b=>{b.touches.length===0&&(r.current=!1,l.current=0,o.current=window.setTimeout(f,8.333333333333334))};if(e&&c!==null){const b=c;return b.addEventListener("touchstart",u),b.addEventListener("touchend",w),()=>{b.removeEventListener("touchstart",u),b.removeEventListener("touchend",w),o.current!==null&&window.clearTimeout(o.current)}}},[e,c])},_c=Uc,Vc=()=>e=>e.isSafari?"scroll":"auto",qc=tn("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[Vc()]}});function jc(e){const[t,n]=a.useState(!1),o=typeof window>"u"?null:window,r=a.useRef(0);return Bt("touchstart",a.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),Bt("touchend",a.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const Zc=e=>{var J,ue;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:l,className:s,preventDiagonalScrolling:c=!1,paddingBottom:f=0,paddingRight:u=0,rightElement:w,rightElementProps:b,kineticScrollPerfHack:g=!1,scrollRef:h,initialSize:m}=e,x=[],C=(b==null?void 0:b.sticky)??!1,v=(b==null?void 0:b.fill)??!1,R=a.useRef(0),O=a.useRef(0),$=a.useRef(null),z=typeof window>"u"?1:window.devicePixelRatio,B=a.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),_=a.useRef(null),S=jc(200),[N,A]=a.useState(!0),F=a.useRef(0);a.useLayoutEffect(()=>{if(!N||S||B.current.lockDirection===void 0)return;const fe=$.current;if(fe===null)return;const[G,pe]=B.current.lockDirection;G!==void 0?fe.scrollLeft=G:pe!==void 0&&(fe.scrollTop=pe),B.current.lockDirection=void 0},[S,N]);const E=a.useCallback((fe,G)=>{var ct;const pe=$.current;if(pe===null)return;G=G??pe.scrollTop,fe=fe??pe.scrollLeft;const xe=B.current.scrollTop,qe=B.current.scrollLeft,Qe=fe-qe,ht=G-xe;S&&Qe!==0&&ht!==0&&(Math.abs(Qe)>3||Math.abs(ht)>3)&&c&&B.current.lockDirection===void 0&&(B.current.lockDirection=Math.abs(Qe)<Math.abs(ht)?[qe,void 0]:[void 0,xe]);const it=B.current.lockDirection;fe=(it==null?void 0:it[0])??fe,G=(it==null?void 0:it[1])??G,B.current.scrollLeft=fe,B.current.scrollTop=G;const Ye=pe.clientWidth,et=pe.clientHeight,Re=G,vt=O.current-Re,Ct=pe.scrollHeight-et;if(O.current=Re,Ct>0&&(Math.abs(vt)>2e3||Re===0||Re===Ct)&&o>pe.scrollHeight+5){const j=Re/Ct,Ee=(o-et)*j;R.current=Ee-Re}it!==void 0&&(window.clearTimeout(F.current),A(!1),F.current=window.setTimeout(()=>A(!0),200)),i({x:fe,y:Re+R.current,width:Ye-u,height:et-f,paddingRight:((ct=_.current)==null?void 0:ct.clientWidth)??0})},[f,u,o,i,c,S]);_c(g&&Xr.value,E,$);const M=a.useRef(E);M.current=E;const ne=a.useRef(),le=a.useRef(!1);a.useLayoutEffect(()=>{le.current?E():le.current=!0},[E,f,u]);const ae=a.useCallback(fe=>{$.current=fe,h!==void 0&&(h.current=fe)},[h]);let be=0,Ce=0;for(x.push(a.createElement("div",{key:be++,style:{width:r,height:0}}));Ce<o;){const fe=Math.min(5e6,o-Ce);x.push(a.createElement("div",{key:be++,style:{width:0,height:fe}})),Ce+=fe}const{ref:Z,width:U,height:Me}=Kc(m);return typeof window<"u"&&(((J=ne.current)==null?void 0:J.height)!==Me||((ue=ne.current)==null?void 0:ue.width)!==U)&&(window.setTimeout(()=>M.current(),0),ne.current={width:U,height:Me}),(U??0)===0||(Me??0)===0?a.createElement("div",{ref:Z}):a.createElement("div",{ref:Z},a.createElement(qc,{isSafari:Xr.value},a.createElement("div",{className:"dvn-underlay"},t),a.createElement("div",{ref:ae,style:ne.current,draggable:l,onDragStart:fe=>{l||(fe.stopPropagation(),fe.preventDefault())},className:"dvn-scroller "+(s??""),onScroll:()=>E()},a.createElement("div",{className:"dvn-scroll-inner"+(w===void 0?" dvn-hidden":"")},a.createElement("div",{className:"dvn-stack"},x),w!==void 0&&a.createElement(a.Fragment,null,!v&&a.createElement("div",{className:"dvn-spacer"}),a.createElement("div",{ref:_,style:{height:Me,maxHeight:n-Math.ceil(z%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:u,flexGrow:v?1:void 0,right:C?u??0:void 0,pointerEvents:"auto"}},w))))))},Jc=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:l,freezeColumns:s,experimental:c,nonGrowWidth:f,clientSize:u,className:w,onVisibleRegionChanged:b,scrollRef:g,preventDiagonalScrolling:h,rightElement:m,rightElementProps:x,overscrollX:C,overscrollY:v,initialSize:R,smoothScrollX:O=!1,smoothScrollY:$=!1,isDraggable:z}=e,{paddingRight:B,paddingBottom:_}=c??{},[S,N]=u,A=a.useRef(),F=a.useRef(),E=a.useRef(),M=a.useRef(),ne=f+Math.max(0,C??0);let le=l?r+i:r;if(typeof o=="number")le+=n*o;else for(let Z=0;Z<n;Z++)le+=o(Z);v!==void 0&&(le+=v);const ae=a.useRef(),be=a.useCallback(()=>{var ht,it;if(ae.current===void 0)return;const Z={...ae.current};let U=0,Me=Z.x<0?-Z.x:0,J=0,ue=0;Z.x=Z.x<0?0:Z.x;let fe=0;for(let Ye=0;Ye<s;Ye++)fe+=t[Ye].width;for(const Ye of t){const et=U-fe;if(Z.x>=et+Ye.width)U+=Ye.width,ue++,J++;else if(Z.x>et)U+=Ye.width,O?Me+=et-Z.x:ue++,J++;else if(Z.x+Z.width>et)U+=Ye.width,J++;else break}let G=0,pe=0,xe=0;if(typeof o=="number")$?(pe=Math.floor(Z.y/o),G=pe*o-Z.y):pe=Math.ceil(Z.y/o),xe=Math.ceil(Z.height/o)+pe,G<0&&xe++;else{let Ye=0;for(let et=0;et<n;et++){const Re=o(et),vt=Ye+($?0:Re/2);if(Z.y>=Ye+Re)Ye+=Re,pe++,xe++;else if(Z.y>vt)Ye+=Re,$?G+=vt-Z.y:pe++,xe++;else if(Z.y+Z.height>Re/2+Ye)Ye+=Re,xe++;else break}}const qe={x:ue,y:pe,width:J-ue,height:xe-pe},Qe=A.current;(Qe===void 0||Qe.y!==qe.y||Qe.x!==qe.x||Qe.height!==qe.height||Qe.width!==qe.width||F.current!==Me||E.current!==G||Z.width!==((ht=M.current)==null?void 0:ht[0])||Z.height!==((it=M.current)==null?void 0:it[1]))&&(b==null||b({x:ue,y:pe,width:J-ue,height:xe-pe},Z.width,Z.height,Z.paddingRight??0,Me,G),A.current=qe,F.current=Me,E.current=G,M.current=[Z.width,Z.height])},[t,o,n,b,s,O,$]),Ce=a.useCallback(Z=>{ae.current=Z,be()},[be]);return a.useEffect(()=>{be()},[be]),a.createElement(Zc,{scrollRef:g,className:w,kineticScrollPerfHack:c==null?void 0:c.kineticScrollPerfHack,preventDiagonalScrolling:h,draggable:z===!0||typeof z=="string",scrollWidth:ne+(B??0),scrollHeight:le+(_??0),clientHeight:N,rightElement:m,paddingBottom:_,paddingRight:B,rightElementProps:x,update:Ce,initialSize:R},a.createElement(Gc,{eventTargetRef:g,width:S,height:N,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},Qc=Jc,ed=tn("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),td=a.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},a.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),nd=a.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},a.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),od=a.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},a.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),rd=10,id=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:l,searchResults:s,onSearchValueChange:c,getCellsForSelection:f,onSearchResultsChanged:u,showSearch:w=!1,onSearchClose:b}=e,[g]=a.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[h,m]=a.useState(""),x=l??h,C=a.useCallback(U=>{m(U),c==null||c(U)},[c]),[v,R]=a.useState(),O=a.useRef(v);O.current=v,a.useEffect(()=>{s!==void 0&&(s.length>0?R(U=>({rowsSearched:o,results:s.length,selectedIndex:(U==null?void 0:U.selectedIndex)??-1})):R(void 0))},[o,s]);const $=a.useRef();$.current===void 0&&($.current=new AbortController);const z=a.useRef(),[B,_]=a.useState([]),S=s??B,N=a.useCallback(()=>{z.current!==void 0&&(window.cancelAnimationFrame(z.current),z.current=void 0,$.current.abort())},[]),A=a.useRef(n);A.current=n;const F=a.useCallback(U=>{const Me=new RegExp(U.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let J=A.current,ue=Math.min(10,o),fe=0;R(void 0),_([]);const G=[],pe=async()=>{var Ct;if(f===void 0)return;const xe=performance.now(),qe=o-fe;let Qe=f({x:0,y:J,width:r.length,height:Math.min(ue,qe,o-J)},$.current.signal);typeof Qe=="function"&&(Qe=await Qe());let ht=!1;for(const[ct,j]of Qe.entries())for(const[Ee,de]of j.entries()){let He;switch(de.kind){case q.Text:case q.Number:He=de.displayData;break;case q.Uri:case q.Markdown:He=de.data;break;case q.Boolean:He=typeof de.data=="boolean"?de.data.toString():void 0;break;case q.Image:case q.Bubble:He=de.data.join("🐳");break;case q.Custom:He=de.copyData;break}He!==void 0&&Me.test(He)&&(G.push([Ee,ct+J]),ht=!0)}const it=performance.now();ht&&_([...G]),fe+=Qe.length,Qt(fe<=o);const Ye=((Ct=O.current)==null?void 0:Ct.selectedIndex)??-1;R({results:G.length,rowsSearched:fe,selectedIndex:Ye}),u==null||u(G,Ye),J+ue>=o?J=0:J+=ue;const et=it-xe,Re=Math.max(et,1),vt=rd/Re;ue=Math.ceil(ue*vt),fe<o&&G.length<1e3&&(z.current=window.requestAnimationFrame(pe))};N(),z.current=window.requestAnimationFrame(pe)},[N,r.length,f,u,o]),E=a.useCallback(()=>{var U;b==null||b(),R(void 0),_([]),u==null||u([],-1),N(),(U=t==null?void 0:t.current)==null||U.focus()},[N,t,b,u]),M=a.useCallback(U=>{C(U.target.value),s===void 0&&(U.target.value===""?(R(void 0),_([]),N()):F(U.target.value))},[F,N,C,s]);a.useEffect(()=>{w&&i.current!==null&&(C(""),i.current.focus({preventScroll:!0}))},[w,i,C]);const ne=a.useCallback(U=>{var J;if((J=U==null?void 0:U.stopPropagation)==null||J.call(U),v===void 0)return;const Me=(v.selectedIndex+1)%v.results;R({...v,selectedIndex:Me}),u==null||u(S,Me)},[v,u,S]),le=a.useCallback(U=>{var J;if((J=U==null?void 0:U.stopPropagation)==null||J.call(U),v===void 0)return;let Me=(v.selectedIndex-1)%v.results;Me<0&&(Me+=v.results),R({...v,selectedIndex:Me}),u==null||u(S,Me)},[u,S,v]),ae=a.useCallback(U=>{(U.ctrlKey||U.metaKey)&&U.nativeEvent.code==="KeyF"||U.key==="Escape"?(E(),U.stopPropagation(),U.preventDefault()):U.key==="Enter"&&(U.shiftKey?le():ne())},[E,ne,le]);a.useEffect(()=>()=>{N()},[N]);const[be,Ce]=a.useState(!1);a.useEffect(()=>{if(w)Ce(!0);else{const U=setTimeout(()=>Ce(!1),150);return()=>clearTimeout(U)}},[w]);const Z=a.useMemo(()=>{if(!w&&!be)return null;let U;v!==void 0&&(U=v.results>=1e3?"over 1000":`${v.results} result${v.results!==1?"s":""}`,v.selectedIndex>=0&&(U=`${v.selectedIndex+1} of ${U}`));const Me=fe=>{fe.stopPropagation()},ue={width:`${Math.floor(((v==null?void 0:v.rowsSearched)??0)/o*100)}%`};return a.createElement(ed,{className:w?"":"out",onMouseDown:Me,onMouseMove:Me,onMouseUp:Me,onClick:Me},a.createElement("div",{className:"gdg-search-bar-inner"},a.createElement("input",{id:g,"aria-hidden":!w,"data-testid":"search-input",ref:i,onChange:M,value:x,tabIndex:w?void 0:-1,onKeyDownCapture:ae}),a.createElement("button",{"aria-label":"Previous Result","aria-hidden":!w,tabIndex:w?void 0:-1,onClick:le,disabled:((v==null?void 0:v.results)??0)===0},td),a.createElement("button",{"aria-label":"Next Result","aria-hidden":!w,tabIndex:w?void 0:-1,onClick:ne,disabled:((v==null?void 0:v.results)??0)===0},nd),b!==void 0&&a.createElement("button",{"aria-label":"Close Search","aria-hidden":!w,"data-testid":"search-close-button",tabIndex:w?void 0:-1,onClick:E},od)),v!==void 0?a.createElement(a.Fragment,null,a.createElement("div",{className:"gdg-search-status"},a.createElement("div",{"data-testid":"search-result-area"},U)),a.createElement("div",{className:"gdg-search-progress",style:ue})):a.createElement("div",{className:"gdg-search-status"},a.createElement("label",{htmlFor:g},"Type to search")))},[w,be,v,o,g,i,M,x,ae,le,ne,b,E]);return a.createElement(a.Fragment,null,a.createElement(Qc,{prelightCells:S,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),Z)},ld=id;class sd extends a.PureComponent{constructor(){super(...arguments);$e(this,"wrapperRef",a.createRef());$e(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){document.addEventListener("touchend",this.clickOutside,!0),document.addEventListener("mousedown",this.clickOutside,!0),document.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){document.removeEventListener("touchend",this.clickOutside,!0),document.removeEventListener("mousedown",this.clickOutside,!0),document.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,...r}=this.props;return a.createElement("div",{...r,ref:this.wrapperRef},this.props.children)}}const ad=()=>e=>Math.max(16,e.targetHeight-10),cd=tn("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[ad(),"px"]}}),dd=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[l,s]=xt.useState(n);return xt.createElement(sd,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},xt.createElement(cd,{targetHeight:t.height,"data-testid":"group-rename-input",value:l,onBlur:o,onFocus:c=>c.target.setSelectionRange(0,l.length),onChange:c=>s(c.target.value),onKeyDown:c=>{c.key==="Enter"?i(l):c.key==="Escape"&&o()},autoFocus:!0}))};function ud(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function Le(e,t,n){const o=ds(e,t);return o&&(n.didMatch=!0),o}function ds(e,t){if(e.length===0)return!1;if(e.includes("|")){const c=e.split("|");for(const f of c)if(ds(f,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const l=e.split("+"),s=l.pop();if(!ud(s,t))return!1;if(l[0]==="any")return!0;for(const c of l)switch(c){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":Yr.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function fd(e,t,n,o,r,i,l){const s=xt.useCallback((u,w,b,g)=>{var R;(i==="cell"||i==="multi-cell")&&u!==void 0&&(u={...u,range:{x:u.cell[0],y:u.cell[1],width:1,height:1}}),!l&&u!==void 0&&u.range.width>1&&(u={...u,range:{...u.range,width:1,x:u.cell[0]}});const h=n==="mixed"&&(b||g==="drag"),m=o==="mixed"&&h,x=r==="mixed"&&h;let C={current:u===void 0?void 0:{...u,rangeStack:g==="drag"?((R=e.current)==null?void 0:R.rangeStack)??[]:[]},columns:m?e.columns:rt.empty(),rows:x?e.rows:rt.empty()};b&&(i==="multi-rect"||i==="multi-cell")&&C.current!==void 0&&e.current!==void 0&&(C={...C,current:{...C.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(C,w)},[o,e,n,i,l,r,t]),c=xt.useCallback((u,w,b)=>{u=u??e.rows,w!==void 0&&(u=u.add(w));let g;if(r==="exclusive"&&u.length>0)g={current:void 0,columns:rt.empty(),rows:u};else{const h=b&&n==="mixed",m=b&&o==="mixed";g={current:h?e.current:void 0,columns:m?e.columns:rt.empty(),rows:u}}t(g,!1)},[o,e,n,r,t]),f=xt.useCallback((u,w,b)=>{u=u??e.columns,w!==void 0&&(u=u.add(w));let g;if(o==="exclusive"&&u.length>0)g={current:void 0,rows:rt.empty(),columns:u};else{const h=b&&n==="mixed",m=b&&r==="mixed";g={current:h?e.current:void 0,rows:m?e.rows:rt.empty(),columns:u}}t(g,!1)},[o,e,n,r,t]);return[s,c,f]}function hd(e,t,n,o,r){const i=a.useCallback(f=>{if(e===!0){const u=[];for(let w=f.y;w<f.y+f.height;w++){const b=[];for(let g=f.x;g<f.x+f.width;g++)g<0||w>=r?b.push({kind:q.Loading,allowOverlay:!1}):b.push(t([g,w]));u.push(b)}return u}return(e==null?void 0:e(f,o.signal))??[]},[o.signal,t,e,r]),l=e!==void 0?i:void 0,s=a.useCallback(f=>{if(l===void 0)return[];const u={...f,x:f.x-n};if(u.x<0){u.x=0,u.width--;const w=l(u,o.signal);return typeof w=="function"?async()=>(await w()).map(b=>[{kind:q.Loading,allowOverlay:!1},...b]):w.map(b=>[{kind:q.Loading,allowOverlay:!1},...b])}return l(u,o.signal)},[o.signal,l,n]);return[e!==void 0?s:void 0,l]}function gd(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string"};switch(e.kind){case q.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Ei?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case q.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case q.Image:case q.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case q.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case q.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case q.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case q.Markdown:case q.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case q.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case q.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case q.Protected:return{formatted:"************",rawValue:"",format:"string"};default:lr()}}function md(e,t){return e.map((o,r)=>{const i=t[r];return o.map(l=>l.span!==void 0&&l.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:gd(l))})}function Cl(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function wd(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(l=>Cl(l,!0)).join(",")):r.push(Cl(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function pi(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function xl(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function bd(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function yd(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${pi(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((l,s)=>`<li gdg-raw-value=${xl(r.rawValue[s])}>`+pi(l)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${xl(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${pi(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function pd(e,t){const n=md(e,t),o=wd(n),r=yd(n);return{textPlain:o,textHtml:r}}function kl(e){var l;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const s=o.pop();if(s===void 0)break;if(s instanceof HTMLTableElement||s.nodeName==="TBODY")o.push(...[...s.children].reverse());else if(s instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...s.children].reverse());else if(s instanceof HTMLTableCellElement){const c=s.cloneNode(!0),u=c.children.length===1&&c.children[0].nodeName==="P"?c.children[0]:null,w=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",b=c.querySelectorAll("br");for(const m of b)m.replaceWith(`
`);const g=c.getAttribute("gdg-raw-value"),h=c.getAttribute("gdg-format")??"string";if(c.querySelector("a")!==null)i==null||i.push({rawValue:((l=c.querySelector("a"))==null?void 0:l.getAttribute("href"))??"",formatted:c.textContent??"",format:h});else if(c.querySelector("ol")!==null){const m=c.querySelectorAll("li");i==null||i.push({rawValue:[...m].map(x=>x.getAttribute("gdg-raw-value")??""),formatted:[...m].map(x=>x.textContent??""),format:"string-array"})}else if(g!==null)i==null||i.push({rawValue:bd(g),formatted:c.textContent??"",format:h});else{let m=c.textContent??"";w&&(m=m.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:m??"",formatted:m??"",format:h})}}}return i!==void 0&&r.push(i),r}function vd(e,t,n,o,r){var s;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let l=!1;do{if((e==null?void 0:e.current)===void 0)break;const c=(s=e.current)==null?void 0:s.range,f=[];if(c.width>2){const b=t({x:c.x,y:c.y,width:1,height:c.height},r.signal);if(typeof b=="function")return i;f.push(...b);const g=t({x:c.x+c.width-1,y:c.y,width:1,height:c.height},r.signal);if(typeof g=="function")return i;f.push(...g)}else{const b=t({x:c.x,y:c.y,width:c.width,height:c.height},r.signal);if(typeof b=="function")return i;f.push(...b)}let u=c.x-n,w=c.x+c.width-1-n;for(const b of f)for(const g of b)g.span!==void 0&&(u=Math.min(g.span[0],u),w=Math.max(g.span[1],w));u===c.x-n&&w===c.x+c.width-1-n?l=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:c.y,width:w-u+1,height:c.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!l);return e}function Sl(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function Cd(e){let t;(function(s){s[s.None=0]="None",s[s.inString=1]="inString",s[s.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let l=0;for(const s of e){switch(i){case t.None:s==="	"||s===`
`?(o.push(e.slice(r,l)),r=l+1,s===`
`&&(n.push(o),o=[])):s==='"'&&(i=t.inString);break;case t.inString:s==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:s==='"'?i=t.inString:((s==="	"||s===`
`)&&(o.push(Sl(e.slice(r,l))),r=l+1,s===`
`&&(n.push(o),o=[])),i=t.None);break}l++}return r<e.length&&o.push(Sl(e.slice(r,e.length))),n.push(o),n.map(s=>s.map(c=>({rawValue:c,formatted:c,format:"string"})))}function Ml(e,t,n){var s;const o=pd(e,t),r=c=>{var f;(f=window.navigator.clipboard)==null||f.writeText(c)},i=(c,f)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([c],{type:"text/plain"}),"text/html":new Blob([f],{type:"text/html"})})]),!0)},l=(c,f)=>{var u,w;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",c),(w=n==null?void 0:n.clipboardData)==null||w.setData("text/html",f)}catch{i(c,f)||r(c)}};((s=window.navigator.clipboard)==null?void 0:s.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?l(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function us(e){return e!==!0}function Rl(e){return typeof e=="string"?e:`${e}px`}const xd=()=>e=>e.innerWidth,kd=()=>e=>e.innerHeight,Sd=tn("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[xd()],"wmyidgi-1":[kd()]}}),Md=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return a.createElement(Sd,{innerHeight:Rl(n),innerWidth:Rl(t),...r},o)},Rd=2,Ed=1300;function Id(e,t,n){const o=xt.useRef(0),[r,i]=e??[0,0];xt.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let l=!1,s=0;const c=f=>{var u;if(!l){if(s===0)s=f;else{const w=f-s;o.current=Math.min(1,o.current+w/Ed);const b=o.current**1.618*w*Rd;(u=t.current)==null||u.scrollBy(r*b,i*b),s=f,n==null||n()}window.requestAnimationFrame(c)}};return window.requestAnimationFrame(c),()=>{l=!0}},[t,r,i,n])}function Fd({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:l,remSize:s}){const[c,f,u,w,b,g]=xt.useMemo(()=>{if(!l||s===16)return[e,t,n,o,r,i];const h=s/16,m=e,x=jl();return[typeof m=="number"?m*h:C=>Math.ceil(m(C)*h),Math.ceil(t*h),Math.ceil(n*h),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??x.headerIconSize)*h,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??x.cellHorizontalPadding)*h,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??x.cellVerticalPadding)*h},Math.ceil((r??0)*h),Math.ceil((i??0)*h)]},[n,t,r,i,s,e,l,o]);return{rowHeight:c,headerHeight:f,groupHeaderHeight:u,theme:w,overscrollX:b,overscrollY:g}}const qn={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function Pe(e,t){return e===!0?t:e===!1?"":e}function El(e){const t=Yr.value;return{activateCell:Pe(e.activateCell," |Enter|shift+Enter"),clear:Pe(e.clear,"any+Escape"),closeOverlay:Pe(e.closeOverlay,"any+Escape"),acceptOverlayDown:Pe(e.acceptOverlayDown,"Enter"),acceptOverlayUp:Pe(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:Pe(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:Pe(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:Pe(e.delete,t?"Backspace|Delete":"Delete"),downFill:Pe(e.downFill,"primary+_68"),scrollToSelectedCell:Pe(e.scrollToSelectedCell,"primary+Enter"),goDownCell:Pe(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:Pe(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:Pe(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:Pe(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:Pe(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:Pe(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:Pe(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:Pe(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:Pe(e.goToFirstCell,"primary+Home"),goToFirstColumn:Pe(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:Pe(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:Pe(e.goToLastCell,"primary+End"),goToLastColumn:Pe(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:Pe(e.goToLastRow,"primary+ArrowDown"),goToNextPage:Pe(e.goToNextPage,"PageDown"),goToPreviousPage:Pe(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:Pe(e.rightFill,"primary+_82"),search:Pe(e.search,"primary+f"),selectAll:Pe(e.selectAll,"primary+a"),selectColumn:Pe(e.selectColumn,"ctrl+ "),selectGrowDown:Pe(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:Pe(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:Pe(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:Pe(e.selectGrowUp,"shift+ArrowUp"),selectRow:Pe(e.selectRow,"shift+ "),selectToFirstCell:Pe(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:Pe(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:Pe(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:Pe(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:Pe(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:Pe(e.selectToLastRow,"primary+shift+ArrowDown")}}function Dd(e){const t=ga(e);return xt.useMemo(()=>{if(t===void 0)return El(qn);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??qn.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??qn.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??qn.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??qn.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??qn.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??qn.selectToLastCell};return El({...qn,...n})},[t])}function Hd(e){function t(o,r,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:r,path:i};const l={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:r,path:i};return o.subGroups!==void 0&&(l.subGroups=o.subGroups.map((s,c)=>t(s,r+1,[...i,c])).sort((s,c)=>s.headerIndex-c.headerIndex)),l}return e.map((o,r)=>t(o,0,[r])).sort((o,r)=>o.headerIndex-r.headerIndex)}function Pi(e,t){const n=[];function o(l,s,c=!1){let f=s!==null?s-l.headerIndex:t-l.headerIndex;if(l.subGroups!==void 0&&(f=l.subGroups[0].headerIndex-l.headerIndex),f--,n.push({headerIndex:l.headerIndex,contentIndex:-1,skip:c,isCollapsed:l.isCollapsed,depth:l.depth,path:l.path,rows:f}),l.subGroups)for(let u=0;u<l.subGroups.length;u++){const w=u<l.subGroups.length-1?l.subGroups[u+1].headerIndex:s;o(l.subGroups[u],w,c||l.isCollapsed)}}const r=Hd(e.groups);for(let l=0;l<r.length;l++){const s=l<r.length-1?r[l+1].headerIndex:null;o(r[l],s)}let i=0;for(const l of n)l.contentIndex=i,i+=l.rows;return n.filter(l=>l.skip===!1).map(l=>{const{skip:s,...c}=l;return c})}function Kr(e,t){if(t===void 0||Pi.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(n--,!o.isCollapsed){if(n<o.rows)return{path:[...o.path,n],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n,contentIndex:o.contentIndex+n,groupRows:o.rows};n-=o.rows}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function Td(e,t,n,o){const r=xt.useMemo(()=>e===void 0?void 0:Pi(e,t),[e,t]),i=xt.useMemo(()=>r===void 0?t:r.reduce((f,u)=>f+(u.isCollapsed?1:u.rows+1),0),[r,t]),l=xt.useMemo(()=>e===void 0||typeof n=="number"&&e.height===n?n:f=>{const{isGroupHeader:u}=Kr(f,r);return u?e.height:typeof n=="number"?n:n(f)},[r,e,n]),s=xt.useCallback(f=>{if(r===void 0)return f;let u=f;for(const w of r){if(u===0)return;if(u--,!w.isCollapsed){if(u<w.rows)return w.contentIndex+u;u-=w.rows}}return f},[r]),c=fo(o??(e==null?void 0:e.themeOverride),xt.useCallback(f=>{if(e===void 0)return o==null?void 0:o(f,f,f);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:u,contentIndex:w,groupIndex:b}=Kr(f,r);return u?e.themeOverride:o==null?void 0:o(f,b,w)},[r,o,e]));return e===void 0?{rowHeight:l,rows:t,rowNumberMapper:s,getRowThemeOverride:c}:{rowHeight:l,rows:i,rowNumberMapper:s,getRowThemeOverride:c}}function Ad(e,t){const n=xt.useMemo(()=>e===void 0?void 0:Pi(e,t),[e,t]);return{getRowGroupingForPath:hs,updateRowGroupingByPath:fs,mapper:xt.useCallback(o=>{if(typeof o=="number")return Kr(o,n);const r=Kr(o[1],n);return{...r,originalIndex:[o[0],r.originalIndex]}},[n])}}function fs(e,t,n){const[o,...r]=t;return r[0]===-1?e.map((i,l)=>l===o?{...i,...n}:i):e.map((i,l)=>l===o?{...i,subGroups:fs(i.subGroups??[],r,n)}:i)}function hs(e,t){const[n,...o]=t;return o[0]===-1?e[n]:hs(e[n].subGroups??[],o)}function zd(e,t){const[n]=a.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const r=n.value;r!==o&&(n.value=o,n.callback(o,r))}}}));return n.callback=t,n.facade}function Bd(e,t,n,o,r){const[i,l]=a.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),s=a.useMemo(()=>({x:o.current.x,y:i,width:o.current.width??1,height:o.current.height??1,ty:l}),[o,l,i]),[c,f,u]=ha(s),w=a.useRef(r);w.current=r;const b=zd(null,m=>{m!==null&&t!==void 0?m.scrollTop=t:m!==null&&e!==void 0&&(m.scrollLeft=e)}),g=(c.height??1)>1;a.useLayoutEffect(()=>{if(t!==void 0&&b.current!==null&&g){if(b.current.scrollTop===t)return;b.current.scrollTop=t,b.current.scrollTop!==t&&u(),w.current()}},[t,g,u,b]);const h=(c.width??1)>1;return a.useLayoutEffect(()=>{if(e!==void 0&&b.current!==null&&h){if(b.current.scrollLeft===e)return;b.current.scrollLeft=e,b.current.scrollLeft!==e&&u(),w.current()}},[e,h,u,b]),{visibleRegion:c,setVisibleRegion:f,scrollRef:b}}const Ld=a.lazy(async()=>await Hl(()=>import("./data-grid-overlay-editor-SJccAyJ2.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url));let Pd=0;function Wd(e){return ta(nl(nl(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return ho((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function Br(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const Lr={kind:q.Loading,allowOverlay:!1},Pr={columns:rt.empty(),rows:rt.empty(),current:void 0},$d=(e,t)=>{var Qi,el,tl;const[n,o]=a.useState(Pr),[r,i]=a.useState(),l=a.useRef(null),s=a.useRef(null),[c,f]=a.useState(),u=a.useRef(),w=typeof window>"u"?null:window,{imageEditorOverride:b,getRowThemeOverride:g,markdownDivCreateNode:h,width:m,height:x,columns:C,rows:v,getCellContent:R,onCellClicked:O,onCellActivated:$,onGridFocused:z,onGridBlurred:B,onFillPattern:_,onFinishedEditing:S,coercePasteValue:N,drawHeader:A,drawCell:F,editorBloom:E,onHeaderClicked:M,onColumnProposeMove:ne,rangeSelectionColumnSpanning:le=!0,spanRangeBehavior:ae="default",onGroupHeaderClicked:be,onCellContextMenu:Ce,className:Z,onHeaderContextMenu:U,getCellsForSelection:Me,onGroupHeaderContextMenu:J,onGroupHeaderRenamed:ue,onCellEdited:fe,onCellsEdited:G,onSearchResultsChanged:pe,searchResults:xe,onSearchValueChange:qe,searchValue:Qe,onKeyDown:ht,onKeyUp:it,keybindings:Ye,editOnType:et=!0,onRowAppended:Re,onColumnMoved:vt,validateCell:Ct,highlightRegions:ct,rangeSelect:j="rect",columnSelect:Ee="multi",rowSelect:de="multi",rangeSelectionBlending:He="exclusive",columnSelectionBlending:ye="exclusive",rowSelectionBlending:_e="exclusive",onDelete:We,onDragStart:Ge,onMouseMove:re,onPaste:Fe,copyHeaders:tt=!1,freezeColumns:ze=0,cellActivationBehavior:Ke="second-click",rowSelectionMode:bt="auto",onHeaderMenuClick:je,onHeaderIndicatorClick:Be,getGroupDetails:kt,rowGrouping:St,onSearchClose:zt,onItemHovered:yt,onSelectionCleared:Mt,showSearch:At,onVisibleRegionChanged:fn,gridSelection:Ut,onGridSelectionChange:lt,minColumnWidth:Rn=50,maxColumnWidth:hn=500,maxColumnAutoWidth:dt,provideEditor:Lt,trailingRowOptions:Oe,freezeTrailingRows:Ft=0,allowedFillDirections:Jt="orthogonal",scrollOffsetX:Ue,scrollOffsetY:Rt,verticalBorder:nt,onDragOverCell:nn,onDrop:Nt,onColumnResize:_t,onColumnResizeEnd:En,onColumnResizeStart:gt,customRenderers:$n,fillHandle:Dt,experimental:Ze,fixedShadowX:In,fixedShadowY:dr,headerIcons:On,imageWindowLoader:Fn,initialSize:Dn,isDraggable:bo,onDragLeave:ur,onRowMoved:Nn,overscrollX:yo,overscrollY:po,preventDiagonalScrolling:vo,rightElement:Co,rightElementProps:Qn,trapFocus:Hn=!1,smoothScrollX:Vr,smoothScrollY:fr,scaleToRem:qr=!1,rowHeight:jr=34,headerHeight:eo=36,groupHeaderHeight:Xn=eo,theme:Zr,isOutsideClick:Jr,renderers:xo,resizeIndicator:hr,scrollToActiveCell:to=!0,drawFocusRing:Qr=!0}=e,Wo=Qr==="no-editor"?r===void 0:Qr,mt=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,Vt=(mt==null?void 0:mt.kind)??e.rowMarkers??"none",$o=(mt==null?void 0:mt.width)??e.rowMarkerWidth,Tn=(mt==null?void 0:mt.startIndex)??e.rowMarkerStartIndex??1,An=(mt==null?void 0:mt.theme)??e.rowMarkerTheme,ko=mt==null?void 0:mt.headerTheme,Yn=mt==null?void 0:mt.headerAlwaysVisible,So=de!=="multi",no=(mt==null?void 0:mt.checkboxStyle)??"square",zn=Math.max(Rn,20),oo=Math.max(hn,zn),ei=Math.max(dt??oo,zn),gr=a.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:ke,rowNumberMapper:Oo,rowHeight:mr,getRowThemeOverride:on}=Td(St,v,jr,g),ti=a.useMemo(()=>Number.parseFloat(gr.fontSize),[gr]),{rowHeight:pn,headerHeight:No,groupHeaderHeight:wr,theme:br,overscrollX:Xo,overscrollY:ni}=Fd({groupHeaderHeight:Xn,headerHeight:eo,overscrollX:yo,overscrollY:po,remSize:ti,rowHeight:mr,scaleToRem:qr,theme:Zr}),vn=Dd(Ye),Gn=$o??(v>1e4?48:v>1e3?44:v>100?36:32),rn=Vt!=="none",H=rn?1:0,at=Re!==void 0,Bn=(Oe==null?void 0:Oe.sticky)===!0,[Yo,yr]=a.useState(!1),Mo=At??Yo,oi=a.useCallback(()=>{zt!==void 0?zt():yr(!1)},[zt]),L=a.useMemo(()=>Ut===void 0?void 0:Br(Ut,H),[Ut,H])??n,Pt=a.useRef();Pt.current===void 0&&(Pt.current=new AbortController),a.useEffect(()=>()=>Pt==null?void 0:Pt.current.abort(),[]);const[k,K]=hd(Me,R,H,Pt.current,ke),ce=a.useCallback((d,p,y)=>{if(Ct===void 0)return!0;const D=[d[0]-H,d[1]];return Ct==null?void 0:Ct(D,p,y)},[H,Ct]),oe=a.useRef(Ut),V=a.useCallback((d,p)=>{p&&(d=vd(d,k,H,ae,Pt.current)),lt!==void 0?(oe.current=Br(d,-H),lt(oe.current)):o(d)},[lt,k,H,ae]),te=fo(_t,a.useCallback((d,p,y,D)=>{_t==null||_t(C[y-H],p,y-H,D)},[_t,H,C])),Te=fo(En,a.useCallback((d,p,y,D)=>{En==null||En(C[y-H],p,y-H,D)},[En,H,C])),Ae=fo(gt,a.useCallback((d,p,y,D)=>{gt==null||gt(C[y-H],p,y-H,D)},[gt,H,C])),he=fo(A,a.useCallback((d,p)=>(A==null?void 0:A({...d,columnIndex:d.columnIndex-H},p))??!1,[A,H])),Ht=fo(F,a.useCallback((d,p)=>(F==null?void 0:F({...d,col:d.col-H},p))??!1,[F,H])),se=a.useCallback(d=>{if(We!==void 0){const p=We(Br(d,-H));return typeof p=="boolean"?p:Br(p,H)}return!0},[We,H]),[De,Ie,ve]=fd(L,V,He,ye,_e,j,le),Ve=a.useMemo(()=>Wn(jl(),br),[br]),[Xt,Et]=a.useState([0,0,0]),ln=a.useMemo(()=>{if(xo===void 0)return{};const d={};for(const p of xo)d[p.kind]=p;return d},[xo]),pt=a.useCallback(d=>d.kind!==q.Custom?ln[d.kind]:$n==null?void 0:$n.find(p=>p.isMatch(d)),[$n,ln]);let{sizedColumns:wt,nonGrowWidth:ot}=$a(C,ke,K,Xt[0]-(H===0?0:Gn)-Xt[2],zn,ei,Ve,pt,Pt.current);Vt!=="none"&&(ot+=Gn);const Yt=a.useMemo(()=>wt.some(d=>d.group!==void 0),[wt]),Wt=Yt?No+wr:No,Kn=L.rows.length,gn=Vt==="none"?void 0:Kn===0?!1:Kn===ke?!0:void 0,Je=a.useMemo(()=>Vt==="none"?wt:[{title:"",width:Gn,icon:void 0,hasMenu:!1,style:"normal",themeOverride:An,rowMarker:no,rowMarkerChecked:gn,headerRowMarkerTheme:ko,headerRowMarkerAlwaysVisible:Yn,headerRowMarkerDisabled:So},...wt],[Vt,wt,Gn,An,no,gn,ko,Yn,So]),Tt=a.useRef({height:1,width:1,x:0,y:0}),pr=a.useRef(!1),{setVisibleRegion:Wi,visibleRegion:ro,scrollRef:ut}=Bd(Ue,Rt,pn,Tt,()=>pr.current=!0);Tt.current=ro;const bs=ro.x+H,vr=ro.y,qt=a.useRef(null),Gt=a.useCallback(d=>{var p;d===!0?(p=qt.current)==null||p.focus():window.requestAnimationFrame(()=>{var y;(y=qt.current)==null||y.focus()})},[]),$t=at?ke+1:ke,sn=a.useCallback(d=>{const p=H===0?d:d.map(D=>({...D,location:[D.location[0]-H,D.location[1]]})),y=G==null?void 0:G(p);if(y!==!0)for(const D of p)fe==null||fe(D.location,D.value);return y},[fe,G,H]),[io,ri]=a.useState(),Cr=L.current!==void 0&&L.current.range.width*L.current.range.height>1?L.current.range:void 0,Ro=Wo?(Qi=L.current)==null?void 0:Qi.cell:void 0,xr=Ro==null?void 0:Ro[0],kr=Ro==null?void 0:Ro[1],ys=a.useMemo(()=>{if((ct===void 0||ct.length===0)&&(Cr??xr??kr??io)===void 0)return;const d=[];if(ct!==void 0)for(const p of ct){const y=Je.length-p.range.x-H;y>0&&d.push({color:p.color,range:{...p.range,x:p.range.x+H,width:Math.min(y,p.range.width)},style:p.style})}return io!==void 0&&d.push({color:mo(Ve.accentColor,0),range:io,style:"dashed"}),Cr!==void 0&&d.push({color:mo(Ve.accentColor,.5),range:Cr,style:"solid-outline"}),xr!==void 0&&kr!==void 0&&d.push({color:Ve.accentColor,range:{x:xr,y:kr,width:1,height:1},style:"solid-outline"}),d.length>0?d:void 0},[io,Cr,xr,kr,ct,Je.length,Ve.accentColor,H]),$i=a.useRef(Je);$i.current=Je;const jt=a.useCallback(([d,p],y=!1)=>{var W,T,P,X,Y,Q,me;const D=at&&p===$t-1;if(d===0&&rn){if(D)return Lr;const ee=Oo(p);return ee===void 0?Lr:{kind:un.Marker,allowOverlay:!1,checkboxStyle:no,checked:(L==null?void 0:L.rows.hasIndex(p))===!0,markerKind:Vt==="clickable-number"?"number":Vt,row:Tn+ee,drawHandle:Nn!==void 0,cursor:Vt==="clickable-number"?"pointer":void 0}}else if(D){const we=d===H?(Oe==null?void 0:Oe.hint)??"":"",ie=$i.current[d];if(((W=ie==null?void 0:ie.trailingRowOptions)==null?void 0:W.disabled)===!0)return Lr;{const Ne=((T=ie==null?void 0:ie.trailingRowOptions)==null?void 0:T.hint)??we,Se=((P=ie==null?void 0:ie.trailingRowOptions)==null?void 0:P.addIcon)??(Oe==null?void 0:Oe.addIcon);return{kind:un.NewRow,hint:Ne,allowOverlay:!1,icon:Se}}}else{const ee=d-H;if(y||(Ze==null?void 0:Ze.strict)===!0){const ie=Tt.current,Ne=ie.x>ee||ee>ie.x+ie.width||ie.y>p||p>ie.y+ie.height||p>=li.current,Se=ee===((Y=(X=ie.extras)==null?void 0:X.selected)==null?void 0:Y[0])&&p===((Q=ie.extras)==null?void 0:Q.selected[1]);let ge=!1;if(((me=ie.extras)==null?void 0:me.freezeRegions)!==void 0){for(const Xe of ie.extras.freezeRegions)if(go(Xe,ee,p)){ge=!0;break}}if(Ne&&!Se&&!ge)return Lr}let we=R([ee,p]);return H!==0&&we.span!==void 0&&(we={...we,span:[we.span[0]+H,we.span[1]+H]}),we}},[at,$t,rn,Oo,no,L==null?void 0:L.rows,Vt,Tn,Nn,H,Oe==null?void 0:Oe.hint,Oe==null?void 0:Oe.addIcon,Ze==null?void 0:Ze.strict,R]),ii=a.useCallback(d=>{let p=(kt==null?void 0:kt(d))??{name:d};return ue!==void 0&&d!==""&&(p={icon:p.icon,name:p.name,overrideTheme:p.overrideTheme,actions:[...p.actions??[],{title:"Rename",icon:"renameIcon",onClick:y=>ai({group:p.name,bounds:y.bounds})}]}),p},[kt,ue]),Sr=a.useCallback(d=>{var P;const[p,y]=d.cell,D=Je[p],I=(D==null?void 0:D.group)!==void 0?(P=ii(D.group))==null?void 0:P.overrideTheme:void 0,W=D==null?void 0:D.themeOverride,T=on==null?void 0:on(y);i({...d,theme:Wn(Ve,I,W,T,d.content.themeOverride)})},[on,Je,ii,Ve]),Eo=a.useCallback((d,p,y)=>{var T;if(L.current===void 0)return;const[D,I]=L.current.cell,W=jt([D,I]);if(W.kind!==q.Boolean&&W.allowOverlay){let P=W;if(y!==void 0)switch(P.kind){case q.Number:{const X=oa(()=>y==="-"?-0:Number.parseFloat(y),0);P={...P,data:Number.isNaN(X)?0:X};break}case q.Text:case q.Markdown:case q.Uri:P={...P,data:y};break}Sr({target:d,content:P,initialValue:y,cell:[D,I],highlight:y===void 0,forceEditMode:y!==void 0})}else W.kind===q.Boolean&&p&&W.readonly!==!0&&(sn([{location:L.current.cell,value:{...W,data:us(W.data)}}]),(T=qt.current)==null||T.damage([{cell:L.current.cell}]))},[jt,L,sn,Sr]),Oi=a.useCallback((d,p)=>{var I;const y=(I=qt.current)==null?void 0:I.getBounds(d,p);if(y===void 0||ut.current===null)return;const D=jt([d,p]);D.allowOverlay&&Sr({target:y,content:D,initialValue:void 0,highlight:!0,cell:[d,p],forceEditMode:!0})},[jt,ut,Sr]),It=a.useCallback((d,p,y="both",D=0,I=0,W=void 0)=>{if(ut.current!==null){const T=qt.current,P=s.current,X=typeof d!="number"?d.unit==="cell"?d.amount:void 0:d,Y=typeof p!="number"?p.unit==="cell"?p.amount:void 0:p,Q=typeof d!="number"&&d.unit==="px"?d.amount:void 0,me=typeof p!="number"&&p.unit==="px"?p.amount:void 0;if(T!==null&&P!==null){let ee={x:0,y:0,width:0,height:0},we=0,ie=0;if((X!==void 0||Y!==void 0)&&(ee=T.getBounds((X??0)+H,Y??0)??ee,ee.width===0||ee.height===0))return;const Ne=P.getBoundingClientRect(),Se=Ne.width/P.offsetWidth;if(Q!==void 0&&(ee={...ee,x:Q-Ne.left-ut.current.scrollLeft,width:1}),me!==void 0&&(ee={...ee,y:me+Ne.top-ut.current.scrollTop,height:1}),ee!==void 0){const ge={x:ee.x-D,y:ee.y-I,width:ee.width+2*D,height:ee.height+2*I};let Xe=0;for(let mi=0;mi<ze;mi++)Xe+=wt[mi].width;let st=0;const Ot=Ft+(Bn?1:0);Ot>0&&(st=wo($t,Ot,pn));let bn=Xe*Se+Ne.left+H*Gn*Se,xn=Ne.right,kn=Ne.top+Wt*Se,Ln=Ne.bottom-st*Se;const Hr=ee.width+D*2;switch(W==null?void 0:W.hAlign){case"start":xn=bn+Hr;break;case"end":bn=xn-Hr;break;case"center":bn=Math.floor((bn+xn)/2)-Hr/2,xn=bn+Hr;break}const Tr=ee.height+I*2;switch(W==null?void 0:W.vAlign){case"start":Ln=kn+Tr;break;case"end":kn=Ln-Tr;break;case"center":kn=Math.floor((kn+Ln)/2)-Tr/2,Ln=kn+Tr;break}bn>ge.x?we=ge.x-bn:xn<ge.x+ge.width&&(we=ge.x+ge.width-xn),kn>ge.y?ie=ge.y-kn:Ln<ge.y+ge.height&&(ie=ge.y+ge.height-Ln),y==="vertical"||typeof d=="number"&&d<ze?we=0:(y==="horizontal"||typeof p=="number"&&p>=$t-Ot)&&(ie=0),(we!==0||ie!==0)&&(Se!==1&&(we/=Se,ie/=Se),ut.current.scrollTo(we+ut.current.scrollLeft,ie+ut.current.scrollTop))}}}},[H,Ft,Gn,ut,Wt,ze,wt,$t,Bn,pn]),Ni=a.useRef(Oi),Xi=a.useRef(R),li=a.useRef(ke);Ni.current=Oi,Xi.current=R,li.current=ke;const Io=a.useCallback(async(d,p=!0)=>{var X;const y=Je[d];if(((X=y==null?void 0:y.trailingRowOptions)==null?void 0:X.disabled)===!0)return;const D=Re==null?void 0:Re();let I,W=!0;D!==void 0&&(I=await D,I==="top"&&(W=!1),typeof I=="number"&&(W=!1));let T=0;const P=()=>{if(li.current<=ke){T<500&&window.setTimeout(P,T),T=50+T*2;return}const Y=typeof I=="number"?I:W?ke:0;Dr.current(d-H,Y),De({cell:[d,Y],range:{x:d,y:Y,width:1,height:1}},!1,!1,"edit");const Q=Xi.current([d-H,Y]);Q.allowOverlay&&tr(Q)&&Q.readonly!==!0&&p&&window.setTimeout(()=>{Ni.current(d,Y)},0)};P()},[Je,Re,H,ke,De]),Mr=a.useCallback(d=>{var y,D;const p=((D=(y=wt[d])==null?void 0:y.trailingRowOptions)==null?void 0:D.targetColumn)??(Oe==null?void 0:Oe.targetColumn);if(typeof p=="number")return p+(rn?1:0);if(typeof p=="object"){const I=C.indexOf(p);if(I>=0)return I+(rn?1:0)}},[wt,C,rn,Oe==null?void 0:Oe.targetColumn]),Un=a.useRef(),Fo=a.useRef(),Ko=a.useCallback((d,p)=>{var I;const[y,D]=p;return Wn(Ve,(I=Je[y])==null?void 0:I.themeOverride,on==null?void 0:on(D),d.themeOverride)},[on,Je,Ve]),{mapper:lo}=Ad(St,v),mn=St==null?void 0:St.navigationBehavior,Uo=a.useCallback(d=>{var Q,me,ee;const p=Yr.value?d.metaKey:d.ctrlKey,y=p&&de==="multi",D=p&&Ee==="multi",[I,W]=d.location,T=L.columns,P=L.rows,[X,Y]=((Q=L.current)==null?void 0:Q.cell)??[];if(d.kind==="cell"){if(Fo.current=void 0,so.current=[I,W],I===0&&rn){if(at===!0&&W===ke||Vt==="number"||de==="none")return;const we=jt(d.location);if(we.kind!==un.Marker)return;if(Nn!==void 0){const Se=pt(we);Qt((Se==null?void 0:Se.kind)===un.Marker);const ge=(me=Se==null?void 0:Se.onClick)==null?void 0:me.call(Se,{...d,cell:we,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,theme:Ko(we,d.location),preventDefault:()=>{}});if(ge===void 0||ge.checked===we.checked)return}i(void 0),Gt();const ie=P.hasIndex(W),Ne=Un.current;if(de==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&Ne!==void 0&&P.hasIndex(Ne)){const Se=[Math.min(Ne,W),Math.max(Ne,W)+1];y||bt==="multi"?Ie(void 0,Se,!0):Ie(rt.fromSingleSelection(Se),void 0,y)}else de==="multi"&&(y||d.isTouch||bt==="multi")?ie?Ie(P.remove(W),void 0,!0):(Ie(void 0,W,!0),Un.current=W):ie&&P.length===1?Ie(rt.empty(),void 0,p):(Ie(rt.fromSingleSelection(W),void 0,p),Un.current=W)}else if(I>=H&&at&&W===ke){const we=Mr(I);Io(we??I)}else if(X!==I||Y!==W){const we=jt(d.location),ie=pt(we);if((ie==null?void 0:ie.onSelect)!==void 0){let ge=!1;if(ie.onSelect({...d,cell:we,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,preventDefault:()=>ge=!0,theme:Ko(we,d.location)}),ge)return}if(mn==="block"&&lo(W).isGroupHeader)return;const Ne=Bn&&W===ke,Se=Bn&&L!==void 0&&((ee=L.current)==null?void 0:ee.cell[1])===ke;if((d.shiftKey||d.isLongTouch===!0)&&X!==void 0&&Y!==void 0&&L.current!==void 0&&!Se){if(Ne)return;const ge=Math.min(I,X),Xe=Math.max(I,X),st=Math.min(W,Y),Ot=Math.max(W,Y);De({...L.current,range:{x:ge,y:st,width:Xe-ge+1,height:Ot-st+1}},!0,p,"click"),Un.current=void 0,Gt()}else De({cell:[I,W],range:{x:I,y:W,width:1,height:1}},!0,p,"click"),Un.current=void 0,i(void 0),Gt()}}else if(d.kind==="header")if(so.current=[I,W],i(void 0),rn&&I===0)Un.current=void 0,Fo.current=void 0,de==="multi"&&(P.length!==ke?Ie(rt.fromSingleSelection([0,ke]),void 0,p):Ie(rt.empty(),void 0,p),Gt());else{const we=Fo.current;if(Ee==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&we!==void 0&&T.hasIndex(we)){const ie=[Math.min(we,I),Math.max(we,I)+1];D?ve(void 0,ie,p):ve(rt.fromSingleSelection(ie),void 0,p)}else D?(T.hasIndex(I)?ve(T.remove(I),void 0,p):ve(void 0,I,p),Fo.current=I):Ee!=="none"&&(ve(rt.fromSingleSelection(I),void 0,p),Fo.current=I);Un.current=void 0,Gt()}else d.kind===dn?so.current=[I,W]:d.kind===Gr&&!d.isMaybeScrollbar&&(V(Pr,!1),i(void 0),Gt(),Mt==null||Mt(),Un.current=void 0,Fo.current=void 0)},[de,Ee,L,rn,H,at,ke,Vt,jt,Nn,Gt,bt,pt,Ko,Ie,Mr,Io,mn,lo,Bn,De,ve,V,Mt]),_o=a.useRef(!1),so=a.useRef(),Yi=a.useRef(ro),an=a.useRef(),ps=a.useCallback(d=>{if(ao.current=!1,Yi.current=Tt.current,d.button!==0&&d.button!==1){an.current=void 0;return}const p=performance.now();an.current={button:d.button,time:p,location:d.location},(d==null?void 0:d.kind)==="header"&&(_o.current=!0);const y=d.kind==="cell"&&d.isFillHandle;!y&&d.kind!=="cell"&&d.isEdge||(f({previousSelection:L,fillHandle:y}),so.current=void 0,!d.isTouch&&d.button===0&&!y?Uo(d):!d.isTouch&&d.button===1&&(so.current=d.location))},[L,Uo]),[si,ai]=a.useState(),Gi=a.useCallback(d=>{if(d.kind!==dn||Ee!=="multi")return;const p=Yr.value?d.metaKey:d.ctrlKey,[y]=d.location,D=L.columns;if(y<H)return;const I=Je[y];let W=y,T=y;for(let P=y-1;P>=H&&sr(I.group,Je[P].group);P--)W--;for(let P=y+1;P<Je.length&&sr(I.group,Je[P].group);P++)T++;if(Gt(),p)if(D.hasAll([W,T+1])){let P=D;for(let X=W;X<=T;X++)P=P.remove(X);ve(P,void 0,p)}else ve(void 0,[W,T+1],p);else ve(rt.fromSingleSelection([W,T+1]),void 0,p)},[Ee,Gt,L.columns,Je,H,ve]),ao=a.useRef(!1),Rr=a.useCallback(async d=>{if(k!==void 0&&te!==void 0){const p=Tt.current.y,y=Tt.current.height;let D=k({x:d,y:p,width:1,height:Math.min(y,ke-p)},Pt.current.signal);typeof D!="object"&&(D=await D());const I=wt[d-H],T=document.createElement("canvas").getContext("2d",{alpha:!1});if(T!==null){T.font=Ve.baseFontFull;const P=Jl(T,Ve,I,0,D,zn,oo,pt);te==null||te(I,P.width,d,P.width)}}},[wt,k,oo,Ve,zn,te,H,ke,pt]),[vs,ci]=a.useState(),Do=a.useCallback(async(d,p)=>{var P,X;const y=(P=d.current)==null?void 0:P.range;if(y===void 0||k===void 0||p.current===void 0)return;const D=p.current.range;if(_!==void 0){let Y=!1;if(_({fillDestination:{...D,x:D.x-H},patternSource:{...y,x:y.x-H},preventDefault:()=>Y=!0}),Y)return}let I=k(y,Pt.current.signal);typeof I!="object"&&(I=await I());const W=I,T=[];for(let Y=0;Y<D.width;Y++)for(let Q=0;Q<D.height;Q++){const me=[D.x+Y,D.y+Q];if($l(me,y))continue;const ee=W[Q%y.height][Y%y.width];Ao(ee)||!tr(ee)||T.push({location:me,value:{...ee}})}sn(T),(X=qt.current)==null||X.damage(T.map(Y=>({cell:Y.location})))},[k,sn,_,H]),Ki=a.useCallback(()=>{if(L.current===void 0||L.current.range.width<=1)return;const d={...L,current:{...L.current,range:{...L.current.range,width:1}}};Do(d,L)},[Do,L]),Ui=a.useCallback(()=>{if(L.current===void 0||L.current.range.height<=1)return;const d={...L,current:{...L.current,range:{...L.current.range,height:1}}};Do(d,L)},[Do,L]),Cs=a.useCallback((d,p)=>{var Q,me;const y=c;if(f(void 0),ri(void 0),ci(void 0),_o.current=!1,p)return;if((y==null?void 0:y.fillHandle)===!0&&L.current!==void 0&&((Q=y.previousSelection)==null?void 0:Q.current)!==void 0){if(io===void 0)return;const ee={...L,current:{...L.current,range:os(y.previousSelection.current.range,io)}};Do(y.previousSelection,ee),V(ee,!0);return}const[D,I]=d.location,[W,T]=so.current??[],P=()=>{ao.current=!0},X=ee=>{var ie,Ne,Se;const we=ee.isTouch||W===D&&T===I;if(we&&(O==null||O([D-H,I],{...ee,preventDefault:P})),!ao.current&&we){const ge=jt(d.location),Xe=pt(ge);if(Xe!==void 0&&Xe.onClick!==void 0){const st=Xe.onClick({...ee,cell:ge,posX:ee.localEventX,posY:ee.localEventY,bounds:ee.bounds,theme:Ko(ge,d.location),preventDefault:P});st!==void 0&&!Ao(st)&&To(st)&&(sn([{location:ee.location,value:st}]),(ie=qt.current)==null||ie.damage([{cell:ee.location}]))}}if(ee.button===1)return!ao.current;if(!ao.current){if(ao.current||L.current===void 0)return!1;const ge=jt(d.location);let Xe=!1;switch(ge.activationBehaviorOverride??Ke){case"double-click":case"second-click":{if(((Se=(Ne=y==null?void 0:y.previousSelection)==null?void 0:Ne.current)==null?void 0:Se.cell)===void 0)break;const[st,Ot]=L.current.cell,[bn,xn]=y.previousSelection.current.cell;Xe=D===st&&D===bn&&I===Ot&&I===xn&&(ee.isDoubleClick===!0||Ke==="second-click");break}case"single-click":{Xe=!0;break}}if(Xe)return $==null||$([D-H,I]),Eo(ee.bounds,!1),!0}return!1},Y=d.location[0]-H;if(d.isTouch){const ee=Tt.current,we=Yi.current;if(ee.x!==we.x||ee.y!==we.y)return;if(d.isLongTouch===!0){if(d.kind==="cell"&&nr((me=L.current)==null?void 0:me.cell,d.location)){Ce==null||Ce([Y,d.location[1]],{...d,preventDefault:P});return}else if(d.kind==="header"&&L.columns.hasIndex(D)){U==null||U(Y,{...d,preventDefault:P});return}else if(d.kind===dn){if(Y<0)return;J==null||J(Y,{...d,preventDefault:P});return}}d.kind==="cell"?X(d)||Uo(d):d.kind===dn?be==null||be(Y,{...d,preventDefault:P}):(d.kind===jn&&(M==null||M(Y,{...d,preventDefault:P})),Uo(d));return}d.kind==="header"&&(d.isEdge?d.isDoubleClick===!0&&Rr(D):d.button===0&&D===W&&I===T&&(M==null||M(Y,{...d,preventDefault:P}))),d.kind===dn&&d.button===0&&D===W&&I===T&&(be==null||be(Y,{...d,preventDefault:P}),ao.current||Gi(d)),d.kind==="cell"&&(d.button===0||d.button===1)&&X(d),so.current=void 0},[c,L,H,io,Do,V,O,jt,pt,Ke,Ko,sn,$,Eo,Ce,U,J,Uo,be,M,Rr,Gi]),xs=a.useCallback(d=>{const p={...d,location:[d.location[0]-H,d.location[1]]};re==null||re(p),c!==void 0&&d.buttons===0&&(f(void 0),ri(void 0),ci(void 0),_o.current=!1),ci(y=>{var D;return _o.current?[d.scrollEdge[0],0]:d.scrollEdge[0]===(y==null?void 0:y[0])&&d.scrollEdge[1]===y[1]?y:c===void 0||(((D=an.current)==null?void 0:D.location[0])??0)<H?void 0:d.scrollEdge})},[c,re,H]),ks=a.useCallback((d,p)=>{je==null||je(d-H,p)},[je,H]),Ss=a.useCallback((d,p)=>{Be==null||Be(d-H,p)},[Be,H]),Cn=(el=L==null?void 0:L.current)==null?void 0:el.cell,Ms=a.useCallback((d,p,y,D,I,W)=>{pr.current=!1;let T=Cn;T!==void 0&&(T=[T[0]-H,T[1]]);const P=ze===0?void 0:{x:0,y:d.y,width:ze,height:d.height},X=[];P!==void 0&&X.push(P),Ft>0&&(X.push({x:d.x-H,y:ke-Ft,width:d.width,height:Ft}),ze>0&&X.push({x:0,y:ke-Ft,width:ze,height:Ft}));const Y={x:d.x-H,y:d.y,width:d.width,height:at&&d.y+d.height>=ke?d.height-1:d.height,tx:I,ty:W,extras:{selected:T,freezeRegion:P,freezeRegions:X}};Tt.current=Y,Wi(Y),Et([p,y,D]),fn==null||fn(Y,Y.tx,Y.ty,Y.extras)},[Cn,H,at,ke,ze,Ft,Wi,fn]),Rs=fo(vt,a.useCallback((d,p)=>{vt==null||vt(d-H,p-H),Ee!=="none"&&ve(rt.fromSingleSelection(p),void 0,!0)},[Ee,vt,H,ve])),di=a.useRef(!1),Es=a.useCallback(d=>{if(d.location[0]===0&&H>0){d.preventDefault();return}Ge==null||Ge({...d,location:[d.location[0]-H,d.location[1]]}),d.defaultPrevented()||(di.current=!0),f(void 0)},[Ge,H]),Is=a.useCallback(()=>{di.current=!1},[]),_i=St==null?void 0:St.selectionBehavior,Er=a.useCallback(d=>{if(_i!=="block-spanning")return;const{isGroupHeader:p,path:y,groupRows:D}=lo(d);if(p)return[d,d];const I=y[y.length-1],W=d-I,T=d+D-I-1;return[W,T]},[lo,_i]),ui=a.useRef(),fi=a.useCallback(d=>{var p,y,D;if(!cs(d,ui.current)&&(ui.current=d,!(((p=an==null?void 0:an.current)==null?void 0:p.button)!==void 0&&an.current.button>=1))){if(d.buttons!==0&&c!==void 0&&((y=an.current)==null?void 0:y.location[0])===0&&d.location[0]===0&&H===1&&de==="multi"&&c.previousSelection&&!c.previousSelection.rows.hasIndex(an.current.location[1])&&L.rows.hasIndex(an.current.location[1])){const I=Math.min(an.current.location[1],d.location[1]),W=Math.max(an.current.location[1],d.location[1])+1;Ie(rt.fromSingleSelection([I,W]),void 0,!1)}if(d.buttons!==0&&c!==void 0&&L.current!==void 0&&!di.current&&!_o.current&&(j==="rect"||j==="multi-rect")){const[I,W]=L.current.cell;let[T,P]=d.location;if(P<0&&(P=Tt.current.y),c.fillHandle===!0&&((D=c.previousSelection)==null?void 0:D.current)!==void 0){const X=c.previousSelection.current.range;P=Math.min(P,at?ke-1:ke);const Y=bc(X,T,P,Jt);ri(Y)}else{if(at&&W===ke)return;if(at&&P===ke)if(d.kind===Gr)P--;else return;T=Math.max(T,H);const Q=Er(W);P=Q===void 0?P:cn(P,Q[0],Q[1]);const me=T-I,ee=P-W,we={x:me>=0?I:T,y:ee>=0?W:P,width:Math.abs(me)+1,height:Math.abs(ee)+1};De({...L.current,range:we},!0,!1,"drag")}}yt==null||yt({...d,location:[d.location[0]-H,d.location[1]]})}},[c,H,de,L,j,yt,Ie,at,ke,Jt,Er,De]),Fs=a.useCallback(()=>{var T,P;const d=ui.current;if(d===void 0)return;const[p,y]=d.scrollEdge;let[D,I]=d.location;const W=Tt.current;p===-1?D=((P=(T=W.extras)==null?void 0:T.freezeRegion)==null?void 0:P.x)??W.x:p===1&&(D=W.x+W.width),y===-1?I=Math.max(0,W.y):y===1&&(I=Math.min(ke-1,W.y+W.height)),D=cn(D,0,Je.length-1),I=cn(I,0,ke-1),fi({...d,location:[D,I]})},[Je.length,fi,ke]);Id(vs,ut,Fs);const wn=a.useCallback(d=>{if(L.current===void 0)return;const[p,y]=d,[D,I]=L.current.cell,W=L.current.range;let T=W.x,P=W.x+W.width,X=W.y,Y=W.y+W.height;const[Q,me]=Er(I)??[0,ke-1],ee=me+1;if(y!==0)switch(y){case 2:{Y=ee,X=I,It(0,Y,"vertical");break}case-2:{X=Q,Y=I+1,It(0,X,"vertical");break}case 1:{X<I?(X++,It(0,X,"vertical")):(Y=Math.min(ee,Y+1),It(0,Y,"vertical"));break}case-1:{Y>I+1?(Y--,It(0,Y,"vertical")):(X=Math.max(Q,X-1),It(0,X,"vertical"));break}default:lr()}if(p!==0)if(p===2)P=Je.length,T=D,It(P-1-H,0,"horizontal");else if(p===-2)T=H,P=D+1,It(T-H,0,"horizontal");else{let we=[];if(k!==void 0){const ie=k({x:T,y:X,width:P-T-H,height:Y-X},Pt.current.signal);typeof ie=="object"&&(we=Wd(ie))}if(p===1){let ie=!1;if(T<D){if(we.length>0){const Ne=ho(T+1,D+1).find(Se=>!we.includes(Se-H));Ne!==void 0&&(T=Ne,ie=!0)}else T++,ie=!0;ie&&It(T,0,"horizontal")}ie||(P=Math.min(Je.length,P+1),It(P-1-H,0,"horizontal"))}else if(p===-1){let ie=!1;if(P>D+1){if(we.length>0){const Ne=ho(P-1,D,-1).find(Se=>!we.includes(Se-H));Ne!==void 0&&(P=Ne,ie=!0)}else P--,ie=!0;ie&&It(P-H,0,"horizontal")}ie||(T=Math.max(H,T-1),It(T-H,0,"horizontal"))}else lr()}De({cell:L.current.cell,range:{x:T,y:X,width:P-T,height:Y-X}},!0,!1,"keyboard-select")},[k,Er,L,Je.length,H,ke,It,De]),hi=a.useRef(to);hi.current=to;const _n=a.useCallback((d,p,y,D)=>{const I=$t-(y?0:1);d=cn(d,H,wt.length-1+H),p=cn(p,0,I);const W=Cn==null?void 0:Cn[0],T=Cn==null?void 0:Cn[1];if(d===W&&p===T)return!1;if(D&&L.current!==void 0){const P=[...L.current.rangeStack];(L.current.range.width>1||L.current.range.height>1)&&P.push(L.current.range),V({...L,current:{cell:[d,p],range:{x:d,y:p,width:1,height:1},rangeStack:P}},!0)}else De({cell:[d,p],range:{x:d,y:p,width:1,height:1}},!0,!1,"keyboard-nav");return u.current!==void 0&&u.current[0]===d&&u.current[1]===p&&(u.current=void 0),hi.current&&It(d-H,p),!0},[$t,H,wt.length,Cn,L,It,V,De]),Ds=a.useCallback((d,p)=>{(r==null?void 0:r.cell)!==void 0&&d!==void 0&&To(d)&&(sn([{location:r.cell,value:d}]),window.requestAnimationFrame(()=>{var I;(I=qt.current)==null||I.damage([{cell:r.cell}])})),Gt(!0),i(void 0);const[y,D]=p;if(L.current!==void 0&&(y!==0||D!==0)){const I=L.current.cell[1]===$t-1&&d!==void 0;_n(cn(L.current.cell[0]+y,0,Je.length-1),cn(L.current.cell[1]+D,0,$t-1),I,!1)}S==null||S(d,p)},[r==null?void 0:r.cell,Gt,L,S,sn,$t,_n,Je.length]),Hs=a.useMemo(()=>`gdg-overlay-${Pd++}`,[]),co=a.useCallback(d=>{var y,D,I,W;Gt();const p=[];for(let T=d.x;T<d.x+d.width;T++)for(let P=d.y;P<d.y+d.height;P++){const X=R([T-H,P]);if(!X.allowOverlay&&X.kind!==q.Boolean)continue;let Y;if(X.kind===q.Custom){const Q=pt(X),me=(y=Q==null?void 0:Q.provideEditor)==null?void 0:y.call(Q,X);(Q==null?void 0:Q.onDelete)!==void 0?Y=Q.onDelete(X):ra(me)&&(Y=(D=me==null?void 0:me.deletedValue)==null?void 0:D.call(me,X))}else if(To(X)&&X.allowOverlay||X.kind===q.Boolean){const Q=pt(X);Y=(I=Q==null?void 0:Q.onDelete)==null?void 0:I.call(Q,X)}Y!==void 0&&!Ao(Y)&&To(Y)&&p.push({location:[T,P],value:Y})}sn(p),(W=qt.current)==null||W.damage(p.map(T=>({cell:T.location})))},[Gt,R,pt,sn,H]),Vo=r!==void 0,Vi=a.useCallback(d=>{var Ne,Se;const p=()=>{d.stopPropagation(),d.preventDefault()},y={didMatch:!1},{bounds:D}=d,I=L.columns,W=L.rows,T=vn;if(!Vo&&Le(T.clear,d,y))V(Pr,!1),Mt==null||Mt();else if(!Vo&&Le(T.selectAll,d,y))V({columns:rt.empty(),rows:rt.empty(),current:{cell:((Ne=L.current)==null?void 0:Ne.cell)??[H,0],range:{x:H,y:0,width:C.length,height:ke},rangeStack:[]}},!1);else if(Le(T.search,d,y))(Se=l==null?void 0:l.current)==null||Se.focus({preventScroll:!0}),yr(!0);else if(Le(T.delete,d,y)){const ge=(se==null?void 0:se(L))??!0;if(ge!==!1){const Xe=ge===!0?L:ge;if(Xe.current!==void 0){co(Xe.current.range);for(const st of Xe.current.rangeStack)co(st)}for(const st of Xe.rows)co({x:H,y:st,width:C.length,height:1});for(const st of Xe.columns)co({x:st,y:0,width:1,height:ke})}}if(y.didMatch)return p(),!0;if(L.current===void 0)return!1;let[P,X]=L.current.cell;const[,Y]=L.current.cell;let Q=!1,me=!1;if(Le(T.scrollToSelectedCell,d,y)?Dr.current(P-H,X):Ee!=="none"&&Le(T.selectColumn,d,y)?I.hasIndex(P)?ve(I.remove(P),void 0,!0):Ee==="single"?ve(rt.fromSingleSelection(P),void 0,!0):ve(void 0,P,!0):de!=="none"&&Le(T.selectRow,d,y)?W.hasIndex(X)?Ie(W.remove(X),void 0,!0):de==="single"?Ie(rt.fromSingleSelection(X),void 0,!0):Ie(void 0,X,!0):!Vo&&D!==void 0&&Le(T.activateCell,d,y)?X===ke&&at?window.setTimeout(()=>{const ge=Mr(P);Io(ge??P)},0):($==null||$([P-H,X]),Eo(D,!0)):L.current.range.height>1&&Le(T.downFill,d,y)?Ui():L.current.range.width>1&&Le(T.rightFill,d,y)?Ki():Le(T.goToNextPage,d,y)?X+=Math.max(1,Tt.current.height-4):Le(T.goToPreviousPage,d,y)?X-=Math.max(1,Tt.current.height-4):Le(T.goToFirstCell,d,y)?(i(void 0),X=0,P=0):Le(T.goToLastCell,d,y)?(i(void 0),X=Number.MAX_SAFE_INTEGER,P=Number.MAX_SAFE_INTEGER):Le(T.selectToFirstCell,d,y)?(i(void 0),wn([-2,-2])):Le(T.selectToLastCell,d,y)?(i(void 0),wn([2,2])):Vo?(Le(T.closeOverlay,d,y)&&i(void 0),Le(T.acceptOverlayDown,d,y)&&(i(void 0),X++),Le(T.acceptOverlayUp,d,y)&&(i(void 0),X--),Le(T.acceptOverlayLeft,d,y)&&(i(void 0),P--),Le(T.acceptOverlayRight,d,y)&&(i(void 0),P++)):(Le(T.goDownCell,d,y)?X+=1:Le(T.goUpCell,d,y)?X-=1:Le(T.goRightCell,d,y)?P+=1:Le(T.goLeftCell,d,y)?P-=1:Le(T.goDownCellRetainSelection,d,y)?(X+=1,Q=!0):Le(T.goUpCellRetainSelection,d,y)?(X-=1,Q=!0):Le(T.goRightCellRetainSelection,d,y)?(P+=1,Q=!0):Le(T.goLeftCellRetainSelection,d,y)?(P-=1,Q=!0):Le(T.goToLastRow,d,y)?X=ke-1:Le(T.goToFirstRow,d,y)?X=Number.MIN_SAFE_INTEGER:Le(T.goToLastColumn,d,y)?P=Number.MAX_SAFE_INTEGER:Le(T.goToFirstColumn,d,y)?P=Number.MIN_SAFE_INTEGER:(j==="rect"||j==="multi-rect")&&(Le(T.selectGrowDown,d,y)?wn([0,1]):Le(T.selectGrowUp,d,y)?wn([0,-1]):Le(T.selectGrowRight,d,y)?wn([1,0]):Le(T.selectGrowLeft,d,y)?wn([-1,0]):Le(T.selectToLastRow,d,y)?wn([0,2]):Le(T.selectToFirstRow,d,y)?wn([0,-2]):Le(T.selectToLastColumn,d,y)?wn([2,0]):Le(T.selectToFirstColumn,d,y)&&wn([-2,0])),me=y.didMatch),mn!==void 0&&mn!=="normal"&&X!==Y){const ge=mn==="skip-up"||mn==="skip"||mn==="block",Xe=mn==="skip-down"||mn==="skip"||mn==="block",st=X<Y;if(st&&ge){for(;X>=0&&lo(X).isGroupHeader;)X--;X<0&&(X=Y)}else if(!st&&Xe){for(;X<ke&&lo(X).isGroupHeader;)X++;X>=ke&&(X=Y)}}const we=_n(P,X,!1,Q),ie=y.didMatch;return ie&&(we||!me||Hn)&&p(),ie},[mn,Vo,L,vn,Ee,de,j,H,lo,ke,_n,V,Mt,C.length,se,Hn,co,ve,Ie,at,Mr,Io,$,Eo,Ui,Ki,wn]),qo=a.useCallback(d=>{let p=!1;if(ht!==void 0&&ht({...d,cancel:()=>{p=!0}}),p||Vi(d)||L.current===void 0)return;const[y,D]=L.current.cell,I=Tt.current;if(et&&!d.metaKey&&!d.ctrlKey&&L.current!==void 0&&d.key.length===1&&/[ -~]/g.test(d.key)&&d.bounds!==void 0&&tr(R([y-H,Math.max(0,Math.min(D,ke-1))]))){if((!at||D!==ke)&&(I.y>D||D>I.y+I.height||I.x>y||y>I.x+I.width))return;Eo(d.bounds,!0,d.key),d.stopPropagation(),d.preventDefault()}},[et,ht,Vi,L,R,H,ke,at,Eo]),Ts=a.useCallback((d,p)=>{const y=d.location[0]-H;if(d.kind==="header"&&(U==null||U(y,{...d,preventDefault:p})),d.kind===dn){if(y<0)return;J==null||J(y,{...d,preventDefault:p})}if(d.kind==="cell"){const[D,I]=d.location;Ce==null||Ce([y,I],{...d,preventDefault:p}),ka(L,d.location)||_n(D,I,!1,!1)}},[L,Ce,J,U,H,_n]),gi=a.useCallback(async d=>{var T,P,X;if(!vn.paste)return;function p(Y,Q,me,ee){var ie,Ne;const we=typeof me=="object"?(me==null?void 0:me.join(`
`))??"":(me==null?void 0:me.toString())??"";if(!Ao(Y)&&tr(Y)&&Y.readonly!==!0){const Se=N==null?void 0:N(we,Y);if(Se!==void 0&&To(Se))return{location:Q,value:Se};const ge=pt(Y);if(ge===void 0)return;if(ge.kind===q.Custom){Qt(Y.kind===q.Custom);const Xe=(ie=ge.onPaste)==null?void 0:ie.call(ge,we,Y.data);return Xe===void 0?void 0:{location:Q,value:{...Y,data:Xe}}}else{const Xe=(Ne=ge.onPaste)==null?void 0:Ne.call(ge,we,Y,{formatted:ee,formattedString:typeof ee=="string"?ee:ee==null?void 0:ee.join(`
`),rawValue:me});return Xe===void 0?void 0:(Qt(Xe.kind===Y.kind),{location:Q,value:Xe})}}}const y=L.columns,D=L.rows,I=((T=ut.current)==null?void 0:T.contains(document.activeElement))===!0||((P=s.current)==null?void 0:P.contains(document.activeElement))===!0;let W;if(L.current!==void 0?W=[L.current.range.x,L.current.range.y]:y.length===1?W=[y.first()??0,0]:D.length===1&&(W=[H,D.first()??0]),I&&W!==void 0){let Y,Q;const me="text/plain",ee="text/html";if(navigator.clipboard.read!==void 0){const Se=await navigator.clipboard.read();for(const ge of Se){if(ge.types.includes(ee)){const st=await(await ge.getType(ee)).text(),Ot=kl(st);if(Ot!==void 0){Y=Ot;break}}ge.types.includes(me)&&(Q=await(await ge.getType(me)).text())}}else if(navigator.clipboard.readText!==void 0)Q=await navigator.clipboard.readText();else if(d!==void 0&&(d==null?void 0:d.clipboardData)!==null){if(d.clipboardData.types.includes(ee)){const Se=d.clipboardData.getData(ee);Y=kl(Se)}Y===void 0&&d.clipboardData.types.includes(me)&&(Q=d.clipboardData.getData(me))}else return;const[we,ie]=W,Ne=[];do{if(Fe===void 0){const Se=jt(W),ge=Q??(Y==null?void 0:Y.map(st=>st.map(Ot=>Ot.rawValue).join("	")).join("	"))??"",Xe=p(Se,W,ge,void 0);Xe!==void 0&&Ne.push(Xe);break}if(Y===void 0){if(Q===void 0)return;Y=Cd(Q)}if(Fe===!1||typeof Fe=="function"&&(Fe==null?void 0:Fe([W[0]-H,W[1]],Y.map(Se=>Se.map(ge=>{var Xe;return((Xe=ge.rawValue)==null?void 0:Xe.toString())??""}))))!==!0)return;for(const[Se,ge]of Y.entries()){if(Se+ie>=ke)break;for(const[Xe,st]of ge.entries()){const Ot=[Xe+we,Se+ie],[bn,xn]=Ot;if(bn>=Je.length||xn>=$t)continue;const kn=jt(Ot),Ln=p(kn,Ot,st.rawValue,st.formatted);Ln!==void 0&&Ne.push(Ln)}}}while(!1);sn(Ne),(X=qt.current)==null||X.damage(Ne.map(Se=>({cell:Se.location})))}},[N,pt,jt,L,vn.paste,ut,Je.length,sn,$t,Fe,H,ke]);Bt("paste",gi,w,!1,!0);const jo=a.useCallback(async(d,p)=>{var T,P;if(!vn.copy)return;const y=p===!0||((T=ut.current)==null?void 0:T.contains(document.activeElement))===!0||((P=s.current)==null?void 0:P.contains(document.activeElement))===!0,D=L.columns,I=L.rows,W=(X,Y)=>{if(!tt)Ml(X,Y,d);else{const Q=Y.map(me=>({kind:q.Text,data:C[me].title,displayData:C[me].title,allowOverlay:!1}));Ml([Q,...X],Y,d)}};if(y&&k!==void 0){if(L.current!==void 0){let X=k(L.current.range,Pt.current.signal);typeof X!="object"&&(X=await X()),W(X,ho(L.current.range.x-H,L.current.range.x+L.current.range.width-H))}else if(I!==void 0&&I.length>0){const Y=[...I].map(Q=>{const me=k({x:H,y:Q,width:C.length,height:1},Pt.current.signal);return typeof me=="object"?me[0]:me().then(ee=>ee[0])});if(Y.some(Q=>Q instanceof Promise)){const Q=await Promise.all(Y);W(Q,ho(C.length))}else W(Y,ho(C.length))}else if(D.length>0){const X=[],Y=[];for(const Q of D){let me=k({x:Q,y:0,width:1,height:ke},Pt.current.signal);typeof me!="object"&&(me=await me()),X.push(me),Y.push(Q-H)}if(X.length===1)W(X[0],Y);else{const Q=X.reduce((me,ee)=>me.map((we,ie)=>[...we,...ee[ie]]));W(Q,Y)}}}},[C,k,L,vn.copy,H,ut,ke,tt]);Bt("copy",jo,w,!1,!1);const As=a.useCallback(async d=>{var y,D;if(!(!vn.cut||!(((y=ut.current)==null?void 0:y.contains(document.activeElement))===!0||((D=s.current)==null?void 0:D.contains(document.activeElement))===!0))&&(await jo(d),L.current!==void 0)){let I={current:{cell:L.current.cell,range:L.current.range,rangeStack:[]},rows:rt.empty(),columns:rt.empty()};const W=se==null?void 0:se(I);if(W===!1||(I=W===!0?I:W,I.current===void 0))return;co(I.current.range)}},[co,L,vn.cut,jo,ut,se]);Bt("cut",As,w,!1,!1);const zs=a.useCallback((d,p)=>{if(pe!==void 0){H!==0&&(d=d.map(I=>[I[0]-H,I[1]])),pe(d,p);return}if(d.length===0||p===-1)return;const[y,D]=d[p];u.current!==void 0&&u.current[0]===y&&u.current[1]===D||(u.current=[y,D],_n(y,D,!1,!1))},[pe,H,_n]),[Ir,Fr]=((tl=Ut==null?void 0:Ut.current)==null?void 0:tl.cell)??[],Dr=a.useRef(It);Dr.current=It,a.useLayoutEffect(()=>{var d,p,y,D;hi.current&&!pr.current&&Ir!==void 0&&Fr!==void 0&&(Ir!==((p=(d=oe.current)==null?void 0:d.current)==null?void 0:p.cell[0])||Fr!==((D=(y=oe.current)==null?void 0:y.current)==null?void 0:D.cell[1]))&&Dr.current(Ir,Fr),pr.current=!1},[Ir,Fr]);const qi=L.current!==void 0&&(L.current.cell[0]>=Je.length||L.current.cell[1]>=$t);a.useLayoutEffect(()=>{qi&&V(Pr,!1)},[qi,V]);const Bs=a.useMemo(()=>at===!0&&(Oe==null?void 0:Oe.tint)===!0?rt.fromSingleSelection($t-1):rt.empty(),[$t,at,Oe==null?void 0:Oe.tint]),Ls=a.useCallback(d=>typeof nt=="boolean"?nt:(nt==null?void 0:nt(d-H))??!0,[H,nt]),Ps=a.useMemo(()=>{if(si===void 0||s.current===null)return null;const{bounds:d,group:p}=si,y=s.current.getBoundingClientRect();return a.createElement(dd,{bounds:d,group:p,canvasBounds:y,onClose:()=>ai(void 0),onFinish:D=>{ai(void 0),ue==null||ue(p,D)}})},[ue,si]),Ws=Math.min(Je.length,ze+(rn?1:0));a.useImperativeHandle(t,()=>({appendRow:(d,p)=>Io(d+H,p),updateCells:d=>{var p;return H!==0&&(d=d.map(y=>({cell:[y.cell[0]+H,y.cell[1]]}))),(p=qt.current)==null?void 0:p.damage(d)},getBounds:(d,p)=>{var y;if(!((s==null?void 0:s.current)===null||(ut==null?void 0:ut.current)===null)){if(d===void 0&&p===void 0){const D=s.current.getBoundingClientRect(),I=D.width/ut.current.clientWidth;return{x:D.x-ut.current.scrollLeft*I,y:D.y-ut.current.scrollTop*I,width:ut.current.scrollWidth*I,height:ut.current.scrollHeight*I}}return(y=qt.current)==null?void 0:y.getBounds((d??0)+H,p)}},focus:()=>{var d;return(d=qt.current)==null?void 0:d.focus()},emit:async d=>{switch(d){case"delete":qo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":qo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":qo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await jo(void 0,!0);break;case"paste":await gi();break}},scrollTo:It,remeasureColumns:d=>{for(const p of d)Rr(p+H)}}),[Io,Rr,ut,jo,qo,gi,H,It]);const[ji,Zi]=Cn??[],$s=a.useCallback(d=>{const[p,y]=d;if(y===-1){Ee!=="none"&&(ve(rt.fromSingleSelection(p),void 0,!1),Gt());return}ji===p&&Zi===y||(De({cell:d,range:{x:p,y,width:1,height:1}},!0,!1,"keyboard-nav"),It(p,y))},[Ee,Gt,It,ji,Zi,De,ve]),[Os,Ns]=a.useState(!1),Ji=a.useRef(Tl(d=>{Ns(d)},5)),Xs=a.useCallback(()=>{Ji.current(!0),z==null||z(),L.current===void 0&&L.columns.length===0&&L.rows.length===0&&c===void 0&&De({cell:[H,vr],range:{x:H,y:vr,width:1,height:1}},!0,!1,"keyboard-select")},[vr,L,c,H,De]),Ys=a.useCallback(()=>{Ji.current(!1),B==null||B()},[B]),[Gs,Ks]=a.useMemo(()=>{let d;const p=(Ze==null?void 0:Ze.scrollbarWidthOverride)??xi(),y=ke+(at?1:0);if(typeof pn=="number")d=Wt+y*pn;else{let I=0;const W=Math.min(y,10);for(let T=0;T<W;T++)I+=pn(T);I=Math.floor(I/W),d=Wt+y*I}d+=p;const D=Je.reduce((I,W)=>W.width+I,0)+p;return[`${Math.min(1e5,D)}px`,`${Math.min(1e5,d)}px`]},[Je,Ze==null?void 0:Ze.scrollbarWidthOverride,pn,ke,at,Wt]),Us=a.useMemo(()=>La(Ve),[Ve]);return a.createElement(Zl.Provider,{value:Ve},a.createElement(Md,{style:Us,className:Z,inWidth:m??Gs,inHeight:x??Ks},a.createElement(ld,{fillHandle:Dt,drawFocusRing:Wo,experimental:Ze,fixedShadowX:In,fixedShadowY:dr,getRowThemeOverride:on,headerIcons:On,imageWindowLoader:Fn,initialSize:Dn,isDraggable:bo,onDragLeave:ur,onRowMoved:Nn,overscrollX:Xo,overscrollY:ni,preventDiagonalScrolling:vo,rightElement:Co,rightElementProps:Qn,smoothScrollX:Vr,smoothScrollY:fr,className:Z,enableGroups:Yt,onCanvasFocused:Xs,onCanvasBlur:Ys,canvasRef:s,onContextMenu:Ts,theme:Ve,cellXOffset:bs,cellYOffset:vr,accessibilityHeight:ro.height,onDragEnd:Is,columns:Je,nonGrowWidth:ot,drawHeader:he,onColumnProposeMove:ne,drawCell:Ht,disabledRows:Bs,freezeColumns:Ws,lockColumns:H,firstColAccessible:H===0,getCellContent:jt,minColumnWidth:zn,maxColumnWidth:oo,searchInputRef:l,showSearch:Mo,onSearchClose:oi,highlightRegions:ys,getCellsForSelection:k,getGroupDetails:ii,headerHeight:No,isFocused:Os,groupHeaderHeight:Yt?wr:0,freezeTrailingRows:Ft+(at&&(Oe==null?void 0:Oe.sticky)===!0?1:0),hasAppendRow:at,onColumnResize:te,onColumnResizeEnd:Te,onColumnResizeStart:Ae,onCellFocused:$s,onColumnMoved:Rs,onDragStart:Es,onHeaderMenuClick:ks,onHeaderIndicatorClick:Ss,onItemHovered:fi,isFilling:(c==null?void 0:c.fillHandle)===!0,onMouseMove:xs,onKeyDown:qo,onKeyUp:it,onMouseDown:ps,onMouseUp:Cs,onDragOverCell:nn,onDrop:Nt,onSearchResultsChanged:zs,onVisibleRegionChanged:Ms,clientSize:Xt,rowHeight:pn,searchResults:xe,searchValue:Qe,onSearchValueChange:qe,rows:$t,scrollRef:ut,selection:L,translateX:ro.tx,translateY:ro.ty,verticalBorder:Ls,gridRef:qt,getCellRenderer:pt,resizeIndicator:hr}),Ps,r!==void 0&&a.createElement(a.Suspense,{fallback:null},a.createElement(Ld,{...r,validateCell:ce,bloom:E,id:Hs,getCellRenderer:pt,className:(Ze==null?void 0:Ze.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:Lt,imageEditorOverride:b,onFinishEditing:Ds,markdownDivCreateNode:h,isOutsideClick:Jr}))))},Od=a.forwardRef($d),gs=20;function Il(e){const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:l,height:s,x:c,y:f}=r,u=t.maxSize??gs,w=Math.floor(r.y+s/2),b=Ll(u,s,i.cellVerticalPadding),g=Bl(t.contentAlign??"center",c,l,i.cellHorizontalPadding,b),h=zl(g,w,b),m=Pl(c+n,f+o,h);return Ii(t)&&m}const Nd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:q.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>Xd(e,e.cell.data,Ii(e.cell),e.cell.maxSize??gs,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Il(e)&&e.preventDefault()},onClick:e=>{if(Il(e))return{...e.cell,data:us(e.cell.data)}},onPaste:(e,t)=>{let n=Or;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Ei),n===t.data?void 0:{...t,data:n}}};function Xd(e,t,n,o,r){if(!n&&t===Or)return;const{ctx:i,hoverAmount:l,theme:s,rect:c,highlighted:f,hoverX:u,hoverY:w,cell:{contentAlign:b}}=e,{x:g,y:h,width:m,height:x}=c;let C=!1;if(r>0){let v=n?1-r+r*l:.4;if(t===Or&&(v*=l),v===0)return;v<1&&(C=!0,i.globalAlpha=v)}Bi(i,s,t,g,h,m,x,f,u,w,o,b),C&&(i.globalAlpha=1)}const Yd=tn("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),Gd=e=>{const{bubbles:t}=e;return a.createElement(Yd,null,t.map((n,o)=>a.createElement("div",{key:o,className:"boe-bubble"},n)),a.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},Kd=Gd,Ud={getAccessibilityString:e=>Wl(e.data),kind:q.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>Zt(r,e,n.baseFontFull).width+o+20,0)+2*n.cellHorizontalPadding-4,draw:e=>Vd(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return a.createElement(Kd,{bubbles:t.data})},onPaste:()=>{}},_d=4;function Vd(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:l,y:s,width:c,height:f}=n,u=20,w=8,b=_d;let g=l+o.cellHorizontalPadding;const h=[];for(const m of t){if(g>l+c)break;const x=Zt(m,r,o.baseFontFull).width;h.push({x:g,width:x}),g+=x+w*2+b}r.beginPath();for(const m of h)Mn(r,m.x,s+(f-u)/2,m.width+w*2,u,o.roundingRadius??u/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[m,x]of h.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[m],x.x+w,s+f/2+Zn(r,o))}const qd=tn("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),jd=e=>{const{drilldowns:t}=e;return a.createElement(qd,null,t.map((n,o)=>a.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&a.createElement("img",{src:n.img}),a.createElement("div",null,n.text))))},Zd=jd,Jd={getAccessibilityString:e=>Wl(e.data.map(t=>t.text)),kind:q.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>Zt(r.text,e,n.baseFontFull).width+o+20+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>tu(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return a.createElement(Zd,{drilldowns:t.data})},onPaste:()=>{}},Qd=4,ir={};function eu(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,l=n-i*2,s=4,c=n*r,f=o+i,u=o*3,w=(u+i*2)*r,b=`${e},${t},${r},${n}`;if(ir[b]!==void 0)return{el:ir[b],height:c,width:w,middleWidth:s*r,sideWidth:f*r,padding:i*r,dpr:r};const g=document.createElement("canvas"),h=g.getContext("2d");return h===null?null:(g.width=w,g.height=c,h.scale(r,r),ir[b]=g,h.beginPath(),Mn(h,i,i,u,l,o),h.shadowColor="rgba(24, 25, 34, 0.4)",h.shadowBlur=1,h.fillStyle=e,h.fill(),h.shadowColor="rgba(24, 25, 34, 0.3)",h.shadowOffsetY=1,h.shadowBlur=5,h.fillStyle=e,h.fill(),h.shadowOffsetY=0,h.shadowBlur=0,h.shadowBlur=0,h.beginPath(),Mn(h,i+.5,i+.5,u,l,o),h.strokeStyle=t,h.lineWidth=1,h.stroke(),{el:g,height:c,width:w,sideWidth:f*r,middleWidth:o*r,padding:i*r,dpr:r})}function tu(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:l,row:s}=e,{x:c,width:f}=n,u=o.baseFontFull,w=Ul(r,u),b=Math.min(n.height,Math.max(16,Math.ceil(w*o.lineHeight)*2)),g=Math.floor(n.y+(n.height-b)/2),h=b-10,m=8,x=Qd;let C=c+o.cellHorizontalPadding;const v=o.roundingRadius??6,R=eu(o.bgCell,o.drilldownBorder,b,v),O=[];for(const $ of t){if(C>c+f)break;const B=Zt($.text,r,u).width;let _=0;if($.img!==void 0){const N=i.loadOrGetImage($.img,l,s);N!==void 0&&(N instanceof HTMLImageElement?N.complete&&N.naturalWidth>0&&N.naturalHeight>0:N.width>0&&N.height>0)&&(_=h-8+4)}const S=B+_+m*2;O.push({x:C,width:S}),C+=S+x}if(R!==null){const{el:$,height:z,middleWidth:B,sideWidth:_,width:S,dpr:N,padding:A}=R;if($.width>0&&$.height>0){const F=_/N,E=A/N;for(const M of O){const ne=Math.floor(M.x),le=Math.floor(M.width),ae=le-(F-E)*2;r.imageSmoothingEnabled=!1;try{r.drawImage($,0,0,_,z,ne-E,g,F,b),ae>0&&r.drawImage($,_,0,B,z,ne+(F-E),g,ae,b),r.drawImage($,S-_,0,_,z,ne+le-(F-E),g,F,b)}catch{const be=`${o.bgCell}_${o.drilldownBorder}_${b}_${v}`;delete ir[be]}r.imageSmoothingEnabled=!0}}else{const F=`${o.bgCell}_${o.drilldownBorder}_${b}_${v}`;delete ir[F]}}r.beginPath();for(const[$,z]of O.entries()){const B=t[$];let _=z.x+m;if(B.img!==void 0){const S=i.loadOrGetImage(B.img,l,s);if(S!==void 0&&(S instanceof HTMLImageElement?S.complete&&S.naturalWidth>0&&S.naturalHeight>0:S.width>0&&S.height>0)){const A=h-8;let F=0,E=0,M=S.width,ne=S.height;M>ne?(F+=(M-ne)/2,M=ne):ne>M&&(E+=(ne-M)/2,ne=M),r.beginPath(),Mn(r,_,g+b/2-A/2,A,A,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(S,F,E,M,ne,_,g+b/2-A/2,A,A),r.restore(),_+=A+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(B.text,_,g+b/2+Zn(r,o))}}const nu={getAccessibilityString:e=>e.data.join(", "),kind:q.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>ou(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??ma;return a.createElement(r,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},vi=4;function ou(e,t,n,o){const{rect:r,col:i,row:l,theme:s,ctx:c,imageLoader:f}=e,{x:u,y:w,height:b,width:g}=r,h=b-s.cellVerticalPadding*2,m=[];let x=0;for(let v=0;v<t.length;v++){const R=t[v];if(R.length===0)continue;const O=f.loadOrGetImage(R,i,l);if(O!==void 0){m[v]=O;const $=O.width*(h/O.height);x+=$+vi}}if(x===0)return;x-=vi;let C=u+s.cellHorizontalPadding;o==="right"?C=Math.floor(u+g-s.cellHorizontalPadding-x):o==="center"&&(C=Math.floor(u+g/2-x/2));for(const v of m){if(v===void 0)continue;const R=v.width*(h/v.height);n>0&&(c.beginPath(),Mn(c,C,w+s.cellVerticalPadding,R,h,n),c.save(),c.clip()),c.drawImage(v,C,w+s.cellVerticalPadding,R,h),n>0&&c.restore(),C+=R+vi}}function ru(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const iu={getAccessibilityString:()=>"",kind:q.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:l}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let s=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(s+=Math.round(ru(n,o)*t.skeletonWidthVariability));const c=l.cellHorizontalPadding;s+c*2>=i.width&&(s=i.width-c*2-1);const f=t.skeletonHeight??Math.min(18,i.height-2*l.cellVerticalPadding);Mn(r,i.x+c,i.y+(i.height-f)/2,s,f,l.roundingRadius??3),r.fillStyle=mo(l.textDark,.1),r.fill()},onPaste:()=>{}},lu=()=>e=>e.targetWidth,Fl=tn("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[lu(),"px"]}}),su=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:l,validatedSelection:s}=e,c=t.data,f=t.readonly===!0,[u,w]=a.useState(c===""||o),b=a.useCallback(()=>{w(h=>!h)},[]),g=c?"gdg-ml-6":"";return u?a.createElement(Fl,{targetWidth:i.width-20},a.createElement(Ur,{autoFocus:!0,highlight:!1,validatedSelection:s,value:c,onKeyDown:h=>{h.key==="Enter"&&h.stopPropagation()},onChange:n}),a.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${g}`,onClick:()=>l(t)},a.createElement(aa,null))):a.createElement(Fl,{targetWidth:i.width},a.createElement(ba,{contents:c,createNode:r}),!f&&a.createElement(a.Fragment,null,a.createElement("div",{className:"spacer"}),a.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${g}`,onClick:b},a.createElement(Fi,null))),a.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},au={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:q.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:cr,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return Zt(o,e,n.baseFontFull).width+2*n.cellHorizontalPadding},draw:e=>Sn(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:l,validatedSelection:s}=e;return a.createElement(su,{onFinish:r,targetRect:o,value:n,validatedSelection:s,onChange:c=>t({...n,data:c.target.value}),forceEditMode:l,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},cu={getAccessibilityString:e=>e.row.toString(),kind:un.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:du,measure:()=>44,draw:e=>fu(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e,{width:i,height:l}=t,s=n.drawHandle?7+(i-7)/2:i/2,c=l/2;if(Math.abs(o-s)<=10&&Math.abs(r-c)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function du(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=uu,n.textAlign="center",i}function uu(e){const{ctx:t}=e;t.textAlign="start"}function fu(e,t,n,o,r,i){const{ctx:l,rect:s,hoverAmount:c,theme:f}=e,{x:u,y:w,width:b,height:g}=s,h=n?1:o==="checkbox-visible"?.6+.4*c:c;if(o!=="number"&&h>0){l.globalAlpha=h;const m=7*(n?c:1);if(Bi(l,f,n,r?u+m:u,w,r?b-m:b,g,!0,void 0,void 0,18,"center",i),r){l.globalAlpha=c,l.beginPath();for(const x of[3,6])for(const C of[-5,-1,3])l.rect(u+x,w+g/2+C,2,2);l.fillStyle=f.textLight,l.fill(),l.beginPath()}l.globalAlpha=1}if(o==="number"||o==="both"&&!n){const m=t.toString(),x=f.markerFontFull,C=u+b/2;o==="both"&&c!==0&&(l.globalAlpha=1-c),l.fillStyle=f.textLight,l.font=x,l.fillText(m,C,w+g/2+Zn(l,x)),c!==0&&(l.globalAlpha=1)}}const hu={getAccessibilityString:()=>"",kind:un.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>gu(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function gu(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:l,spriteManager:s}=e,{x:c,y:f,width:u,height:w}=r;o.beginPath(),o.globalAlpha=i,o.rect(c+1,f+1,u,w-2),o.fillStyle=l.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const b=t!=="";let g=0;if(n!==void 0){const m=w-8,x=c+8/2,C=f+8/2;s.drawSprite(n,"normal",o,x,C,m,l,b?1:i),g=m}else{g=24;const h=12,m=b?h:i*h,x=b?0:(1-i)*h*.5,C=l.cellHorizontalPadding+4;m>0&&(o.moveTo(c+C+x,f+w/2),o.lineTo(c+C+x+m,f+w/2),o.moveTo(c+C+x+m*.5,f+w/2-m*.5),o.lineTo(c+C+x+m*.5,f+w/2+m*.5),o.lineWidth=2,o.strokeStyle=l.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=l.textMedium,o.fillText(t,g+c+l.cellHorizontalPadding+.5,f+w/2+Zn(o,l)),o.beginPath()}function ms(e,t,n,o,r,i,l){e.textBaseline="alphabetic";const s=mu(e,r,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),Mn(e,s.x,s.y,s.width,s.height,t.roundingRadius??4),e.globalAlpha=i,e.fillStyle=(n==null?void 0:n.bgColor)??mo(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",l==null||l("text")}function mu(e,t,n,o,r){const i=o.cellHorizontalPadding,l=o.cellVerticalPadding;if(r)return{x:t.x+i/2,y:t.y+l/2+1,width:t.width-i,height:t.height-l-1};const s=Zt(n,e,o.baseFontFull,"alphabetic"),c=t.height-l,f=Math.min(c,s.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-f)/2+1,width:s.width+i*3,height:f-1}}const wu=a.lazy(async()=>await Hl(()=>import("./number-overlay-editor-fo52B4Ih.js"),__vite__mapDeps([8,1,3,9]),import.meta.url)),bu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:q.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:cr,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:r,rect:i,overrideCursor:l}=e,{hoverEffect:s,displayData:c,hoverEffectTheme:f}=n;s===!0&&t>0&&ms(o,r,f,c,i,t,l),Sn(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>Zt(t.displayData,e,n.baseFontFull).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return a.createElement(a.Suspense,{fallback:null},a.createElement(wu,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:r,onChange:i=>n({...o,data:Number.isNaN(i.floatValue??0)?0:i.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},yu={getAccessibilityString:()=>"",measure:()=>108,kind:q.Protected,needsHover:!1,needsHoverPosition:!1,draw:pu,onPaste:()=>{}};function pu(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:l}=o;t.beginPath();const s=2.5;let c=r+n.cellHorizontalPadding+s;const f=i+l/2,u=Math.cos(sl(30))*s,w=Math.sin(sl(30))*s;for(let b=0;b<12;b++)t.moveTo(c,f-s),t.lineTo(c,f+s),t.moveTo(c+u,f-w),t.lineTo(c-u,f+w),t.moveTo(c-u,f-w),t.lineTo(c+u,f+w),c+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const vu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:q.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>cr(e,t,e.theme.textLight),draw:e=>Sn(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>Zt(t.data,e,n.baseFontFull).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return xt.createElement(Ur,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:r,onChange:i=>n({...o,data:i.target.value})})},onPaste:()=>{}},Cu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:q.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:cr,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:l,overrideCursor:s}=e,{displayData:c,contentAlign:f,hoverEffect:u,allowWrapping:w,hoverEffectTheme:b}=t;u===!0&&n>0&&ms(r,l,b,c,i,n,s),Sn(e,c,f,w,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,Zt(i,e,n.baseFontFull).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return a.createElement(Ur,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:l=>o({...r,data:l.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},xu=tn("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),ku=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:l}=e,[s,c]=a.useState(!r&&(t===""||o)),f=a.useCallback(()=>{c(!0)},[]);return s?a.createElement(Ur,{validatedSelection:i,highlight:!0,autoFocus:!0,value:t,onChange:n}):a.createElement(xu,null,a.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},l),!r&&a.createElement("div",{className:"gdg-edit-icon",onClick:f},a.createElement(Fi,null)),a.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},Su=ku;function ws(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,l=e.width,s=e.actualBoundingBoxAscent;return o==="right"?r=t.width-l-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-l/2),{x:r,y:i,width:l,height:s}}function Dl(e){const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,l=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const s=Gl(l,i.baseFontFull);if(s===void 0)return!1;const c=ws(s,n,i,t.contentAlign);return go({x:c.x-4,y:c.y-4,width:c.width+8,height:c.height+8},o,r)}const Mu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:q.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:cr,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:l,ctx:s}=e,c=t.displayData??t.data,f=t.hoverEffect===!0;if(o!==void 0&&f&&r!==void 0&&i!==void 0){const u=Zt(c,s,n.baseFontFull),w=ws(u,l,n,t.contentAlign),{x:b,y:g,width:h,height:m}=w;if(r>=b-4&&r<=b-4+h+8&&i>=g-4&&i<=g-4+m+8){const x=Zn(s,n.baseFontFull);o("pointer");const C=5,v=g-x;s.beginPath(),s.moveTo(l.x+b,Math.floor(l.y+v+m+C)+.5),s.lineTo(l.x+b+h,Math.floor(l.y+v+m+C)+.5),s.strokeStyle=n.linkColor,s.stroke(),s.save(),s.fillStyle=e.cellFillColor,Sn({...e,rect:{...l,x:l.x-1}},c,t.contentAlign),Sn({...e,rect:{...l,x:l.x-2}},c,t.contentAlign),Sn({...e,rect:{...l,x:l.x+1}},c,t.contentAlign),Sn({...e,rect:{...l,x:l.x+2}},c,t.contentAlign),s.restore()}}s.fillStyle=f?n.linkColor:n.textDark,Sn(e,c,t.contentAlign)},onSelect:e=>{Dl(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;Dl(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>Zt(t.displayData??t.data,e,n.baseFontFull).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return a.createElement(Su,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:l=>n({...o,data:l.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Ru=[cu,hu,Nd,Ud,Jd,nu,iu,au,bu,yu,vu,Cu,Mu],Ci=[];class Eu extends Vl{constructor(){super(...arguments);$e(this,"imageLoaded",()=>{});$e(this,"loadedLocations",[]);$e(this,"cache",{});$e(this,"sendLoaded",ea(()=>{this.imageLoaded(new rr(this.loadedLocations)),this.loadedLocations=[]},20));$e(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let l=0;l<r.cells.length;l++){const s=r.cells[l];if(this.isInWindow(s)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let l=!1;const s=Ci.pop()??new Image;let c=!1;const f={img:void 0,cells:[yn(o,r)],url:n,cancel:()=>{c||(c=!0,Ci.length<12?Ci.unshift(s):l||(s.src=""))}},u=new Promise(w=>s.addEventListener("load",()=>w(null)));requestAnimationFrame(async()=>{try{s.src=n,await u,await s.decode();const w=this.cache[i];if(w!==void 0&&!c){w.img=s;for(const b of w.cells)this.loadedLocations.push(zi(b));l=!0,this.sendLoaded()}}catch{f.cancel()}}),this.cache[i]=f}loadOrGetImage(n,o,r){const i=n,l=this.cache[i];if(l!==void 0){const s=yn(o,r);return l.cells.includes(s)||l.cells.push(s),l.img}else this.loadImage(n,o,r,i)}}const Iu=Eu,Fu=(e,t)=>{const n=a.useMemo(()=>({...gc,...e.headerIcons}),[e.headerIcons]),o=a.useMemo(()=>e.imageWindowLoader??new Iu,[e.imageWindowLoader]);return a.createElement(Od,{...e,renderers:Ru,headerIcons:n,ref:t,imageWindowLoader:o})},Nu=a.forwardRef(Fu);export{sd as C,Nu as D,q as G,Zl as T,Ur as a,en as b,Wu as c,$u as d,Lu as e,To as f,Zn as g,rl as h,Pu as i,Ao as j,ra as k,La as l,Zt as m,Lo as p,Mn as r,Ou as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./data-grid-overlay-editor-SJccAyJ2.js","./index-KtDdPitk.js","./index-iY2XSz2k.js","./marked.esm-I79JNzkl.js","./iframe-DzV9Zd2n.js","./throttle-UPaD_CsS.js","./_baseIteratee-MFXT5464.js","./flatten-5Fd1fcTu.js","./number-overlay-editor-fo52B4Ih.js","./react-number-format.es-GxoQxwCo.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}